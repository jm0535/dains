{
  "hash": "ec8620e25a174cc948de0d251f44068e",
  "result": {
    "engine": "knitr",
    "markdown": "---\nprefer-html: true\n---\n\n# Exploratory Data Analysis\n\n## Introduction\n\n::: {.callout-note}\n## Learning Objectives\n\nBy the end of this chapter, you will be able to:\n\n1.  Calculate and interpret descriptive statistics (mean, median, standard deviation)\n2.  Create and analyze frequency tables for categorical data\n3.  Visualize distributions using histograms, density plots, and box plots\n4.  Explore relationships between variables using scatter plots and correlation matrices\n5.  Identify outliers and anomalies using statistical methods and visualizations\n6.  Analyze missing data patterns and their potential impact\n:::\n\nExploratory Data Analysis (EDA) is a critical first step in any data analysis project. In this chapter, you'll learn how to systematically explore your data to understand its structure, identify patterns, detect anomalies, and generate hypotheses for further investigation.\n\n## The Purpose of Exploratory Data Analysis\n\nExploratory Data Analysis serves several important purposes in natural sciences research:\n\n1. **Understanding Data Structure**: Gain insights into the basic properties of your dataset\n2. **Checking Data Quality**: Identify missing values, outliers, and potential errors\n3. **Discovering Patterns**: Detect relationships, trends, and distributions\n4. **Generating Hypotheses**: Develop questions and hypotheses for formal testing\n5. **Informing Analysis Choices**: Guide decisions about appropriate statistical methods\n\n::: {.callout-tip}\n## PROFESSIONAL TIP: Creating Reproducible EDA Workflows\n\nTo ensure your exploratory data analysis is reproducible and transparent:\n\n- **Document all data transformations**: Record every cleaning step, filter, and transformation applied to raw data\n- **Use R Markdown or Quarto**: Create executable documents that combine code, output, and narrative explanation\n- **Version control your analysis**: Track changes to your EDA scripts using Git or similar tools\n- **Save exploratory outputs**: Store key visualizations and summary statistics in organized directories\n- **Create clear data lineage**: Document the origin of each dataset and how it connects to derived datasets\n- **Use consistent naming conventions**: Apply systematic naming to files, variables, and functions\n- **Separate exploration from confirmation**: Clearly distinguish exploratory analyses from confirmatory hypothesis testing\n- **Include data validation checks**: Incorporate automated checks for data integrity and quality\n- **Provide detailed method documentation**: Document statistical approaches like ANOVA types (e.g., Type II tests for unbalanced designs)\n- **Share your EDA code**: Make your exploratory scripts available alongside final analyses for complete transparency\n:::\n\n## Summarizing Data\n\n### Descriptive Statistics\n\nDescriptive statistics provide a concise summary of your data's central tendency, dispersion, and shape:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(tidyverse)\n\n# Load the crop yield dataset\ncrop_yields <- read_csv(\"../data/agriculture/crop_yields.csv\")\n\n# Get summary statistics for wheat yields\nwheat_summary <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`)) %>%\n  summarize(\n    Mean = mean(`Wheat (tonnes per hectare)`, na.rm = TRUE),\n    Median = median(`Wheat (tonnes per hectare)`, na.rm = TRUE),\n    StdDev = sd(`Wheat (tonnes per hectare)`, na.rm = TRUE),\n    Min = min(`Wheat (tonnes per hectare)`, na.rm = TRUE),\n    Max = max(`Wheat (tonnes per hectare)`, na.rm = TRUE),\n    Q1 = quantile(`Wheat (tonnes per hectare)`, 0.25, na.rm = TRUE),\n    Q3 = quantile(`Wheat (tonnes per hectare)`, 0.75, na.rm = TRUE)\n  )\n```\n:::\n\n\n\n::: {#tbl-wheat-summary-stats .cell layout-align=\"center\" tbl-cap='Summary Statistics for Global Wheat Yields'}\n\n```{.r .cell-code}\n# Display the summary statistics\nknitr::kable(wheat_summary)\n```\n\n::: {.cell-output-display}\n\n\n|     Mean| Median|   StdDev| Min|     Max|    Q1|     Q3|\n|--------:|------:|--------:|---:|-------:|-----:|------:|\n| 2.434914|   1.99| 1.687949|   0| 10.6677| 1.228| 3.1245|\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Visualize the distribution of wheat yields\nggplot(crop_yields, aes(x = `Wheat (tonnes per hectare)`)) +\n  geom_histogram(bins = 30, fill = \"forestgreen\", color = \"black\", alpha = 0.7) +\n  labs(title = \"Distribution of Global Wheat Yields\",\n       x = \"Wheat Yield (tonnes per hectare)\",\n       y = \"Frequency\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Distribution of global wheat yields](03-exploratory-analysis_files/figure-html/fig-descriptive-stats-1.png){#fig-descriptive-stats fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {#tbl-top-wheat-countries .cell layout-align=\"center\" tbl-cap='Top 10 Countries by Average Wheat Yield'}\n\n```{.r .cell-code}\n# Identify top wheat-producing countries (by average yield)\ntop_wheat_countries <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`)) %>%\n  group_by(Entity) %>%\n  summarize(Avg_Yield = mean(`Wheat (tonnes per hectare)`, na.rm = TRUE)) %>%\n  arrange(desc(Avg_Yield)) %>%\n  head(10)\n\n# Display the top countries\nknitr::kable(top_wheat_countries)\n```\n\n::: {.cell-output-display}\n\n\n|Entity          | Avg_Yield|\n|:---------------|---------:|\n|Belgium         |  8.544200|\n|Netherlands     |  7.030172|\n|Ireland         |  6.829840|\n|United Kingdom  |  6.366400|\n|Denmark         |  6.175285|\n|Luxembourg      |  5.977411|\n|Germany         |  5.893978|\n|Europe, Western |  5.723267|\n|France          |  5.645341|\n|Northern Europe |  5.589988|\n\n\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code block demonstrates how to calculate and visualize descriptive statistics:\n\n1. `library(tidyverse)` loads the tidyverse collection of packages for data manipulation and visualization.\n2. `read_csv()` imports the crop yields dataset from a CSV file.\n3. `head()` displays the first few rows to inspect the data structure.\n4. The `summarize()` function calculates key statistics for wheat yields:\n   - `Mean`: Average yield across all observations\n   - `Median`: Middle value when yields are arranged in order\n   - `StdDev`: Standard deviation, measuring data dispersion\n   - `Min/Max`: Minimum and maximum values in the dataset\n   - `Q1/Q3`: First and third quartiles (25th and 75th percentiles)\n5. `knitr::kable()` creates a formatted table of the summary statistics.\n6. `ggplot()` with `geom_histogram()` visualizes the distribution of wheat yields.\n7. The final section identifies and displays the top 10 countries by average wheat yield using:\n   - `group_by()` to organize data by country\n   - `summarize()` to calculate average yield per country\n   - `arrange(desc())` to sort in descending order\n   - `head(10)` to select the top 10 entries\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe summary statistics reveal several key insights about global wheat yields:\n\n- The mean wheat yield is higher than the median, suggesting a right-skewed distribution with some countries achieving exceptionally high yields.\n- The standard deviation indicates substantial variability in wheat productivity across different regions.\n- The histogram confirms this skewed distribution, with most countries clustered at lower to moderate yield levels, and fewer countries achieving very high yields.\n- The top 10 countries table shows which nations have the most productive wheat cultivation systems, likely due to advanced agricultural practices, favorable climate conditions, or intensive farming methods.\n- This analysis provides a foundation for investigating factors that contribute to high wheat yields and potential strategies for improving agricultural productivity in lower-yielding regions.\n:::\n\n### Frequency Tables\n\nFrequency tables are useful for understanding the distribution of categorical variables:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Let's create a categorical variable based on wheat yield levels\ncrop_yields_with_categories <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`)) %>%\n  mutate(yield_category = case_when(\n    `Wheat (tonnes per hectare)` < 2 ~ \"Low\",\n    `Wheat (tonnes per hectare)` >= 2 & `Wheat (tonnes per hectare)` < 4 ~ \"Medium\",\n    `Wheat (tonnes per hectare)` >= 4 ~ \"High\"\n  ))\n\n# Frequency table for yield categories\ntable(crop_yields_with_categories$yield_category)\n#> \n#>   High    Low Medium \n#>   1279   4081   2741\n\n# Proportions\nprop.table(table(crop_yields_with_categories$yield_category))\n#> \n#>      High       Low    Medium \n#> 0.1578817 0.5037650 0.3383533\n\n# Create a decade variable for temporal analysis\ncrop_yields_with_categories <- crop_yields_with_categories %>%\n  mutate(decade = floor(Year / 10) * 10)\n\n# Two-way frequency table: yield category by decade\nyield_decade_table <- table(crop_yields_with_categories$yield_category,\n                            crop_yields_with_categories$decade)\nyield_decade_table\n#>         \n#>          1960 1970 1980 1990 2000 2010\n#>   High     34  102  200  261  326  356\n#>   Low     838  833  760  681  563  406\n#>   Medium  239  335  344  550  656  617\n\n# Convert to proportions (by row)\nprop.table(yield_decade_table, margin = 1)\n#>         \n#>                1960       1970       1980       1990       2000       2010\n#>   High   0.02658327 0.07974980 0.15637217 0.20406568 0.25488663 0.27834246\n#>   Low    0.20534183 0.20411664 0.18622887 0.16687086 0.13795638 0.09948542\n#>   Medium 0.08719445 0.12221817 0.12550164 0.20065669 0.23932871 0.22510033\n```\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code block demonstrates how to create and analyze frequency tables:\n\n1. `mutate()` with `case_when()` creates a new categorical variable `yield_category` by binning wheat yields into \"Low,\" \"Medium,\" and \"High\" categories.\n2. `table()` produces a frequency count for each yield category.\n3. `prop.table()` converts the frequency counts to proportions (relative frequencies).\n4. A new variable `decade` is created by rounding down the year to the nearest decade using `floor(Year / 10) * 10`.\n5. A two-way frequency table is created to examine the relationship between yield categories and decades.\n6. `prop.table(yield_decade_table, margin = 1)` calculates row proportions, showing the distribution of decades within each yield category.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe frequency tables reveal important patterns in wheat yield categories:\n\n- The distribution of yield categories shows which productivity levels are most common globally.\n- The proportions table quantifies this distribution, indicating what percentage of observations fall into each yield category.\n- The two-way table between yield categories and decades allows us to track how wheat productivity has changed over time.\n- The row proportions reveal whether certain yield categories have become more or less common in different decades, potentially indicating technological improvements, climate effects, or changes in agricultural practices.\n- These temporal patterns are crucial for understanding agricultural development trends and projecting future food security scenarios.\n:::\n\n### Box Plots\n\nBox plots are excellent for comparing distributions across groups:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Select a few major countries for comparison\nmajor_wheat_producers <- c(\"United States\", \"China\", \"India\", \"Russia\", \"France\", \"Australia\")\n\n# Filter data for these countries and recent years\nrecent_wheat_data <- crop_yields %>%\n  filter(Entity %in% major_wheat_producers,\n         Year >= 2000,\n         !is.na(`Wheat (tonnes per hectare)`))\n\n# Box plot of wheat yields by country\nggplot(recent_wheat_data, aes(x = Entity, y = `Wheat (tonnes per hectare)`)) +\n  geom_boxplot(fill = \"darkgreen\", alpha = 0.7) +\n  labs(title = \"Wheat Yields by Country (2000-present)\",\n       x = \"Country\",\n       y = \"Wheat Yield (tonnes per hectare)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n# Enhanced box plot with jittered points\nggplot(recent_wheat_data, aes(x = Entity, y = `Wheat (tonnes per hectare)`)) +\n  geom_boxplot(fill = \"darkgreen\", alpha = 0.5) +\n  geom_jitter(width = 0.2, alpha = 0.5, color = \"darkgreen\") +\n  labs(title = \"Wheat Yields by Country (2000-present)\",\n       x = \"Country\",\n       y = \"Wheat Yield (tonnes per hectare)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![Wheat yields by country](03-exploratory-analysis_files/figure-html/fig-boxplots-summary-1.png){#fig-boxplots-summary-1 fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![Enhanced boxplot with data points](03-exploratory-analysis_files/figure-html/fig-boxplots-summary-2.png){#fig-boxplots-summary-2 fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to create and enhance box plots for comparing distributions:\n\n1. First, we select major wheat-producing countries for comparison and filter for recent data (since 2000).\n2. The basic box plot:\n   - `geom_boxplot()` creates a box-and-whisker plot for each country\n   - Each box shows the median (middle line), interquartile range (IQR, the box), and whiskers extending to 1.5 × IQR\n   - Points beyond the whiskers represent outliers\n\n3. The enhanced box plot adds:\n   - `geom_jitter()` to display individual data points with slight horizontal displacement\n   - This combination shows both the summary statistics (box plot) and the raw data distribution (points)\n   - `angle = 45, hjust = 1` rotates country labels for better readability\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe box plots reveal important comparisons between major wheat-producing countries:\n\n- The median line in each box shows the typical yield for each country, allowing direct comparison of central tendency.\n- The height of each box (IQR) indicates the variability of yields within each country over the time period.\n- Whisker length reflects the range of typical yields, while outlier points show exceptional years.\n- Countries with higher boxes generally have more variable production, possibly due to climate fluctuations or changing agricultural practices.\n- The jittered points reveal the actual distribution and density of observations for each country.\n- These comparisons help identify which countries have the most consistent and productive wheat cultivation systems, providing insights for agricultural policy and development.\n:::\n\n### Bar Charts\n\nBar charts are useful for visualizing categorical data:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Calculate average wheat yield by country for the last decade\nrecent_avg_yields <- crop_yields %>%\n  filter(Year >= 2010, !is.na(`Wheat (tonnes per hectare)`)) %>%\n  group_by(Entity) %>%\n  summarize(avg_wheat_yield = mean(`Wheat (tonnes per hectare)`, na.rm = TRUE)) %>%\n  arrange(desc(avg_wheat_yield)) %>%\n  head(10)  # Top 10 countries\n\n# Bar chart of average wheat yields\nggplot(recent_avg_yields, aes(x = reorder(Entity, avg_wheat_yield), y = avg_wheat_yield)) +\n  geom_bar(stat = \"identity\", fill = \"darkgreen\") +\n  labs(title = \"Top 10 Countries by Average Wheat Yield (2010-present)\",\n       x = \"Country\",\n       y = \"Average Wheat Yield (tonnes per hectare)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![Top 10 countries by average wheat yield (2010-present)](03-exploratory-analysis_files/figure-html/fig-barchart-yields-1.png){#fig-barchart-yields fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to create a bar chart for visualizing categorical data:\n\n1. First, we calculate the average wheat yield by country for the last decade (2010-present).\n2. We then select the top 10 countries by average yield.\n3. The bar chart:\n   - `geom_bar(stat = \"identity\")` creates a bar for each country, with height proportional to average yield\n   - `reorder(Entity, avg_wheat_yield)` sorts the countries by average yield in descending order\n   - `fill = \"darkgreen\"` sets the bar color\n   - `theme(axis.text.x = element_text(angle = 45, hjust = 1))` rotates country labels for better readability\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe bar chart reveals the top 10 countries by average wheat yield:\n\n- The height of each bar represents the average yield for each country.\n- The countries are sorted in descending order by average yield, making it easy to identify the most productive nations.\n- This visualization helps identify which countries have the most efficient wheat cultivation systems, providing insights for agricultural policy and development.\n- The bar chart can also be used to compare the average yields of different countries, helping to identify potential areas for improvement.\n:::\n\n## Visualizing Distributions\n\n### Histograms and Density Plots\n\nHistograms and density plots help visualize the distribution of continuous variables:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Histogram of wheat yields\nggplot(crop_yields, aes(x = `Wheat (tonnes per hectare)`)) +\n  geom_histogram(bins = 30, fill = \"darkgreen\", color = \"white\", na.rm = TRUE) +\n  labs(title = \"Histogram of Wheat Yields\",\n       x = \"Wheat Yield (tonnes per hectare)\",\n       y = \"Frequency\") +\n  theme_minimal()\n\n# Density plot\nggplot(crop_yields, aes(x = `Wheat (tonnes per hectare)`)) +\n  geom_density(fill = \"darkgreen\", alpha = 0.5, na.rm = TRUE) +\n  labs(title = \"Density Plot of Wheat Yields\",\n       x = \"Wheat Yield (tonnes per hectare)\",\n       y = \"Density\") +\n  theme_minimal()\n\n# Histogram with density overlay\nggplot(crop_yields, aes(x = `Wheat (tonnes per hectare)`)) +\n  geom_histogram(aes(y = after_stat(density)), bins = 30, fill = \"darkgreen\", color = \"white\", na.rm = TRUE) +\n  geom_density(color = \"darkgreen\", linewidth = 1, na.rm = TRUE) +\n  labs(title = \"Distribution of Wheat Yields\",\n       x = \"Wheat Yield (tonnes per hectare)\",\n       y = \"Density\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Histogram of wheat yields](03-exploratory-analysis_files/figure-html/fig-distributions-1.png){#fig-distributions-1 fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![Density plot of wheat yields](03-exploratory-analysis_files/figure-html/fig-distributions-2.png){#fig-distributions-2 fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![Combined histogram with density overlay](03-exploratory-analysis_files/figure-html/fig-distributions-3.png){#fig-distributions-3 fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates three approaches to visualizing distributions:\n\n1. **Histogram**:\n   - `geom_histogram()` divides the data into bins and counts observations in each bin\n   - `bins = 30` specifies the number of divisions\n   - `na.rm = TRUE` removes missing values from the visualization\n\n2. **Density Plot**:\n   - `geom_density()` creates a smoothed representation of the distribution\n   - `fill` and `alpha` control the appearance and transparency\n   - Density plots show the probability density function of the data\n\n3. **Combined Visualization**:\n   - The histogram is converted to density scale with `aes(y = after_stat(density))`\n   - `geom_density()` overlays a smoothed curve on the histogram\n   - This combination shows both the raw data structure and the smoothed distribution\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThese distribution visualizations reveal key patterns in wheat yields:\n\n- The histogram shows the frequency of observations at different yield levels, highlighting where most countries cluster.\n- The density plot smooths the distribution, making it easier to identify the central tendency and spread.\n- The combined plot allows us to see both the actual data distribution (histogram) and the underlying probability density (curve).\n- The right-skewed shape indicates that while most countries have moderate yields, a few achieve exceptionally high productivity.\n- Multiple peaks (if present) might suggest distinct groups of countries with different agricultural technologies or growing conditions.\n- These visualizations help identify outliers and understand the overall pattern of global wheat production efficiency.\n:::\n\n### Box Plots\n\nBox plots are excellent for comparing distributions across groups:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Select a few major countries for comparison\nmajor_wheat_producers <- c(\"United States\", \"China\", \"India\", \"Russia\", \"France\", \"Australia\")\n\n# Filter data for these countries and recent years\nrecent_wheat_data <- crop_yields %>%\n  filter(Entity %in% major_wheat_producers,\n         Year >= 2000,\n         !is.na(`Wheat (tonnes per hectare)`))\n\n# Box plot of wheat yields by country\nggplot(recent_wheat_data, aes(x = Entity, y = `Wheat (tonnes per hectare)`)) +\n  geom_boxplot(fill = \"darkgreen\", alpha = 0.7) +\n  labs(title = \"Wheat Yields by Country (2000-present)\",\n       x = \"Country\",\n       y = \"Wheat Yield (tonnes per hectare)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n# Enhanced box plot with jittered points\nggplot(recent_wheat_data, aes(x = Entity, y = `Wheat (tonnes per hectare)`)) +\n  geom_boxplot(fill = \"darkgreen\", alpha = 0.5) +\n  geom_jitter(width = 0.2, alpha = 0.5, color = \"darkgreen\") +\n  labs(title = \"Wheat Yields by Country (2000-present)\",\n       x = \"Country\",\n       y = \"Wheat Yield (tonnes per hectare)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![Country comparison boxplot](03-exploratory-analysis_files/figure-html/fig-boxplots-visualizing-1.png){#fig-boxplots-visualizing-1 fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![Boxplot with jittered observations](03-exploratory-analysis_files/figure-html/fig-boxplots-visualizing-2.png){#fig-boxplots-visualizing-2 fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to create and enhance box plots for comparing distributions:\n\n1. First, we select major wheat-producing countries for comparison and filter for recent data (since 2000).\n2. The basic box plot:\n   - `geom_boxplot()` creates a box-and-whisker plot for each country\n   - Each box shows the median (middle line), interquartile range (IQR, the box), and whiskers extending to 1.5 × IQR\n   - Points beyond the whiskers represent outliers\n\n3. The enhanced box plot adds:\n   - `geom_jitter()` to display individual data points with slight horizontal displacement\n   - This combination shows both the summary statistics (box plot) and the raw data distribution (points)\n   - `angle = 45, hjust = 1` rotates country labels for better readability\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe box plots reveal important comparisons between major wheat-producing countries:\n\n- The median line in each box shows the typical yield for each country, allowing direct comparison of central tendency.\n- The height of each box (IQR) indicates the variability of yields within each country over the time period.\n- Whisker length reflects the range of typical yields, while outlier points show exceptional years.\n- Countries with higher boxes generally have more variable production, possibly due to climate fluctuations or changing agricultural practices.\n- The jittered points reveal the actual distribution and density of observations for each country.\n- These comparisons help identify which countries have the most consistent and productive wheat cultivation systems, providing insights for agricultural policy and development.\n:::\n\n### Bar Charts\n\nBar charts are useful for visualizing categorical data:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Calculate average wheat yield by country for the last decade\nrecent_avg_yields <- crop_yields %>%\n  filter(Year >= 2010, !is.na(`Wheat (tonnes per hectare)`)) %>%\n  group_by(Entity) %>%\n  summarize(avg_wheat_yield = mean(`Wheat (tonnes per hectare)`, na.rm = TRUE)) %>%\n  arrange(desc(avg_wheat_yield)) %>%\n  head(10)  # Top 10 countries\n\n# Bar chart of average wheat yields\nggplot(recent_avg_yields, aes(x = reorder(Entity, avg_wheat_yield), y = avg_wheat_yield)) +\n  geom_bar(stat = \"identity\", fill = \"darkgreen\") +\n  labs(title = \"Top 10 Countries by Average Wheat Yield (2010-present)\",\n       x = \"Country\",\n       y = \"Average Wheat Yield (tonnes per hectare)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![Top 10 countries by average wheat yield](03-exploratory-analysis_files/figure-html/fig-barchart-distributions-1.png){#fig-barchart-distributions fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to create a bar chart for visualizing categorical data:\n\n1. First, we calculate the average wheat yield by country for the last decade (2010-present).\n2. We then select the top 10 countries by average yield.\n3. The bar chart:\n   - `geom_bar(stat = \"identity\")` creates a bar for each country, with height proportional to average yield\n   - `reorder(Entity, avg_wheat_yield)` sorts the countries by average yield in descending order\n   - `fill = \"darkgreen\"` sets the bar color\n   - `theme(axis.text.x = element_text(angle = 45, hjust = 1))` rotates country labels for better readability\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe bar chart reveals the top 10 countries by average wheat yield:\n\n- The height of each bar represents the average yield for each country.\n- The countries are sorted in descending order by average yield, making it easy to identify the most productive nations.\n- This visualization helps identify which countries have the most efficient wheat cultivation systems, providing insights for agricultural policy and development.\n- The bar chart can also be used to compare the average yields of different countries, helping to identify potential areas for improvement.\n:::\n\n## Exploring Relationships\n\n### Scatter Plots\n\nScatter plots help visualize relationships between two continuous variables:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Let's compare wheat and rice yields\ncrop_yields_filtered <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`), !is.na(`Rice (tonnes per hectare)`)) %>%\n  filter(Year >= 2000)\n\n# Basic scatter plot\nggplot(crop_yields_filtered, aes(x = `Wheat (tonnes per hectare)`, y = `Rice (tonnes per hectare)`)) +\n  geom_point(alpha = 0.5, color = \"darkgreen\") +\n  labs(title = \"Relationship between Wheat and Rice Yields\",\n       x = \"Wheat Yield (tonnes per hectare)\",\n       y = \"Rice Yield (tonnes per hectare)\") +\n  theme_minimal()\n\n# Scatter plot with color by continent (we'll need to add continent information)\n# For demonstration, let's create a simple mapping for a few countries\ncontinent_mapping <- tibble(\n  Entity = c(\"United States\", \"Canada\", \"Mexico\",\n             \"China\", \"India\", \"Japan\",\n             \"Germany\", \"France\", \"United Kingdom\",\n             \"Brazil\", \"Argentina\", \"Chile\",\n             \"Egypt\", \"Nigeria\", \"South Africa\",\n             \"Australia\", \"New Zealand\"),\n  Continent = c(rep(\"North America\", 3),\n                rep(\"Asia\", 3),\n                rep(\"Europe\", 3),\n                rep(\"South America\", 3),\n                rep(\"Africa\", 3),\n                rep(\"Oceania\", 2))\n)\n\n# Join with our dataset\ncrop_yields_with_continent <- crop_yields_filtered %>%\n  inner_join(continent_mapping, by = \"Entity\")\n\n# Scatter plot with color by continent\nggplot(crop_yields_with_continent, aes(x = `Wheat (tonnes per hectare)`, y = `Rice (tonnes per hectare)`, color = Continent)) +\n  geom_point(size = 3, alpha = 0.7) +\n  labs(title = \"Relationship between Wheat and Rice Yields by Continent\",\n       x = \"Wheat Yield (tonnes per hectare)\",\n       y = \"Rice Yield (tonnes per hectare)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Relationship between wheat and rice yields](03-exploratory-analysis_files/figure-html/fig-scatter-relationships-1.png){#fig-scatter-relationships-1 fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![Wheat vs rice yields by continent](03-exploratory-analysis_files/figure-html/fig-scatter-relationships-2.png){#fig-scatter-relationships-2 fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to create scatter plots for exploring relationships:\n\n1. First, we filter the data to include only observations with non-missing values for wheat and rice yields, and only consider recent data (since 2000).\n2. The basic scatter plot:\n   - `geom_point()` creates a scatter plot of wheat yields vs. rice yields\n   - `alpha = 0.5` sets the transparency of the points\n   - `color = \"darkgreen\"` sets the color of the points\n\n3. The scatter plot with color by continent:\n   - We create a simple mapping of countries to continents using `tibble()`.\n   - We join this mapping with our dataset using `inner_join()`.\n   - We create a scatter plot with color by continent using `geom_point(aes(color = Continent))`.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe scatter plots reveal the relationship between wheat and rice yields:\n\n- The basic scatter plot shows the overall relationship between wheat and rice yields.\n- The scatter plot with color by continent reveals how the relationship varies across different continents.\n- This visualization helps identify patterns and correlations between wheat and rice yields, providing insights for agricultural policy and development.\n- The scatter plot can also be used to identify outliers and anomalies in the data.\n:::\n\n### Correlation Analysis\n\nCorrelation analysis quantifies the strength and direction of relationships between variables:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Select numeric columns for correlation analysis\ncrop_numeric <- crop_yields %>%\n  select(`Wheat (tonnes per hectare)`, `Rice (tonnes per hectare)`, `Maize (tonnes per hectare)`, `Soybeans (tonnes per hectare)`, `Potatoes (tonnes per hectare)`, `Beans (tonnes per hectare)`) %>%\n  na.omit()\n\n# Correlation matrix\ncor_matrix <- cor(crop_numeric)\nround(cor_matrix, 2)\n#>                               Wheat (tonnes per hectare)\n#> Wheat (tonnes per hectare)                          1.00\n#> Rice (tonnes per hectare)                           0.43\n#> Maize (tonnes per hectare)                          0.57\n#> Soybeans (tonnes per hectare)                       0.47\n#> Potatoes (tonnes per hectare)                       0.57\n#> Beans (tonnes per hectare)                          0.44\n#>                               Rice (tonnes per hectare)\n#> Wheat (tonnes per hectare)                         0.43\n#> Rice (tonnes per hectare)                          1.00\n#> Maize (tonnes per hectare)                         0.73\n#> Soybeans (tonnes per hectare)                      0.58\n#> Potatoes (tonnes per hectare)                      0.67\n#> Beans (tonnes per hectare)                         0.46\n#>                               Maize (tonnes per hectare)\n#> Wheat (tonnes per hectare)                          0.57\n#> Rice (tonnes per hectare)                           0.73\n#> Maize (tonnes per hectare)                          1.00\n#> Soybeans (tonnes per hectare)                       0.65\n#> Potatoes (tonnes per hectare)                       0.74\n#> Beans (tonnes per hectare)                          0.63\n#>                               Soybeans (tonnes per hectare)\n#> Wheat (tonnes per hectare)                             0.47\n#> Rice (tonnes per hectare)                              0.58\n#> Maize (tonnes per hectare)                             0.65\n#> Soybeans (tonnes per hectare)                          1.00\n#> Potatoes (tonnes per hectare)                          0.59\n#> Beans (tonnes per hectare)                             0.41\n#>                               Potatoes (tonnes per hectare)\n#> Wheat (tonnes per hectare)                             0.57\n#> Rice (tonnes per hectare)                              0.67\n#> Maize (tonnes per hectare)                             0.74\n#> Soybeans (tonnes per hectare)                          0.59\n#> Potatoes (tonnes per hectare)                          1.00\n#> Beans (tonnes per hectare)                             0.46\n#>                               Beans (tonnes per hectare)\n#> Wheat (tonnes per hectare)                          0.44\n#> Rice (tonnes per hectare)                           0.46\n#> Maize (tonnes per hectare)                          0.63\n#> Soybeans (tonnes per hectare)                       0.41\n#> Potatoes (tonnes per hectare)                       0.46\n#> Beans (tonnes per hectare)                          1.00\n\n# Visualize correlation matrix\nlibrary(corrplot)\ncorrplot(cor_matrix, method = \"circle\", type = \"upper\",\n         tl.col = \"black\", tl.srt = 45,\n         title = \"Correlation Matrix of Crop Yields\")\n```\n\n::: {.cell-output-display}\n![Correlation matrix of crop yields](03-exploratory-analysis_files/figure-html/fig-correlation-matrix-1.png){#fig-correlation-matrix fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to perform correlation analysis:\n\n1. First, we select the numeric columns of interest for correlation analysis.\n2. We remove any missing values using `na.omit()`.\n3. We calculate the correlation matrix using `cor()`.\n4. We round the correlation matrix to 2 decimal places using `round()`.\n5. We visualize the correlation matrix using `corrplot()`.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe correlation matrix reveals the strength and direction of relationships between variables:\n\n- The correlation matrix shows the correlation coefficients between each pair of variables.\n- The correlation coefficients range from -1 (perfect negative correlation) to 1 (perfect positive correlation).\n- This visualization helps identify strong correlations between variables, providing insights for agricultural policy and development.\n- The correlation matrix can also be used to identify potential multicollinearity issues in regression analysis.\n:::\n\n### Pair Plots\n\nPair plots provide a comprehensive view of relationships between multiple variables:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Basic pair plot\npairs(crop_numeric, pch = 19, col = \"darkgreen\")\n\n# Enhanced pair plot with GGally\nlibrary(GGally)\nggpairs(crop_numeric) +\n  theme_minimal() +\n  labs(title = \"Relationships Between Different Crop Yields\")\n```\n\n::: {.cell-output-display}\n![Basic pair plot of crop yields](03-exploratory-analysis_files/figure-html/fig-pair-plots-1.png){#fig-pair-plots-1 fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![Enhanced pair plot with GGally](03-exploratory-analysis_files/figure-html/fig-pair-plots-2.png){#fig-pair-plots-2 fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to create pair plots:\n\n1. First, we create a basic pair plot using `pairs()`.\n2. We then create an enhanced pair plot using `ggpairs()` from the GGally package.\n3. The enhanced pair plot includes histograms, scatter plots, and correlation coefficients for each pair of variables.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe pair plots reveal the relationships between multiple variables:\n\n- The pair plots show the relationships between each pair of variables.\n- The histograms and scatter plots provide a visual representation of the relationships.\n- The correlation coefficients provide a quantitative measure of the strength and direction of the relationships.\n- This visualization helps identify patterns and correlations between multiple variables, providing insights for agricultural policy and development.\n:::\n\n## Identifying Outliers and Anomalies\n\n### Box Plots for Outlier Detection\n\nBox plots can help identify potential outliers:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Box plot to identify outliers in wheat yield\nggplot(crop_yields, aes(y = `Wheat (tonnes per hectare)`)) +\n  geom_boxplot(fill = \"darkgreen\", alpha = 0.7, na.rm = TRUE) +\n  labs(title = \"Box Plot of Wheat Yields with Potential Outliers\",\n       y = \"Wheat Yield (tonnes per hectare)\") +\n  theme_minimal()\n\n# Identify potential outliers\nwheat_outliers <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`)) %>%\n  mutate(\n    q1 = quantile(`Wheat (tonnes per hectare)`, 0.25),\n    q3 = quantile(`Wheat (tonnes per hectare)`, 0.75),\n    iqr = q3 - q1,\n    lower_bound = q1 - 1.5 * iqr,\n    upper_bound = q3 + 1.5 * iqr,\n    is_outlier = `Wheat (tonnes per hectare)` < lower_bound | `Wheat (tonnes per hectare)` > upper_bound\n  ) %>%\n  filter(is_outlier) %>%\n  select(Entity, Year, `Wheat (tonnes per hectare)`)\n\n# Display the outliers\nhead(wheat_outliers, 10)\n#> # A tibble: 10 × 3\n#>    Entity   Year `Wheat (tonnes per hectare)`\n#>    <chr>   <dbl>                        <dbl>\n#>  1 Austria  2016                         6.25\n#>  2 Belgium  2000                         7.92\n#>  3 Belgium  2001                         8.05\n#>  4 Belgium  2002                         8.28\n#>  5 Belgium  2003                         8.58\n#>  6 Belgium  2004                         8.98\n#>  7 Belgium  2005                         8.27\n#>  8 Belgium  2006                         8.25\n#>  9 Belgium  2007                         7.89\n#> 10 Belgium  2008                         8.76\n```\n\n::: {.cell-output-display}\n![Box plot showing potential outliers in wheat yields](03-exploratory-analysis_files/figure-html/fig-outlier-detection-1.png){#fig-outlier-detection fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to use box plots for outlier detection:\n\n1. First, we create a box plot of wheat yields using `geom_boxplot()`.\n2. We then identify potential outliers using the interquartile range (IQR) method.\n3. We calculate the lower and upper bounds for outliers using `q1 - 1.5 * iqr` and `q3 + 1.5 * iqr`, respectively.\n4. We identify observations that fall outside these bounds as potential outliers.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe box plot and outlier detection reveal potential outliers:\n\n- The box plot shows the distribution of wheat yields, with potential outliers indicated by points outside the whiskers.\n- The outlier detection identifies observations that fall outside the lower and upper bounds.\n- This visualization helps identify potential errors or anomalies in the data, providing insights for data cleaning and quality control.\n:::\n\n### Z-Scores for Outlier Detection\n\nZ-scores can also help identify outliers:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Calculate z-scores for wheat yields\nwheat_z_scores <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`)) %>%\n  mutate(\n    wheat_mean = mean(`Wheat (tonnes per hectare)`),\n    wheat_sd = sd(`Wheat (tonnes per hectare)`),\n    z_score = (`Wheat (tonnes per hectare)` - wheat_mean) / wheat_sd,\n    is_extreme = abs(z_score) > 3\n  )\n\n# Display extreme values (z-score > 3 or < -3)\nwheat_extremes <- wheat_z_scores %>%\n  filter(is_extreme) %>%\n  select(Entity, Year, `Wheat (tonnes per hectare)`, z_score) %>%\n  arrange(desc(abs(z_score)))\n\nhead(wheat_extremes, 10)\n#> # A tibble: 10 × 4\n#>    Entity       Year `Wheat (tonnes per hectare)` z_score\n#>    <chr>       <dbl>                        <dbl>   <dbl>\n#>  1 Ireland      2015                        10.7     4.88\n#>  2 Ireland      2017                        10.2     4.58\n#>  3 Belgium      2015                        10.0     4.49\n#>  4 Ireland      2014                        10.0     4.49\n#>  5 Zambia       2008                         9.94    4.45\n#>  6 Ireland      2004                         9.92    4.44\n#>  7 New Zealand  2017                         9.86    4.40\n#>  8 Ireland      2011                         9.86    4.40\n#>  9 Ireland      2016                         9.54    4.21\n#> 10 Belgium      2009                         9.47    4.16\n```\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to use z-scores for outlier detection:\n\n1. First, we calculate the mean and standard deviation of wheat yields using `mean()` and `sd()`, respectively.\n2. We then calculate the z-scores for each observation using `(x - mean) / sd`.\n3. We identify observations with absolute z-scores greater than 3 as extreme values.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe z-scores reveal extreme values:\n\n- The z-scores show the number of standard deviations from the mean for each observation.\n- The extreme values are identified by their absolute z-scores greater than 3.\n- This visualization helps identify potential outliers or anomalies in the data, providing insights for data cleaning and quality control.\n:::\n\n## Time Series Exploration\n\nAgricultural data often contains important temporal patterns:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Select a few countries for time series analysis\ncountries_for_ts <- c(\"United States\", \"China\", \"India\", \"France\")\n\n# Filter data for these countries\nwheat_ts_data <- crop_yields %>%\n  filter(Entity %in% countries_for_ts, !is.na(`Wheat (tonnes per hectare)`)) %>%\n  filter(Year >= 1960)\n\n# Time series plot\nggplot(wheat_ts_data, aes(x = Year, y = `Wheat (tonnes per hectare)`, color = Entity)) +\n  geom_line(linewidth = 1) +\n  geom_point(size = 2) +\n  labs(title = \"Wheat Yield Trends Over Time\",\n       x = \"Year\",\n       y = \"Wheat Yield (tonnes per hectare)\") +\n  theme_minimal() +\n  scale_color_brewer(palette = \"Dark2\")\n```\n\n::: {.cell-output-display}\n![Wheat yield trends over time for major producers](03-exploratory-analysis_files/figure-html/fig-time-series-1.png){#fig-time-series fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to create a time series plot:\n\n1. First, we select a few countries for time series analysis.\n2. We filter the data for these countries and non-missing wheat yields.\n3. We create a time series plot using `geom_line()` and `geom_point()`.\n4. We add a title, x-axis label, and y-axis label using `labs()`.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe time series plot reveals temporal patterns:\n\n- The time series plot shows the trends in wheat yields over time for each country.\n- The plot reveals patterns such as increasing or decreasing trends, seasonality, or anomalies.\n- This visualization helps identify temporal patterns and correlations in the data, providing insights for agricultural policy and development.\n:::\n\n## Missing Data Analysis\n\nUnderstanding patterns of missing data is crucial:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Check for missing values in each column\ncolSums(is.na(crop_yields))\n#>                           Entity                             Code \n#>                                0                             1919 \n#>                             Year       Wheat (tonnes per hectare) \n#>                                0                             4974 \n#>        Rice (tonnes per hectare)       Maize (tonnes per hectare) \n#>                             4604                             2301 \n#>    Soybeans (tonnes per hectare)    Potatoes (tonnes per hectare) \n#>                             7114                             3059 \n#>       Beans (tonnes per hectare)        Peas (tonnes per hectare) \n#>                             5066                             6840 \n#>     Cassava (tonnes per hectare)      Barley (tonnes per hectare) \n#>                             5887                             6342 \n#> Cocoa beans (tonnes per hectare)     Bananas (tonnes per hectare) \n#>                             8466                             4166\n\n# Visualize missing data patterns\nif(requireNamespace(\"naniar\", quietly = TRUE)) {\n  library(naniar)\n\n  # Create a visualization of missing data\n  gg_miss_var(crop_yields)\n\n  # Create a matrix showing missing data patterns\n  vis_miss(crop_yields[, c(\"Entity\", \"Year\", \"Wheat (tonnes per hectare)\", \"Rice (tonnes per hectare)\", \"Maize (tonnes per hectare)\")])\n} else {\n  message(\"The 'naniar' package is not installed. Install it with install.packages('naniar') to visualize missing data patterns.\")\n\n  # Alternative: simple summary of missing data\n  missing_summary <- sapply(crop_yields, function(x) sum(is.na(x)))\n  missing_df <- data.frame(\n    Variable = names(missing_summary),\n    Missing_Count = missing_summary,\n    Missing_Percent = round(missing_summary / nrow(crop_yields) * 100, 2)\n  )\n\n  # Display the summary\n  missing_df <- missing_df[order(-missing_df$Missing_Count), ]\n  head(missing_df, 10)\n}\n```\n\n::: {.cell-output-display}\n![Missing values by variable](03-exploratory-analysis_files/figure-html/fig-missing-data-1.png){#fig-missing-data fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to analyze missing data:\n\n1. First, we check for missing values in each column using `colSums(is.na())`.\n2. We then visualize missing data patterns using `gg_miss_var()` and `vis_miss()` from the naniar package.\n3. If the naniar package is not installed, we provide an alternative summary of missing data using `sapply()` and `data.frame()`.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe missing data analysis reveals patterns of missingness:\n\n- The summary of missing data shows the number and percentage of missing values in each column.\n- The visualization of missing data patterns reveals the distribution of missing values across different variables.\n- This analysis helps identify potential issues with data quality and informs strategies for handling missing data.\n:::\n\n## Summary\n\nThis chapter has demonstrated various techniques for exploratory data analysis using a real agricultural dataset. We've covered:\n\n1. Computing and interpreting descriptive statistics\n2. Creating and analyzing frequency tables\n3. Visualizing distributions with histograms, density plots, and box plots\n4. Exploring relationships with scatter plots and correlation analysis\n5. Identifying outliers and anomalies\n6. Analyzing time series patterns\n7. Examining missing data\n\nThese techniques provide a foundation for understanding your data before proceeding to more advanced analyses. By thoroughly exploring your data, you can make informed decisions about appropriate statistical methods and generate meaningful hypotheses for testing.\n\n## Exercises\n\n1. Load the plant biodiversity dataset from `docs/data/ecology/biodiversity.csv` and perform a comprehensive exploratory analysis.\n2. Create a histogram and density plot for another crop in the dataset. How does its distribution compare to wheat?\n3. Investigate the relationship between potato yields and latitude (you'll need to find or create a dataset with latitude information).\n4. Identify countries with the most significant improvement in crop yields over time.\n5. Create a time series plot showing the ratio of wheat to rice yields over time for major producing countries.\n6. Perform the same exploratory analyses in R for the spatial dataset in `docs/data/geography/spatial.csv`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(viridis)  # For colorblind-friendly palettes\n\n# Create a sample plant biodiversity dataset since the original is not available\n# This simulates conservation status data across different regions\nset.seed(123)  # For reproducibility\nregions <- c(\"North America\", \"South America\", \"Europe\", \"Africa\", \"Asia\", \"Oceania\")\nstatuses <- c(\"Least Concern\", \"Near Threatened\", \"Vulnerable\", \"Endangered\", \"Critically Endangered\")\n\n# Create sample data with 200 observations\nplant_data <- data.frame(\n  region = sample(regions, 200, replace = TRUE),\n  conservation_status = sample(statuses, 200, replace = TRUE,\n                                prob = c(0.4, 0.3, 0.15, 0.1, 0.05))\n)\n\n# Set a professional theme for all plots\ntheme_set(theme_minimal() +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14),\n    axis.title = element_text(face = \"bold\"),\n    legend.title = element_text(face = \"bold\")\n  ))\n\n# Create a bar chart of conservation status\nggplot(plant_data, aes(x = region, fill = conservation_status)) +\n  geom_bar(position = \"stack\") +\n  scale_fill_viridis_d() +\n  labs(\n    title = \"Conservation Status of Plant Species by Region\",\n    x = \"Region\",\n    y = \"Number of Species\",\n    fill = \"Conservation Status\"\n  ) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![Conservation status of plant species by region](03-exploratory-analysis_files/figure-html/fig-conservation-status-1.png){#fig-conservation-status fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates professional visualization techniques:\n\n1. **Package Setup**:\n   - `tidyverse` for data manipulation\n   - `ggplot2` for creating plots\n   - `viridis` for colorblind-friendly color palettes\n\n2. **Theme Customization**:\n   - `theme_set()` applies consistent styling\n   - Customizes text appearance for titles and labels\n   - Ensures professional look across all plots\n\n3. **Plot Construction**:\n   - `ggplot()` creates the base plot\n   - `aes()` defines aesthetic mappings\n   - `geom_bar()` creates stacked bars\n   - `scale_fill_viridis_d()` applies colorblind-friendly colors\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe visualization reveals important patterns:\n\n1. **Regional Distribution**:\n   - Different regions show varying numbers of species\n   - Some regions have more diverse plant communities\n   - Conservation status varies across regions\n\n2. **Conservation Status**:\n   - Proportion of threatened species varies by region\n   - Some regions have better conservation outcomes\n   - Areas needing conservation attention are visible\n\n3. **Data Quality**:\n   - Completeness of conservation status data\n   - Potential gaps in monitoring\n   - Regional differences in data collection\n:::\n\n::: {.callout-tip}\n## PROFESSIONAL TIP: Visualization Best Practices\n\nWhen creating scientific visualizations:\n\n1. **Design Principles**:\n   - Use clear, readable fonts\n   - Choose appropriate color schemes\n   - Maintain consistent styling\n   - Include informative titles and labels\n\n2. **Accessibility**:\n   - Use colorblind-friendly palettes\n   - Ensure sufficient contrast\n   - Provide clear legends\n   - Consider alternative text\n\n3. **Data Representation**:\n   - Choose appropriate plot types\n   - Scale axes appropriately\n   - Handle missing data clearly\n   - Consider data density\n:::\n\n## Chapter Summary\n\n### Key Concepts\n\n-   **Descriptive Statistics**: Measures of central tendency (mean, median) and dispersion (SD, IQR) summarize data properties\n-   **Data Distributions**: Visualizing distributions helps identify skewness, multimodality, and outliers\n-   **Relationships**: Scatter plots and correlation matrices reveal associations between variables\n-   **Outliers**: Identifying extreme values is crucial for data quality and robust analysis\n-   **Missing Data**: Understanding missingness patterns informs appropriate handling strategies\n\n### R Functions Learned\n\n-   `summarize()` - Calculate summary statistics\n-   `geom_histogram()` / `geom_density()` - Visualize distributions\n-   `geom_boxplot()` - Compare distributions and identify outliers\n-   `geom_point()` - Create scatter plots\n-   `cor()` - Calculate correlation coefficients\n-   `pairs()` / `ggpairs()` - Create pair plots for multiple variables\n-   `is.na()` - Detect missing values\n\n### Next Steps\n\nIn the next chapter, we will move from exploration to inference, learning how to formulate and test scientific hypotheses using statistical methods.\n\n## Exercises\n\n1.  **Descriptive Statistics**: Calculate the mean, median, and standard deviation for a continuous variable in your own dataset.\n2.  **Distribution Visualization**: Create a histogram and density plot for the same variable. Describe the shape of the distribution.\n3.  **Group Comparison**: Use box plots to compare the distribution of a continuous variable across different groups (e.g., species, treatments).\n4.  **Correlation Analysis**: Calculate the correlation matrix for a set of continuous variables and visualize it using a heatmap or pair plot.\n5.  **Outlier Detection**: Identify potential outliers in your dataset using the IQR method or Z-scores.\n6.  **Missing Data**: Visualize missing data patterns in your dataset and discuss potential reasons for missingness.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}