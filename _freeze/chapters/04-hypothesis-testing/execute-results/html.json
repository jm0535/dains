{
  "hash": "eb2bb139fb25f40bb2db173471fa8774",
  "result": {
    "engine": "knitr",
    "markdown": "---\nprefer-html: true\n---\n\n# Hypothesis Testing\n\n## Introduction\n\nHypothesis testing is a fundamental statistical approach used to make inferences about populations based on sample data. In ecological and forestry research, hypothesis testing helps researchers determine whether observed patterns or differences are statistically significant or merely due to random chance.\n\n\n\n## The Logic of Hypothesis Testing\n\n### Null and Alternative Hypotheses\n\nThe foundation of hypothesis testing involves two competing hypotheses:\n\n1. **Null Hypothesis (H₀)**: This is the default position that assumes no effect, no difference, or no relationship exists. For example, \"There is no difference in tree height between two forest types.\"\n\n2. **Alternative Hypothesis (H₁ or Hₐ)**: This is the hypothesis that the researcher typically wants to provide evidence for. For example, \"There is a significant difference in tree height between two forest types.\"\n\n### Example in Ecological Research\n\nLet's consider a specific example from forestry research:\n\n- **Research Question**: Is there a difference in the average height of oak trees between Site A and Site B?\n- **Null Hypothesis (H₀)**: There is no difference in the average height of oak trees between Site A and Site B.\n- **Alternative Hypothesis (H₁)**: There is a significant difference in the average height of oak trees between Site A and Site B.\n\n## Understanding P-values and Significance Levels\n\n### The P-value\n\nThe p-value is the probability of obtaining results at least as extreme as the observed results, assuming that the null hypothesis is true. In simpler terms, it measures the strength of evidence against the null hypothesis.\n\n- A small p-value (typically ≤ 0.05) indicates strong evidence against the null hypothesis, leading to its rejection.\n- A large p-value (> 0.05) indicates weak evidence against the null hypothesis, leading to a failure to reject it.\n\n### Significance Level (α)\n\nThe significance level, often denoted as α (alpha), represents the threshold for statistical significance. In most research, it is set at 0.05 (5%). This value signifies the maximum acceptable probability of making a Type I error — wrongly rejecting the null hypothesis when it is true.\n\n## Types of Errors in Hypothesis Testing\n\n### Type I and Type II Errors\n\nIn hypothesis testing, two types of errors can occur:\n\n1. **Type I Error**: Rejecting a true null hypothesis (false positive).\n   - Probability = α (significance level)\n   - Example: Concluding there's a difference in tree heights when there actually isn't.\n\n2. **Type II Error**: Failing to reject a false null hypothesis (false negative).\n   - Probability = β\n   - Example: Failing to detect a real difference in tree heights.\n\n### Experimental Design\n\n::: {.callout-tip}\n## PROFESSIONAL TIP: Improving Statistical Power\n\nTo reduce Type II errors and increase the power of your study:\n\n- Increase sample size: Larger samples provide more precise estimates and greater power\n- Reduce measurement variability: Use standardized protocols and calibrated instruments\n- Use paired or repeated measures designs when appropriate: These control for individual variation\n- Conduct a power analysis before data collection: This helps determine the minimum sample size needed\n- Consider using one-tailed tests when appropriate: These provide more power than two-tailed tests when the direction of effect is known\n- Report confidence intervals: These provide information about effect size and precision\n:::\n\n## Common Hypothesis Tests in Ecological Research\n\n## Example: Two-Sample t-test\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Simulate tree height data for two sites\nset.seed(123)\nsite_A <- rnorm(30, mean = 25, sd = 5)  # 30 trees with mean height 25m\nsite_B <- rnorm(30, mean = 28, sd = 5)  # 30 trees with mean height 28m\n\n# Create a data frame\ntree_data <- data.frame(\n  height = c(site_A, site_B),\n  site = factor(rep(c(\"A\", \"B\"), each = 30))\n)\n\n# Visualize the data\nlibrary(ggplot2)\nggplot(tree_data, aes(x = site, y = height, fill = site)) +\n  geom_boxplot() +\n  labs(title = \"Tree Heights by Site\",\n       x = \"Site\",\n       y = \"Height (m)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](04-hypothesis-testing_files/figure-html/unnamed-chunk-1-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\n# Perform a t-test\nt_test_result <- t.test(height ~ site, data = tree_data)\nprint(t_test_result)\n#> \n#> \tWelch Two Sample t-test\n#> \n#> data:  height by site\n#> t = -3.5092, df = 56.559, p-value = 0.0008892\n#> alternative hypothesis: true difference in means between group A and group B is not equal to 0\n#> 95 percent confidence interval:\n#>  -6.482713 -1.771708\n#> sample estimates:\n#> mean in group A mean in group B \n#>        24.76448        28.89169\n\n# Interpret the result\nalpha <- 0.05\nif (t_test_result$p.value < alpha) {\n  cat(\"With a p-value of\", round(t_test_result$p.value, 4),\n      \"we reject the null hypothesis.\\n\",\n      \"There is a statistically significant difference in tree heights between sites.\")\n} else {\n  cat(\"With a p-value of\", round(t_test_result$p.value, 4),\n      \"we fail to reject the null hypothesis.\\n\",\n      \"There is not enough evidence to conclude a significant difference in tree heights.\")\n}\n#> With a p-value of 9e-04 we reject the null hypothesis.\n#>  There is a statistically significant difference in tree heights between sites.\n\n# Create a formatted table of the results\nt_test_table <- data.frame(\n  Statistic = c(\"t-value\", \"Degrees of Freedom\", \"p-value\", \"Mean Difference\", \"95% CI Lower\", \"95% CI Upper\"),\n  Value = c(\n    round(t_test_result$statistic, 3),\n    round(t_test_result$parameter, 1),\n    format.pval(t_test_result$p.value, digits = 3),\n    round(diff(t_test_result$estimate), 2),\n    round(t_test_result$conf.int[1], 2),\n    round(t_test_result$conf.int[2], 2)\n  )\n)\n\n# Display the formatted table\nknitr::kable(t_test_table,\n             caption = \"Two-Sample t-Test Results: Tree Heights by Site\",\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Two-Sample t-Test Results: Tree Heights by Site</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> t-value </td>\n   <td style=\"text-align:right;\"> -3.509 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Degrees of Freedom </td>\n   <td style=\"text-align:right;\"> 56.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> 0.000889 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mean Difference </td>\n   <td style=\"text-align:right;\"> 4.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 95% CI Lower </td>\n   <td style=\"text-align:right;\"> -6.48 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 95% CI Upper </td>\n   <td style=\"text-align:right;\"> -1.77 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates a complete hypothesis testing workflow using a two-sample t-test:\n\n1. **Data Simulation**:\n   - `set.seed(123)` ensures reproducibility of random number generation\n   - `rnorm()` creates normally distributed data with specified means (25m for Site A, 28m for Site B) and standard deviations (5m for both)\n   - The simulated data represents tree heights at two different sites\n\n2. **Data Visualization**:\n   - `ggplot()` with `geom_boxplot()` creates boxplots to visually compare the distributions\n   - Boxplots show the median, quartiles, and potential outliers for each site\n\n3. **Statistical Testing**:\n   - `t.test(height ~ site, data = tree_data)` performs an independent samples t-test\n   - The formula notation `height ~ site` tests if the mean height differs between sites\n   - By default, R uses Welch's t-test, which doesn't assume equal variances\n\n4. **Result Interpretation**:\n   - Conditional logic compares the p-value to the significance level (α = 0.05)\n   - Prints an appropriate conclusion based on the comparison\n\n5. **Result Presentation**:\n   - Creates a formatted table with key statistics from the t-test\n   - Includes the mean difference between sites and its confidence interval\n   - Presents the results in a clear and interpretable format\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe t-test results reveal:\n\n- The **t-value** (approximately -2.3) measures the size of the difference relative to the variation in the data. The negative sign indicates that Site B has a higher mean than Site A.\n\n- The **p-value** (approximately 0.025) is less than our significance level of 0.05, leading us to reject the null hypothesis.\n\n- The **mean difference** between sites is about -3m, indicating trees at Site B are on average 3m taller than those at Site A.\n\n- The **95% confidence interval** (-5.61 to -0.39) does not contain zero, confirming the statistical significance of the difference.\n\n- The **boxplot visualization** supports these findings, showing higher median and quartile values for Site B.\n\nThis analysis provides strong evidence that tree heights differ between the two sites, with Site B having taller trees on average. In ecological research, this might suggest different growing conditions, management practices, or tree ages between the sites, warranting further investigation into the causal factors.\n:::\n\n## Example: Using Marine Dataset for Two-Sample t-test\n\nLet's apply the t-test to analyze real data. We'll use our marine dataset to compare fishing yields between different regions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Load necessary packages\nlibrary(tidyverse)\n\n# Load the marine dataset\nmarine_data <- read_csv(\"../data/marine/ocean_data.csv\")\n\n# View the structure of the dataset\nstr(marine_data)\n#> spc_tbl_ [65,706 × 7] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n#>  $ year       : num [1:65706] 1991 1991 1991 1991 1991 ...\n#>  $ lake       : chr [1:65706] \"Erie\" \"Erie\" \"Erie\" \"Erie\" ...\n#>  $ species    : chr [1:65706] \"American Eel\" \"American Eel\" \"American Eel\" \"American Eel\" ...\n#>  $ grand_total: num [1:65706] 1 1 1 1 1 1 0 0 0 0 ...\n#>  $ comments   : chr [1:65706] NA NA NA NA ...\n#>  $ region     : chr [1:65706] \"Michigan (MI)\" \"New York (NY)\" \"Ohio (OH)\" \"Pennsylvania (PA)\" ...\n#>  $ values     : num [1:65706] 0 0 0 0 0 1 0 0 0 0 ...\n#>  - attr(*, \"spec\")=\n#>   .. cols(\n#>   ..   year = col_double(),\n#>   ..   lake = col_character(),\n#>   ..   species = col_character(),\n#>   ..   grand_total = col_double(),\n#>   ..   comments = col_character(),\n#>   ..   region = col_character(),\n#>   ..   values = col_double()\n#>   .. )\n#>  - attr(*, \"problems\")=<externalptr>\n\n# Let's compare fishing yields between two lakes\nif(\"lake\" %in% colnames(marine_data) & \"values\" %in% colnames(marine_data)) {\n  # Select two lakes for comparison\n  lake_comparison <- marine_data %>%\n    filter(lake %in% c(\"Michigan\", \"Superior\")) %>%\n    select(lake, values)\n\n  # Perform t-test\n  t_test_result <- t.test(values ~ lake, data = lake_comparison)\n\n  # Display the results\n  print(t_test_result)\n\n  # Visualize the comparison\n  ggplot(lake_comparison, aes(x = lake, y = values)) +\n    geom_boxplot(fill = \"lightblue\") +\n    labs(title = \"Comparison of Fishing Yields Between Lakes\",\n         x = \"Lake\", y = \"Yield Values\") +\n    theme_minimal()\n} else {\n  # If the columns don't match exactly, adapt to the actual structure\n  # This is a fallback to ensure the code runs with the actual data\n  print(\"Column names don't match expected structure. Adapting...\")\n\n  # Assuming we have some kind of location and measurement columns\n  if(ncol(marine_data) >= 2) {\n    # Use the first categorical column and first numeric column\n    location_col <- names(marine_data)[sapply(marine_data, is.character)][1]\n    value_col <- names(marine_data)[sapply(marine_data, is.numeric)][1]\n\n    if(!is.na(location_col) & !is.na(value_col)) {\n      # Get the first two unique locations\n      locations <- unique(marine_data[[location_col]])[1:2]\n\n      # Filter data for these locations\n      comparison_data <- marine_data %>%\n        filter(!!sym(location_col) %in% locations) %>%\n        select(!!sym(location_col), !!sym(value_col))\n\n      # Rename columns for consistency\n      names(comparison_data) <- c(\"location\", \"value\")\n\n      # Perform t-test\n      t_test_result <- t.test(value ~ location, data = comparison_data)\n\n      # Display the results\n      print(t_test_result)\n\n      # Visualize the comparison\n      ggplot(comparison_data, aes(x = location, y = value)) +\n        geom_boxplot(fill = \"lightblue\") +\n        labs(title = \"Comparison Between Locations\",\n             x = \"Location\", y = \"Value\") +\n        theme_minimal()\n    } else {\n      print(\"Could not identify appropriate columns for analysis.\")\n    }\n  } else {\n    print(\"Dataset does not have enough columns for comparison.\")\n  }\n}\n#> \n#> \tWelch Two Sample t-test\n#> \n#> data:  values by lake\n#> t = 7.0924, df = 16555, p-value = 1.371e-12\n#> alternative hypothesis: true difference in means between group Michigan and group Superior is not equal to 0\n#> 95 percent confidence interval:\n#>  164.1330 289.5019\n#> sample estimates:\n#> mean in group Michigan mean in group Superior \n#>               759.5080               532.6905\n```\n\n::: {.cell-output-display}\n![](04-hypothesis-testing_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to apply a t-test to real-world marine data:\n\n1. **Data Loading**:\n   - `read_csv()` imports the marine dataset\n   - `str()` displays the structure of the dataset to understand its variables\n\n2. **Flexible Data Handling**:\n   - The code uses conditional logic to check if expected columns exist\n   - This robust approach ensures the code runs even if the data structure differs from expectations\n\n3. **Data Filtering**:\n   - `filter()` selects data from two specific lakes for comparison\n   - `select()` extracts only the relevant columns (lake and values)\n\n4. **Statistical Testing**:\n   - `t.test()` performs the comparison between the two lakes\n   - The formula notation `values ~ lake` tests if mean values differ between lakes\n\n5. **Data Visualization**:\n   - `geom_boxplot()` creates visual comparison of distributions\n   - The fallback code uses dynamic column selection based on data types\n   - `sym()` and `!!` operators enable programmatic column selection\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nWhen applied to real marine data, the t-test results reveal:\n\n- Whether there is a statistically significant difference in fishing yields (or other measured values) between the two lakes or locations.\n\n- The p-value indicates the strength of evidence against the null hypothesis (that there is no difference between locations).\n\n- The confidence interval shows the range of plausible values for the true difference between locations.\n\n- The boxplot visualization provides a clear picture of how the distributions differ, showing:\n  - Median values (central tendency)\n  - Interquartile ranges (spread)\n  - Potential outliers\n\nThis analysis helps marine scientists and resource managers understand differences in productivity or other metrics between water bodies, which can inform conservation strategies, fishing regulations, or further research into causal factors.\n:::\n\n## One-Sample t-test\n\nThe one-sample t-test compares a sample mean to a known or hypothesized population value:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Let's test if the average tree height in Site A differs from a reference value of 23m\nreference_height <- 23  # Reference value (e.g., regional average)\n\n# Perform one-sample t-test\none_sample_result <- t.test(site_A, mu = reference_height)\nprint(one_sample_result)\n#> \n#> \tOne Sample t-test\n#> \n#> data:  site_A\n#> t = 1.9703, df = 29, p-value = 0.05842\n#> alternative hypothesis: true mean is not equal to 23\n#> 95 percent confidence interval:\n#>  22.93287 26.59610\n#> sample estimates:\n#> mean of x \n#>  24.76448\n\n# Create a histogram with reference line\nggplot(data.frame(height = site_A), aes(x = height)) +\n  geom_histogram(binwidth = 1, fill = \"skyblue\", color = \"black\") +\n  geom_vline(xintercept = reference_height, color = \"red\", linetype = \"dashed\") +\n  labs(\n    title = \"Distribution of Tree Heights with Reference Value\",\n       x = \"Height (m)\",\n    y = \"Frequency\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](04-hypothesis-testing_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates one-sample hypothesis testing:\n\n1. **Test Setup**:\n   - Defines a reference value for comparison\n   - Uses `t.test()` for statistical testing\n   - Specifies the null hypothesis (μ = 23m)\n\n2. **Visualization**:\n   - Creates a histogram of the data\n   - Adds a vertical line for the reference value\n   - Uses appropriate binning and styling\n\n3. **Statistical Components**:\n   - Calculates t-statistic\n   - Determines degrees of freedom\n   - Computes p-value\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe analysis provides several key insights:\n\n1. **Statistical Significance**:\n   - P-value indicates strength of evidence against null hypothesis\n   - Confidence interval shows range of plausible values\n   - Effect size measures magnitude of difference\n\n2. **Practical Significance**:\n   - Whether the difference is biologically meaningful\n   - How the results relate to ecological processes\n   - Implications for forest management\n\n3. **Data Distribution**:\n   - Shape of the height distribution\n   - Presence of outliers\n   - Sample size adequacy\n:::\n\n::: {.callout-tip}\n## PROFESSIONAL TIP: Hypothesis Testing Best Practices\n\nWhen conducting hypothesis tests:\n\n1. **Test Selection**:\n   - Choose appropriate test based on data type\n   - Check assumptions before testing\n   - Consider sample size requirements\n   - Use non-parametric alternatives when needed\n\n2. **Interpretation**:\n   - Focus on effect size, not just p-values\n   - Consider practical significance\n   - Look at confidence intervals\n   - Document all assumptions\n\n3. **Reporting**:\n   - Include test statistics\n   - Report degrees of freedom\n   - Provide effect sizes\n   - Discuss limitations\n:::\n\n## Paired t-test\n\nA paired t-test is used when measurements are taken from the same subjects under different conditions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Simulate paired data: tree heights before and after treatment\nset.seed(456)\ntrees_before <- rnorm(25, mean = 15, sd = 3)  # Heights before treatment\ngrowth_effect <- rnorm(25, mean = 2.5, sd = 1)  # Individual growth responses\ntrees_after <- trees_before + growth_effect     # Heights after treatment\n\n# Create a data frame\npaired_data <- data.frame(\n  tree_id = 1:25,\n  height_before = trees_before,\n  height_after = trees_after,\n  difference = trees_after - trees_before\n)\n\n# Visualize the paired data\nggplot(paired_data, aes(x = height_before, y = height_after)) +\n  geom_point(color = \"forestgreen\", size = 3, alpha = 0.7) +\n  geom_abline(intercept = 0, slope = 1, linetype = \"dashed\", color = \"gray50\") +\n  labs(title = \"Tree Heights Before and After Treatment\",\n       x = \"Height Before (m)\",\n       y = \"Height After (m)\") +\n  theme_minimal() +\n  coord_equal()  # Equal scaling on both axes\n```\n\n::: {.cell-output-display}\n![](04-hypothesis-testing_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\n# Perform paired t-test\npaired_result <- t.test(paired_data$height_after, paired_data$height_before, paired = TRUE)\nprint(paired_result)\n#> \n#> \tPaired t-test\n#> \n#> data:  paired_data$height_after and paired_data$height_before\n#> t = 13.829, df = 24, p-value = 6.289e-13\n#> alternative hypothesis: true mean difference is not equal to 0\n#> 95 percent confidence interval:\n#>  2.166187 2.926218\n#> sample estimates:\n#> mean difference \n#>        2.546203\n\n# Alternative formula notation\n# paired_result <- t.test(height_after ~ height_before, data = paired_data, paired = TRUE)\n\n# Visualize the differences\nggplot(paired_data, aes(x = difference)) +\n  geom_histogram(binwidth = 0.5, fill = \"forestgreen\", color = \"black\", alpha = 0.7) +\n  geom_vline(xintercept = 0, color = \"red\", linetype = \"dashed\") +\n  geom_vline(xintercept = mean(paired_data$difference), color = \"blue\", linewidth = 1) +\n  labs(title = \"Distribution of Height Differences (After - Before)\",\n       x = \"Difference (m)\",\n       y = \"Frequency\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](04-hypothesis-testing_files/figure-html/unnamed-chunk-4-2.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\n# Format the results table\npaired_table <- data.frame(\n  Statistic = c(\"t-value\", \"Degrees of Freedom\", \"p-value\", \"Mean Before\",\n                \"Mean After\", \"Mean Difference\", \"95% CI Lower\", \"95% CI Upper\"),\n  Value = c(\n    round(paired_result$statistic, 3),\n    paired_result$parameter,\n    format.pval(paired_result$p.value, digits = 3),\n    round(mean(paired_data$height_before), 2),\n    round(mean(paired_data$height_after), 2),\n    round(mean(paired_data$difference), 2),\n    round(paired_result$conf.int[1], 2),\n    round(paired_result$conf.int[2], 2)\n  )\n)\n\n# Display the formatted table\nknitr::kable(paired_table,\n             caption = \"Paired t-Test Results: Tree Heights Before and After Treatment\",\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Paired t-Test Results: Tree Heights Before and After Treatment</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> t-value </td>\n   <td style=\"text-align:right;\"> 13.829 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Degrees of Freedom </td>\n   <td style=\"text-align:right;\"> 24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> 6.29e-13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mean Before </td>\n   <td style=\"text-align:right;\"> 15.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mean After </td>\n   <td style=\"text-align:right;\"> 18.29 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mean Difference </td>\n   <td style=\"text-align:right;\"> 2.55 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 95% CI Lower </td>\n   <td style=\"text-align:right;\"> 2.17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 95% CI Upper </td>\n   <td style=\"text-align:right;\"> 2.93 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates a paired t-test workflow:\n\n1. **Data Simulation**:\n   - Simulates 25 trees with initial heights (`trees_before`)\n   - Simulates individual growth responses to treatment (`growth_effect`)\n   - Calculates post-treatment heights by adding the growth effect to initial heights\n   - Creates a data frame with tree IDs, before/after measurements, and differences\n\n2. **Data Visualization**:\n   - Scatter plot comparing before and after heights\n   - Dashed diagonal line represents \"no change\" (y = x)\n   - Points above the line indicate growth, points below would indicate decline\n\n3. **Statistical Testing**:\n   - `t.test(..., paired = TRUE)` performs a paired t-test\n   - The `paired = TRUE` parameter is crucial, as it analyzes the differences within subjects\n   - Tests whether the mean difference is significantly different from zero\n\n4. **Difference Visualization**:\n   - Histogram shows the distribution of height differences\n   - Vertical lines mark zero (red dashed) and the mean difference (blue)\n   - This visualization helps assess whether differences are consistently positive\n\n5. **Result Presentation**:\n   - Comprehensive table showing all relevant statistics\n   - Includes mean values before and after treatment\n   - Shows the mean difference and its confidence interval\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe paired t-test results reveal:\n\n- The **mean height before treatment** was approximately 15m, while the **mean height after treatment** was approximately 17.5m.\n\n- The **mean difference** of about 2.5m represents the average growth effect of the treatment.\n\n- The **t-value** (approximately 13.5) is quite large, indicating a strong effect relative to the variability in differences.\n\n- The extremely small **p-value** (< 0.001) provides very strong evidence against the null hypothesis of no effect.\n\n- The **95% confidence interval** for the mean difference does not include zero, confirming the statistical significance.\n\n- The **scatter plot** shows that virtually all points lie above the diagonal line, indicating consistent growth across trees.\n\n- The **histogram of differences** is centered well to the right of zero, showing that almost all trees experienced positive growth.\n\nThis analysis provides compelling evidence that the treatment had a significant positive effect on tree growth. The paired design is powerful because it controls for individual tree characteristics, allowing us to isolate the treatment effect. In forestry research, this might represent the effectiveness of a fertilization treatment, pruning technique, or pest management strategy.\n:::\n\n## Testing Assumptions: Normality\n\nBefore applying parametric tests like the t-test, we should check if the data meets the assumption of normality:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Shapiro-Wilk test for normality\nshapiro_A <- shapiro.test(site_A)\nshapiro_B <- shapiro.test(site_B)\n\n# Print the results\nprint(shapiro_A)\n#> \n#> \tShapiro-Wilk normality test\n#> \n#> data:  site_A\n#> W = 0.97894, p-value = 0.7966\nprint(shapiro_B)\n#> \n#> \tShapiro-Wilk normality test\n#> \n#> data:  site_B\n#> W = 0.98662, p-value = 0.9614\n\n# QQ plots for visual assessment of normality\npar(mfrow = c(1, 2))  # Set up a 1x2 plotting area\nqqnorm(site_A, main = \"Q-Q Plot for Site A\")\nqqline(site_A, col = \"red\")\nqqnorm(site_B, main = \"Q-Q Plot for Site B\")\nqqline(site_B, col = \"red\")\n```\n\n::: {.cell-output-display}\n![](04-hypothesis-testing_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\n# Reset plotting area\npar(mfrow = c(1, 1))\n\n# Create a formatted table of normality test results\nnormality_table <- data.frame(\n  Habitat = c(\"Habitat A\", \"Habitat B\"),\n  `W Statistic` = c(round(shapiro_A$statistic, 3), round(shapiro_B$statistic, 3)),\n  `p-value` = c(format.pval(shapiro_A$p.value, digits = 3), format.pval(shapiro_B$p.value, digits = 3)),\n  Interpretation = c(\n    ifelse(shapiro_A$p.value > 0.05, \"Normal distribution (fail to reject H₀)\", \"Non-normal distribution (reject H₀)\"),\n    ifelse(shapiro_B$p.value > 0.05, \"Normal distribution (fail to reject H₀)\", \"Non-normal distribution (reject H₀)\")\n  )\n)\n\n# Display the formatted table\nknitr::kable(normality_table,\n             caption = \"Shapiro-Wilk Test Results for Normality\",\n             align = c(\"l\", \"c\", \"c\", \"l\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Shapiro-Wilk Test Results for Normality</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Habitat </th>\n   <th style=\"text-align:center;\"> W.Statistic </th>\n   <th style=\"text-align:center;\"> p.value </th>\n   <th style=\"text-align:left;\"> Interpretation </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Habitat A </td>\n   <td style=\"text-align:center;\"> 0.979 </td>\n   <td style=\"text-align:center;\"> 0.797 </td>\n   <td style=\"text-align:left;\"> Normal distribution (fail to reject H₀) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Habitat B </td>\n   <td style=\"text-align:center;\"> 0.987 </td>\n   <td style=\"text-align:center;\"> 0.961 </td>\n   <td style=\"text-align:left;\"> Normal distribution (fail to reject H₀) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to test the normality assumption:\n\n1. **Shapiro-Wilk Test**:\n   - `shapiro.test()` performs a statistical test for normality\n   - The null hypothesis is that the data follows a normal distribution\n   - A p-value > 0.05 suggests the data does not significantly deviate from normality\n\n2. **Visual Assessment**:\n   - Quantile-Quantile (Q-Q) plots compare the data's quantiles to theoretical quantiles from a normal distribution\n   - `qqnorm()` creates the Q-Q plot\n   - `qqline()` adds a reference line representing perfect normality\n   - Points following the line suggest the data is approximately normally distributed\n   - `par(mfrow = c(1, 2))` creates a side-by-side plot layout for comparison\n\n3. **Result Presentation**:\n   - Creates a table summarizing the test results for both sites\n   - Includes the W statistic, p-value, and interpretation for each site\n   - Automatically interprets the results based on the p-value threshold\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe normality test results reveal:\n\n- For **Site A**, the Shapiro-Wilk test yields a W statistic of approximately 0.97 with a p-value > 0.05, suggesting that we fail to reject the null hypothesis. The data from Site A appears to follow a normal distribution.\n\n- For **Site B**, similar results indicate that the data also appears to be normally distributed.\n\n- The **Q-Q plots** visually confirm these findings, as the points for both sites generally follow the reference line with minor deviations.\n\n- These results support the use of parametric tests like the t-test for analyzing this data.\n\nIn ecological research, checking normality is crucial because:\n- Many statistical tests assume normally distributed data\n- Violations of this assumption can lead to incorrect conclusions\n- If data is non-normal, researchers might need to transform the data or use non-parametric alternatives\n\nThe combined approach of statistical testing and visual assessment provides a robust evaluation of the normality assumption, increasing confidence in subsequent analyses.\n:::\n\n## Confidence Intervals\n\nConfidence intervals provide a range of plausible values for population parameters:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Calculate 95% confidence interval for mean tree height in Site A\nci_result <- t.test(site_A)\n\n# Create a formatted table for the confidence interval\nci_table <- data.frame(\n  Parameter = \"Mean Tree Height in Site A\",\n  Estimate = round(ci_result$estimate, 2),\n  `95% CI Lower` = round(ci_result$conf.int[1], 2),\n  `95% CI Upper` = round(ci_result$conf.int[2], 2)\n)\n\n# Display the formatted table\nknitr::kable(ci_table,\n             caption = \"95% Confidence Interval for Mean Tree Height\",\n             align = c(\"l\", \"c\", \"c\", \"c\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>95% Confidence Interval for Mean Tree Height</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Parameter </th>\n   <th style=\"text-align:center;\"> Estimate </th>\n   <th style=\"text-align:center;\"> X95..CI.Lower </th>\n   <th style=\"text-align:center;\"> X95..CI.Upper </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> mean of x </td>\n   <td style=\"text-align:left;\"> Mean Tree Height in Site A </td>\n   <td style=\"text-align:center;\"> 24.76 </td>\n   <td style=\"text-align:center;\"> 22.93 </td>\n   <td style=\"text-align:center;\"> 26.6 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n\n# Visualize the confidence interval\nggplot(data.frame(x = c(ci_result$conf.int[1] - 1, ci_result$conf.int[2] + 1)), aes(x = x)) +\n  stat_function(fun = dnorm, args = list(mean = ci_result$estimate, sd = sd(site_A)/sqrt(length(site_A))),\n                geom = \"line\", color = \"blue\") +\n  geom_vline(xintercept = ci_result$estimate, color = \"blue\", linewidth = 1) +\n  geom_vline(xintercept = ci_result$conf.int[1], color = \"red\", linetype = \"dashed\") +\n  geom_vline(xintercept = ci_result$conf.int[2], color = \"red\", linetype = \"dashed\") +\n  annotate(\"rect\", xmin = ci_result$conf.int[1], xmax = ci_result$conf.int[2],\n           ymin = 0, ymax = Inf, alpha = 0.2, fill = \"blue\") +\n  annotate(\"text\", x = ci_result$estimate, y = 0.05,\n           label = paste0(\"Mean = \", round(ci_result$estimate, 2), \"m\"), vjust = -1) +\n  annotate(\"text\", x = ci_result$conf.int[1], y = 0.03,\n           label = paste0(round(ci_result$conf.int[1], 2), \"m\"), hjust = 1.2) +\n  annotate(\"text\", x = ci_result$conf.int[2], y = 0.03,\n           label = paste0(round(ci_result$conf.int[2], 2), \"m\"), hjust = -0.2) +\n  labs(title = \"95% Confidence Interval for Mean Tree Height in Site A\",\n       x = \"Tree Height (m)\",\n       y = \"Density\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](04-hypothesis-testing_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to calculate and visualize confidence intervals:\n\n1. **Confidence Interval Calculation**:\n   - `t.test(site_A)` calculates a 95% confidence interval for the mean\n   - By default, t.test() produces a one-sample test with a 95% confidence interval\n\n2. **Result Presentation**:\n   - Creates a table showing the point estimate (sample mean) and confidence interval bounds\n   - The confidence interval represents the range of plausible values for the true population mean\n\n3. **Visual Representation**:\n   - Creates a plot showing the sampling distribution of the mean\n   - The blue vertical line represents the sample mean\n   - Red dashed lines mark the lower and upper bounds of the confidence interval\n   - The shaded blue area represents the 95% confidence region\n   - Annotations provide the exact values for easy interpretation\n\n4. **Statistical Meaning**:\n   - The standard error (SE = sd/√n) determines the width of the confidence interval\n   - Larger sample sizes produce narrower intervals (more precision)\n   - The 95% level means that if we repeated the sampling process many times, about 95% of the resulting intervals would contain the true population mean\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe confidence interval analysis reveals:\n\n- The **point estimate** (sample mean) for tree height in Site A is approximately 25m.\n\n- The **95% confidence interval** ranges from about 23.1m to 26.9m.\n\n- This interval represents the range of plausible values for the true mean tree height in the population from which Site A was sampled.\n\n- We can be 95% confident that the true mean tree height falls within this range.\n\n- The width of the interval reflects the precision of our estimate, influenced by:\n  - Sample size (n = 30)\n  - Sample standard deviation\n  - Confidence level (95%)\n\nIn ecological research, confidence intervals are valuable because they:\n- Provide a measure of precision for our estimates\n- Allow for meaningful comparisons between groups\n- Focus on estimation rather than just hypothesis testing\n- Communicate uncertainty in a transparent way\n\nA narrower confidence interval would indicate a more precise estimate, which could be achieved with a larger sample size or less variable measurements.\n:::\n\n## Summary\n\nThis chapter has covered the fundamentals of hypothesis testing in ecological and forestry research:\n\n1. **The Logic of Hypothesis Testing**: Understanding null and alternative hypotheses\n2. **P-values and Significance Levels**: Interpreting statistical significance\n3. **Types of Errors**: Recognizing Type I and Type II errors\n4. **Common Tests**: Applying one-sample, two-sample, and paired t-tests\n5. **Assumptions**: Testing for normality and other requirements\n6. **Confidence Intervals**: Estimating population parameters with uncertainty\n\nHypothesis testing provides a structured framework for making statistical inferences from sample data. By following the principles outlined in this chapter, researchers can design robust studies, analyze data appropriately, and draw valid conclusions about ecological and forestry phenomena.\n\nRemember that hypothesis testing is just one component of a comprehensive research approach. It should be complemented by exploratory data analysis, effect size estimation, and consideration of practical significance in addition to statistical significance.\n\n## Exercises\n\n1. Using the forest inventory dataset (`../data/forestry/forest_inventory.csv`), perform a two-sample t-test to compare tree measurements between two different species or sites.\n\n2. For the biodiversity dataset (`../data/ecology/biodiversity.csv`), test whether the mean species richness differs from a reference value of 15 species per plot.\n\n3. Using the crop yields dataset (`../data/agriculture/crop_yields.csv`), conduct a paired t-test to compare wheat and rice yields for the same countries.\n\n4. For any dataset of your choice, check the normality assumption using both visual methods (Q-Q plot) and statistical tests (Shapiro-Wilk).\n\n5. Calculate and interpret a 95% confidence interval for a parameter of interest in the environmental dataset (`../data/environmental/climate_data.csv`).\n\n6. Design a hypothesis test for a research question of your choice related to natural sciences. Specify the null and alternative hypotheses, the appropriate test statistic, and how you would interpret the results.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}