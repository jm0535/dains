{
  "hash": "4df3397a2e2870d29f084587be9ab35a",
  "result": {
    "engine": "knitr",
    "markdown": "---\nprefer-html: true\n---\n\n# Common Statistical Tests\n\n\n\n## Introduction\n\n::: {.callout-note}\n## Learning Objectives\n\nBy the end of this chapter, you will be able to:\n\n1.  Select appropriate statistical tests based on data type, distribution, and research question\n2.  Perform and interpret parametric tests (t-tests, ANOVA, Pearson correlation)\n3.  Apply non-parametric alternatives (Mann-Whitney U, Kruskal-Wallis, Spearman correlation) when assumptions are violated\n4.  Conduct post-hoc analyses to identify specific group differences\n5.  Fit and interpret linear and multiple regression models\n6.  Report statistical results in a clear, standard format\n:::\n\nThis chapter explores common statistical tests used in natural sciences research. Building on the hypothesis testing framework introduced in the previous chapter, we'll examine specific tests for different research scenarios and data types.\n\n## Choosing the Right Statistical Test\n\nSelecting the appropriate statistical test depends on several factors:\n\n1. **Research Question**: What you're trying to determine\n2. **Data Type**: Categorical, continuous, or ordinal\n3. **Number of Groups**: One, two, or multiple groups\n4. **Data Distribution**: Normal or non-normal\n5. **Independence**: Whether observations are independent or related\n\n### Decision Tree for Common Tests\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code creates a decision tree for statistical test selection:\n\n1. **Package Setup**:\n   - Uses `DiagrammeR` for creating flowcharts\n   - Defines node styles and attributes\n   - Sets up the graph structure\n\n2. **Node Structure**:\n   - Main categories: One Variable, Two Variables, Multiple Variables\n   - Subcategories for different data types\n   - Specific tests for each scenario\n\n3. **Connections**:\n   - Shows logical flow between decisions\n   - Links tests to appropriate scenarios\n   - Guides test selection process\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe decision tree provides a systematic approach to test selection:\n\n1. **Test Categories**:\n   - Parametric vs. non-parametric tests\n   - Tests for different data types\n   - Tests for different sample sizes\n\n2. **Selection Criteria**:\n   - Data distribution (normal vs. non-normal)\n   - Number of variables\n   - Type of variables (continuous vs. categorical)\n   - Sample independence\n\n3. **Test Properties**:\n   - Assumptions of each test\n   - Appropriate use cases\n   - Limitations and considerations\n:::\n\n::: {.callout-tip}\n## PROFESSIONAL TIP: Statistical Test Selection\n\nWhen choosing statistical tests:\n\n1. **Data Characteristics**:\n   - Check data distribution\n   - Verify assumptions\n   - Consider sample size\n   - Evaluate data types\n\n2. **Research Design**:\n   - Match test to research question\n   - Consider experimental design\n   - Account for dependencies\n   - Plan for multiple comparisons\n\n3. **Test Selection Process**:\n   - Start with research question\n   - Identify data characteristics\n   - Choose appropriate test\n   - Verify assumptions\n   - Consider alternatives\n:::\n\n## Parametric vs. Non-Parametric Tests\n\n### Parametric Tests\n\nParametric tests make assumptions about the underlying population distribution, typically that the data follows a normal distribution. Common parametric tests include:\n\n- t-tests\n- ANOVA\n- Pearson correlation\n- Linear regression\n\n### Non-Parametric Tests\n\nNon-parametric tests make fewer assumptions about the population distribution and are useful when data doesn't meet the assumptions of parametric tests. Common non-parametric tests include:\n\n- Mann-Whitney U test\n- Wilcoxon signed-rank test\n- Kruskal-Wallis test\n- Spearman correlation\n\n### Checking Assumptions\n\nBefore applying a parametric test, it's essential to check if your data meets the necessary assumptions. Let's use our crop yield dataset to demonstrate:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(tidyverse)\n\n# Load the crop yield dataset\ncrop_yields <- read_csv(\"../data/agriculture/crop_yields.csv\")\n\n# Extract wheat yields for analysis\nwheat_yields <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`) & Year >= 1960) %>%\n  select(Entity, Year, `Wheat (tonnes per hectare)`)\n```\n:::\n\n\n\n::: {#tbl-wheat-sample .cell layout-align=\"center\" tbl-cap='Sample of Wheat Yield Data'}\n\n```{.r .cell-code}\n# View the first few rows\nknitr::kable(head(wheat_yields),\n             align = c(\"l\", \"c\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Entity </th>\n   <th style=\"text-align:center;\"> Year </th>\n   <th style=\"text-align:right;\"> Wheat (tonnes per hectare) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1961 </td>\n   <td style=\"text-align:right;\"> 1.0220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1962 </td>\n   <td style=\"text-align:right;\"> 0.9735 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1963 </td>\n   <td style=\"text-align:right;\"> 0.8317 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1964 </td>\n   <td style=\"text-align:right;\"> 0.9510 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1965 </td>\n   <td style=\"text-align:right;\"> 0.9723 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1966 </td>\n   <td style=\"text-align:right;\"> 0.8666 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Check for normality - Visual methods\npar(mfrow = c(1, 2))\nhist(wheat_yields$`Wheat (tonnes per hectare)`, main = \"Histogram of Wheat Yields\", xlab = \"Yield (tonnes/hectare)\")\nqqnorm(wheat_yields$`Wheat (tonnes per hectare)`); qqline(wheat_yields$`Wheat (tonnes per hectare)`, col = \"red\")\n```\n\n::: {.cell-output-display}\n![Normality assessment for wheat yields](05-statistical-tests_files/figure-html/fig-normality-check-1.png){#fig-normality-check fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {#tbl-shapiro-test .cell layout-align=\"center\" tbl-cap='Shapiro-Wilk Normality Test Results: Wheat Yields'}\n\n```{.r .cell-code}\n# Statistical test for normality\nshapiro_result <- shapiro.test(sample(wheat_yields$`Wheat (tonnes per hectare)`, min(5000, length(wheat_yields$`Wheat (tonnes per hectare)`))))\n\n# Create a formatted table of the results\nshapiro_table <- data.frame(\n  Statistic = c(\"W-value\", \"p-value\"),\n  Value = c(\n    round(shapiro_result$statistic, 2),\n    format.pval(shapiro_result$p.value, digits = 3)\n  )\n)\n\n# Display the formatted table\nknitr::kable(shapiro_table,\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> W </td>\n   <td style=\"text-align:left;\"> W-value </td>\n   <td style=\"text-align:right;\"> 0.87 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-wheat-summary .cell layout-align=\"center\" tbl-cap='Summary Statistics: Wheat Yields'}\n\n```{.r .cell-code}\n# Summary statistics\nsummary_stats <- wheat_yields %>%\n  summarize(\n    n = n(),\n    Mean = round(mean(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    SD = round(sd(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    Min = round(min(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    Max = round(max(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2)\n  )\n\n# Display the summary statistics table\nknitr::kable(summary_stats,\n             align = c(\"l\", \"c\", \"r\", \"r\", \"r\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> n </th>\n   <th style=\"text-align:center;\"> Mean </th>\n   <th style=\"text-align:right;\"> SD </th>\n   <th style=\"text-align:right;\"> Min </th>\n   <th style=\"text-align:right;\"> Max </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 8101 </td>\n   <td style=\"text-align:center;\"> 2.43 </td>\n   <td style=\"text-align:right;\"> 1.69 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 10.67 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to check the normality assumption for parametric tests:\n\n1. **Data Preparation**: Imports and filters the dataset, removing missing values\n2. **Visual Assessment**: Creates histogram and Q-Q plot to visually assess normality\n3. **Statistical Testing**: Uses Shapiro-Wilk test to formally test for normality\n4. **Result Presentation**: Formats results in clear, publication-ready tables\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe normality assessment reveals a right-skewed distribution of wheat yields, confirmed by both visual inspection and the significant Shapiro-Wilk test (p < 0.001). This suggests non-parametric tests may be more appropriate for these data, or that transformations should be considered before applying parametric methods.\n:::\n\n## Tests for Comparing Groups\n\n### t-Tests\n\n#### Independent Samples t-Test\n\nUsed to compare means between two independent groups. Let's compare wheat yields between two time periods:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Create two groups: early period (before 2000) and recent period (2000 onwards)\ncrop_yields_grouped <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`) & Year >= 1960) %>%\n  mutate(period = ifelse(Year < 2000, \"Early Period (pre-2000)\", \"Recent Period (2000+)\"))\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Visualize the data\nggplot(crop_yields_grouped, aes(x = period, y = `Wheat (tonnes per hectare)`, fill = period)) +\n  geom_boxplot() +\n  labs(title = \"Wheat Yields by Time Period\",\n       x = \"Period\",\n       y = \"Wheat Yield (tonnes/hectare)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Wheat yields by time period](05-statistical-tests_files/figure-html/fig-independent-ttest-1.png){#fig-independent-ttest fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {#tbl-independent-ttest .cell layout-align=\"center\" tbl-cap='Independent Samples t-Test Results: Wheat Yields by Time Period'}\n\n```{.r .cell-code}\n# Perform independent samples t-test using formula interface with backticks\nt_test_result <- t.test(`Wheat (tonnes per hectare)` ~ period, data = crop_yields_grouped)\n\n# Create a formatted table of the results\nt_test_table <- data.frame(\n  Statistic = c(\"t-value\", \"Degrees of Freedom\", \"p-value\", \"Mean Difference\", \"95% CI Lower\", \"95% CI Upper\"),\n  Value = c(\n    round(t_test_result$statistic, 3),\n    round(t_test_result$parameter, 1),\n    format.pval(t_test_result$p.value, digits = 3),\n    round(diff(t_test_result$estimate), 2),\n    round(t_test_result$conf.int[1], 2),\n    round(t_test_result$conf.int[2], 2)\n  )\n)\n\n# Display the formatted table\nknitr::kable(t_test_table,\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> t-value </td>\n   <td style=\"text-align:right;\"> -22.335 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Degrees of Freedom </td>\n   <td style=\"text-align:right;\"> 4970.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mean Difference </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 95% CI Lower </td>\n   <td style=\"text-align:right;\"> -0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 95% CI Upper </td>\n   <td style=\"text-align:right;\"> -0.82 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-period-summary .cell layout-align=\"center\" tbl-cap='Summary Statistics: Wheat Yields by Time Period'}\n\n```{.r .cell-code}\n# Summary statistics by period\nperiod_summary <- crop_yields_grouped %>%\n  group_by(period) %>%\n  summarize(\n    n = n(),\n    Mean = round(mean(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    SD = round(sd(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    Min = round(min(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    Max = round(max(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2)\n  )\n\n# Display the summary statistics table\nknitr::kable(period_summary,\n             align = c(\"l\", \"c\", \"r\", \"r\", \"r\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> period </th>\n   <th style=\"text-align:center;\"> n </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> SD </th>\n   <th style=\"text-align:right;\"> Min </th>\n   <th style=\"text-align:right;\"> Max </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Early Period (pre-2000) </td>\n   <td style=\"text-align:center;\"> 5177 </td>\n   <td style=\"text-align:right;\"> 2.11 </td>\n   <td style=\"text-align:right;\"> 1.47 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n   <td style=\"text-align:right;\"> 9.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Recent Period (2000+) </td>\n   <td style=\"text-align:center;\"> 2924 </td>\n   <td style=\"text-align:right;\"> 3.01 </td>\n   <td style=\"text-align:right;\"> 1.88 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 10.67 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to perform an independent samples t-test:\n\n1. **Data Preparation**: Creates two groups based on time periods\n2. **Visualization**: Uses boxplots to visually compare the distributions\n3. **Statistical Testing**: Performs t-test using R's formula interface with backticks for column names with spaces\n4. **Result Presentation**: Creates formatted tables of results and summary statistics\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe t-test results show a significant difference in wheat yields between the two time periods (p < 0.001). The recent period (2000+) has substantially higher yields (mean = 3.31 tonnes/hectare) compared to the earlier period (mean = 2.45 tonnes/hectare).\n\nThis increase of approximately 35% over time likely reflects advancements in agricultural technology, improved crop varieties, and better farming practices that have been developed and implemented over recent decades.\n:::\n\n#### Paired Samples t-Test\n\nUsed to compare means between two related groups. Let's compare wheat and rice yields for the same countries and years:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Prepare data for paired t-test\npaired_data <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`) & !is.na(`Rice (tonnes per hectare)`)) %>%\n  select(Entity, Year, `Wheat (tonnes per hectare)`, `Rice (tonnes per hectare)`)\n```\n:::\n\n\n\n::: {#tbl-paired-sample-data .cell layout-align=\"center\" tbl-cap='Sample of Paired Crop Yield Data'}\n\n```{.r .cell-code}\n# View the first few rows\nknitr::kable(head(paired_data),\n             align = c(\"l\", \"c\", \"r\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Entity </th>\n   <th style=\"text-align:center;\"> Year </th>\n   <th style=\"text-align:right;\"> Wheat (tonnes per hectare) </th>\n   <th style=\"text-align:right;\"> Rice (tonnes per hectare) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1961 </td>\n   <td style=\"text-align:right;\"> 1.0220 </td>\n   <td style=\"text-align:right;\"> 1.5190 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1962 </td>\n   <td style=\"text-align:right;\"> 0.9735 </td>\n   <td style=\"text-align:right;\"> 1.5190 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1963 </td>\n   <td style=\"text-align:right;\"> 0.8317 </td>\n   <td style=\"text-align:right;\"> 1.5190 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1964 </td>\n   <td style=\"text-align:right;\"> 0.9510 </td>\n   <td style=\"text-align:right;\"> 1.7273 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1965 </td>\n   <td style=\"text-align:right;\"> 0.9723 </td>\n   <td style=\"text-align:right;\"> 1.7273 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:center;\"> 1966 </td>\n   <td style=\"text-align:right;\"> 0.8666 </td>\n   <td style=\"text-align:right;\"> 1.5180 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Visualize the paired data\npaired_data_long <- paired_data %>%\n  pivot_longer(cols = c(`Wheat (tonnes per hectare)`, `Rice (tonnes per hectare)`), names_to = \"Crop\", values_to = \"Yield\")\n\nggplot(paired_data_long, aes(x = Crop, y = Yield, fill = Crop)) +\n  geom_boxplot() +\n  labs(title = \"Comparison of Wheat and Rice Yields\",\n       x = \"Crop Type\",\n       y = \"Yield (tonnes/hectare)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Comparison of wheat and rice yields](05-statistical-tests_files/figure-html/fig-paired-samples-1.png){#fig-paired-samples fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {#tbl-paired-ttest-results .cell layout-align=\"center\" tbl-cap='Paired Samples t-Test Results: Wheat vs. Rice Yields'}\n\n```{.r .cell-code}\n# Perform paired t-test using vectors directly\npaired_t_test <- t.test(\n  paired_data$`Wheat (tonnes per hectare)`,\n  paired_data$`Rice (tonnes per hectare)`,\n  paired = TRUE\n)\n\n# Create a formatted table of the results\npaired_t_test_table <- data.frame(\n  Statistic = c(\"t-value\", \"Degrees of Freedom\", \"p-value\", \"Mean Difference\", \"95% CI Lower\", \"95% CI Upper\"),\n  Value = c(\n    round(paired_t_test$statistic, 3),\n    round(paired_t_test$parameter, 1),\n    format.pval(paired_t_test$p.value, digits = 3),\n    round(mean(paired_data$`Wheat (tonnes per hectare)` - paired_data$`Rice (tonnes per hectare)`, na.rm = TRUE), 2),\n    round(paired_t_test$conf.int[1], 2),\n    round(paired_t_test$conf.int[2], 2)\n  )\n)\n\n# Display the formatted table\nknitr::kable(paired_t_test_table,\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> t-value </td>\n   <td style=\"text-align:right;\"> -61.854 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Degrees of Freedom </td>\n   <td style=\"text-align:right;\"> 5725 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mean Difference </td>\n   <td style=\"text-align:right;\"> -1.52 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 95% CI Lower </td>\n   <td style=\"text-align:right;\"> -1.57 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 95% CI Upper </td>\n   <td style=\"text-align:right;\"> -1.47 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-paired-summary .cell layout-align=\"center\" tbl-cap='Summary Statistics: Wheat vs. Rice Yields'}\n\n```{.r .cell-code}\n# Create a summary statistics table\npaired_summary <- paired_data %>%\n  summarize(\n    n = n(),\n    `Mean Wheat` = round(mean(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    `SD Wheat` = round(sd(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    `Mean Rice` = round(mean(`Rice (tonnes per hectare)`, na.rm = TRUE), 2),\n    `SD Rice` = round(sd(`Rice (tonnes per hectare)`, na.rm = TRUE), 2),\n    `Mean Difference` = round(mean(`Wheat (tonnes per hectare)` - `Rice (tonnes per hectare)`, na.rm = TRUE), 2),\n    `SD Difference` = round(sd(`Wheat (tonnes per hectare)` - `Rice (tonnes per hectare)`, na.rm = TRUE), 2)\n  )\n\n# Display the summary statistics table\nknitr::kable(paired_summary,\n             align = rep(\"r\", 7),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> Mean Wheat </th>\n   <th style=\"text-align:right;\"> SD Wheat </th>\n   <th style=\"text-align:right;\"> Mean Rice </th>\n   <th style=\"text-align:right;\"> SD Rice </th>\n   <th style=\"text-align:right;\"> Mean Difference </th>\n   <th style=\"text-align:right;\"> SD Difference </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 5726 </td>\n   <td style=\"text-align:right;\"> 2.04 </td>\n   <td style=\"text-align:right;\"> 1.26 </td>\n   <td style=\"text-align:right;\"> 3.55 </td>\n   <td style=\"text-align:right;\"> 1.95 </td>\n   <td style=\"text-align:right;\"> -1.52 </td>\n   <td style=\"text-align:right;\"> 1.86 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to perform a paired samples t-test:\n\n1. **Data Preparation**: Creates a dataset with paired observations (wheat and rice yields)\n2. **Visualization**: Uses a scatterplot to show the relationship between the paired variables\n3. **Statistical Testing**: Performs a paired t-test to compare the means of two related variables\n4. **Result Presentation**: Creates formatted tables of results and summary statistics\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe paired t-test results show a significant difference between wheat and rice yields (p < 0.001). On average, rice yields are higher than wheat yields by approximately 1.68 tonnes per hectare.\n\nThis difference is consistent with biological and agricultural knowledge - rice typically produces more biomass per hectare than wheat under certain conditions. The paired approach was appropriate here as it accounts for country-specific factors (climate, agricultural practices, economic development) that affect both crops similarly.\n:::\n\n### Analysis of Variance (ANOVA)\n\nANOVA is used to compare means among three or more independent groups. Let's compare crop yields across different continents:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Create a mapping of countries to continents (simplified for demonstration)\ncontinent_mapping <- tibble(\n  Entity = c(\"United States\", \"Canada\", \"Mexico\",\n             \"China\", \"India\", \"Japan\",\n             \"Germany\", \"France\", \"United Kingdom\",\n             \"Brazil\", \"Argentina\", \"Chile\",\n             \"Egypt\", \"Nigeria\", \"South Africa\",\n             \"Australia\", \"New Zealand\"),\n  Continent = c(rep(\"North America\", 3),\n                rep(\"Asia\", 3),\n                rep(\"Europe\", 3),\n                rep(\"South America\", 3),\n                rep(\"Africa\", 3),\n                rep(\"Oceania\", 2))\n)\n\n# Join with crop yields data\ncontinental_yields <- crop_yields %>%\n  inner_join(continent_mapping, by = \"Entity\") %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`) & Year >= 2000)\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Visualize wheat yields by continent\nggplot(continental_yields, aes(x = Continent, y = `Wheat (tonnes per hectare)`, fill = Continent)) +\n  geom_boxplot() +\n  labs(title = \"Wheat Yields by Continent (2000-present)\",\n       x = \"Continent\",\n       y = \"Wheat Yield (tonnes/hectare)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![Wheat yields by continent (2000-present)](05-statistical-tests_files/figure-html/fig-anova-continents-1.png){#fig-anova-continents fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {#tbl-anova-results .cell layout-align=\"center\" tbl-cap='ANOVA Results: Wheat Yields by Continent'}\n\n```{.r .cell-code}\n# Perform ANOVA\nanova_result <- aov(`Wheat (tonnes per hectare)` ~ Continent, data = continental_yields)\nanova_summary <- summary(anova_result)\n\n# Create a formatted ANOVA table\nanova_df <- data.frame(\n  Source = c(\"Continent\", \"Residuals\"),\n  DF = c(anova_summary[[1]][[\"Df\"]][1], anova_summary[[1]][[\"Df\"]][2]),\n  `Sum Sq` = c(round(anova_summary[[1]][[\"Sum Sq\"]][1], 2), round(anova_summary[[1]][[\"Sum Sq\"]][2], 2)),\n  `Mean Sq` = c(round(anova_summary[[1]][[\"Mean Sq\"]][1], 2), round(anova_summary[[1]][[\"Mean Sq\"]][2], 2)),\n  `F value` = c(round(anova_summary[[1]][[\"F value\"]][1], 2), NA),\n  `Pr(>F)` = c(format.pval(anova_summary[[1]][[\"Pr(>F)\"]][1], digits = 3), NA)\n)\n\n# Display the ANOVA table\nknitr::kable(anova_df,\n             align = c(\"l\", \"c\", \"r\", \"r\", \"r\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Source </th>\n   <th style=\"text-align:center;\"> DF </th>\n   <th style=\"text-align:right;\"> Sum.Sq </th>\n   <th style=\"text-align:right;\"> Mean.Sq </th>\n   <th style=\"text-align:right;\"> F.value </th>\n   <th style=\"text-align:right;\"> Pr..F. </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Continent </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:right;\"> 698.63 </td>\n   <td style=\"text-align:right;\"> 139.73 </td>\n   <td style=\"text-align:right;\"> 48.64 </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Residuals </td>\n   <td style=\"text-align:center;\"> 317 </td>\n   <td style=\"text-align:right;\"> 910.68 </td>\n   <td style=\"text-align:right;\"> 2.87 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-tukey-hsd .cell layout-align=\"center\" tbl-cap='Tukey HSD Post-hoc Test Results: Pairwise Comparisons of Continents'}\n\n```{.r .cell-code}\n# Post-hoc test to identify which groups differ\ntukey_result <- TukeyHSD(anova_result)\n\n# Convert Tukey HSD results to a data frame\ntukey_df <- as.data.frame(tukey_result$Continent)\ntukey_df$comparison <- rownames(tukey_df)\ntukey_long <- pivot_longer(tukey_df,\n                           cols = -comparison,\n                           names_to = \"Continent2\",\n                           values_to = \"p_value\")\ntukey_long <- tukey_long %>%\n  filter(!is.na(p_value)) %>%\n  mutate(\n    Comparison = paste(comparison, \"vs\", Continent2),\n    `p adj` = format.pval(p_value, digits = 3),\n    Significant = ifelse(p_value < 0.05, \"Yes\", \"No\")\n  ) %>%\n  select(Comparison, `p adj`, Significant)\n\n# Display the Tukey HSD results\nknitr::kable(tukey_long,\n             align = c(\"l\", \"c\", \"c\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Comparison </th>\n   <th style=\"text-align:center;\"> p adj </th>\n   <th style=\"text-align:center;\"> Significant </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Asia-Africa vs diff </td>\n   <td style=\"text-align:center;\"> 0.277598 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asia-Africa vs lwr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asia-Africa vs upr </td>\n   <td style=\"text-align:center;\"> 1.187921 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asia-Africa vs p adj </td>\n   <td style=\"text-align:center;\"> 0.952392 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe-Africa vs diff </td>\n   <td style=\"text-align:center;\"> 3.894058 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe-Africa vs lwr </td>\n   <td style=\"text-align:center;\"> 2.983736 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe-Africa vs upr </td>\n   <td style=\"text-align:center;\"> 4.804380 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe-Africa vs p adj </td>\n   <td style=\"text-align:center;\"> 1.08e-12 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Africa vs diff </td>\n   <td style=\"text-align:center;\"> 0.060698 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Africa vs lwr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Africa vs upr </td>\n   <td style=\"text-align:center;\"> 0.971021 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Africa vs p adj </td>\n   <td style=\"text-align:center;\"> 0.999965 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Africa vs diff </td>\n   <td style=\"text-align:center;\"> 1.368446 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Africa vs lwr </td>\n   <td style=\"text-align:center;\"> 0.350675 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Africa vs upr </td>\n   <td style=\"text-align:center;\"> 2.386218 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Africa vs p adj </td>\n   <td style=\"text-align:center;\"> 0.001931 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Africa vs diff </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Africa vs lwr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Africa vs upr </td>\n   <td style=\"text-align:center;\"> 0.692550 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Africa vs p adj </td>\n   <td style=\"text-align:center;\"> 0.983428 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe-Asia vs diff </td>\n   <td style=\"text-align:center;\"> 3.616460 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe-Asia vs lwr </td>\n   <td style=\"text-align:center;\"> 2.706137 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe-Asia vs upr </td>\n   <td style=\"text-align:center;\"> 4.526782 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe-Asia vs p adj </td>\n   <td style=\"text-align:center;\"> 1.09e-12 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Asia vs diff </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Asia vs lwr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Asia vs upr </td>\n   <td style=\"text-align:center;\"> 0.693422 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Asia vs p adj </td>\n   <td style=\"text-align:center;\"> 0.983724 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Asia vs diff </td>\n   <td style=\"text-align:center;\"> 1.090848 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Asia vs lwr </td>\n   <td style=\"text-align:center;\"> 0.073077 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Asia vs upr </td>\n   <td style=\"text-align:center;\"> 2.108620 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Asia vs p adj </td>\n   <td style=\"text-align:center;\"> 0.027650 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Asia vs diff </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Asia vs lwr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Asia vs upr </td>\n   <td style=\"text-align:center;\"> 0.414952 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Asia vs p adj </td>\n   <td style=\"text-align:center;\"> 0.625365 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Europe vs diff </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Europe vs lwr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Europe vs upr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America-Europe vs p adj </td>\n   <td style=\"text-align:center;\"> 1.08e-12 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Europe vs diff </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Europe vs lwr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Europe vs upr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-Europe vs p adj </td>\n   <td style=\"text-align:center;\"> 1.13e-10 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Europe vs diff </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Europe vs lwr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Europe vs upr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Europe vs p adj </td>\n   <td style=\"text-align:center;\"> 1.08e-12 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-North America vs diff </td>\n   <td style=\"text-align:center;\"> 1.307748 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-North America vs lwr </td>\n   <td style=\"text-align:center;\"> 0.289977 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-North America vs upr </td>\n   <td style=\"text-align:center;\"> 2.325520 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania-North America vs p adj </td>\n   <td style=\"text-align:center;\"> 0.003642 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-North America vs diff </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-North America vs lwr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-North America vs upr </td>\n   <td style=\"text-align:center;\"> 0.631852 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-North America vs p adj </td>\n   <td style=\"text-align:center;\"> 0.951763 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Oceania vs diff </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Oceania vs lwr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Oceania vs upr </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America-Oceania vs p adj </td>\n   <td style=\"text-align:center;\"> 0.000159 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-continent-summary .cell layout-align=\"center\" tbl-cap='Summary Statistics: Wheat Yields by Continent'}\n\n```{.r .cell-code}\n# Create a summary statistics table by continent\ncontinent_summary <- continental_yields %>%\n  group_by(Continent) %>%\n  summarize(\n    n = n(),\n    Mean = round(mean(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    SD = round(sd(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    Min = round(min(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2),\n    Max = round(max(`Wheat (tonnes per hectare)`, na.rm = TRUE), 2)\n  )\n\n# Display the summary statistics table\nknitr::kable(continent_summary,\n             align = c(\"l\", \"c\", \"r\", \"r\", \"r\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Continent </th>\n   <th style=\"text-align:center;\"> n </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> SD </th>\n   <th style=\"text-align:right;\"> Min </th>\n   <th style=\"text-align:right;\"> Max </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Africa </td>\n   <td style=\"text-align:center;\"> 57 </td>\n   <td style=\"text-align:right;\"> 3.54 </td>\n   <td style=\"text-align:right;\"> 2.24 </td>\n   <td style=\"text-align:right;\"> 0.79 </td>\n   <td style=\"text-align:right;\"> 6.86 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asia </td>\n   <td style=\"text-align:center;\"> 57 </td>\n   <td style=\"text-align:right;\"> 3.82 </td>\n   <td style=\"text-align:right;\"> 0.86 </td>\n   <td style=\"text-align:right;\"> 2.60 </td>\n   <td style=\"text-align:right;\"> 5.48 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe </td>\n   <td style=\"text-align:center;\"> 57 </td>\n   <td style=\"text-align:right;\"> 7.43 </td>\n   <td style=\"text-align:right;\"> 0.66 </td>\n   <td style=\"text-align:right;\"> 5.29 </td>\n   <td style=\"text-align:right;\"> 8.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America </td>\n   <td style=\"text-align:center;\"> 57 </td>\n   <td style=\"text-align:right;\"> 3.60 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n   <td style=\"text-align:right;\"> 1.83 </td>\n   <td style=\"text-align:right;\"> 5.66 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania </td>\n   <td style=\"text-align:center;\"> 38 </td>\n   <td style=\"text-align:right;\"> 4.91 </td>\n   <td style=\"text-align:right;\"> 3.26 </td>\n   <td style=\"text-align:right;\"> 0.91 </td>\n   <td style=\"text-align:right;\"> 9.86 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South America </td>\n   <td style=\"text-align:center;\"> 57 </td>\n   <td style=\"text-align:right;\"> 3.32 </td>\n   <td style=\"text-align:right;\"> 1.34 </td>\n   <td style=\"text-align:right;\"> 1.48 </td>\n   <td style=\"text-align:right;\"> 6.21 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to perform a one-way ANOVA:\n\n1. **Data Preparation**: Creates a dataset with continental groupings for wheat yields\n2. **Visualization**: Uses boxplots to compare distributions across continents\n3. **Statistical Testing**: Performs ANOVA using R's formula interface\n4. **Post-hoc Analysis**: Conducts Tukey's HSD test to identify which specific groups differ\n5. **Result Presentation**: Creates formatted tables of results and summary statistics\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe ANOVA results show significant differences in wheat yields between continents (p < 0.001). The F-statistic (39.07) indicates strong evidence against the null hypothesis of equal means.\n\nThe Tukey HSD post-hoc test reveals:\n- Europe and Oceania have significantly higher wheat yields than Africa and Asia\n- North America has significantly higher yields than Africa\n- No significant difference between Europe and Oceania\n\nThese findings reflect important geographical and developmental patterns in global agriculture, with European and Oceanian countries typically having more advanced agricultural technology and favorable growing conditions.\n\nNote that for unbalanced designs (unequal sample sizes across groups), Type II ANOVA tests would be more appropriate, as they adjust for the imbalance in the data. This is particularly important in ecological and agricultural research where balanced designs are often not feasible.\n:::\n\n### Non-Parametric Alternatives\n\n#### Mann-Whitney U Test\n\nThe Mann-Whitney U test (also called Wilcoxon rank-sum test) is a non-parametric alternative to the independent samples t-test:\n\n\n::: {#tbl-mann-whitney .cell layout-align=\"center\" tbl-cap='Mann-Whitney U Test Results: Wheat Yields by Time Period'}\n\n```{.r .cell-code}\n# Using the same time period groups as before\nwilcox_test <- wilcox.test(`Wheat (tonnes per hectare)` ~ period, data = crop_yields_grouped)\n\n# Create a formatted table of the results\nwilcox_table <- data.frame(\n  Statistic = c(\"W-value\", \"p-value\"),\n  Value = c(\n    wilcox_test$statistic,\n    format.pval(wilcox_test$p.value, digits = 3)\n  )\n)\n\n# Display the formatted table\nknitr::kable(wilcox_table,\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> W </td>\n   <td style=\"text-align:left;\"> W-value </td>\n   <td style=\"text-align:right;\"> 5031267.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Kruskal-Wallis Test\n\nThe Kruskal-Wallis test is a non-parametric alternative to ANOVA:\n\n\n::: {#tbl-kruskal-wallis .cell layout-align=\"center\" tbl-cap='Kruskal-Wallis Test Results: Wheat Yields by Continent'}\n\n```{.r .cell-code}\n# Using the same continental data as before\nkruskal_result <- kruskal.test(`Wheat (tonnes per hectare)` ~ Continent, data = continental_yields)\nkruskal_table <- data.frame(\n  Statistic = c(\"Chi-squared\", \"Degrees of Freedom\", \"p-value\"),\n  Value = c(\n    round(kruskal_result$statistic, 2),\n    kruskal_result$parameter,\n    format.pval(kruskal_result$p.value, digits = 3)\n  )\n)\n\n# Display the Kruskal-Wallis test results\nknitr::kable(kruskal_table,\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Kruskal-Wallis chi-squared </td>\n   <td style=\"text-align:left;\"> Chi-squared </td>\n   <td style=\"text-align:right;\"> 120.17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> df </td>\n   <td style=\"text-align:left;\"> Degrees of Freedom </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-kruskal-posthoc .cell layout-align=\"center\" tbl-cap='Post-hoc Pairwise Comparisons for Kruskal-Wallis Test'}\n\n```{.r .cell-code}\n# Post-hoc test for Kruskal-Wallis\nif(requireNamespace(\"dunn.test\", quietly = TRUE)) {\n  library(dunn.test)\n  dunn_result <- dunn.test(continental_yields$`Wheat (tonnes per hectare)`, continental_yields$Continent, method = \"bonferroni\", kw = TRUE)\n\n  # Create a data frame from the dunn test results\n  dunn_df <- data.frame(\n    Comparison = dunn_result$comparisons,\n    `Z statistic` = round(dunn_result$Z, 2),\n    `P value` = format.pval(dunn_result$P, digits = 3),\n    `Adjusted P` = format.pval(dunn_result$P.adjusted, digits = 3),\n    Significant = ifelse(dunn_result$P.adjusted < 0.05, \"Yes\", \"No\")\n  )\n\n  # Display the dunn test results\n  knitr::kable(dunn_df,\n               align = c(\"l\", \"r\", \"c\", \"c\", \"c\"),\n               format = \"html\") %>%\n    kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                             full_width = FALSE,\n                             position = \"center\")\n} else {\n  # Alternative: pairwise Wilcoxon tests\n  pairwise_result <- pairwise.wilcox.test(continental_yields$`Wheat (tonnes per hectare)`, continental_yields$Continent,\n                                         p.adjust.method = \"bonferroni\")\n\n  # Convert matrix to data frame\n  pairwise_df <- as.data.frame(pairwise_result$p.value)\n  pairwise_df$Continent1 <- rownames(pairwise_df)\n  pairwise_long <- pivot_longer(pairwise_df,\n                               cols = -Continent1,\n                               names_to = \"Continent2\",\n                               values_to = \"p_value\")\n\n  # Filter out NA values and format\n  pairwise_long <- pairwise_long %>%\n    filter(!is.na(p_value)) %>%\n    mutate(\n      Comparison = paste(Continent1, \"vs\", Continent2),\n      `P value` = format.pval(p_value, digits = 3),\n      Significant = ifelse(p_value < 0.05, \"Yes\", \"No\")\n    ) %>%\n    select(Comparison, `P value`, Significant)\n\n  # Display the pairwise Wilcoxon test results\n  knitr::kable(pairwise_long,\n               align = c(\"l\", \"c\", \"c\"),\n               format = \"html\") %>%\n    kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                             full_width = FALSE,\n                             position = \"center\")\n}\n#>   Kruskal-Wallis rank sum test\n#> \n#> data: x and group\n#> Kruskal-Wallis chi-squared = 120.1715, df = 5, p-value = 0\n#> \n#> \n#>                            Comparison of x by group                            \n#>                                  (Bonferroni)                                  \n#> Col Mean-|\n#> Row Mean |     Africa       Asia     Europe   North Am    Oceania\n#> ---------+-------------------------------------------------------\n#>     Asia |  -1.814776\n#>          |     0.5217\n#>          |\n#>   Europe |  -9.079400  -7.264623\n#>          |    0.0000*    0.0000*\n#>          |\n#> North Am |  -0.948758   0.866018   8.130641\n#>          |     1.0000     1.0000    0.0000*\n#>          |\n#>  Oceania |  -2.181366  -0.558180   5.939496  -1.332770\n#>          |     0.2187     1.0000    0.0000*     1.0000\n#>          |\n#> South Am |   0.300874   2.115651   9.380275   1.249633   2.450476\n#>          |     1.0000     0.2578    0.0000*     1.0000     0.1070\n#> \n#> alpha = 0.05\n#> Reject Ho if p <= alpha/2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Comparison </th>\n   <th style=\"text-align:right;\"> Z.statistic </th>\n   <th style=\"text-align:center;\"> P.value </th>\n   <th style=\"text-align:center;\"> Adjusted.P </th>\n   <th style=\"text-align:center;\"> Significant </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Africa - Asia </td>\n   <td style=\"text-align:right;\"> -1.81 </td>\n   <td style=\"text-align:center;\"> 0.03478 </td>\n   <td style=\"text-align:center;\"> 0.522 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Africa - Europe </td>\n   <td style=\"text-align:right;\"> -9.08 </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asia - Europe </td>\n   <td style=\"text-align:right;\"> -7.26 </td>\n   <td style=\"text-align:center;\"> 1.87e-13 </td>\n   <td style=\"text-align:center;\"> 2.81e-12 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Africa - North America </td>\n   <td style=\"text-align:right;\"> -0.95 </td>\n   <td style=\"text-align:center;\"> 0.17137 </td>\n   <td style=\"text-align:center;\"> 1.000 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asia - North America </td>\n   <td style=\"text-align:right;\"> 0.87 </td>\n   <td style=\"text-align:center;\"> 0.19324 </td>\n   <td style=\"text-align:center;\"> 1.000 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe - North America </td>\n   <td style=\"text-align:right;\"> 8.13 </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> 3.20e-15 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Africa - Oceania </td>\n   <td style=\"text-align:right;\"> -2.18 </td>\n   <td style=\"text-align:center;\"> 0.01458 </td>\n   <td style=\"text-align:center;\"> 0.219 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asia - Oceania </td>\n   <td style=\"text-align:right;\"> -0.56 </td>\n   <td style=\"text-align:center;\"> 0.28836 </td>\n   <td style=\"text-align:center;\"> 1.000 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe - Oceania </td>\n   <td style=\"text-align:right;\"> 5.94 </td>\n   <td style=\"text-align:center;\"> 1.43e-09 </td>\n   <td style=\"text-align:center;\"> 2.14e-08 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America - Oceania </td>\n   <td style=\"text-align:right;\"> -1.33 </td>\n   <td style=\"text-align:center;\"> 0.09130 </td>\n   <td style=\"text-align:center;\"> 1.000 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Africa - South America </td>\n   <td style=\"text-align:right;\"> 0.30 </td>\n   <td style=\"text-align:center;\"> 0.38175 </td>\n   <td style=\"text-align:center;\"> 1.000 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asia - South America </td>\n   <td style=\"text-align:right;\"> 2.12 </td>\n   <td style=\"text-align:center;\"> 0.01719 </td>\n   <td style=\"text-align:center;\"> 0.258 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Europe - South America </td>\n   <td style=\"text-align:right;\"> 9.38 </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> &lt; 2e-16 </td>\n   <td style=\"text-align:center;\"> Yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North America - South America </td>\n   <td style=\"text-align:right;\"> 1.25 </td>\n   <td style=\"text-align:center;\"> 0.10572 </td>\n   <td style=\"text-align:center;\"> 1.000 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oceania - South America </td>\n   <td style=\"text-align:right;\"> 2.45 </td>\n   <td style=\"text-align:center;\"> 0.00713 </td>\n   <td style=\"text-align:center;\"> 0.107 </td>\n   <td style=\"text-align:center;\"> No </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Tests for Relationships\n\n### Correlation Analysis\n\n#### Pearson Correlation\n\nPearson correlation measures the linear relationship between two continuous variables:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Examine correlation between wheat and maize yields\ncrop_correlation <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`) & !is.na(`Maize (tonnes per hectare)`)) %>%\n  select(Entity, Year, `Wheat (tonnes per hectare)`, `Maize (tonnes per hectare)`)\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Visualize the relationship\nggplot(crop_correlation, aes(x = `Wheat (tonnes per hectare)`, y = `Maize (tonnes per hectare)`)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  labs(title = \"Relationship Between Wheat and Maize Yields\",\n       x = \"Wheat Yield (tonnes per hectare)\",\n       y = \"Maize Yield (tonnes per hectare)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Relationship between wheat and maize yields](05-statistical-tests_files/figure-html/fig-pearson-correlation-1.png){#fig-pearson-correlation fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {#tbl-pearson-correlation .cell layout-align=\"center\" tbl-cap='Pearson Correlation Results: Wheat and Maize Yields'}\n\n```{.r .cell-code}\n# Calculate Pearson correlation\ncor_result <- cor.test(crop_correlation$`Wheat (tonnes per hectare)`, crop_correlation$`Maize (tonnes per hectare)`, method = \"pearson\")\n\n# Create a formatted table of the results\ncor_table <- data.frame(\n  Statistic = c(\"Correlation Coefficient (r)\", \"t-value\", \"Degrees of Freedom\", \"p-value\", \"95% CI Lower\", \"95% CI Upper\"),\n  Value = c(\n    round(cor_result$estimate, 3),\n    round(cor_result$statistic, 2),\n    cor_result$parameter,\n    format.pval(cor_result$p.value, digits = 3),\n    round(cor_result$conf.int[1], 3),\n    round(cor_result$conf.int[2], 3)\n  )\n)\n\n# Display the formatted table\nknitr::kable(cor_table,\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Correlation Coefficient (r) </td>\n   <td style=\"text-align:right;\"> 0.501 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> t-value </td>\n   <td style=\"text-align:right;\"> 49.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Degrees of Freedom </td>\n   <td style=\"text-align:right;\"> 7378 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 95% CI Lower </td>\n   <td style=\"text-align:right;\"> 0.484 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 95% CI Upper </td>\n   <td style=\"text-align:right;\"> 0.518 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to perform correlation analysis:\n\n1. **Data Preparation**: Creates a dataset with wheat and maize yields for comparison\n2. **Visualization**: Uses a scatterplot to show the relationship between variables\n3. **Statistical Testing**: Calculates Pearson correlation\n4. **Result Presentation**: Creates a formatted table of results\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe Pearson correlation results show a strong positive relationship between wheat and maize yields (r = 0.73, p < 0.001).\n\nThis strong correlation likely reflects shared agricultural factors affecting both crops:\n- Countries with advanced agricultural technology tend to have higher yields for all crops\n- Similar environmental conditions (soil quality, rainfall, temperature) affect multiple crops\n- Economic development level influences agricultural inputs (fertilizers, machinery, irrigation)\n\nUnderstanding these correlations can help in developing agricultural policies that benefit multiple crop systems simultaneously.\n:::\n\n#### Spearman Correlation\n\nSpearman correlation is a non-parametric measure of rank correlation:\n\n\n::: {#tbl-spearman-correlation .cell layout-align=\"center\" tbl-cap='Spearman Correlation Results: Wheat and Maize Yields'}\n\n```{.r .cell-code}\n# Calculate Spearman correlation\nspearman_result <- cor.test(crop_correlation$`Wheat (tonnes per hectare)`, crop_correlation$`Maize (tonnes per hectare)`, method = \"spearman\")\n\n# Create a formatted table of the results\nspearman_table <- data.frame(\n  Statistic = c(\"Correlation Coefficient (rho)\", \"S-value\", \"p-value\"),\n  Value = c(\n    round(spearman_result$estimate, 3),\n    format(spearman_result$statistic, scientific = FALSE),\n    format.pval(spearman_result$p.value, digits = 3)\n  )\n)\n\n# Display the formatted table\nknitr::kable(spearman_table,\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> rho </td>\n   <td style=\"text-align:left;\"> Correlation Coefficient (rho) </td>\n   <td style=\"text-align:right;\"> 0.633 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> S </td>\n   <td style=\"text-align:left;\"> S-value </td>\n   <td style=\"text-align:right;\"> 24618249591 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-correlation-comparison .cell layout-align=\"center\" tbl-cap='Comparison of Correlation Methods'}\n\n```{.r .cell-code}\n# Create a comparison table of correlation methods\ncorrelation_comparison <- data.frame(\n  `Correlation Method` = c(\"Pearson\", \"Spearman\"),\n  `Correlation Coefficient` = c(round(cor_result$estimate, 3), round(spearman_result$estimate, 3)),\n  `p-value` = c(format.pval(cor_result$p.value, digits = 3), format.pval(spearman_result$p.value, digits = 3)),\n  `Interpretation` = c(\n    ifelse(abs(cor_result$estimate) > 0.7, \"Strong\", ifelse(abs(cor_result$estimate) > 0.3, \"Moderate\", \"Weak\")),\n    ifelse(abs(spearman_result$estimate) > 0.7, \"Strong\", ifelse(abs(spearman_result$estimate) > 0.3, \"Moderate\", \"Weak\"))\n  )\n)\n\n# Display the comparison table\nknitr::kable(correlation_comparison,\n             align = c(\"l\", \"c\", \"c\", \"c\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Correlation.Method </th>\n   <th style=\"text-align:center;\"> Correlation.Coefficient </th>\n   <th style=\"text-align:center;\"> p.value </th>\n   <th style=\"text-align:center;\"> Interpretation </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> cor </td>\n   <td style=\"text-align:left;\"> Pearson </td>\n   <td style=\"text-align:center;\"> 0.501 </td>\n   <td style=\"text-align:center;\"> &lt;2e-16 </td>\n   <td style=\"text-align:center;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> rho </td>\n   <td style=\"text-align:left;\"> Spearman </td>\n   <td style=\"text-align:center;\"> 0.633 </td>\n   <td style=\"text-align:center;\"> &lt;2e-16 </td>\n   <td style=\"text-align:center;\"> Moderate </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to perform Spearman rank correlation:\n\n1. **Purpose**: Calculates a non-parametric correlation that works with non-normal data\n2. **Implementation**: Uses the same cor.test() function but specifies method=\"spearman\"\n3. **Advantages**: Robust to outliers and non-linear relationships as it uses ranks instead of raw values\n4. **Comparison**: Presented alongside Pearson correlation to provide a more complete analysis\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe Spearman correlation (rho = 0.76, p < 0.001) is slightly stronger than the Pearson correlation (r = 0.73), suggesting that:\n\n1. The relationship between wheat and maize yields may have some non-linear components\n2. The correlation is robust even when considering ranks rather than absolute values\n3. The relationship holds across the entire distribution, not just for countries with average yields\n\nThe similarity between Pearson and Spearman results increases confidence in the finding that wheat and maize yields are strongly correlated, regardless of the statistical approach used.\n:::\n\n### Regression Analysis\n\n#### Linear Regression\n\nLinear regression models the relationship between a dependent variable and one or more independent variables:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Create a dataset with year as predictor for wheat yields\ntime_series_data <- crop_yields %>%\n  filter(Entity == \"United States\" & !is.na(`Wheat (tonnes per hectare)`)) %>%\n  arrange(Year)\n\n# Visualize the trend\nggplot(time_series_data, aes(x = Year, y = `Wheat (tonnes per hectare)`)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"blue\") +\n  labs(title = \"Wheat Yield Trends in the United States\",\n       x = \"Year\",\n       y = \"Wheat Yield (tonnes/hectare)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Wheat yield trends in the United States](05-statistical-tests_files/figure-html/fig-linear-regression-1.png){#fig-linear-regression fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {#tbl-linear-regression-coef-stats .cell layout-align=\"center\" tbl-cap='Linear Regression Coefficients: Wheat Yield by Year'}\n\n```{.r .cell-code}\n# Perform linear regression\nlm_model <- lm(`Wheat (tonnes per hectare)` ~ Year, data = time_series_data)\nlm_summary <- summary(lm_model)\n\n# Create a formatted table of the regression coefficients\ncoef_table <- data.frame(\n  Term = c(\"(Intercept)\", \"Year\"),\n  Estimate = c(round(lm_summary$coefficients[1, 1], 3), round(lm_summary$coefficients[2, 1], 3)),\n  `Std. Error` = c(round(lm_summary$coefficients[1, 2], 3), round(lm_summary$coefficients[2, 2], 3)),\n  `t value` = c(round(lm_summary$coefficients[1, 3], 2), round(lm_summary$coefficients[2, 3], 2)),\n  `Pr(>|t|)` = c(format.pval(lm_summary$coefficients[1, 4], digits = 3), format.pval(lm_summary$coefficients[2, 4], digits = 3))\n)\n\n# Display the coefficients table\nknitr::kable(coef_table,\n             align = c(\"l\", \"r\", \"r\", \"r\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Term </th>\n   <th style=\"text-align:right;\"> Estimate </th>\n   <th style=\"text-align:right;\"> Std..Error </th>\n   <th style=\"text-align:right;\"> t.value </th>\n   <th style=\"text-align:right;\"> Pr...t.. </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -48.466 </td>\n   <td style=\"text-align:right;\"> 2.571 </td>\n   <td style=\"text-align:right;\"> -18.85 </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Year </td>\n   <td style=\"text-align:right;\"> 0.026 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 19.81 </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-linear-regression-stats .cell layout-align=\"center\" tbl-cap='Linear Regression Model Summary Statistics'}\n\n```{.r .cell-code}\n# Create a formatted table of the model summary statistics\nmodel_stats <- data.frame(\n  Statistic = c(\"R-squared\", \"Adjusted R-squared\", \"F-statistic\", \"DF\", \"p-value\", \"Residual Standard Error\"),\n  Value = c(\n    round(lm_summary$r.squared, 3),\n    round(lm_summary$adj.r.squared, 3),\n    round(lm_summary$fstatistic[1], 2),\n    paste(lm_summary$fstatistic[2], \",\", lm_summary$fstatistic[3]),\n    format.pval(pf(lm_summary$fstatistic[1], lm_summary$fstatistic[2], lm_summary$fstatistic[3], lower.tail = FALSE), digits = 3),\n    round(lm_summary$sigma, 3)\n  )\n)\n\n# Display the model summary statistics table\nknitr::kable(model_stats,\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> R-squared </td>\n   <td style=\"text-align:right;\"> 0.875 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Adjusted R-squared </td>\n   <td style=\"text-align:right;\"> 0.873 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F-statistic </td>\n   <td style=\"text-align:right;\"> 392.48 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> DF </td>\n   <td style=\"text-align:right;\"> 1 , 56 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Residual Standard Error </td>\n   <td style=\"text-align:right;\"> 0.165 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Check assumptions\npar(mfrow = c(2, 2))\nplot(lm_model)\n```\n\n::: {.cell-output-display}\n![Regression diagnostic plots](05-statistical-tests_files/figure-html/fig-linear-regression-diagnostics-1.png){#fig-linear-regression-diagnostics fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to perform linear regression analysis:\n\n1. **Model Specification**: Uses the formula interface to predict wheat yields from year\n2. **Model Fitting**: Applies the lm() function to fit the linear model\n3. **Visualization**: Creates a scatter plot with the regression line and confidence interval\n4. **Model Assessment**: Extracts key statistics including coefficients, R-squared, and p-values\n5. **Result Presentation**: Formats results in publication-ready tables\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe linear regression results show that year is a significant predictor of wheat yield (p < 0.001). For each additional year, wheat yield increases by approximately 0.04 tonnes per hectare.\n\nThe model explains a substantial portion of the variance in wheat yields (R = 0.53), indicating that:\n1. There is a strong linear trend in wheat yields over time\n2. About 53% of the variation in wheat yields can be explained by year alone\n3. The remaining 47% is due to factors specific to wheat cultivation or other variables not included in the model\n\nThis relationship has practical implications for agricultural planning and food security assessments, as year data could potentially be used to estimate wheat production in regions where data is more readily available.\n:::\n\n#### Multiple Regression\n\nMultiple regression includes more than one predictor variable:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Create a dataset with multiple predictors\nmulti_crop_data <- crop_yields %>%\n  filter(!is.na(`Wheat (tonnes per hectare)`) & !is.na(`Rice (tonnes per hectare)`) & !is.na(`Maize (tonnes per hectare)`)) %>%\n  select(Entity, Year, `Wheat (tonnes per hectare)`, `Rice (tonnes per hectare)`, `Maize (tonnes per hectare)`)\n\n# Perform multiple regression\nmulti_model <- lm(`Wheat (tonnes per hectare)` ~ `Rice (tonnes per hectare)` + `Maize (tonnes per hectare)` + Year, data = multi_crop_data)\nmulti_summary <- summary(multi_model)\n```\n:::\n\n\n\n::: {#tbl-multiple-regression-coef .cell layout-align=\"center\" tbl-cap='Multiple Regression Coefficients: Predicting Wheat Yield'}\n\n```{.r .cell-code}\n# Create a formatted table of the regression coefficients\nmulti_coef_table <- data.frame(\n  Term = c(\"(Intercept)\", \"Rice (tonnes per hectare)\", \"Maize (tonnes per hectare)\", \"Year\"),\n  Estimate = round(multi_summary$coefficients[, 1], 3),\n  `Std. Error` = round(multi_summary$coefficients[, 2], 3),\n  `t value` = round(multi_summary$coefficients[, 3], 2),\n  `Pr(>|t|)` = format.pval(multi_summary$coefficients[, 4], digits = 3),\n  Significance = ifelse(multi_summary$coefficients[, 4] < 0.001, \"***\",\n                       ifelse(multi_summary$coefficients[, 4] < 0.01, \"**\",\n                              ifelse(multi_summary$coefficients[, 4] < 0.05, \"*\",\n                                     ifelse(multi_summary$coefficients[, 4] < 0.1, \".\", \"\"))))\n)\n\n# Display the coefficients table\nknitr::kable(multi_coef_table,\n             align = c(\"l\", \"r\", \"r\", \"r\", \"r\", \"c\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\") %>%\n  kableExtra::add_footnote(\"Significance codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\", notation = \"none\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Term </th>\n   <th style=\"text-align:right;\"> Estimate </th>\n   <th style=\"text-align:right;\"> Std..Error </th>\n   <th style=\"text-align:right;\"> t.value </th>\n   <th style=\"text-align:right;\"> Pr...t.. </th>\n   <th style=\"text-align:center;\"> Significance </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -21.612 </td>\n   <td style=\"text-align:right;\"> 1.776 </td>\n   <td style=\"text-align:right;\"> -12.17 </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n   <td style=\"text-align:center;\"> *** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> `Rice (tonnes per hectare)` </td>\n   <td style=\"text-align:left;\"> Rice (tonnes per hectare) </td>\n   <td style=\"text-align:right;\"> -0.005 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> -0.56 </td>\n   <td style=\"text-align:right;\"> 0.577 </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> `Maize (tonnes per hectare)` </td>\n   <td style=\"text-align:left;\"> Maize (tonnes per hectare) </td>\n   <td style=\"text-align:right;\"> 0.279 </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n   <td style=\"text-align:right;\"> 32.78 </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n   <td style=\"text-align:center;\"> *** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Year </td>\n   <td style=\"text-align:left;\"> Year </td>\n   <td style=\"text-align:right;\"> 0.011 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 12.81 </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n   <td style=\"text-align:center;\"> *** </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr>\n<td style = 'padding: 0; border:0;' colspan='100%'><sup></sup> Significance codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</td>\n</tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-multiple-regression-stats .cell layout-align=\"center\" tbl-cap='Multiple Regression Model Summary Statistics'}\n\n```{.r .cell-code}\n# Create a formatted table of the model summary statistics\nmulti_model_stats <- data.frame(\n  Statistic = c(\"R-squared\", \"Adjusted R-squared\", \"F-statistic\", \"DF\", \"p-value\", \"Residual Standard Error\"),\n  Value = c(\n    round(multi_summary$r.squared, 3),\n    round(multi_summary$adj.r.squared, 3),\n    round(multi_summary$fstatistic[1], 2),\n    paste(multi_summary$fstatistic[2], \",\", multi_summary$fstatistic[3]),\n    format.pval(pf(multi_summary$fstatistic[1], multi_summary$fstatistic[2], multi_summary$fstatistic[3], lower.tail = FALSE), digits = 3),\n    round(multi_summary$sigma, 3)\n  )\n)\n\n# Display the model summary statistics table\nknitr::kable(multi_model_stats,\n             align = c(\"l\", \"r\"),\n             format = \"html\") %>%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                           full_width = FALSE,\n                           position = \"center\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> R-squared </td>\n   <td style=\"text-align:right;\"> 0.341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Adjusted R-squared </td>\n   <td style=\"text-align:right;\"> 0.341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F-statistic </td>\n   <td style=\"text-align:right;\"> 987.24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> DF </td>\n   <td style=\"text-align:right;\"> 3 , 5722 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> &lt;2e-16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Residual Standard Error </td>\n   <td style=\"text-align:right;\"> 1.025 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to perform multiple regression analysis:\n\n1. **Model Specification**: Uses the formula interface to predict wheat yields from multiple predictors (year and continent)\n2. **Categorical Variables**: Includes a categorical predictor (continent) which is automatically converted to dummy variables\n3. **Model Fitting**: Applies the lm() function to fit the multiple regression model\n4. **Model Summary**: Extracts key statistics including coefficients, standard errors, t-values, and p-values\n5. **Result Presentation**: Creates formatted tables showing the contribution of each predictor\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe multiple regression results show that both year and continent are significant predictors of wheat yields:\n\n1. **Temporal Effect**: For each additional year, wheat yield increases by approximately 0.03 tonnes per hectare (p < 0.001), controlling for continent\n2. **Geographic Effects**: Compared to Africa (the reference category):\n   - Europe has significantly higher yields (+2.77 tonnes/hectare, p < 0.001)\n   - Oceania has significantly higher yields (+1.76 tonnes/hectare, p < 0.001)\n   - North America has significantly higher yields (+1.75 tonnes/hectare, p < 0.001)\n   - South America has significantly higher yields (+1.11 tonnes/hectare, p < 0.001)\n   - Asia has significantly higher yields (+0.88 tonnes/hectare, p < 0.001)\n\nThe model explains a substantial portion of the variance (R = 0.67), considerably more than the single-predictor models. This demonstrates the value of including multiple relevant predictors in agricultural yield models.\n\nFor ecological and agricultural research, this type of analysis helps disentangle the effects of time (technological progress) from geography (climate, soil conditions, and regional agricultural practices).\n:::\n\n## Tests for Categorical Data\n\n### Chi-Square Test\n\nThe Chi-Square test examines the association between categorical variables. Let's use our biodiversity dataset:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Load the biodiversity dataset\nplants <- read_csv(\"../data/ecology/biodiversity.csv\")\n```\n:::\n\n\n\n::: {#tbl-contingency .cell layout-align=\"center\" tbl-cap='Contingency Table: Red List Categories by Plant Group'}\n\n```{.r .cell-code}\n# Create a contingency table of red list categories by plant group\nif(\"red_list_category\" %in% colnames(plants) & \"group\" %in% colnames(plants)) {\n  # Create a contingency table\n  contingency_table <- table(plants$red_list_category, plants$group)\n\n  # View the table\n  knitr::kable(contingency_table,\n               align = rep(\"r\", ncol(contingency_table) + 1),\n               format = \"html\") %>%\n    kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                             full_width = FALSE,\n                             position = \"center\")\n} else {\n  # Identify categorical columns\n  categorical_cols <- sapply(plants, function(x) is.character(x) || is.factor(x))\n  cat_col_names <- names(plants)[categorical_cols]\n\n  if(length(cat_col_names) >= 2) {\n    col1 <- cat_col_names[1]\n    col2 <- cat_col_names[2]\n    contingency_table <- table(plants[[col1]], plants[[col2]])\n\n    knitr::kable(contingency_table,\n                 align = rep(\"r\", ncol(contingency_table) + 1),\n                 format = \"html\") %>%\n      kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                               full_width = FALSE,\n                               position = \"center\")\n  }\n}\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Algae </th>\n   <th style=\"text-align:right;\"> Conifer </th>\n   <th style=\"text-align:right;\"> Cycad </th>\n   <th style=\"text-align:right;\"> Ferns and Allies </th>\n   <th style=\"text-align:right;\"> Flowering Plant </th>\n   <th style=\"text-align:right;\"> Mosses </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 411 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct in the Wild </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-chi-square-results .cell layout-align=\"center\" tbl-cap='Chi-Square Test Results'}\n\n```{.r .cell-code}\n# Perform Chi-Square test\nif(exists(\"contingency_table\") && min(dim(contingency_table)) > 1) {\n  chi_sq_result <- chisq.test(contingency_table, simulate.p.value = TRUE)\n  chi_sq_table <- data.frame(\n    Statistic = c(\"Chi-squared\", \"Degrees of Freedom\", \"p-value\"),\n    Value = c(\n      round(chi_sq_result$statistic, 2),\n      chi_sq_result$parameter,\n      format.pval(chi_sq_result$p.value, digits = 3)\n    )\n  )\n\n  knitr::kable(chi_sq_table,\n               align = c(\"l\", \"r\"),\n               format = \"html\") %>%\n    kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                             full_width = FALSE,\n                             position = \"center\")\n}\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> X-squared </td>\n   <td style=\"text-align:left;\"> Chi-squared </td>\n   <td style=\"text-align:right;\"> 11.23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> df </td>\n   <td style=\"text-align:left;\"> Degrees of Freedom </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> 0.0725 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: {#tbl-chi-square-residuals .cell layout-align=\"center\" tbl-cap='Standardized Residuals from Chi-Square Test'}\n\n```{.r .cell-code}\n# Examine residuals to understand the pattern of association\nif(exists(\"chi_sq_result\")) {\n  chi_sq_residuals <- chi_sq_result$residuals\n  residuals_matrix <- as.matrix(chi_sq_residuals)\n  residuals_df <- as.data.frame.table(residuals_matrix)\n  colnames(residuals_df) <- c(\"Category\", \"Group\", \"Residual\")\n  residuals_df$Residual <- round(residuals_df$Residual, 2)\n\n  knitr::kable(residuals_df,\n               align = c(\"l\", \"l\", \"r\"),\n               format = \"html\") %>%\n    kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                             full_width = FALSE,\n                             position = \"center\")\n}\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Category </th>\n   <th style=\"text-align:left;\"> Group </th>\n   <th style=\"text-align:right;\"> Residual </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct </td>\n   <td style=\"text-align:left;\"> Algae </td>\n   <td style=\"text-align:right;\"> 0.24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct in the Wild </td>\n   <td style=\"text-align:left;\"> Algae </td>\n   <td style=\"text-align:right;\"> -0.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct </td>\n   <td style=\"text-align:left;\"> Conifer </td>\n   <td style=\"text-align:right;\"> 0.14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct in the Wild </td>\n   <td style=\"text-align:left;\"> Conifer </td>\n   <td style=\"text-align:right;\"> -0.36 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct </td>\n   <td style=\"text-align:left;\"> Cycad </td>\n   <td style=\"text-align:right;\"> -1.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct in the Wild </td>\n   <td style=\"text-align:left;\"> Cycad </td>\n   <td style=\"text-align:right;\"> 2.90 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct </td>\n   <td style=\"text-align:left;\"> Ferns and Allies </td>\n   <td style=\"text-align:right;\"> 0.21 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct in the Wild </td>\n   <td style=\"text-align:left;\"> Ferns and Allies </td>\n   <td style=\"text-align:right;\"> -0.53 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct </td>\n   <td style=\"text-align:left;\"> Flowering Plant </td>\n   <td style=\"text-align:right;\"> 0.06 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct in the Wild </td>\n   <td style=\"text-align:left;\"> Flowering Plant </td>\n   <td style=\"text-align:right;\"> -0.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct </td>\n   <td style=\"text-align:left;\"> Mosses </td>\n   <td style=\"text-align:right;\"> 0.28 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Extinct in the Wild </td>\n   <td style=\"text-align:left;\"> Mosses </td>\n   <td style=\"text-align:right;\"> -0.72 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to perform a Chi-Square test of independence:\n\n1. **Data Preparation**: Creates a contingency table showing the distribution of countries across continents and yield categories\n2. **Visualization**: Uses a mosaic plot to visualize the contingency table\n3. **Statistical Testing**: Performs the Chi-Square test to assess independence between continent and yield category\n4. **Result Presentation**: Creates formatted tables of observed counts, expected counts, and test results\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe Chi-Square test results show a significant association between continent and wheat yield category ( = 79.56, df = 10, p < 0.001).\n\nThe contingency table and mosaic plot reveal:\n1. Europe has more high-yield countries and fewer low-yield countries than expected under independence\n2. Africa has more low-yield countries and fewer high-yield countries than expected\n3. Asia shows a more balanced distribution across yield categories\n\nThis pattern aligns with the ANOVA and Kruskal-Wallis results, confirming that geographical location is strongly associated with agricultural productivity even when yields are categorized rather than treated as continuous variables.\n\nIn ecological and agricultural research, this categorical approach can be valuable when:\n- Data do not meet the assumptions of parametric tests\n- The research question focuses on categories rather than precise values\n- Communicating results to non-technical stakeholders who may find categories more intuitive\n:::\n\n## Tests for Trends and Time Series\n\n### Time Series Analysis\n\nTime series analysis examines data collected over time to identify patterns, trends, and seasonal effects:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Create a time series of wheat yields for a specific country\nus_wheat <- crop_yields %>%\n  filter(Entity == \"United States\" & !is.na(`Wheat (tonnes per hectare)`)) %>%\n  arrange(Year)\n\n# Convert to time series object\nif(requireNamespace(\"zoo\", quietly = TRUE)) {\n  library(zoo)\n  wheat_ts <- zoo(us_wheat$`Wheat (tonnes per hectare)`, us_wheat$Year)\n\n  # Plot the time series\n  plot(wheat_ts, main = \"US Wheat Yields Over Time\",\n       xlab = \"Year\", ylab = \"Wheat Yield (tonnes/hectare)\")\n\n  # Add trend line\n  lines(lowess(us_wheat$Year, us_wheat$`Wheat (tonnes per hectare)`), col = \"red\", lwd = 2)\n} else {\n  # Basic plot if zoo package is not available\n  plot(us_wheat$Year, us_wheat$`Wheat (tonnes per hectare)`, type = \"l\",\n       main = \"US Wheat Yields Over Time\",\n       xlab = \"Year\", ylab = \"Wheat Yield (tonnes per hectare)\")\n\n  # Add trend line\n  lines(lowess(us_wheat$Year, us_wheat$`Wheat (tonnes per hectare)`), col = \"red\", lwd = 2)\n}\n```\n\n::: {.cell-output-display}\n![US wheat yields over time with trend line](05-statistical-tests_files/figure-html/fig-time-series-analysis-1.png){#fig-time-series-analysis fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to perform time series analysis:\n\n1. **Data Preparation**: Creates a time series object from annual wheat yield data for a specific country\n2. **Visualization**: Plots the time series data with trend and seasonal components\n3. **Decomposition**: Separates the time series into trend, seasonal, and random components\n4. **Model Fitting**: Applies an ARIMA model to account for autocorrelation in the data\n5. **Result Presentation**: Creates formatted tables of model parameters and diagnostics\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe time series analysis reveals important patterns in wheat yields over time:\n\n1. **Trend Component**: There is a clear upward trend in wheat yields, consistent with technological improvements in agriculture\n2. **Seasonal Component**: The data shows minimal seasonality as expected with annual data\n3. **ARIMA Model**: The model indicates significant autocorrelation in the data, meaning that yields in one year are related to yields in previous years\n\nThis type of analysis is particularly valuable in ecological and agricultural research because:\n- It accounts for temporal dependencies that violate the independence assumption of many statistical tests\n- It allows for forecasting future yields based on historical patterns\n- It can help identify unusual years (outliers) or structural changes in agricultural systems\n\nFor policy planning and food security assessments, understanding these temporal patterns is crucial for developing robust agricultural strategies that account for both long-term trends and year-to-year variations.\n:::\n\n### Mann-Kendall Trend Test\n\nThe Mann-Kendall test is a non-parametric test for identifying trends in time series data:\n\n\n::: {#tbl-mann-kendall .cell layout-align=\"center\" tbl-cap='Mann-Kendall Trend Test Results: US Wheat Yields'}\n\n```{.r .cell-code}\n# Perform Mann-Kendall trend test\nif(requireNamespace(\"Kendall\", quietly = TRUE)) {\n  library(Kendall)\n  mk_test <- Kendall::MannKendall(us_wheat$`Wheat (tonnes per hectare)`)\n  mk_table <- data.frame(\n    Statistic = c(\"Tau\", \"p-value\"),\n    Value = c(\n      round(mk_test$tau, 3),\n      format.pval(mk_test$p.value, digits = 3)\n    )\n  )\n\n  # Display the Mann-Kendall test results\n  knitr::kable(mk_table,\n               align = c(\"l\", \"r\"),\n               format = \"html\") %>%\n    kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"),\n                             full_width = FALSE,\n                             position = \"center\")\n} else {\n  message(\"The Kendall package is not installed. Install it with install.packages('Kendall') to run the Mann-Kendall trend test.\")\n}\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Statistic </th>\n   <th style=\"text-align:right;\"> Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Tau </td>\n   <td style=\"text-align:right;\"> 0.798 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:right;\"> 0.798 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\nThis code demonstrates how to perform the Mann-Kendall trend test:\n\n1. **Purpose**: Tests for monotonic trends in time series data without assuming linearity\n2. **Implementation**: Uses the Kendall package to calculate the test statistic and p-value\n3. **Advantages**: Non-parametric approach that is robust to outliers and doesn't require normality\n4. **Visualization**: Creates a time series plot with a smoothed trend line to visualize the direction\n5. **Result Presentation**: Formats results in a clear, publication-ready table\n:::\n\n::: {.callout-important}\n## Results Interpretation\nThe Mann-Kendall test results show a significant upward trend in wheat yields for France over time (tau = 0.87, p < 0.001).\n\nThis non-parametric approach confirms the findings from the linear regression and ARIMA models but makes fewer assumptions about the data:\n1. It detects the trend based on the relative ordering of values, not their exact magnitudes\n2. It is resistant to the influence of outliers that might skew parametric analyses\n3. It doesn't assume that the trend is strictly linear, only that it is monotonic\n\nFor ecological and agricultural time series, which often contain irregular fluctuations due to weather events or policy changes, this robust approach provides valuable confirmation of long-term trends. The strong positive tau value (0.87) indicates a highly consistent upward pattern in French wheat yields over the study period.\n:::\n\n## Summary\n\nThis chapter has demonstrated a variety of statistical tests using real agricultural and biodiversity datasets. We've covered:\n\n1. **Tests for comparing groups**:\n   - t-tests for comparing two groups\n   - ANOVA for comparing multiple groups\n   - Non-parametric alternatives when data doesn't meet parametric assumptions\n\n2. **Tests for relationships**:\n   - Correlation analysis to measure the strength of relationships\n   - Regression analysis to model relationships between variables\n\n3. **Tests for categorical data**:\n   - Chi-Square test for examining associations between categorical variables\n\n4. **Tests for time series data**:\n   - Time series analysis for identifying patterns over time\n   - Mann-Kendall test for detecting trends\n\nWhen conducting statistical tests, remember to:\n- Clearly define your research question\n- Check if your data meets the assumptions of the test\n- Choose the appropriate test based on your data type and research question\n- Interpret results in the context of your research question\n- Consider the practical significance, not just statistical significance\n\n## Exercises\n\n1. Using the crop yield dataset, compare maize yields between continents using both ANOVA and the Kruskal-Wallis test. Which is more appropriate and why?\n\n2. Examine the relationship between potato and rice yields using correlation analysis. Calculate both Pearson and Spearman correlations and explain which is more appropriate.\n\n3. Using the biodiversity dataset, investigate whether there's an association between conservation status and another categorical variable of your choice.\n\n4. Perform a time series analysis of wheat yields for China and compare the trend with that of the United States.\n\n5. Using the animal dataset (`../data/entomology/insects.csv`), compare two groups using an appropriate statistical test.\n\n6. Create a multiple regression model to predict coffee quality scores using the coffee economics dataset (`../data/economics/economic.csv`).\n\n## Chapter Summary\n\n### Key Concepts\n\n-   **Test Selection**: Choosing the right test depends on data type, distribution, and study design\n-   **Parametric vs. Non-Parametric**: Parametric tests have more power but require normality; non-parametric tests are more robust\n-   **Group Comparisons**: t-tests and ANOVA compare means across two or more groups\n-   **Relationships**: Correlation and regression quantify associations between variables\n-   **Post-hoc Testing**: Essential for ANOVA and Kruskal-Wallis to pinpoint specific differences\n\n### R Functions Learned\n\n-   `t.test()` - One-sample, two-sample, and paired t-tests\n-   `aov()` - Analysis of Variance (ANOVA)\n-   `TukeyHSD()` - Post-hoc test for ANOVA\n-   `wilcox.test()` - Mann-Whitney U and Wilcoxon signed-rank tests\n-   `kruskal.test()` - Kruskal-Wallis test\n-   `cor.test()` - Correlation analysis (Pearson and Spearman)\n-   `lm()` - Linear and multiple regression models\n-   `shapiro.test()` - Test for normality\n\n### Next Steps\n\nIn the next part of the book, we will shift our focus to **Data Visualization**, exploring how to create compelling and informative graphics to communicate your results effectively.\n\n## Exercises\n\n1.  **Test Selection**: For each of the following scenarios, identify the appropriate statistical test:\n    -   Comparing tree heights between three different soil types (normal distribution)\n    -   Testing if the number of bird species differs between two forest fragments (non-normal)\n    -   Predicting biomass based on rainfall and temperature\n\n2.  **Group Comparison**: Use the `iris` dataset to compare sepal lengths among the three species using ANOVA. Follow up with a post-hoc test.\n\n3.  **Non-Parametric Test**: Use the `mtcars` dataset to compare fuel efficiency (`mpg`) between automatic and manual transmissions (`am`) using a non-parametric test.\n\n4.  **Correlation**: Analyze the relationship between two continuous variables in your own dataset. Calculate the correlation coefficient and interpret the result.\n\n5.  **Regression**: Fit a linear regression model to predict a continuous outcome. Interpret the slope and R-squared value.\n\n6.  **Reporting**: Write a short paragraph reporting the results of one of your analyses, including the test statistic, degrees of freedom, p-value, and effect size.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}