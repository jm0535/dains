{
  "hash": "cc3b1609f9e57070f10612d8fd5e8e82",
  "result": {
    "engine": "knitr",
    "markdown": "---\nprefer-html: true\n---\n\n# Advanced Data Visualization\n\n## Introduction\n\n::: {.callout-note}\n## Learning Objectives\n\nBy the end of this chapter, you will be able to:\n\n1.  Customize `ggplot2` themes and aesthetics for publication-quality graphics\n2.  Create multi-panel figures using `patchwork` or `cowplot`\n3.  Visualize spatial data using maps and `sf` objects\n4.  Build interactive visualizations with `plotly` and `leaflet`\n5.  Create specialized ecological plots (e.g., ordination, phylogenetics)\n6.  Animate visualizations to show temporal changes using `gganimate`\n:::\n\nBuilding on the visualization techniques covered in Chapter 6, this chapter explores advanced data visualization methods that can help you communicate complex ecological data more effectively. We'll focus on creating publication-quality graphics, interactive visualizations, and specialized plots for ecological data.\n\n## Creating Publication-Quality Graphics\n\n### Customizing ggplot2 Themes\n\nThe ggplot2 package allows extensive customization of plot appearance:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Load necessary packages\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Create a basic scatter plot\nbase_plot <- ggplot(iris, aes(x = Sepal.Length, y = Petal.Length, color = Species)) +\n  geom_point(size = 3, alpha = 0.8) +\n  labs(\n    title = \"Relationship Between Sepal and Petal Length\",\n    subtitle = \"Comparison across three Iris species\",\n    x = \"Sepal Length (cm)\",\n    y = \"Petal Length (cm)\",\n    caption = \"Data source: Anderson's Iris dataset\"\n  )\n\n# Create a custom theme\ncustom_theme <- theme_minimal() +\n  theme(\n    # Text elements\n    plot.title = element_text(face = \"bold\", size = 16),\n    plot.subtitle = element_text(size = 12, color = \"gray40\"),\n    axis.title = element_text(face = \"bold\"),\n\n    # Legend position\n    legend.position = \"bottom\",\n\n    # Grid lines and panel\n    panel.grid.minor = element_blank(),\n    panel.border = element_rect(color = \"gray80\", fill = NA, linewidth = 0.5)\n  )\n\n# Apply the custom theme\nbase_plot + custom_theme\n```\n\n::: {.cell-output-display}\n![Customized ggplot2 scatter plot with professional theme](07-advanced-visualization_files/figure-html/fig-custom-theme-1.png){#fig-custom-theme fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates advanced visualization customization:\n\n1. **Base Plot Creation**:\n   - Uses `ggplot()` for the foundation\n   - Maps variables to aesthetics\n   - Adds points with transparency\n   - Includes comprehensive labels\n\n2. **Theme Customization**:\n   - Creates a custom theme object\n   - Modifies text elements\n   - Adjusts legend position\n   - Customizes grid and panel appearance\n\n3. **Visual Elements**:\n   - Point size and transparency\n   - Color coding by species\n   - Axis labels and titles\n   - Caption with data source\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nThe visualization reveals several key insights:\n\n1. **Species Differentiation**:\n   - Clear clustering of species\n   - Distinct morphological patterns\n   - Overlap between some species\n\n2. **Morphological Relationships**:\n   - Positive correlation between sepal and petal length\n   - Different scaling relationships by species\n   - Species-specific size ranges\n\n3. **Visual Effectiveness**:\n   - Clear species separation\n   - Readable labels and legend\n   - Professional appearance\n:::\n\n::: {.callout-tip}\n## PROFESSIONAL TIP: Advanced Visualization Techniques\n\nWhen creating publication-quality visualizations:\n\n1. **Theme Design**:\n   - Create consistent themes\n   - Use appropriate font sizes\n   - Balance white space\n   - Consider journal requirements\n\n2. **Aesthetic Choices**:\n   - Select meaningful colors\n   - Use appropriate point sizes\n   - Consider transparency\n   - Balance visual elements\n\n3. **Labeling Strategy**:\n   - Include clear titles\n   - Use informative subtitles\n   - Provide data sources\n   - Consider audience needs\n:::\n\nIn ecological research, you might create different custom themes for field guides, scientific publications, presentations, interactive dashboards, or reports for non-scientific audiences, each with design elements optimized for their specific purpose and audience.\n\n### Color Palettes for Ecological Data\n\nChoosing appropriate color palettes is crucial for effective visualization:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Load packages for color palettes\nlibrary(RColorBrewer)\nlibrary(viridis)\n\n# Display color palettes suitable for ecological data\npar(mfrow = c(4, 1), mar = c(2, 6, 2, 1))\ndisplay.brewer.pal(8, \"YlGn\")\ndisplay.brewer.pal(8, \"BrBG\")\ndisplay.brewer.pal(11, \"RdYlBu\")\nscales::show_col(viridis(8))\n\n# Apply different color palettes to our plot\nplot1 <- base_plot +\n  scale_color_brewer(palette = \"Set1\") +\n  custom_theme +\n  ggtitle(\"Color Brewer 'Set1' Palette\")\n\nplot2 <- base_plot +\n  scale_color_viridis_d() +\n  custom_theme +\n  ggtitle(\"Viridis Discrete Palette\")\n\n# Display the plots\nplot1\nplot2\n\n# Create a plot with a sequential color palette for a continuous variable\nggplot(iris, aes(x = Sepal.Length, y = Petal.Length, color = Petal.Width)) +\n  geom_point(size = 3, alpha = 0.8) +\n  scale_color_viridis_c() +\n  custom_theme +\n  labs(title = \"Iris Dataset with Continuous Color Scale\",\n       subtitle = \"Petal Width mapped to color\",\n       x = \"Sepal Length (cm)\",\n       y = \"Petal Length (cm)\",\n       color = \"Petal Width (cm)\")\n```\n\n::: {.cell-output-display}\n![ColorBrewer palettes for ecological data](07-advanced-visualization_files/figure-html/fig-color-palettes-1.png){#fig-color-palettes-1 fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![Viridis palette display](07-advanced-visualization_files/figure-html/fig-color-palettes-2.png){#fig-color-palettes-2 fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![Scatter plot with Set1 palette](07-advanced-visualization_files/figure-html/fig-color-palettes-3.png){#fig-color-palettes-3 fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![Scatter plot with Viridis palette](07-advanced-visualization_files/figure-html/fig-color-palettes-4.png){#fig-color-palettes-4 fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to use and apply different color palettes for ecological data visualization. Let's break down the key components:\n\n1. **Loading Color Palette Packages**\n   - We load `RColorBrewer`, which provides a set of carefully designed color palettes.\n   - We also load `viridis`, which offers perceptually uniform and colorblind-friendly palettes.\n\n2. **Displaying Color Palettes**\n   - We use `par(mfrow = c(4, 1))` to set up a 4-row panel for displaying multiple palettes.\n   - We display three ColorBrewer palettes that are particularly useful for ecological data:\n     - \"YlGn\" (Yellow-Green): A sequential palette good for representing intensity (e.g., vegetation density)\n     - \"BrBG\" (Brown-Blue-Green): A diverging palette useful for showing deviations from a midpoint (e.g., temperature anomalies)\n     - \"RdYlBu\" (Red-Yellow-Blue): Another diverging palette good for environmental gradients\n   - We also display the Viridis palette, which is designed to be perceptually uniform and colorblind-friendly.\n\n3. **Applying Palettes to Plots**\n   - We create two versions of our scatter plot with different color schemes:\n     - One using ColorBrewer's \"Set1\" palette with `scale_color_brewer()`\n     - Another using the Viridis discrete palette with `scale_color_viridis_d()`\n   - We add our custom theme and appropriate titles to each plot.\n\n4. **Continuous Color Mapping**\n   - We create a third plot that maps a continuous variable (Petal Width) to color.\n   - We use `scale_color_viridis_c()` for a continuous color scale that is perceptually uniform.\n   - This demonstrates how to use color to represent a third dimension in your data.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nChoosing appropriate color palettes is crucial for effective ecological data visualization:\n\n1. **Types of Color Palettes**:\n   - **Sequential palettes** (like YlGn) are ideal for representing ordered data where values progress from low to high (e.g., species abundance, elevation).\n   - **Diverging palettes** (like BrBG, RdYlBu) are best for data with a meaningful midpoint (e.g., temperature anomalies, pH deviations from neutral).\n   - **Qualitative palettes** (like Set1) are designed for categorical data with no inherent order (e.g., species, habitat types).\n\n2. **Colorblind Accessibility**:\n   - The Viridis palettes are specifically designed to be perceptually uniform and accessible to people with color vision deficiencies.\n   - This is particularly important in scientific publications where accurate interpretation of colors is crucial.\n\n3. **Ecological Applications**:\n   - **Habitat mapping**: Sequential green palettes for vegetation density\n   - **Climate data**: Diverging palettes for temperature or precipitation anomalies\n   - **Species distribution**: Qualitative palettes for different species\n   - **Environmental gradients**: Sequential or diverging palettes for pH, elevation, or pollution levels\n\n4. **Practical Considerations**:\n   - Consider how your visualization will be used (digital display, print, presentation)\n   - Test your visualizations with colorblind simulation tools\n   - Ensure sufficient contrast between categories for clear differentiation\n   - Use complementary visual cues (shapes, sizes) alongside color when possible\n:::\n\nBy thoughtfully selecting color palettes, you can enhance the interpretability of your ecological visualizations while ensuring they remain accessible to all audiences.\n\n### Arranging Multiple Plots\n\nCombining multiple plots can help compare different aspects of your data:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(patchwork)\n\n# Create individual plots\np1 <- ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species)) +\n  geom_boxplot() +\n  labs(title = \"Sepal Length by Species\",\n       x = NULL,\n       y = \"Sepal Length (cm)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\np2 <- ggplot(iris, aes(x = Species, y = Petal.Length, fill = Species)) +\n  geom_boxplot() +\n  labs(title = \"Petal Length by Species\",\n       x = NULL,\n       y = \"Petal Length (cm)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\np3 <- ggplot(iris, aes(x = Sepal.Length, fill = Species)) +\n  geom_density(alpha = 0.7) +\n  labs(title = \"Sepal Length Distribution\",\n       x = \"Sepal Length (cm)\",\n       y = \"Density\") +\n  theme_minimal()\n\np4 <- ggplot(iris, aes(x = Petal.Length, fill = Species)) +\n  geom_density(alpha = 0.7) +\n  labs(title = \"Petal Length Distribution\",\n       x = \"Petal Length (cm)\",\n       y = \"Density\") +\n  theme_minimal()\n\n# Arrange the plots\n(p1 + p2) / (p3 + p4) +\n  plot_annotation(\n    title = \"Iris Morphology by Species\",\n    caption = \"Source: Anderson's Iris dataset\"\n  )\n```\n\n::: {.cell-output-display}\n![Multi-panel figure combining boxplots and density plots](07-advanced-visualization_files/figure-html/fig-multi-panel-1.png){#fig-multi-panel fig-align='center' width=100%}\n:::\n:::\n\n\n## Interactive Visualizations\n\nInteractive visualizations allow users to explore data in more depth than static plots. In R, packages like `plotly` and `leaflet` make it easy to create interactive graphics.\n\n### Interactive Plots with plotly\n\nThe `plotly` package allows you to convert ggplot2 graphics to interactive versions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(plotly)\n\n# Check if we're in HTML output mode\nif (knitr::is_html_output()) {\n  # For HTML output, use plotly directly (more compatible)\n  plot_ly(iris, x = ~Sepal.Length, y = ~Petal.Length, color = ~Species,\n          type = \"scatter\", mode = \"markers\",\n          marker = list(size = 10, opacity = 0.7),\n          colors = viridis::viridis(3)) |>\n    layout(title = \"Relationship between Sepal Length and Petal Length\",\n           xaxis = list(title = \"Sepal Length (cm)\"),\n           yaxis = list(title = \"Petal Length (cm)\"))\n} else {\n  # For PDF output, use static ggplot version\n  ggplot(iris, aes(x = Sepal.Length, y = Petal.Length, color = Species)) +\n    geom_point(size = 3, alpha = 0.7) +\n    labs(title = \"Relationship between Sepal Length and Petal Length\",\n         x = \"Sepal Length (cm)\",\n         y = \"Petal Length (cm)\") +\n    theme_minimal() +\n    scale_color_viridis_d() +\n    annotate(\"text\", x = 6, y = 6,\n             label = \"Note: Interactive version available in HTML output\",\n             fontface = \"italic\", size = 3)\n}\n```\n\n::: {#fig-interactive-plotly .cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-2b214990d4f6500bdc07\" style=\"width:100%;height:1800px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2b214990d4f6500bdc07\">{\"x\":{\"visdat\":{\"3935e94792b17d\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"3935e94792b17d\",\"attrs\":{\"3935e94792b17d\":{\"x\":{},\"y\":{},\"mode\":\"markers\",\"marker\":{\"size\":10,\"opacity\":0.69999999999999996},\"color\":{},\"colors\":[\"#440154FF\",\"#21908CFF\",\"#FDE725FF\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Relationship between Sepal Length and Petal Length\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Sepal Length (cm)\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Petal Length (cm)\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[5.0999999999999996,4.9000000000000004,4.7000000000000002,4.5999999999999996,5,5.4000000000000004,4.5999999999999996,5,4.4000000000000004,4.9000000000000004,5.4000000000000004,4.7999999999999998,4.7999999999999998,4.2999999999999998,5.7999999999999998,5.7000000000000002,5.4000000000000004,5.0999999999999996,5.7000000000000002,5.0999999999999996,5.4000000000000004,5.0999999999999996,4.5999999999999996,5.0999999999999996,4.7999999999999998,5,5,5.2000000000000002,5.2000000000000002,4.7000000000000002,4.7999999999999998,5.4000000000000004,5.2000000000000002,5.5,4.9000000000000004,5,5.5,4.9000000000000004,4.4000000000000004,5.0999999999999996,5,4.5,4.4000000000000004,5,5.0999999999999996,4.7999999999999998,5.0999999999999996,4.5999999999999996,5.2999999999999998,5],\"y\":[1.3999999999999999,1.3999999999999999,1.3,1.5,1.3999999999999999,1.7,1.3999999999999999,1.5,1.3999999999999999,1.5,1.5,1.6000000000000001,1.3999999999999999,1.1000000000000001,1.2,1.5,1.3,1.3999999999999999,1.7,1.5,1.7,1.5,1,1.7,1.8999999999999999,1.6000000000000001,1.6000000000000001,1.5,1.3999999999999999,1.6000000000000001,1.6000000000000001,1.5,1.5,1.3999999999999999,1.5,1.2,1.3,1.3999999999999999,1.3,1.5,1.3,1.3,1.3,1.6000000000000001,1.8999999999999999,1.3999999999999999,1.6000000000000001,1.3999999999999999,1.5,1.3999999999999999],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(68,1,84,1)\",\"size\":10,\"opacity\":0.69999999999999996,\"line\":{\"color\":\"rgba(68,1,84,1)\"}},\"type\":\"scatter\",\"name\":\"setosa\",\"textfont\":{\"color\":\"rgba(68,1,84,1)\"},\"error_y\":{\"color\":\"rgba(68,1,84,1)\"},\"error_x\":{\"color\":\"rgba(68,1,84,1)\"},\"line\":{\"color\":\"rgba(68,1,84,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[7,6.4000000000000004,6.9000000000000004,5.5,6.5,5.7000000000000002,6.2999999999999998,4.9000000000000004,6.5999999999999996,5.2000000000000002,5,5.9000000000000004,6,6.0999999999999996,5.5999999999999996,6.7000000000000002,5.5999999999999996,5.7999999999999998,6.2000000000000002,5.5999999999999996,5.9000000000000004,6.0999999999999996,6.2999999999999998,6.0999999999999996,6.4000000000000004,6.5999999999999996,6.7999999999999998,6.7000000000000002,6,5.7000000000000002,5.5,5.5,5.7999999999999998,6,5.4000000000000004,6,6.7000000000000002,6.2999999999999998,5.5999999999999996,5.5,5.5,6.0999999999999996,5.7999999999999998,5,5.5999999999999996,5.7000000000000002,5.7000000000000002,6.2000000000000002,5.0999999999999996,5.7000000000000002],\"y\":[4.7000000000000002,4.5,4.9000000000000004,4,4.5999999999999996,4.5,4.7000000000000002,3.2999999999999998,4.5999999999999996,3.8999999999999999,3.5,4.2000000000000002,4,4.7000000000000002,3.6000000000000001,4.4000000000000004,4.5,4.0999999999999996,4.5,3.8999999999999999,4.7999999999999998,4,4.9000000000000004,4.7000000000000002,4.2999999999999998,4.4000000000000004,4.7999999999999998,5,4.5,3.5,3.7999999999999998,3.7000000000000002,3.8999999999999999,5.0999999999999996,4.5,4.5,4.7000000000000002,4.4000000000000004,4.0999999999999996,4,4.4000000000000004,4.5999999999999996,4,3.2999999999999998,4.2000000000000002,4.2000000000000002,4.2000000000000002,4.2999999999999998,3,4.0999999999999996],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(33,144,140,1)\",\"size\":10,\"opacity\":0.69999999999999996,\"line\":{\"color\":\"rgba(33,144,140,1)\"}},\"type\":\"scatter\",\"name\":\"versicolor\",\"textfont\":{\"color\":\"rgba(33,144,140,1)\"},\"error_y\":{\"color\":\"rgba(33,144,140,1)\"},\"error_x\":{\"color\":\"rgba(33,144,140,1)\"},\"line\":{\"color\":\"rgba(33,144,140,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[6.2999999999999998,5.7999999999999998,7.0999999999999996,6.2999999999999998,6.5,7.5999999999999996,4.9000000000000004,7.2999999999999998,6.7000000000000002,7.2000000000000002,6.5,6.4000000000000004,6.7999999999999998,5.7000000000000002,5.7999999999999998,6.4000000000000004,6.5,7.7000000000000002,7.7000000000000002,6,6.9000000000000004,5.5999999999999996,7.7000000000000002,6.2999999999999998,6.7000000000000002,7.2000000000000002,6.2000000000000002,6.0999999999999996,6.4000000000000004,7.2000000000000002,7.4000000000000004,7.9000000000000004,6.4000000000000004,6.2999999999999998,6.0999999999999996,7.7000000000000002,6.2999999999999998,6.4000000000000004,6,6.9000000000000004,6.7000000000000002,6.9000000000000004,5.7999999999999998,6.7999999999999998,6.7000000000000002,6.7000000000000002,6.2999999999999998,6.5,6.2000000000000002,5.9000000000000004],\"y\":[6,5.0999999999999996,5.9000000000000004,5.5999999999999996,5.7999999999999998,6.5999999999999996,4.5,6.2999999999999998,5.7999999999999998,6.0999999999999996,5.0999999999999996,5.2999999999999998,5.5,5,5.0999999999999996,5.2999999999999998,5.5,6.7000000000000002,6.9000000000000004,5,5.7000000000000002,4.9000000000000004,6.7000000000000002,4.9000000000000004,5.7000000000000002,6,4.7999999999999998,4.9000000000000004,5.5999999999999996,5.7999999999999998,6.0999999999999996,6.4000000000000004,5.5999999999999996,5.0999999999999996,5.5999999999999996,6.0999999999999996,5.5999999999999996,5.5,4.7999999999999998,5.4000000000000004,5.5999999999999996,5.0999999999999996,5.0999999999999996,5.9000000000000004,5.7000000000000002,5.2000000000000002,5,5.2000000000000002,5.4000000000000004,5.0999999999999996],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(253,231,37,1)\",\"size\":10,\"opacity\":0.69999999999999996,\"line\":{\"color\":\"rgba(253,231,37,1)\"}},\"type\":\"scatter\",\"name\":\"virginica\",\"textfont\":{\"color\":\"rgba(253,231,37,1)\"},\"error_y\":{\"color\":\"rgba(253,231,37,1)\"},\"error_x\":{\"color\":\"rgba(253,231,37,1)\"},\"line\":{\"color\":\"rgba(253,231,37,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\nInteractive scatter plot of iris dataset\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code demonstrates how to create an interactive scatter plot using the `plotly` package. Let's break down the key components:\n\n1. **Creating the Base ggplot2 Plot**\n   - We start by creating a standard ggplot2 scatter plot of the iris dataset, mapping Sepal Length to the x-axis, Petal Length to the y-axis, and Species to the color aesthetic.\n   - We add styling elements like point size, transparency, informative labels, and a clean theme.\n   - We use the Viridis color palette for better accessibility.\n\n2. **Converting to an Interactive Plot**\n   - We use the `ggplotly()` function to convert our ggplot2 object into an interactive plotly visualization.\n   - This simple conversion adds several interactive features automatically:\n     - Hover tooltips showing data values\n     - Zoom and pan capabilities\n     - Ability to toggle legend items\n     - Download options for saving the plot\n\n3. **Output Format Handling**\n   - We use `knitr::is_html_output()` to check if we're rendering to HTML format.\n   - For HTML output, we display the interactive plotly version.\n   - For other formats (like PDF), we display the static ggplot2 version with a note about the interactive version.\n   - This ensures the document works well in all output formats.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nInteractive plots offer several advantages for ecological data exploration:\n\n1. **Data Exploration Benefits**:\n   - **Detail on demand**: Users can hover over points to see exact values without cluttering the visualization.\n   - **Selective viewing**: Legend items can be clicked to show/hide specific groups (e.g., different species).\n   - **Focus on regions of interest**: Zoom functionality allows detailed examination of specific data regions.\n\n2. **Ecological Applications**:\n   - **Species trait analysis**: Explore relationships between multiple morphological traits.\n   - **Environmental gradients**: Investigate how species respond to environmental variables.\n   - **Outlier identification**: Easily identify and examine unusual data points.\n   - **Data quality control**: Interactive features help spot potential errors or anomalies.\n\n3. **Communication Advantages**:\n   - **Engagement**: Interactive plots engage readers more effectively than static images.\n   - **Self-guided exploration**: Readers can investigate aspects of the data that interest them most.\n   - **Reduced complexity**: Complex datasets can be presented more clearly when users can focus on specific elements.\n\n4. **Practical Considerations**:\n   - Interactive plots are only available in HTML output formats.\n   - They may require more computational resources to render.\n   - Always provide alternative static versions for PDF outputs or publications.\n   - Consider accessibility for users who may rely on keyboard navigation.\n:::\n\n::: {.callout-tip}\n## PROFESSIONAL TIP: Creating Effective Interactive Visualizations\n\nWhen using interactive plots in scientific communication:\n\n1. **Purpose-Driven Interactivity**:\n   - Add interactive elements with clear purpose, not just for novelty\n   - Include only interactions that reveal meaningful patterns or details\n   - Consider what specific questions users might want to answer through interaction\n\n2. **Performance and Compatibility**:\n   - Test interactive visualizations on different devices and browsers\n   - Optimize for reasonable file sizes (especially for web deployment)\n   - Provide static fallbacks for non-HTML formats and accessibility\n\n3. **Tooltip Design**:\n   - Include units of measurement in tooltips\n   - Format numeric values appropriately (proper decimal places)\n   - Include contextual information beyond just the raw values\n   - Consider hierarchical information display (most important first)\n\n4. **Scientific Rigor**:\n   - Ensure interactive features don't mislead or obscure statistical significance\n   - Maintain appropriate axis scales during zooming\n   - Include uncertainty or confidence intervals where applicable\n   - Document interactive capabilities in figure captions or methods sections\n:::\n\n### Interactive Maps with leaflet\n\nFor spatial ecological data, interactive maps can be particularly useful:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(leaflet)\nlibrary(ggplot2)\nlibrary(knitr)\n\n# Create sample ecological site data\nsites <- data.frame(\n  name = c(\"Forest Reserve\", \"Wetland Study Area\", \"Grassland Transect\",\n           \"Mountain Research Station\", \"Coastal Monitoring Site\"),\n  lat = c(37.7749, 37.8, 37.75, 37.85, 37.7),\n  lng = c(-122.4194, -122.45, -122.5, -122.4, -122.3),\n  habitat = c(\"Forest\", \"Wetland\", \"Grassland\", \"Alpine\", \"Coastal\"),\n  species_count = c(120, 85, 65, 95, 110)\n)\n\n# Create a color palette based on habitat type\nhabitat_colors <- c(\"darkgreen\", \"blue\", \"gold\", \"purple\", \"lightblue\")\nnames(habitat_colors) <- c(\"Forest\", \"Wetland\", \"Grassland\", \"Alpine\", \"Coastal\")\n\nif (knitr::is_html_output()) {\n  # For HTML output, create an interactive leaflet map\n  habitat_pal <- colorFactor(\n    palette = habitat_colors,\n    domain = sites$habitat\n  )\n\n  # Create an interactive map\n  leaflet(sites) %>%\n    addProviderTiles(\"Esri.WorldTopoMap\") %>%\n    addCircleMarkers(\n      ~lng, ~lat,\n      color = ~habitat_pal(habitat),\n      radius = ~sqrt(species_count) * 1.5,\n      fillOpacity = 0.7,\n      stroke = TRUE,\n      weight = 1,\n      popup = ~paste(\"<b>\", name, \"</b><br>\",\n                    \"Habitat: \", habitat, \"<br>\",\n                    \"Species Count: \", species_count)\n    ) %>%\n    addLegend(\n      position = \"bottomright\",\n      pal = habitat_pal,\n      values = ~habitat,\n      title = \"Habitat Type\"\n    )\n} else {\n  # For non-HTML output, create a static ggplot map\n  ggplot(sites, aes(x = lng, y = lat, color = habitat, size = species_count)) +\n    borders(\"world\", regions = \"USA\", fill = \"gray90\") +\n    geom_point(alpha = 0.7) +\n    scale_color_manual(values = habitat_colors) +\n    scale_size_continuous(range = c(3, 8)) +\n    coord_fixed(1.3) +\n    theme_minimal() +\n    labs(\n      title = \"Ecological Study Sites\",\n      subtitle = \"Note: Interactive version available in HTML output\",\n      x = \"Longitude\",\n      y = \"Latitude\",\n      color = \"Habitat Type\",\n      size = \"Species Count\"\n    )\n}\n```\n\n::: {#fig-interactive-map .cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-35dbfdb3e5467d0fb12d\" style=\"width:100%;height:1800px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-35dbfdb3e5467d0fb12d\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldTopoMap\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircleMarkers\",\"args\":[[37.7749,37.8,37.75,37.85,37.7],[-122.4194,-122.45,-122.5,-122.4,-122.3],[16.43167672515498,13.82931668593933,12.09338662244782,14.62019151721345,15.73213272255227],null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":[\"#FFD700\",\"#ADD8E6\",\"#A020F0\",\"#006400\",\"#0000FF\"],\"weight\":1,\"opacity\":0.5,\"fill\":true,\"fillColor\":[\"#FFD700\",\"#ADD8E6\",\"#A020F0\",\"#006400\",\"#0000FF\"],\"fillOpacity\":0.7},null,null,[\"<b> Forest Reserve <\\/b><br> Habitat:  Forest <br> Species Count:  120\",\"<b> Wetland Study Area <\\/b><br> Habitat:  Wetland <br> Species Count:  85\",\"<b> Grassland Transect <\\/b><br> Habitat:  Grassland <br> Species Count:  65\",\"<b> Mountain Research Station <\\/b><br> Habitat:  Alpine <br> Species Count:  95\",\"<b> Coastal Monitoring Site <\\/b><br> Habitat:  Coastal <br> Species Count:  110\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#006400\",\"#0000FF\",\"#FFD700\",\"#A020F0\",\"#ADD8E6\"],\"labels\":[\"Alpine\",\"Coastal\",\"Forest\",\"Grassland\",\"Wetland\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":0.5,\"position\":\"bottomright\",\"type\":\"factor\",\"title\":\"Habitat Type\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[37.7,37.85],\"lng\":[-122.5,-122.3]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\nEcological study sites across different habitat types\n:::\n:::\n\n\n::: {.callout-note}\n## Code Explanation\n\nThis code creates an interactive map of ecological study sites using the `leaflet` package. Let's break down the key components:\n\n1. **Data Preparation**\n   - We create a sample dataset of ecological study sites with location coordinates (latitude and longitude), habitat types, and species counts.\n   - We define a custom color palette that maps habitat types to ecologically intuitive colors (e.g., green for forest, blue for wetland).\n\n2. **Creating the Interactive Map**\n   - We use the `leaflet()` function to initialize a map with our site data.\n   - We add a topographic base map with `addProviderTiles(\"Esri.WorldTopoMap\")`.\n   - We represent each study site with a circle marker using `addCircleMarkers()`:\n     - The marker color corresponds to the habitat type.\n     - The marker size is proportional to the square root of the species count (a common transformation for visual scaling).\n     - We add popups that display site details when a marker is clicked.\n   - We include a legend with `addLegend()` to explain the habitat type colors.\n\n3. **Output Format Handling**\n   - Similar to the previous example, we check if we're rendering to HTML.\n   - For non-HTML formats, we create a static map using ggplot2 as a fallback.\n   - This ensures the document is useful in all output formats.\n:::\n\n::: {.callout-important}\n## Results Interpretation\n\nInteractive maps offer powerful capabilities for ecological spatial data visualization:\n\n1. **Spatial Data Exploration**:\n   - **Context awareness**: Base maps provide geographical context (topography, water bodies, urban areas).\n   - **Multi-scale examination**: Zoom functionality allows viewing patterns at different spatial scales.\n   - **Detailed information**: Popups provide detailed site-specific information without cluttering the map.\n\n2. **Ecological Applications**:\n   - **Field site selection**: Visualize potential study locations based on habitat types and existing data.\n   - **Biodiversity hotspots**: Map species richness across different locations.\n   - **Sampling design**: Plan spatially balanced sampling strategies.\n   - **Stakeholder engagement**: Create accessible maps for communicating with non-specialists.\n\n3. **Analytical Advantages**:\n   - **Spatial pattern recognition**: Identify clustering or dispersion of ecological phenomena.\n   - **Environmental correlations**: Overlay ecological data with environmental features.\n   - **Accessibility**: Make complex spatial data accessible to broader audiences.\n   - **Data integration**: Combine multiple spatial datasets in a single interactive interface.\n\n4. **Practical Considerations**:\n   - Interactive maps require HTML output format.\n   - Consider data privacy when mapping sensitive locations (e.g., endangered species).\n   - Ensure color choices are meaningful and accessible.\n   - Balance information density with clarity.\n:::\n\n::: {.callout-tip}\n## PROFESSIONAL TIP: Best Practices for Ecological Mapping\n\nWhen creating interactive maps for ecological data:\n\n1. **Base Map Selection**:\n   - Choose base maps appropriate to your ecological context (topographic for terrestrial studies, bathymetric for marine)\n   - Consider offline capability for field use with packages like `mapview`\n   - Be aware of licensing issues for base maps in publications\n\n2. **Data Representation**:\n   - Use ecologically intuitive color schemes (greens for forests, blues for aquatic)\n   - Scale markers appropriately (âˆšn transformation for count data often works well)\n   - Consider using multiple layers for different data types (species, environmental variables)\n   - Add scale bars and north arrows for static versions\n\n3. **Sensitive Location Handling**:\n   - Deliberately obscure precise locations of endangered species or sensitive habitats\n   - Consider using grid cells, jittering, or reduced precision for protected species\n   - Include appropriate disclaimers about location precision\n   - Follow relevant regulations (e.g., IUCN guidelines for endangered species)\n\n4. **Technical Considerations**:\n   - Test on mobile devices when field use is anticipated\n   - Optimize popup content for readability on small screens\n   - Include data download capabilities when appropriate\n   - Document the coordinate reference system (CRS) used\n:::\n\nInteractive visualizations transform static ecological data into explorable resources, allowing readers to engage more deeply with your research findings and discover patterns that might otherwise remain hidden.\n\n## Network Visualizations\n\n{{ ... }}\n\n## Chapter Summary\n\n### Key Concepts\n\n-   **Publication Quality**: Customizing themes, fonts, and colors is essential for professional graphics\n-   **Composition**: Combining multiple plots into a single figure helps tell a cohesive story\n-   **Interactivity**: Interactive plots allow users to explore data dynamically\n-   **Spatial Visualization**: Mapping is crucial for understanding geographical patterns in ecological data\n-   **Animation**: Animating changes over time can reveal temporal trends effectively\n\n### R Functions Learned\n\n-   `theme()` - Customize plot appearance\n-   `ggsave()` - Save plots in high resolution\n-   `patchwork` / `cowplot` - Combine multiple plots\n-   `ggplotly()` - Convert static plots to interactive ones\n-   `geom_sf()` - Visualize spatial data\n-   `transition_time()` - Animate plots over time\n\n### Next Steps\n\nIn the next part of the book, we will explore **Statistical Modeling**, starting with regression analysis to quantify relationships between variables.\n\n## Exercises\n\n1.  **Theme Customization**: Take a basic plot from Chapter 6 and customize its theme, colors, and fonts to make it publication-ready.\n2.  **Multi-Panel Figure**: Create a figure with three panels: a scatter plot, a box plot, and a bar chart, arranged using `patchwork`.\n3.  **Interactive Plot**: Convert one of your static plots into an interactive version using `plotly`.\n4.  **Map Creation**: If you have spatial data, create a map showing the distribution of your study sites or species.\n5.  **Animation**: Create an animation showing how a variable changes over time (e.g., temperature, population size).\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../site_libs/plotly-binding-4.11.0/plotly.js\"></script>\n<script src=\"../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.2/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.2/js/crosstalk.min.js\"></script>\n<link href=\"../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n<link href=\"../site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"../site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/leaflet-binding-2.2.3/leaflet.js\"></script>\n<script src=\"../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js\"></script>\n<script src=\"../site_libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}