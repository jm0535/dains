<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3&nbsp; Exploratory Data Analysis – Data Analysis in Natural Sciences</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/04-hypothesis-testing.html" rel="next">
<link href="../chapters/02-data-basics.html" rel="prev">
<link href="../images/Rlogo.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-56b67755cebbfb78539c873898544994.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-f0bc7793ffdd46ddf3b99218c6954345.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dark-5cb9b089ed55fbb2d9030d6bb4f5b5f8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-5cb9b089ed55fbb2d9030d6bb4f5b5f8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<meta name="description" content="A comprehensive guide to data analysis in natural sciences using R. Learn statistical methods, data visualization, and reproducible research practices.">
<meta name="keywords" content="R programming, data analysis, statistics, ecology, natural sciences, ggplot2, tidyverse, data visualization">
<meta name="author" content="Jimmy Moses">
<link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/Rlogo.jpg" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DAINS</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-wide tools-end">
    <a href="https://github.com/jm0535/dains" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html">Part II: Data Analysis Fundamentals</a></li><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-data-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Basics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: Data Analysis Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-exploratory-analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-statistical-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-advanced-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Advanced Data Visualization</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: Statistical Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-advanced-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Advanced Modeling Techniques</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V: Applied Ecology</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-conservation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Conservation Applications</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">3.1</span> Introduction</a></li>
  <li><a href="#the-purpose-of-exploratory-data-analysis" id="toc-the-purpose-of-exploratory-data-analysis" class="nav-link" data-scroll-target="#the-purpose-of-exploratory-data-analysis"><span class="header-section-number">3.2</span> The Purpose of Exploratory Data Analysis</a></li>
  <li>
<a href="#summarizing-data" id="toc-summarizing-data" class="nav-link" data-scroll-target="#summarizing-data"><span class="header-section-number">3.3</span> Summarizing Data</a>
  <ul class="collapse">
<li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics"><span class="header-section-number">3.3.1</span> Descriptive Statistics</a></li>
  <li><a href="#frequency-tables" id="toc-frequency-tables" class="nav-link" data-scroll-target="#frequency-tables"><span class="header-section-number">3.3.2</span> Frequency Tables</a></li>
  <li><a href="#box-plots" id="toc-box-plots" class="nav-link" data-scroll-target="#box-plots"><span class="header-section-number">3.3.3</span> Box Plots</a></li>
  <li><a href="#bar-charts" id="toc-bar-charts" class="nav-link" data-scroll-target="#bar-charts"><span class="header-section-number">3.3.4</span> Bar Charts</a></li>
  </ul>
</li>
  <li>
<a href="#visualizing-distributions" id="toc-visualizing-distributions" class="nav-link" data-scroll-target="#visualizing-distributions"><span class="header-section-number">3.4</span> Visualizing Distributions</a>
  <ul class="collapse">
<li><a href="#histograms-and-density-plots" id="toc-histograms-and-density-plots" class="nav-link" data-scroll-target="#histograms-and-density-plots"><span class="header-section-number">3.4.1</span> Histograms and Density Plots</a></li>
  <li><a href="#box-plots-1" id="toc-box-plots-1" class="nav-link" data-scroll-target="#box-plots-1"><span class="header-section-number">3.4.2</span> Box Plots</a></li>
  <li><a href="#bar-charts-1" id="toc-bar-charts-1" class="nav-link" data-scroll-target="#bar-charts-1"><span class="header-section-number">3.4.3</span> Bar Charts</a></li>
  </ul>
</li>
  <li>
<a href="#exploring-relationships" id="toc-exploring-relationships" class="nav-link" data-scroll-target="#exploring-relationships"><span class="header-section-number">3.5</span> Exploring Relationships</a>
  <ul class="collapse">
<li><a href="#scatter-plots" id="toc-scatter-plots" class="nav-link" data-scroll-target="#scatter-plots"><span class="header-section-number">3.5.1</span> Scatter Plots</a></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis"><span class="header-section-number">3.5.2</span> Correlation Analysis</a></li>
  <li><a href="#pair-plots" id="toc-pair-plots" class="nav-link" data-scroll-target="#pair-plots"><span class="header-section-number">3.5.3</span> Pair Plots</a></li>
  </ul>
</li>
  <li>
<a href="#identifying-outliers-and-anomalies" id="toc-identifying-outliers-and-anomalies" class="nav-link" data-scroll-target="#identifying-outliers-and-anomalies"><span class="header-section-number">3.6</span> Identifying Outliers and Anomalies</a>
  <ul class="collapse">
<li><a href="#box-plots-for-outlier-detection" id="toc-box-plots-for-outlier-detection" class="nav-link" data-scroll-target="#box-plots-for-outlier-detection"><span class="header-section-number">3.6.1</span> Box Plots for Outlier Detection</a></li>
  <li><a href="#z-scores-for-outlier-detection" id="toc-z-scores-for-outlier-detection" class="nav-link" data-scroll-target="#z-scores-for-outlier-detection"><span class="header-section-number">3.6.2</span> Z-Scores for Outlier Detection</a></li>
  </ul>
</li>
  <li><a href="#time-series-exploration" id="toc-time-series-exploration" class="nav-link" data-scroll-target="#time-series-exploration"><span class="header-section-number">3.7</span> Time Series Exploration</a></li>
  <li><a href="#missing-data-analysis" id="toc-missing-data-analysis" class="nav-link" data-scroll-target="#missing-data-analysis"><span class="header-section-number">3.8</span> Missing Data Analysis</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">3.9</span> Summary</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">3.10</span> Exercises</a></li>
  <li>
<a href="#chapter-summary" id="toc-chapter-summary" class="nav-link" data-scroll-target="#chapter-summary"><span class="header-section-number">3.11</span> Chapter Summary</a>
  <ul class="collapse">
<li><a href="#key-concepts" id="toc-key-concepts" class="nav-link" data-scroll-target="#key-concepts"><span class="header-section-number">3.11.1</span> Key Concepts</a></li>
  <li><a href="#r-functions-learned" id="toc-r-functions-learned" class="nav-link" data-scroll-target="#r-functions-learned"><span class="header-section-number">3.11.2</span> R Functions Learned</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps"><span class="header-section-number">3.11.3</span> Next Steps</a></li>
  </ul>
</li>
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1"><span class="header-section-number">3.12</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/jm0535/dains/edit/main/chapters/03-exploratory-analysis.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jm0535/dains/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/jm0535/dains/blob/main/chapters/03-exploratory-analysis.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html">Part II: Data Analysis Fundamentals</a></li><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduction" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">3.1</span> Introduction</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this chapter, you will be able to:</p>
<ol type="1">
<li>Calculate and interpret descriptive statistics (mean, median, standard deviation)</li>
<li>Create and analyze frequency tables for categorical data</li>
<li>Visualize distributions using histograms, density plots, and box plots</li>
<li>Explore relationships between variables using scatter plots and correlation matrices</li>
<li>Identify outliers and anomalies using statistical methods and visualizations</li>
<li>Analyze missing data patterns and their potential impact</li>
</ol>
</div>
</div>
<p>Exploratory Data Analysis (EDA) is a critical first step in any data analysis project. In this chapter, you’ll learn how to systematically explore your data to understand its structure, identify patterns, detect anomalies, and generate hypotheses for further investigation.</p>
</section><section id="the-purpose-of-exploratory-data-analysis" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="the-purpose-of-exploratory-data-analysis">
<span class="header-section-number">3.2</span> The Purpose of Exploratory Data Analysis</h2>
<p>Exploratory Data Analysis serves several important purposes in natural sciences research:</p>
<ol type="1">
<li>
<strong>Understanding Data Structure</strong>: Gain insights into the basic properties of your dataset</li>
<li>
<strong>Checking Data Quality</strong>: Identify missing values, outliers, and potential errors</li>
<li>
<strong>Discovering Patterns</strong>: Detect relationships, trends, and distributions</li>
<li>
<strong>Generating Hypotheses</strong>: Develop questions and hypotheses for formal testing</li>
<li>
<strong>Informing Analysis Choices</strong>: Guide decisions about appropriate statistical methods</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PROFESSIONAL TIP: Creating Reproducible EDA Workflows
</div>
</div>
<div class="callout-body-container callout-body">
<p>To ensure your exploratory data analysis is reproducible and transparent:</p>
<ul>
<li>
<strong>Document all data transformations</strong>: Record every cleaning step, filter, and transformation applied to raw data</li>
<li>
<strong>Use R Markdown or Quarto</strong>: Create executable documents that combine code, output, and narrative explanation</li>
<li>
<strong>Version control your analysis</strong>: Track changes to your EDA scripts using Git or similar tools</li>
<li>
<strong>Save exploratory outputs</strong>: Store key visualizations and summary statistics in organized directories</li>
<li>
<strong>Create clear data lineage</strong>: Document the origin of each dataset and how it connects to derived datasets</li>
<li>
<strong>Use consistent naming conventions</strong>: Apply systematic naming to files, variables, and functions</li>
<li>
<strong>Separate exploration from confirmation</strong>: Clearly distinguish exploratory analyses from confirmatory hypothesis testing</li>
<li>
<strong>Include data validation checks</strong>: Incorporate automated checks for data integrity and quality</li>
<li>
<strong>Provide detailed method documentation</strong>: Document statistical approaches like ANOVA types (e.g., Type II tests for unbalanced designs)</li>
<li>
<strong>Share your EDA code</strong>: Make your exploratory scripts available alongside final analyses for complete transparency</li>
</ul>
</div>
</div>
</section><section id="summarizing-data" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="summarizing-data">
<span class="header-section-number">3.3</span> Summarizing Data</h2>
<section id="descriptive-statistics" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="descriptive-statistics">
<span class="header-section-number">3.3.1</span> Descriptive Statistics</h3>
<p>Descriptive statistics provide a concise summary of your data’s central tendency, dispersion, and shape:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the crop yield dataset</span></span>
<span><span class="va">crop_yields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"../data/agriculture/crop_yields.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get summary statistics for wheat yields</span></span>
<span><span class="va">wheat_summary</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    StdDev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    Q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    Q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Display the summary statistics</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">wheat_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-wheat-summary-stats" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wheat-summary-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.1: Summary Statistics for Global Wheat Yields
</figcaption><div aria-describedby="tbl-wheat-summary-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">StdDev</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Q3</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">2.434914</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">1.687949</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10.6677</td>
<td style="text-align: right;">1.228</td>
<td style="text-align: right;">3.1245</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize the distribution of wheat yields</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">crop_yields</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Global Wheat Yields"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-descriptive-stats" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-descriptive-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-descriptive-stats-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-descriptive-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Distribution of global wheat yields
</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Identify top wheat-producing countries (by average yield)</span></span>
<span><span class="va">top_wheat_countries</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Entity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>Avg_Yield <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">Avg_Yield</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the top countries</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">top_wheat_countries</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-top-wheat-countries" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-top-wheat-countries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.2: Top 10 Countries by Average Wheat Yield
</figcaption><div aria-describedby="tbl-top-wheat-countries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Entity</th>
<th style="text-align: right;">Avg_Yield</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Belgium</td>
<td style="text-align: right;">8.544200</td>
</tr>
<tr class="even">
<td style="text-align: left;">Netherlands</td>
<td style="text-align: right;">7.030172</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ireland</td>
<td style="text-align: right;">6.829840</td>
</tr>
<tr class="even">
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: right;">6.366400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Denmark</td>
<td style="text-align: right;">6.175285</td>
</tr>
<tr class="even">
<td style="text-align: left;">Luxembourg</td>
<td style="text-align: right;">5.977411</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Germany</td>
<td style="text-align: right;">5.893978</td>
</tr>
<tr class="even">
<td style="text-align: left;">Europe, Western</td>
<td style="text-align: right;">5.723267</td>
</tr>
<tr class="odd">
<td style="text-align: left;">France</td>
<td style="text-align: right;">5.645341</td>
</tr>
<tr class="even">
<td style="text-align: left;">Northern Europe</td>
<td style="text-align: right;">5.589988</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code block demonstrates how to calculate and visualize descriptive statistics:</p>
<ol type="1">
<li>
<code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code> loads the tidyverse collection of packages for data manipulation and visualization.</li>
<li>
<code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> imports the crop yields dataset from a CSV file.</li>
<li>
<code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> displays the first few rows to inspect the data structure.</li>
<li>The <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> function calculates key statistics for wheat yields:
<ul>
<li>
<code>Mean</code>: Average yield across all observations</li>
<li>
<code>Median</code>: Middle value when yields are arranged in order</li>
<li>
<code>StdDev</code>: Standard deviation, measuring data dispersion</li>
<li>
<code>Min/Max</code>: Minimum and maximum values in the dataset</li>
<li>
<code>Q1/Q3</code>: First and third quartiles (25th and 75th percentiles)</li>
</ul>
</li>
<li>
<code><a href="https://rdrr.io/pkg/knitr/man/kable.html">knitr::kable()</a></code> creates a formatted table of the summary statistics.</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> with <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> visualizes the distribution of wheat yields.</li>
<li>The final section identifies and displays the top 10 countries by average wheat yield using:
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> to organize data by country</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> to calculate average yield per country</li>
<li>
<code>arrange(desc())</code> to sort in descending order</li>
<li>
<code>head(10)</code> to select the top 10 entries</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The summary statistics reveal several key insights about global wheat yields:</p>
<ul>
<li>The mean wheat yield is higher than the median, suggesting a right-skewed distribution with some countries achieving exceptionally high yields.</li>
<li>The standard deviation indicates substantial variability in wheat productivity across different regions.</li>
<li>The histogram confirms this skewed distribution, with most countries clustered at lower to moderate yield levels, and fewer countries achieving very high yields.</li>
<li>The top 10 countries table shows which nations have the most productive wheat cultivation systems, likely due to advanced agricultural practices, favorable climate conditions, or intensive farming methods.</li>
<li>This analysis provides a foundation for investigating factors that contribute to high wheat yields and potential strategies for improving agricultural productivity in lower-yielding regions.</li>
</ul>
</div>
</div>
</section><section id="frequency-tables" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="frequency-tables">
<span class="header-section-number">3.3.2</span> Frequency Tables</h3>
<p>Frequency tables are useful for understanding the distribution of categorical variables:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Let's create a categorical variable based on wheat yield levels</span></span>
<span><span class="va">crop_yields_with_categories</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>yield_category <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">&lt;</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Low"</span>,</span>
<span>    <span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">&gt;=</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">&lt;</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"Medium"</span>,</span>
<span>    <span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">&gt;=</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"High"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Frequency table for yield categories</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">crop_yields_with_categories</span><span class="op">$</span><span class="va">yield_category</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   High    Low Medium </span></span>
<span><span class="co">#&gt;   1279   4081   2741</span></span>
<span></span>
<span><span class="co"># Proportions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">crop_yields_with_categories</span><span class="op">$</span><span class="va">yield_category</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      High       Low    Medium </span></span>
<span><span class="co">#&gt; 0.1578817 0.5037650 0.3383533</span></span>
<span></span>
<span><span class="co"># Create a decade variable for temporal analysis</span></span>
<span><span class="va">crop_yields_with_categories</span> <span class="op">&lt;-</span> <span class="va">crop_yields_with_categories</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>decade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Two-way frequency table: yield category by decade</span></span>
<span><span class="va">yield_decade_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">crop_yields_with_categories</span><span class="op">$</span><span class="va">yield_category</span>,</span>
<span>                            <span class="va">crop_yields_with_categories</span><span class="op">$</span><span class="va">decade</span><span class="op">)</span></span>
<span><span class="va">yield_decade_table</span></span>
<span><span class="co">#&gt;         </span></span>
<span><span class="co">#&gt;          1960 1970 1980 1990 2000 2010</span></span>
<span><span class="co">#&gt;   High     34  102  200  261  326  356</span></span>
<span><span class="co">#&gt;   Low     838  833  760  681  563  406</span></span>
<span><span class="co">#&gt;   Medium  239  335  344  550  656  617</span></span>
<span></span>
<span><span class="co"># Convert to proportions (by row)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="va">yield_decade_table</span>, margin <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;         </span></span>
<span><span class="co">#&gt;                1960       1970       1980       1990       2000       2010</span></span>
<span><span class="co">#&gt;   High   0.02658327 0.07974980 0.15637217 0.20406568 0.25488663 0.27834246</span></span>
<span><span class="co">#&gt;   Low    0.20534183 0.20411664 0.18622887 0.16687086 0.13795638 0.09948542</span></span>
<span><span class="co">#&gt;   Medium 0.08719445 0.12221817 0.12550164 0.20065669 0.23932871 0.22510033</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code block demonstrates how to create and analyze frequency tables:</p>
<ol type="1">
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> with <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> creates a new categorical variable <code>yield_category</code> by binning wheat yields into “Low,” “Medium,” and “High” categories.</li>
<li>
<code><a href="https://rdrr.io/r/base/table.html">table()</a></code> produces a frequency count for each yield category.</li>
<li>
<code><a href="https://rdrr.io/r/base/proportions.html">prop.table()</a></code> converts the frequency counts to proportions (relative frequencies).</li>
<li>A new variable <code>decade</code> is created by rounding down the year to the nearest decade using <code>floor(Year / 10) * 10</code>.</li>
<li>A two-way frequency table is created to examine the relationship between yield categories and decades.</li>
<li>
<code>prop.table(yield_decade_table, margin = 1)</code> calculates row proportions, showing the distribution of decades within each yield category.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The frequency tables reveal important patterns in wheat yield categories:</p>
<ul>
<li>The distribution of yield categories shows which productivity levels are most common globally.</li>
<li>The proportions table quantifies this distribution, indicating what percentage of observations fall into each yield category.</li>
<li>The two-way table between yield categories and decades allows us to track how wheat productivity has changed over time.</li>
<li>The row proportions reveal whether certain yield categories have become more or less common in different decades, potentially indicating technological improvements, climate effects, or changes in agricultural practices.</li>
<li>These temporal patterns are crucial for understanding agricultural development trends and projecting future food security scenarios.</li>
</ul>
</div>
</div>
</section><section id="box-plots" class="level3" data-number="3.3.3"><h3 data-number="3.3.3" class="anchored" data-anchor-id="box-plots">
<span class="header-section-number">3.3.3</span> Box Plots</h3>
<p>Box plots are excellent for comparing distributions across groups:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Select a few major countries for comparison</span></span>
<span><span class="va">major_wheat_producers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"United States"</span>, <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Russia"</span>, <span class="st">"France"</span>, <span class="st">"Australia"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter data for these countries and recent years</span></span>
<span><span class="va">recent_wheat_data</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Entity</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">major_wheat_producers</span>,</span>
<span>         <span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">2000</span>,</span>
<span>         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Box plot of wheat yields by country</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">recent_wheat_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Entity</span>, y <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wheat Yields by Country (2000-present)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Country"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Enhanced box plot with jittered points</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">recent_wheat_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Entity</span>, y <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wheat Yields by Country (2000-present)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Country"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-boxplots-summary-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-boxplots-summary-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-boxplots-summary-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplots-summary-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Wheat yields by country
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-boxplots-summary-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-boxplots-summary-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-boxplots-summary-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplots-summary-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Enhanced boxplot with data points
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to create and enhance box plots for comparing distributions:</p>
<ol type="1">
<li>First, we select major wheat-producing countries for comparison and filter for recent data (since 2000).</li>
<li>The basic box plot:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> creates a box-and-whisker plot for each country</li>
<li>Each box shows the median (middle line), interquartile range (IQR, the box), and whiskers extending to 1.5 × IQR</li>
<li>Points beyond the whiskers represent outliers</li>
</ul>
</li>
<li>The enhanced box plot adds:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code> to display individual data points with slight horizontal displacement</li>
<li>This combination shows both the summary statistics (box plot) and the raw data distribution (points)</li>
<li>
<code>angle = 45, hjust = 1</code> rotates country labels for better readability</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The box plots reveal important comparisons between major wheat-producing countries:</p>
<ul>
<li>The median line in each box shows the typical yield for each country, allowing direct comparison of central tendency.</li>
<li>The height of each box (IQR) indicates the variability of yields within each country over the time period.</li>
<li>Whisker length reflects the range of typical yields, while outlier points show exceptional years.</li>
<li>Countries with higher boxes generally have more variable production, possibly due to climate fluctuations or changing agricultural practices.</li>
<li>The jittered points reveal the actual distribution and density of observations for each country.</li>
<li>These comparisons help identify which countries have the most consistent and productive wheat cultivation systems, providing insights for agricultural policy and development.</li>
</ul>
</div>
</div>
</section><section id="bar-charts" class="level3" data-number="3.3.4"><h3 data-number="3.3.4" class="anchored" data-anchor-id="bar-charts">
<span class="header-section-number">3.3.4</span> Bar Charts</h3>
<p>Bar charts are useful for visualizing categorical data:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate average wheat yield by country for the last decade</span></span>
<span><span class="va">recent_avg_yields</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">2010</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Entity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>avg_wheat_yield <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">avg_wheat_yield</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>  <span class="co"># Top 10 countries</span></span>
<span></span>
<span><span class="co"># Bar chart of average wheat yields</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">recent_avg_yields</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Entity</span>, <span class="va">avg_wheat_yield</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">avg_wheat_yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Top 10 Countries by Average Wheat Yield (2010-present)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Country"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Average Wheat Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-barchart-yields" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-barchart-yields-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-barchart-yields-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barchart-yields-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Top 10 countries by average wheat yield (2010-present)
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to create a bar chart for visualizing categorical data:</p>
<ol type="1">
<li>First, we calculate the average wheat yield by country for the last decade (2010-present).</li>
<li>We then select the top 10 countries by average yield.</li>
<li>The bar chart:
<ul>
<li>
<code>geom_bar(stat = "identity")</code> creates a bar for each country, with height proportional to average yield</li>
<li>
<code>reorder(Entity, avg_wheat_yield)</code> sorts the countries by average yield in descending order</li>
<li>
<code>fill = "darkgreen"</code> sets the bar color</li>
<li>
<code>theme(axis.text.x = element_text(angle = 45, hjust = 1))</code> rotates country labels for better readability</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The bar chart reveals the top 10 countries by average wheat yield:</p>
<ul>
<li>The height of each bar represents the average yield for each country.</li>
<li>The countries are sorted in descending order by average yield, making it easy to identify the most productive nations.</li>
<li>This visualization helps identify which countries have the most efficient wheat cultivation systems, providing insights for agricultural policy and development.</li>
<li>The bar chart can also be used to compare the average yields of different countries, helping to identify potential areas for improvement.</li>
</ul>
</div>
</div>
</section></section><section id="visualizing-distributions" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="visualizing-distributions">
<span class="header-section-number">3.4</span> Visualizing Distributions</h2>
<section id="histograms-and-density-plots" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="histograms-and-density-plots">
<span class="header-section-number">3.4.1</span> Histograms and Density Plots</h3>
<p>Histograms and density plots help visualize the distribution of continuous variables:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Histogram of wheat yields</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">crop_yields</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"darkgreen"</span>, color <span class="op">=</span> <span class="st">"white"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of Wheat Yields"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Density plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">crop_yields</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Density Plot of Wheat Yields"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Histogram with density overlay</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">crop_yields</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"darkgreen"</span>, color <span class="op">=</span> <span class="st">"white"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"darkgreen"</span>, linewidth <span class="op">=</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Wheat Yields"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-distributions-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-distributions-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-distributions-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distributions-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Histogram of wheat yields
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-distributions-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-distributions-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-distributions-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distributions-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Density plot of wheat yields
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-distributions-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-distributions-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-distributions-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distributions-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: Combined histogram with density overlay
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates three approaches to visualizing distributions:</p>
<ol type="1">
<li>
<strong>Histogram</strong>:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> divides the data into bins and counts observations in each bin</li>
<li>
<code>bins = 30</code> specifies the number of divisions</li>
<li>
<code>na.rm = TRUE</code> removes missing values from the visualization</li>
</ul>
</li>
<li>
<strong>Density Plot</strong>:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> creates a smoothed representation of the distribution</li>
<li>
<code>fill</code> and <code>alpha</code> control the appearance and transparency</li>
<li>Density plots show the probability density function of the data</li>
</ul>
</li>
<li>
<strong>Combined Visualization</strong>:
<ul>
<li>The histogram is converted to density scale with <code>aes(y = after_stat(density))</code>
</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> overlays a smoothed curve on the histogram</li>
<li>This combination shows both the raw data structure and the smoothed distribution</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>These distribution visualizations reveal key patterns in wheat yields:</p>
<ul>
<li>The histogram shows the frequency of observations at different yield levels, highlighting where most countries cluster.</li>
<li>The density plot smooths the distribution, making it easier to identify the central tendency and spread.</li>
<li>The combined plot allows us to see both the actual data distribution (histogram) and the underlying probability density (curve).</li>
<li>The right-skewed shape indicates that while most countries have moderate yields, a few achieve exceptionally high productivity.</li>
<li>Multiple peaks (if present) might suggest distinct groups of countries with different agricultural technologies or growing conditions.</li>
<li>These visualizations help identify outliers and understand the overall pattern of global wheat production efficiency.</li>
</ul>
</div>
</div>
</section><section id="box-plots-1" class="level3" data-number="3.4.2"><h3 data-number="3.4.2" class="anchored" data-anchor-id="box-plots-1">
<span class="header-section-number">3.4.2</span> Box Plots</h3>
<p>Box plots are excellent for comparing distributions across groups:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Select a few major countries for comparison</span></span>
<span><span class="va">major_wheat_producers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"United States"</span>, <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Russia"</span>, <span class="st">"France"</span>, <span class="st">"Australia"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter data for these countries and recent years</span></span>
<span><span class="va">recent_wheat_data</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Entity</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">major_wheat_producers</span>,</span>
<span>         <span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">2000</span>,</span>
<span>         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Box plot of wheat yields by country</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">recent_wheat_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Entity</span>, y <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wheat Yields by Country (2000-present)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Country"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Enhanced box plot with jittered points</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">recent_wheat_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Entity</span>, y <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wheat Yields by Country (2000-present)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Country"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-boxplots-visualizing-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-boxplots-visualizing-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-boxplots-visualizing-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplots-visualizing-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.8: Country comparison boxplot
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-boxplots-visualizing-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-boxplots-visualizing-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-boxplots-visualizing-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplots-visualizing-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.9: Boxplot with jittered observations
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to create and enhance box plots for comparing distributions:</p>
<ol type="1">
<li>First, we select major wheat-producing countries for comparison and filter for recent data (since 2000).</li>
<li>The basic box plot:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> creates a box-and-whisker plot for each country</li>
<li>Each box shows the median (middle line), interquartile range (IQR, the box), and whiskers extending to 1.5 × IQR</li>
<li>Points beyond the whiskers represent outliers</li>
</ul>
</li>
<li>The enhanced box plot adds:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code> to display individual data points with slight horizontal displacement</li>
<li>This combination shows both the summary statistics (box plot) and the raw data distribution (points)</li>
<li>
<code>angle = 45, hjust = 1</code> rotates country labels for better readability</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The box plots reveal important comparisons between major wheat-producing countries:</p>
<ul>
<li>The median line in each box shows the typical yield for each country, allowing direct comparison of central tendency.</li>
<li>The height of each box (IQR) indicates the variability of yields within each country over the time period.</li>
<li>Whisker length reflects the range of typical yields, while outlier points show exceptional years.</li>
<li>Countries with higher boxes generally have more variable production, possibly due to climate fluctuations or changing agricultural practices.</li>
<li>The jittered points reveal the actual distribution and density of observations for each country.</li>
<li>These comparisons help identify which countries have the most consistent and productive wheat cultivation systems, providing insights for agricultural policy and development.</li>
</ul>
</div>
</div>
</section><section id="bar-charts-1" class="level3" data-number="3.4.3"><h3 data-number="3.4.3" class="anchored" data-anchor-id="bar-charts-1">
<span class="header-section-number">3.4.3</span> Bar Charts</h3>
<p>Bar charts are useful for visualizing categorical data:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate average wheat yield by country for the last decade</span></span>
<span><span class="va">recent_avg_yields</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">2010</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Entity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>avg_wheat_yield <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">avg_wheat_yield</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>  <span class="co"># Top 10 countries</span></span>
<span></span>
<span><span class="co"># Bar chart of average wheat yields</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">recent_avg_yields</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Entity</span>, <span class="va">avg_wheat_yield</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">avg_wheat_yield</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Top 10 Countries by Average Wheat Yield (2010-present)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Country"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Average Wheat Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-barchart-distributions" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-barchart-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-barchart-distributions-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barchart-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.10: Top 10 countries by average wheat yield
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to create a bar chart for visualizing categorical data:</p>
<ol type="1">
<li>First, we calculate the average wheat yield by country for the last decade (2010-present).</li>
<li>We then select the top 10 countries by average yield.</li>
<li>The bar chart:
<ul>
<li>
<code>geom_bar(stat = "identity")</code> creates a bar for each country, with height proportional to average yield</li>
<li>
<code>reorder(Entity, avg_wheat_yield)</code> sorts the countries by average yield in descending order</li>
<li>
<code>fill = "darkgreen"</code> sets the bar color</li>
<li>
<code>theme(axis.text.x = element_text(angle = 45, hjust = 1))</code> rotates country labels for better readability</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The bar chart reveals the top 10 countries by average wheat yield:</p>
<ul>
<li>The height of each bar represents the average yield for each country.</li>
<li>The countries are sorted in descending order by average yield, making it easy to identify the most productive nations.</li>
<li>This visualization helps identify which countries have the most efficient wheat cultivation systems, providing insights for agricultural policy and development.</li>
<li>The bar chart can also be used to compare the average yields of different countries, helping to identify potential areas for improvement.</li>
</ul>
</div>
</div>
</section></section><section id="exploring-relationships" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="exploring-relationships">
<span class="header-section-number">3.5</span> Exploring Relationships</h2>
<section id="scatter-plots" class="level3" data-number="3.5.1"><h3 data-number="3.5.1" class="anchored" data-anchor-id="scatter-plots">
<span class="header-section-number">3.5.1</span> Scatter Plots</h3>
<p>Scatter plots help visualize relationships between two continuous variables:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Let's compare wheat and rice yields</span></span>
<span><span class="va">crop_yields_filtered</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Rice (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Basic scatter plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">crop_yields_filtered</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span>, y <span class="op">=</span> <span class="va">`Rice (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Relationship between Wheat and Rice Yields"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Rice Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Scatter plot with color by continent (we'll need to add continent information)</span></span>
<span><span class="co"># For demonstration, let's create a simple mapping for a few countries</span></span>
<span><span class="va">continent_mapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  Entity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"United States"</span>, <span class="st">"Canada"</span>, <span class="st">"Mexico"</span>,</span>
<span>             <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Japan"</span>,</span>
<span>             <span class="st">"Germany"</span>, <span class="st">"France"</span>, <span class="st">"United Kingdom"</span>,</span>
<span>             <span class="st">"Brazil"</span>, <span class="st">"Argentina"</span>, <span class="st">"Chile"</span>,</span>
<span>             <span class="st">"Egypt"</span>, <span class="st">"Nigeria"</span>, <span class="st">"South Africa"</span>,</span>
<span>             <span class="st">"Australia"</span>, <span class="st">"New Zealand"</span><span class="op">)</span>,</span>
<span>  Continent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"North America"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Asia"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Europe"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"South America"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Africa"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Oceania"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Join with our dataset</span></span>
<span><span class="va">crop_yields_with_continent</span> <span class="op">&lt;-</span> <span class="va">crop_yields_filtered</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">continent_mapping</span>, by <span class="op">=</span> <span class="st">"Entity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Scatter plot with color by continent</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">crop_yields_with_continent</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span>, y <span class="op">=</span> <span class="va">`Rice (tonnes per hectare)`</span>, color <span class="op">=</span> <span class="va">Continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Relationship between Wheat and Rice Yields by Continent"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Rice Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-scatter-relationships-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-scatter-relationships-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-scatter-relationships-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-relationships-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.11: Relationship between wheat and rice yields
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-scatter-relationships-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-scatter-relationships-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-scatter-relationships-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-relationships-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.12: Wheat vs rice yields by continent
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to create scatter plots for exploring relationships:</p>
<ol type="1">
<li>First, we filter the data to include only observations with non-missing values for wheat and rice yields, and only consider recent data (since 2000).</li>
<li>The basic scatter plot:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> creates a scatter plot of wheat yields vs.&nbsp;rice yields</li>
<li>
<code>alpha = 0.5</code> sets the transparency of the points</li>
<li>
<code>color = "darkgreen"</code> sets the color of the points</li>
</ul>
</li>
<li>The scatter plot with color by continent:
<ul>
<li>We create a simple mapping of countries to continents using <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble()</a></code>.</li>
<li>We join this mapping with our dataset using <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code>.</li>
<li>We create a scatter plot with color by continent using <code>geom_point(aes(color = Continent))</code>.</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The scatter plots reveal the relationship between wheat and rice yields:</p>
<ul>
<li>The basic scatter plot shows the overall relationship between wheat and rice yields.</li>
<li>The scatter plot with color by continent reveals how the relationship varies across different continents.</li>
<li>This visualization helps identify patterns and correlations between wheat and rice yields, providing insights for agricultural policy and development.</li>
<li>The scatter plot can also be used to identify outliers and anomalies in the data.</li>
</ul>
</div>
</div>
</section><section id="correlation-analysis" class="level3" data-number="3.5.2"><h3 data-number="3.5.2" class="anchored" data-anchor-id="correlation-analysis">
<span class="header-section-number">3.5.2</span> Correlation Analysis</h3>
<p>Correlation analysis quantifies the strength and direction of relationships between variables:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Select numeric columns for correlation analysis</span></span>
<span><span class="va">crop_numeric</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">`Rice (tonnes per hectare)`</span>, <span class="va">`Maize (tonnes per hectare)`</span>, <span class="va">`Soybeans (tonnes per hectare)`</span>, <span class="va">`Potatoes (tonnes per hectare)`</span>, <span class="va">`Beans (tonnes per hectare)`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correlation matrix</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">crop_numeric</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">cor_matrix</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;                               Wheat (tonnes per hectare)</span></span>
<span><span class="co">#&gt; Wheat (tonnes per hectare)                          1.00</span></span>
<span><span class="co">#&gt; Rice (tonnes per hectare)                           0.43</span></span>
<span><span class="co">#&gt; Maize (tonnes per hectare)                          0.57</span></span>
<span><span class="co">#&gt; Soybeans (tonnes per hectare)                       0.47</span></span>
<span><span class="co">#&gt; Potatoes (tonnes per hectare)                       0.57</span></span>
<span><span class="co">#&gt; Beans (tonnes per hectare)                          0.44</span></span>
<span><span class="co">#&gt;                               Rice (tonnes per hectare)</span></span>
<span><span class="co">#&gt; Wheat (tonnes per hectare)                         0.43</span></span>
<span><span class="co">#&gt; Rice (tonnes per hectare)                          1.00</span></span>
<span><span class="co">#&gt; Maize (tonnes per hectare)                         0.73</span></span>
<span><span class="co">#&gt; Soybeans (tonnes per hectare)                      0.58</span></span>
<span><span class="co">#&gt; Potatoes (tonnes per hectare)                      0.67</span></span>
<span><span class="co">#&gt; Beans (tonnes per hectare)                         0.46</span></span>
<span><span class="co">#&gt;                               Maize (tonnes per hectare)</span></span>
<span><span class="co">#&gt; Wheat (tonnes per hectare)                          0.57</span></span>
<span><span class="co">#&gt; Rice (tonnes per hectare)                           0.73</span></span>
<span><span class="co">#&gt; Maize (tonnes per hectare)                          1.00</span></span>
<span><span class="co">#&gt; Soybeans (tonnes per hectare)                       0.65</span></span>
<span><span class="co">#&gt; Potatoes (tonnes per hectare)                       0.74</span></span>
<span><span class="co">#&gt; Beans (tonnes per hectare)                          0.63</span></span>
<span><span class="co">#&gt;                               Soybeans (tonnes per hectare)</span></span>
<span><span class="co">#&gt; Wheat (tonnes per hectare)                             0.47</span></span>
<span><span class="co">#&gt; Rice (tonnes per hectare)                              0.58</span></span>
<span><span class="co">#&gt; Maize (tonnes per hectare)                             0.65</span></span>
<span><span class="co">#&gt; Soybeans (tonnes per hectare)                          1.00</span></span>
<span><span class="co">#&gt; Potatoes (tonnes per hectare)                          0.59</span></span>
<span><span class="co">#&gt; Beans (tonnes per hectare)                             0.41</span></span>
<span><span class="co">#&gt;                               Potatoes (tonnes per hectare)</span></span>
<span><span class="co">#&gt; Wheat (tonnes per hectare)                             0.57</span></span>
<span><span class="co">#&gt; Rice (tonnes per hectare)                              0.67</span></span>
<span><span class="co">#&gt; Maize (tonnes per hectare)                             0.74</span></span>
<span><span class="co">#&gt; Soybeans (tonnes per hectare)                          0.59</span></span>
<span><span class="co">#&gt; Potatoes (tonnes per hectare)                          1.00</span></span>
<span><span class="co">#&gt; Beans (tonnes per hectare)                             0.46</span></span>
<span><span class="co">#&gt;                               Beans (tonnes per hectare)</span></span>
<span><span class="co">#&gt; Wheat (tonnes per hectare)                          0.44</span></span>
<span><span class="co">#&gt; Rice (tonnes per hectare)                           0.46</span></span>
<span><span class="co">#&gt; Maize (tonnes per hectare)                          0.63</span></span>
<span><span class="co">#&gt; Soybeans (tonnes per hectare)                       0.41</span></span>
<span><span class="co">#&gt; Potatoes (tonnes per hectare)                       0.46</span></span>
<span><span class="co">#&gt; Beans (tonnes per hectare)                          1.00</span></span>
<span></span>
<span><span class="co"># Visualize correlation matrix</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">cor_matrix</span>, method <span class="op">=</span> <span class="st">"circle"</span>, type <span class="op">=</span> <span class="st">"upper"</span>,</span>
<span>         tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">45</span>,</span>
<span>         title <span class="op">=</span> <span class="st">"Correlation Matrix of Crop Yields"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-correlation-matrix" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-correlation-matrix-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.13: Correlation matrix of crop yields
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform correlation analysis:</p>
<ol type="1">
<li>First, we select the numeric columns of interest for correlation analysis.</li>
<li>We remove any missing values using <code><a href="https://rdrr.io/r/stats/na.fail.html">na.omit()</a></code>.</li>
<li>We calculate the correlation matrix using <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code>.</li>
<li>We round the correlation matrix to 2 decimal places using <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code>.</li>
<li>We visualize the correlation matrix using <code><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot()</a></code>.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The correlation matrix reveals the strength and direction of relationships between variables:</p>
<ul>
<li>The correlation matrix shows the correlation coefficients between each pair of variables.</li>
<li>The correlation coefficients range from -1 (perfect negative correlation) to 1 (perfect positive correlation).</li>
<li>This visualization helps identify strong correlations between variables, providing insights for agricultural policy and development.</li>
<li>The correlation matrix can also be used to identify potential multicollinearity issues in regression analysis.</li>
</ul>
</div>
</div>
</section><section id="pair-plots" class="level3" data-number="3.5.3"><h3 data-number="3.5.3" class="anchored" data-anchor-id="pair-plots">
<span class="header-section-number">3.5.3</span> Pair Plots</h3>
<p>Pair plots provide a comprehensive view of relationships between multiple variables:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Basic pair plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">crop_numeric</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Enhanced pair plot with GGally</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">crop_numeric</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Relationships Between Different Crop Yields"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-pair-plots-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pair-plots-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-pair-plots-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pair-plots-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.14: Basic pair plot of crop yields
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-pair-plots-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pair-plots-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-pair-plots-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pair-plots-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.15: Enhanced pair plot with GGally
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to create pair plots:</p>
<ol type="1">
<li>First, we create a basic pair plot using <code><a href="https://rdrr.io/r/graphics/pairs.html">pairs()</a></code>.</li>
<li>We then create an enhanced pair plot using <code><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs()</a></code> from the GGally package.</li>
<li>The enhanced pair plot includes histograms, scatter plots, and correlation coefficients for each pair of variables.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The pair plots reveal the relationships between multiple variables:</p>
<ul>
<li>The pair plots show the relationships between each pair of variables.</li>
<li>The histograms and scatter plots provide a visual representation of the relationships.</li>
<li>The correlation coefficients provide a quantitative measure of the strength and direction of the relationships.</li>
<li>This visualization helps identify patterns and correlations between multiple variables, providing insights for agricultural policy and development.</li>
</ul>
</div>
</div>
</section></section><section id="identifying-outliers-and-anomalies" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="identifying-outliers-and-anomalies">
<span class="header-section-number">3.6</span> Identifying Outliers and Anomalies</h2>
<section id="box-plots-for-outlier-detection" class="level3" data-number="3.6.1"><h3 data-number="3.6.1" class="anchored" data-anchor-id="box-plots-for-outlier-detection">
<span class="header-section-number">3.6.1</span> Box Plots for Outlier Detection</h3>
<p>Box plots can help identify potential outliers:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Box plot to identify outliers in wheat yield</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">crop_yields</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Box Plot of Wheat Yields with Potential Outliers"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify potential outliers</span></span>
<span><span class="va">wheat_outliers</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>    q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>    iqr <span class="op">=</span> <span class="va">q3</span> <span class="op">-</span> <span class="va">q1</span>,</span>
<span>    lower_bound <span class="op">=</span> <span class="va">q1</span> <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> <span class="va">iqr</span>,</span>
<span>    upper_bound <span class="op">=</span> <span class="va">q3</span> <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> <span class="va">iqr</span>,</span>
<span>    is_outlier <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">&lt;</span> <span class="va">lower_bound</span> <span class="op">|</span> <span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">&gt;</span> <span class="va">upper_bound</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">is_outlier</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Entity</span>, <span class="va">Year</span>, <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the outliers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">wheat_outliers</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 3</span></span>
<span><span class="co">#&gt;    Entity   Year `Wheat (tonnes per hectare)`</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;                        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Austria  2016                         6.25</span></span>
<span><span class="co">#&gt;  2 Belgium  2000                         7.92</span></span>
<span><span class="co">#&gt;  3 Belgium  2001                         8.05</span></span>
<span><span class="co">#&gt;  4 Belgium  2002                         8.28</span></span>
<span><span class="co">#&gt;  5 Belgium  2003                         8.58</span></span>
<span><span class="co">#&gt;  6 Belgium  2004                         8.98</span></span>
<span><span class="co">#&gt;  7 Belgium  2005                         8.27</span></span>
<span><span class="co">#&gt;  8 Belgium  2006                         8.25</span></span>
<span><span class="co">#&gt;  9 Belgium  2007                         7.89</span></span>
<span><span class="co">#&gt; 10 Belgium  2008                         8.76</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-outlier-detection" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-outlier-detection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-outlier-detection-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-outlier-detection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.16: Box plot showing potential outliers in wheat yields
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to use box plots for outlier detection:</p>
<ol type="1">
<li>First, we create a box plot of wheat yields using <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>.</li>
<li>We then identify potential outliers using the interquartile range (IQR) method.</li>
<li>We calculate the lower and upper bounds for outliers using <code>q1 - 1.5 * iqr</code> and <code>q3 + 1.5 * iqr</code>, respectively.</li>
<li>We identify observations that fall outside these bounds as potential outliers.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The box plot and outlier detection reveal potential outliers:</p>
<ul>
<li>The box plot shows the distribution of wheat yields, with potential outliers indicated by points outside the whiskers.</li>
<li>The outlier detection identifies observations that fall outside the lower and upper bounds.</li>
<li>This visualization helps identify potential errors or anomalies in the data, providing insights for data cleaning and quality control.</li>
</ul>
</div>
</div>
</section><section id="z-scores-for-outlier-detection" class="level3" data-number="3.6.2"><h3 data-number="3.6.2" class="anchored" data-anchor-id="z-scores-for-outlier-detection">
<span class="header-section-number">3.6.2</span> Z-Scores for Outlier Detection</h3>
<p>Z-scores can also help identify outliers:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate z-scores for wheat yields</span></span>
<span><span class="va">wheat_z_scores</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    wheat_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span>,</span>
<span>    wheat_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span>,</span>
<span>    z_score <span class="op">=</span> <span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">-</span> <span class="va">wheat_mean</span><span class="op">)</span> <span class="op">/</span> <span class="va">wheat_sd</span>,</span>
<span>    is_extreme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z_score</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display extreme values (z-score &gt; 3 or &lt; -3)</span></span>
<span><span class="va">wheat_extremes</span> <span class="op">&lt;-</span> <span class="va">wheat_z_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">is_extreme</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Entity</span>, <span class="va">Year</span>, <span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">z_score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z_score</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">wheat_extremes</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 4</span></span>
<span><span class="co">#&gt;    Entity       Year `Wheat (tonnes per hectare)` z_score</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt;                        &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Ireland      2015                        10.7     4.88</span></span>
<span><span class="co">#&gt;  2 Ireland      2017                        10.2     4.58</span></span>
<span><span class="co">#&gt;  3 Belgium      2015                        10.0     4.49</span></span>
<span><span class="co">#&gt;  4 Ireland      2014                        10.0     4.49</span></span>
<span><span class="co">#&gt;  5 Zambia       2008                         9.94    4.45</span></span>
<span><span class="co">#&gt;  6 Ireland      2004                         9.92    4.44</span></span>
<span><span class="co">#&gt;  7 New Zealand  2017                         9.86    4.40</span></span>
<span><span class="co">#&gt;  8 Ireland      2011                         9.86    4.40</span></span>
<span><span class="co">#&gt;  9 Ireland      2016                         9.54    4.21</span></span>
<span><span class="co">#&gt; 10 Belgium      2009                         9.47    4.16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to use z-scores for outlier detection:</p>
<ol type="1">
<li>First, we calculate the mean and standard deviation of wheat yields using <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> and <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>, respectively.</li>
<li>We then calculate the z-scores for each observation using <code>(x - mean) / sd</code>.</li>
<li>We identify observations with absolute z-scores greater than 3 as extreme values.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The z-scores reveal extreme values:</p>
<ul>
<li>The z-scores show the number of standard deviations from the mean for each observation.</li>
<li>The extreme values are identified by their absolute z-scores greater than 3.</li>
<li>This visualization helps identify potential outliers or anomalies in the data, providing insights for data cleaning and quality control.</li>
</ul>
</div>
</div>
</section></section><section id="time-series-exploration" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="time-series-exploration">
<span class="header-section-number">3.7</span> Time Series Exploration</h2>
<p>Agricultural data often contains important temporal patterns:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Select a few countries for time series analysis</span></span>
<span><span class="va">countries_for_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"United States"</span>, <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"France"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter data for these countries</span></span>
<span><span class="va">wheat_ts_data</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Entity</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">countries_for_ts</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">1960</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Time series plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">wheat_ts_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span>, color <span class="op">=</span> <span class="va">Entity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wheat Yield Trends Over Time"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-time-series" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-time-series-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-time-series-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-time-series-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.17: Wheat yield trends over time for major producers
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to create a time series plot:</p>
<ol type="1">
<li>First, we select a few countries for time series analysis.</li>
<li>We filter the data for these countries and non-missing wheat yields.</li>
<li>We create a time series plot using <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>.</li>
<li>We add a title, x-axis label, and y-axis label using <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code>.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The time series plot reveals temporal patterns:</p>
<ul>
<li>The time series plot shows the trends in wheat yields over time for each country.</li>
<li>The plot reveals patterns such as increasing or decreasing trends, seasonality, or anomalies.</li>
<li>This visualization helps identify temporal patterns and correlations in the data, providing insights for agricultural policy and development.</li>
</ul>
</div>
</div>
</section><section id="missing-data-analysis" class="level2" data-number="3.8"><h2 data-number="3.8" class="anchored" data-anchor-id="missing-data-analysis">
<span class="header-section-number">3.8</span> Missing Data Analysis</h2>
<p>Understanding patterns of missing data is crucial:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check for missing values in each column</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">crop_yields</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                           Entity                             Code </span></span>
<span><span class="co">#&gt;                                0                             1919 </span></span>
<span><span class="co">#&gt;                             Year       Wheat (tonnes per hectare) </span></span>
<span><span class="co">#&gt;                                0                             4974 </span></span>
<span><span class="co">#&gt;        Rice (tonnes per hectare)       Maize (tonnes per hectare) </span></span>
<span><span class="co">#&gt;                             4604                             2301 </span></span>
<span><span class="co">#&gt;    Soybeans (tonnes per hectare)    Potatoes (tonnes per hectare) </span></span>
<span><span class="co">#&gt;                             7114                             3059 </span></span>
<span><span class="co">#&gt;       Beans (tonnes per hectare)        Peas (tonnes per hectare) </span></span>
<span><span class="co">#&gt;                             5066                             6840 </span></span>
<span><span class="co">#&gt;     Cassava (tonnes per hectare)      Barley (tonnes per hectare) </span></span>
<span><span class="co">#&gt;                             5887                             6342 </span></span>
<span><span class="co">#&gt; Cocoa beans (tonnes per hectare)     Bananas (tonnes per hectare) </span></span>
<span><span class="co">#&gt;                             8466                             4166</span></span>
<span></span>
<span><span class="co"># Visualize missing data patterns</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"naniar"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/njtierney/naniar">naniar</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Create a visualization of missing data</span></span>
<span>  <span class="fu"><a href="https://naniar.njtierney.com/reference/gg_miss_var.html">gg_miss_var</a></span><span class="op">(</span><span class="va">crop_yields</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Create a matrix showing missing data patterns</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/visdat/reference/vis_miss.html">vis_miss</a></span><span class="op">(</span><span class="va">crop_yields</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Entity"</span>, <span class="st">"Year"</span>, <span class="st">"Wheat (tonnes per hectare)"</span>, <span class="st">"Rice (tonnes per hectare)"</span>, <span class="st">"Maize (tonnes per hectare)"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"The 'naniar' package is not installed. Install it with install.packages('naniar') to visualize missing data patterns."</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Alternative: simple summary of missing data</span></span>
<span>  <span class="va">missing_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">crop_yields</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">missing_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    Variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">missing_summary</span><span class="op">)</span>,</span>
<span>    Missing_Count <span class="op">=</span> <span class="va">missing_summary</span>,</span>
<span>    Missing_Percent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">missing_summary</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">crop_yields</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Display the summary</span></span>
<span>  <span class="va">missing_df</span> <span class="op">&lt;-</span> <span class="va">missing_df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">missing_df</span><span class="op">$</span><span class="va">Missing_Count</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">missing_df</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-missing-data" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-missing-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-missing-data-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-missing-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.18: Missing values by variable
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to analyze missing data:</p>
<ol type="1">
<li>First, we check for missing values in each column using <code>colSums(is.na())</code>.</li>
<li>We then visualize missing data patterns using <code><a href="https://naniar.njtierney.com/reference/gg_miss_var.html">gg_miss_var()</a></code> and <code><a href="https://docs.ropensci.org/visdat/reference/vis_miss.html">vis_miss()</a></code> from the naniar package.</li>
<li>If the naniar package is not installed, we provide an alternative summary of missing data using <code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code> and <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code>.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The missing data analysis reveals patterns of missingness:</p>
<ul>
<li>The summary of missing data shows the number and percentage of missing values in each column.</li>
<li>The visualization of missing data patterns reveals the distribution of missing values across different variables.</li>
<li>This analysis helps identify potential issues with data quality and informs strategies for handling missing data.</li>
</ul>
</div>
</div>
</section><section id="summary" class="level2" data-number="3.9"><h2 data-number="3.9" class="anchored" data-anchor-id="summary">
<span class="header-section-number">3.9</span> Summary</h2>
<p>This chapter has demonstrated various techniques for exploratory data analysis using a real agricultural dataset. We’ve covered:</p>
<ol type="1">
<li>Computing and interpreting descriptive statistics</li>
<li>Creating and analyzing frequency tables</li>
<li>Visualizing distributions with histograms, density plots, and box plots</li>
<li>Exploring relationships with scatter plots and correlation analysis</li>
<li>Identifying outliers and anomalies</li>
<li>Analyzing time series patterns</li>
<li>Examining missing data</li>
</ol>
<p>These techniques provide a foundation for understanding your data before proceeding to more advanced analyses. By thoroughly exploring your data, you can make informed decisions about appropriate statistical methods and generate meaningful hypotheses for testing.</p>
</section><section id="exercises" class="level2" data-number="3.10"><h2 data-number="3.10" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">3.10</span> Exercises</h2>
<ol type="1">
<li>Load the plant biodiversity dataset from <code>docs/data/ecology/biodiversity.csv</code> and perform a comprehensive exploratory analysis.</li>
<li>Create a histogram and density plot for another crop in the dataset. How does its distribution compare to wheat?</li>
<li>Investigate the relationship between potato yields and latitude (you’ll need to find or create a dataset with latitude information).</li>
<li>Identify countries with the most significant improvement in crop yields over time.</li>
<li>Create a time series plot showing the ratio of wheat to rice yields over time for major producing countries.</li>
<li>Perform the same exploratory analyses in R for the spatial dataset in <code>docs/data/geography/spatial.csv</code>.</li>
</ol>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/">viridis</a></span><span class="op">)</span>  <span class="co"># For colorblind-friendly palettes</span></span>
<span></span>
<span><span class="co"># Create a sample plant biodiversity dataset since the original is not available</span></span>
<span><span class="co"># This simulates conservation status data across different regions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span>
<span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"North America"</span>, <span class="st">"South America"</span>, <span class="st">"Europe"</span>, <span class="st">"Africa"</span>, <span class="st">"Asia"</span>, <span class="st">"Oceania"</span><span class="op">)</span></span>
<span><span class="va">statuses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Least Concern"</span>, <span class="st">"Near Threatened"</span>, <span class="st">"Vulnerable"</span>, <span class="st">"Endangered"</span>, <span class="st">"Critically Endangered"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create sample data with 200 observations</span></span>
<span><span class="va">plant_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">regions</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  conservation_status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">statuses</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set a professional theme for all plots</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a bar chart of conservation status</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">plant_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">region</span>, fill <span class="op">=</span> <span class="va">conservation_status</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Conservation Status of Plant Species by Region"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of Species"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Conservation Status"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-conservation-status" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-conservation-status-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-exploratory-analysis_files/figure-html/fig-conservation-status-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-conservation-status-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.19: Conservation status of plant species by region
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates professional visualization techniques:</p>
<ol type="1">
<li>
<strong>Package Setup</strong>:
<ul>
<li>
<code>tidyverse</code> for data manipulation</li>
<li>
<code>ggplot2</code> for creating plots</li>
<li>
<code>viridis</code> for colorblind-friendly color palettes</li>
</ul>
</li>
<li>
<strong>Theme Customization</strong>:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/get_theme.html">theme_set()</a></code> applies consistent styling</li>
<li>Customizes text appearance for titles and labels</li>
<li>Ensures professional look across all plots</li>
</ul>
</li>
<li>
<strong>Plot Construction</strong>:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> creates the base plot</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> defines aesthetic mappings</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> creates stacked bars</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d()</a></code> applies colorblind-friendly colors</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The visualization reveals important patterns:</p>
<ol type="1">
<li>
<strong>Regional Distribution</strong>:
<ul>
<li>Different regions show varying numbers of species</li>
<li>Some regions have more diverse plant communities</li>
<li>Conservation status varies across regions</li>
</ul>
</li>
<li>
<strong>Conservation Status</strong>:
<ul>
<li>Proportion of threatened species varies by region</li>
<li>Some regions have better conservation outcomes</li>
<li>Areas needing conservation attention are visible</li>
</ul>
</li>
<li>
<strong>Data Quality</strong>:
<ul>
<li>Completeness of conservation status data</li>
<li>Potential gaps in monitoring</li>
<li>Regional differences in data collection</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PROFESSIONAL TIP: Visualization Best Practices
</div>
</div>
<div class="callout-body-container callout-body">
<p>When creating scientific visualizations:</p>
<ol type="1">
<li>
<strong>Design Principles</strong>:
<ul>
<li>Use clear, readable fonts</li>
<li>Choose appropriate color schemes</li>
<li>Maintain consistent styling</li>
<li>Include informative titles and labels</li>
</ul>
</li>
<li>
<strong>Accessibility</strong>:
<ul>
<li>Use colorblind-friendly palettes</li>
<li>Ensure sufficient contrast</li>
<li>Provide clear legends</li>
<li>Consider alternative text</li>
</ul>
</li>
<li>
<strong>Data Representation</strong>:
<ul>
<li>Choose appropriate plot types</li>
<li>Scale axes appropriately</li>
<li>Handle missing data clearly</li>
<li>Consider data density</li>
</ul>
</li>
</ol>
</div>
</div>
</section><section id="chapter-summary" class="level2" data-number="3.11"><h2 data-number="3.11" class="anchored" data-anchor-id="chapter-summary">
<span class="header-section-number">3.11</span> Chapter Summary</h2>
<section id="key-concepts" class="level3" data-number="3.11.1"><h3 data-number="3.11.1" class="anchored" data-anchor-id="key-concepts">
<span class="header-section-number">3.11.1</span> Key Concepts</h3>
<ul>
<li>
<strong>Descriptive Statistics</strong>: Measures of central tendency (mean, median) and dispersion (SD, IQR) summarize data properties</li>
<li>
<strong>Data Distributions</strong>: Visualizing distributions helps identify skewness, multimodality, and outliers</li>
<li>
<strong>Relationships</strong>: Scatter plots and correlation matrices reveal associations between variables</li>
<li>
<strong>Outliers</strong>: Identifying extreme values is crucial for data quality and robust analysis</li>
<li>
<strong>Missing Data</strong>: Understanding missingness patterns informs appropriate handling strategies</li>
</ul></section><section id="r-functions-learned" class="level3" data-number="3.11.2"><h3 data-number="3.11.2" class="anchored" data-anchor-id="r-functions-learned">
<span class="header-section-number">3.11.2</span> R Functions Learned</h3>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> - Calculate summary statistics</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> / <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> - Visualize distributions</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> - Compare distributions and identify outliers</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> - Create scatter plots</li>
<li>
<code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> - Calculate correlation coefficients</li>
<li>
<code><a href="https://rdrr.io/r/graphics/pairs.html">pairs()</a></code> / <code><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs()</a></code> - Create pair plots for multiple variables</li>
<li>
<code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> - Detect missing values</li>
</ul></section><section id="next-steps" class="level3" data-number="3.11.3"><h3 data-number="3.11.3" class="anchored" data-anchor-id="next-steps">
<span class="header-section-number">3.11.3</span> Next Steps</h3>
<p>In the next chapter, we will move from exploration to inference, learning how to formulate and test scientific hypotheses using statistical methods.</p>
</section></section><section id="exercises-1" class="level2" data-number="3.12"><h2 data-number="3.12" class="anchored" data-anchor-id="exercises-1">
<span class="header-section-number">3.12</span> Exercises</h2>
<ol type="1">
<li>
<strong>Descriptive Statistics</strong>: Calculate the mean, median, and standard deviation for a continuous variable in your own dataset.</li>
<li>
<strong>Distribution Visualization</strong>: Create a histogram and density plot for the same variable. Describe the shape of the distribution.</li>
<li>
<strong>Group Comparison</strong>: Use box plots to compare the distribution of a continuous variable across different groups (e.g., species, treatments).</li>
<li>
<strong>Correlation Analysis</strong>: Calculate the correlation matrix for a set of continuous variables and visualize it using a heatmap or pair plot.</li>
<li>
<strong>Outlier Detection</strong>: Identify potential outliers in your dataset using the IQR method or Z-scores.</li>
<li>
<strong>Missing Data</strong>: Visualize missing data patterns in your dataset and discuss potential reasons for missingness.</li>
</ol>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("^(?:http:|https:)\/\/jm0535\.github\.io\/dains");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/02-data-basics.html" class="pagination-link" aria-label="Data Basics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Basics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/04-hypothesis-testing.html" class="pagination-link" aria-label="Hypothesis Testing">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb19" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="an">prefer-html:</span><span class="co"> true</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploratory Data Analysis</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Objectives</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Calculate and interpret descriptive statistics (mean, median, standard deviation)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Create and analyze frequency tables for categorical data</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Visualize distributions using histograms, density plots, and box plots</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Explore relationships between variables using scatter plots and correlation matrices</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Identify outliers and anomalies using statistical methods and visualizations</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Analyze missing data patterns and their potential impact</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>Exploratory Data Analysis (EDA) is a critical first step in any data analysis project. In this chapter, you'll learn how to systematically explore your data to understand its structure, identify patterns, detect anomalies, and generate hypotheses for further investigation.</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Purpose of Exploratory Data Analysis</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>Exploratory Data Analysis serves several important purposes in natural sciences research:</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Understanding Data Structure**: Gain insights into the basic properties of your dataset</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Checking Data Quality**: Identify missing values, outliers, and potential errors</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Discovering Patterns**: Detect relationships, trends, and distributions</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Generating Hypotheses**: Develop questions and hypotheses for formal testing</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Informing Analysis Choices**: Guide decisions about appropriate statistical methods</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## PROFESSIONAL TIP: Creating Reproducible EDA Workflows</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>To ensure your exploratory data analysis is reproducible and transparent:</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Document all data transformations**: Record every cleaning step, filter, and transformation applied to raw data</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Use R Markdown or Quarto**: Create executable documents that combine code, output, and narrative explanation</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Version control your analysis**: Track changes to your EDA scripts using Git or similar tools</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Save exploratory outputs**: Store key visualizations and summary statistics in organized directories</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Create clear data lineage**: Document the origin of each dataset and how it connects to derived datasets</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Use consistent naming conventions**: Apply systematic naming to files, variables, and functions</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Separate exploration from confirmation**: Clearly distinguish exploratory analyses from confirmatory hypothesis testing</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Include data validation checks**: Incorporate automated checks for data integrity and quality</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Provide detailed method documentation**: Document statistical approaches like ANOVA types (e.g., Type II tests for unbalanced designs)</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Share your EDA code**: Make your exploratory scripts available alongside final analyses for complete transparency</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summarizing Data</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a><span class="fu">### Descriptive Statistics</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>Descriptive statistics provide a concise summary of your data's central tendency, dispersion, and shape:</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-crop-yields</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the crop yield dataset</span></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>crop_yields <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/agriculture/crop_yields.csv"</span>)</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Get summary statistics for wheat yields</span></span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>wheat_summary <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> <span class="fu">median</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">StdDev =</span> <span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">min</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">max</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q1 =</span> <span class="fu">quantile</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q3 =</span> <span class="fu">quantile</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-wheat-summary-stats</span></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Summary Statistics for Global Wheat Yields"</span></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics</span></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(wheat_summary)</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-descriptive-stats</span></span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of global wheat yields"</span></span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the distribution of wheat yields</span></span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_yields, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"forestgreen"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Global Wheat Yields"</span>,</span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-top-wheat-countries</span></span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Top 10 Countries by Average Wheat Yield"</span></span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify top wheat-producing countries (by average yield)</span></span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a>top_wheat_countries <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Entity) <span class="sc">%&gt;%</span></span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Avg_Yield =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Avg_Yield)) <span class="sc">%&gt;%</span></span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the top countries</span></span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(top_wheat_countries)</span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a>This code block demonstrates how to calculate and visualize descriptive statistics:</span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`library(tidyverse)`</span> loads the tidyverse collection of packages for data manipulation and visualization.</span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="in">`read_csv()`</span> imports the crop yields dataset from a CSV file.</span>
<span id="cb19-133"><a href="#cb19-133" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="in">`head()`</span> displays the first few rows to inspect the data structure.</span>
<span id="cb19-134"><a href="#cb19-134" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>The <span class="in">`summarize()`</span> function calculates key statistics for wheat yields:</span>
<span id="cb19-135"><a href="#cb19-135" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`Mean`</span>: Average yield across all observations</span>
<span id="cb19-136"><a href="#cb19-136" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`Median`</span>: Middle value when yields are arranged in order</span>
<span id="cb19-137"><a href="#cb19-137" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`StdDev`</span>: Standard deviation, measuring data dispersion</span>
<span id="cb19-138"><a href="#cb19-138" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`Min/Max`</span>: Minimum and maximum values in the dataset</span>
<span id="cb19-139"><a href="#cb19-139" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`Q1/Q3`</span>: First and third quartiles (25th and 75th percentiles)</span>
<span id="cb19-140"><a href="#cb19-140" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span><span class="in">`knitr::kable()`</span> creates a formatted table of the summary statistics.</span>
<span id="cb19-141"><a href="#cb19-141" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span><span class="in">`ggplot()`</span> with <span class="in">`geom_histogram()`</span> visualizes the distribution of wheat yields.</span>
<span id="cb19-142"><a href="#cb19-142" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>The final section identifies and displays the top 10 countries by average wheat yield using:</span>
<span id="cb19-143"><a href="#cb19-143" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`group_by()`</span> to organize data by country</span>
<span id="cb19-144"><a href="#cb19-144" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`summarize()`</span> to calculate average yield per country</span>
<span id="cb19-145"><a href="#cb19-145" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`arrange(desc())`</span> to sort in descending order</span>
<span id="cb19-146"><a href="#cb19-146" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`head(10)`</span> to select the top 10 entries</span>
<span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-148"><a href="#cb19-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-149"><a href="#cb19-149" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-150"><a href="#cb19-150" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-151"><a href="#cb19-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-152"><a href="#cb19-152" aria-hidden="true" tabindex="-1"></a>The summary statistics reveal several key insights about global wheat yields:</span>
<span id="cb19-153"><a href="#cb19-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-154"><a href="#cb19-154" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The mean wheat yield is higher than the median, suggesting a right-skewed distribution with some countries achieving exceptionally high yields.</span>
<span id="cb19-155"><a href="#cb19-155" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The standard deviation indicates substantial variability in wheat productivity across different regions.</span>
<span id="cb19-156"><a href="#cb19-156" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The histogram confirms this skewed distribution, with most countries clustered at lower to moderate yield levels, and fewer countries achieving very high yields.</span>
<span id="cb19-157"><a href="#cb19-157" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The top 10 countries table shows which nations have the most productive wheat cultivation systems, likely due to advanced agricultural practices, favorable climate conditions, or intensive farming methods.</span>
<span id="cb19-158"><a href="#cb19-158" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This analysis provides a foundation for investigating factors that contribute to high wheat yields and potential strategies for improving agricultural productivity in lower-yielding regions.</span>
<span id="cb19-159"><a href="#cb19-159" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-160"><a href="#cb19-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-161"><a href="#cb19-161" aria-hidden="true" tabindex="-1"></a><span class="fu">### Frequency Tables</span></span>
<span id="cb19-162"><a href="#cb19-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-163"><a href="#cb19-163" aria-hidden="true" tabindex="-1"></a>Frequency tables are useful for understanding the distribution of categorical variables:</span>
<span id="cb19-164"><a href="#cb19-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-167"><a href="#cb19-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-168"><a href="#cb19-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: frequency-tables</span></span>
<span id="cb19-169"><a href="#cb19-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-170"><a href="#cb19-170" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's create a categorical variable based on wheat yield levels</span></span>
<span id="cb19-171"><a href="#cb19-171" aria-hidden="true" tabindex="-1"></a>crop_yields_with_categories <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-172"><a href="#cb19-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-173"><a href="#cb19-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yield_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-174"><a href="#cb19-174" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb19-175"><a href="#cb19-175" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb19-176"><a href="#cb19-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">&gt;=</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"High"</span></span>
<span id="cb19-177"><a href="#cb19-177" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb19-178"><a href="#cb19-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-179"><a href="#cb19-179" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency table for yield categories</span></span>
<span id="cb19-180"><a href="#cb19-180" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(crop_yields_with_categories<span class="sc">$</span>yield_category)</span>
<span id="cb19-181"><a href="#cb19-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-182"><a href="#cb19-182" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions</span></span>
<span id="cb19-183"><a href="#cb19-183" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(crop_yields_with_categories<span class="sc">$</span>yield_category))</span>
<span id="cb19-184"><a href="#cb19-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-185"><a href="#cb19-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a decade variable for temporal analysis</span></span>
<span id="cb19-186"><a href="#cb19-186" aria-hidden="true" tabindex="-1"></a>crop_yields_with_categories <span class="ot">&lt;-</span> crop_yields_with_categories <span class="sc">%&gt;%</span></span>
<span id="cb19-187"><a href="#cb19-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(Year <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>)</span>
<span id="cb19-188"><a href="#cb19-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-189"><a href="#cb19-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-way frequency table: yield category by decade</span></span>
<span id="cb19-190"><a href="#cb19-190" aria-hidden="true" tabindex="-1"></a>yield_decade_table <span class="ot">&lt;-</span> <span class="fu">table</span>(crop_yields_with_categories<span class="sc">$</span>yield_category,</span>
<span id="cb19-191"><a href="#cb19-191" aria-hidden="true" tabindex="-1"></a>                            crop_yields_with_categories<span class="sc">$</span>decade)</span>
<span id="cb19-192"><a href="#cb19-192" aria-hidden="true" tabindex="-1"></a>yield_decade_table</span>
<span id="cb19-193"><a href="#cb19-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-194"><a href="#cb19-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to proportions (by row)</span></span>
<span id="cb19-195"><a href="#cb19-195" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(yield_decade_table, <span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb19-196"><a href="#cb19-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-197"><a href="#cb19-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-198"><a href="#cb19-198" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-199"><a href="#cb19-199" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-200"><a href="#cb19-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-201"><a href="#cb19-201" aria-hidden="true" tabindex="-1"></a>This code block demonstrates how to create and analyze frequency tables:</span>
<span id="cb19-202"><a href="#cb19-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-203"><a href="#cb19-203" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`mutate()`</span> with <span class="in">`case_when()`</span> creates a new categorical variable <span class="in">`yield_category`</span> by binning wheat yields into "Low," "Medium," and "High" categories.</span>
<span id="cb19-204"><a href="#cb19-204" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="in">`table()`</span> produces a frequency count for each yield category.</span>
<span id="cb19-205"><a href="#cb19-205" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="in">`prop.table()`</span> converts the frequency counts to proportions (relative frequencies).</span>
<span id="cb19-206"><a href="#cb19-206" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>A new variable <span class="in">`decade`</span> is created by rounding down the year to the nearest decade using <span class="in">`floor(Year / 10) * 10`</span>.</span>
<span id="cb19-207"><a href="#cb19-207" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>A two-way frequency table is created to examine the relationship between yield categories and decades.</span>
<span id="cb19-208"><a href="#cb19-208" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span><span class="in">`prop.table(yield_decade_table, margin = 1)`</span> calculates row proportions, showing the distribution of decades within each yield category.</span>
<span id="cb19-209"><a href="#cb19-209" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-210"><a href="#cb19-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-211"><a href="#cb19-211" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-212"><a href="#cb19-212" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-213"><a href="#cb19-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-214"><a href="#cb19-214" aria-hidden="true" tabindex="-1"></a>The frequency tables reveal important patterns in wheat yield categories:</span>
<span id="cb19-215"><a href="#cb19-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-216"><a href="#cb19-216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The distribution of yield categories shows which productivity levels are most common globally.</span>
<span id="cb19-217"><a href="#cb19-217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The proportions table quantifies this distribution, indicating what percentage of observations fall into each yield category.</span>
<span id="cb19-218"><a href="#cb19-218" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The two-way table between yield categories and decades allows us to track how wheat productivity has changed over time.</span>
<span id="cb19-219"><a href="#cb19-219" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The row proportions reveal whether certain yield categories have become more or less common in different decades, potentially indicating technological improvements, climate effects, or changes in agricultural practices.</span>
<span id="cb19-220"><a href="#cb19-220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>These temporal patterns are crucial for understanding agricultural development trends and projecting future food security scenarios.</span>
<span id="cb19-221"><a href="#cb19-221" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-222"><a href="#cb19-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-223"><a href="#cb19-223" aria-hidden="true" tabindex="-1"></a><span class="fu">### Box Plots</span></span>
<span id="cb19-224"><a href="#cb19-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-225"><a href="#cb19-225" aria-hidden="true" tabindex="-1"></a>Box plots are excellent for comparing distributions across groups:</span>
<span id="cb19-226"><a href="#cb19-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-229"><a href="#cb19-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-230"><a href="#cb19-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplots-summary</span></span>
<span id="cb19-231"><a href="#cb19-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap:</span></span>
<span id="cb19-232"><a href="#cb19-232" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Wheat yields by country"</span></span>
<span id="cb19-233"><a href="#cb19-233" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Enhanced boxplot with data points"</span></span>
<span id="cb19-234"><a href="#cb19-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-235"><a href="#cb19-235" aria-hidden="true" tabindex="-1"></a><span class="co"># Select a few major countries for comparison</span></span>
<span id="cb19-236"><a href="#cb19-236" aria-hidden="true" tabindex="-1"></a>major_wheat_producers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Russia"</span>, <span class="st">"France"</span>, <span class="st">"Australia"</span>)</span>
<span id="cb19-237"><a href="#cb19-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-238"><a href="#cb19-238" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for these countries and recent years</span></span>
<span id="cb19-239"><a href="#cb19-239" aria-hidden="true" tabindex="-1"></a>recent_wheat_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-240"><a href="#cb19-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Entity <span class="sc">%in%</span> major_wheat_producers,</span>
<span id="cb19-241"><a href="#cb19-241" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">&gt;=</span> <span class="dv">2000</span>,</span>
<span id="cb19-242"><a href="#cb19-242" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>))</span>
<span id="cb19-243"><a href="#cb19-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-244"><a href="#cb19-244" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot of wheat yields by country</span></span>
<span id="cb19-245"><a href="#cb19-245" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recent_wheat_data, <span class="fu">aes</span>(<span class="at">x =</span> Entity, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-246"><a href="#cb19-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb19-247"><a href="#cb19-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yields by Country (2000-present)"</span>,</span>
<span id="cb19-248"><a href="#cb19-248" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb19-249"><a href="#cb19-249" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb19-250"><a href="#cb19-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-251"><a href="#cb19-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb19-252"><a href="#cb19-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-253"><a href="#cb19-253" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced box plot with jittered points</span></span>
<span id="cb19-254"><a href="#cb19-254" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recent_wheat_data, <span class="fu">aes</span>(<span class="at">x =</span> Entity, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-255"><a href="#cb19-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-256"><a href="#cb19-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb19-257"><a href="#cb19-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yields by Country (2000-present)"</span>,</span>
<span id="cb19-258"><a href="#cb19-258" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb19-259"><a href="#cb19-259" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb19-260"><a href="#cb19-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-261"><a href="#cb19-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb19-262"><a href="#cb19-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-263"><a href="#cb19-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-264"><a href="#cb19-264" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-265"><a href="#cb19-265" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-266"><a href="#cb19-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-267"><a href="#cb19-267" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to create and enhance box plots for comparing distributions:</span>
<span id="cb19-268"><a href="#cb19-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-269"><a href="#cb19-269" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we select major wheat-producing countries for comparison and filter for recent data (since 2000).</span>
<span id="cb19-270"><a href="#cb19-270" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The basic box plot:</span>
<span id="cb19-271"><a href="#cb19-271" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_boxplot()`</span> creates a box-and-whisker plot for each country</span>
<span id="cb19-272"><a href="#cb19-272" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Each box shows the median (middle line), interquartile range (IQR, the box), and whiskers extending to 1.5 × IQR</span>
<span id="cb19-273"><a href="#cb19-273" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Points beyond the whiskers represent outliers</span>
<span id="cb19-274"><a href="#cb19-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-275"><a href="#cb19-275" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The enhanced box plot adds:</span>
<span id="cb19-276"><a href="#cb19-276" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_jitter()`</span> to display individual data points with slight horizontal displacement</span>
<span id="cb19-277"><a href="#cb19-277" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This combination shows both the summary statistics (box plot) and the raw data distribution (points)</span>
<span id="cb19-278"><a href="#cb19-278" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`angle = 45, hjust = 1`</span> rotates country labels for better readability</span>
<span id="cb19-279"><a href="#cb19-279" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-280"><a href="#cb19-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-281"><a href="#cb19-281" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-282"><a href="#cb19-282" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-283"><a href="#cb19-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-284"><a href="#cb19-284" aria-hidden="true" tabindex="-1"></a>The box plots reveal important comparisons between major wheat-producing countries:</span>
<span id="cb19-285"><a href="#cb19-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-286"><a href="#cb19-286" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The median line in each box shows the typical yield for each country, allowing direct comparison of central tendency.</span>
<span id="cb19-287"><a href="#cb19-287" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The height of each box (IQR) indicates the variability of yields within each country over the time period.</span>
<span id="cb19-288"><a href="#cb19-288" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Whisker length reflects the range of typical yields, while outlier points show exceptional years.</span>
<span id="cb19-289"><a href="#cb19-289" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Countries with higher boxes generally have more variable production, possibly due to climate fluctuations or changing agricultural practices.</span>
<span id="cb19-290"><a href="#cb19-290" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The jittered points reveal the actual distribution and density of observations for each country.</span>
<span id="cb19-291"><a href="#cb19-291" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>These comparisons help identify which countries have the most consistent and productive wheat cultivation systems, providing insights for agricultural policy and development.</span>
<span id="cb19-292"><a href="#cb19-292" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-293"><a href="#cb19-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-294"><a href="#cb19-294" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bar Charts</span></span>
<span id="cb19-295"><a href="#cb19-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-296"><a href="#cb19-296" aria-hidden="true" tabindex="-1"></a>Bar charts are useful for visualizing categorical data:</span>
<span id="cb19-297"><a href="#cb19-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-300"><a href="#cb19-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-301"><a href="#cb19-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-barchart-yields</span></span>
<span id="cb19-302"><a href="#cb19-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Top 10 countries by average wheat yield (2010-present)"</span></span>
<span id="cb19-303"><a href="#cb19-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-304"><a href="#cb19-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average wheat yield by country for the last decade</span></span>
<span id="cb19-305"><a href="#cb19-305" aria-hidden="true" tabindex="-1"></a>recent_avg_yields <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-306"><a href="#cb19-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2010</span>, <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-307"><a href="#cb19-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Entity) <span class="sc">%&gt;%</span></span>
<span id="cb19-308"><a href="#cb19-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_wheat_yield =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-309"><a href="#cb19-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_wheat_yield)) <span class="sc">%&gt;%</span></span>
<span id="cb19-310"><a href="#cb19-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)  <span class="co"># Top 10 countries</span></span>
<span id="cb19-311"><a href="#cb19-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-312"><a href="#cb19-312" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart of average wheat yields</span></span>
<span id="cb19-313"><a href="#cb19-313" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recent_avg_yields, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Entity, avg_wheat_yield), <span class="at">y =</span> avg_wheat_yield)) <span class="sc">+</span></span>
<span id="cb19-314"><a href="#cb19-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb19-315"><a href="#cb19-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Countries by Average Wheat Yield (2010-present)"</span>,</span>
<span id="cb19-316"><a href="#cb19-316" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb19-317"><a href="#cb19-317" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Wheat Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb19-318"><a href="#cb19-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-319"><a href="#cb19-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb19-320"><a href="#cb19-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-321"><a href="#cb19-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-322"><a href="#cb19-322" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-323"><a href="#cb19-323" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-324"><a href="#cb19-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-325"><a href="#cb19-325" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to create a bar chart for visualizing categorical data:</span>
<span id="cb19-326"><a href="#cb19-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-327"><a href="#cb19-327" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we calculate the average wheat yield by country for the last decade (2010-present).</span>
<span id="cb19-328"><a href="#cb19-328" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>We then select the top 10 countries by average yield.</span>
<span id="cb19-329"><a href="#cb19-329" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The bar chart:</span>
<span id="cb19-330"><a href="#cb19-330" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_bar(stat = "identity")`</span> creates a bar for each country, with height proportional to average yield</span>
<span id="cb19-331"><a href="#cb19-331" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`reorder(Entity, avg_wheat_yield)`</span> sorts the countries by average yield in descending order</span>
<span id="cb19-332"><a href="#cb19-332" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`fill = "darkgreen"`</span> sets the bar color</span>
<span id="cb19-333"><a href="#cb19-333" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`theme(axis.text.x = element_text(angle = 45, hjust = 1))`</span> rotates country labels for better readability</span>
<span id="cb19-334"><a href="#cb19-334" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-335"><a href="#cb19-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-336"><a href="#cb19-336" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-337"><a href="#cb19-337" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-338"><a href="#cb19-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-339"><a href="#cb19-339" aria-hidden="true" tabindex="-1"></a>The bar chart reveals the top 10 countries by average wheat yield:</span>
<span id="cb19-340"><a href="#cb19-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-341"><a href="#cb19-341" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The height of each bar represents the average yield for each country.</span>
<span id="cb19-342"><a href="#cb19-342" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The countries are sorted in descending order by average yield, making it easy to identify the most productive nations.</span>
<span id="cb19-343"><a href="#cb19-343" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This visualization helps identify which countries have the most efficient wheat cultivation systems, providing insights for agricultural policy and development.</span>
<span id="cb19-344"><a href="#cb19-344" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The bar chart can also be used to compare the average yields of different countries, helping to identify potential areas for improvement.</span>
<span id="cb19-345"><a href="#cb19-345" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-346"><a href="#cb19-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-347"><a href="#cb19-347" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualizing Distributions</span></span>
<span id="cb19-348"><a href="#cb19-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-349"><a href="#cb19-349" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histograms and Density Plots</span></span>
<span id="cb19-350"><a href="#cb19-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-351"><a href="#cb19-351" aria-hidden="true" tabindex="-1"></a>Histograms and density plots help visualize the distribution of continuous variables:</span>
<span id="cb19-352"><a href="#cb19-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-355"><a href="#cb19-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-356"><a href="#cb19-356" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-distributions</span></span>
<span id="cb19-357"><a href="#cb19-357" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap:</span></span>
<span id="cb19-358"><a href="#cb19-358" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Histogram of wheat yields"</span></span>
<span id="cb19-359"><a href="#cb19-359" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Density plot of wheat yields"</span></span>
<span id="cb19-360"><a href="#cb19-360" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Combined histogram with density overlay"</span></span>
<span id="cb19-361"><a href="#cb19-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-362"><a href="#cb19-362" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram of wheat yields</span></span>
<span id="cb19-363"><a href="#cb19-363" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_yields, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-364"><a href="#cb19-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-365"><a href="#cb19-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Wheat Yields"</span>,</span>
<span id="cb19-366"><a href="#cb19-366" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span id="cb19-367"><a href="#cb19-367" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb19-368"><a href="#cb19-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb19-369"><a href="#cb19-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-370"><a href="#cb19-370" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot</span></span>
<span id="cb19-371"><a href="#cb19-371" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_yields, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-372"><a href="#cb19-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-373"><a href="#cb19-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density Plot of Wheat Yields"</span>,</span>
<span id="cb19-374"><a href="#cb19-374" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span id="cb19-375"><a href="#cb19-375" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb19-376"><a href="#cb19-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb19-377"><a href="#cb19-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-378"><a href="#cb19-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram with density overlay</span></span>
<span id="cb19-379"><a href="#cb19-379" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_yields, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-380"><a href="#cb19-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-381"><a href="#cb19-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-382"><a href="#cb19-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Wheat Yields"</span>,</span>
<span id="cb19-383"><a href="#cb19-383" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span id="cb19-384"><a href="#cb19-384" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb19-385"><a href="#cb19-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb19-386"><a href="#cb19-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-387"><a href="#cb19-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-388"><a href="#cb19-388" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-389"><a href="#cb19-389" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-390"><a href="#cb19-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-391"><a href="#cb19-391" aria-hidden="true" tabindex="-1"></a>This code demonstrates three approaches to visualizing distributions:</span>
<span id="cb19-392"><a href="#cb19-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-393"><a href="#cb19-393" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Histogram**:</span>
<span id="cb19-394"><a href="#cb19-394" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_histogram()`</span> divides the data into bins and counts observations in each bin</span>
<span id="cb19-395"><a href="#cb19-395" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`bins = 30`</span> specifies the number of divisions</span>
<span id="cb19-396"><a href="#cb19-396" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`na.rm = TRUE`</span> removes missing values from the visualization</span>
<span id="cb19-397"><a href="#cb19-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-398"><a href="#cb19-398" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Density Plot**:</span>
<span id="cb19-399"><a href="#cb19-399" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_density()`</span> creates a smoothed representation of the distribution</span>
<span id="cb19-400"><a href="#cb19-400" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`fill`</span> and <span class="in">`alpha`</span> control the appearance and transparency</span>
<span id="cb19-401"><a href="#cb19-401" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Density plots show the probability density function of the data</span>
<span id="cb19-402"><a href="#cb19-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-403"><a href="#cb19-403" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Combined Visualization**:</span>
<span id="cb19-404"><a href="#cb19-404" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The histogram is converted to density scale with <span class="in">`aes(y = after_stat(density))`</span></span>
<span id="cb19-405"><a href="#cb19-405" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_density()`</span> overlays a smoothed curve on the histogram</span>
<span id="cb19-406"><a href="#cb19-406" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This combination shows both the raw data structure and the smoothed distribution</span>
<span id="cb19-407"><a href="#cb19-407" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-408"><a href="#cb19-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-409"><a href="#cb19-409" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-410"><a href="#cb19-410" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-411"><a href="#cb19-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-412"><a href="#cb19-412" aria-hidden="true" tabindex="-1"></a>These distribution visualizations reveal key patterns in wheat yields:</span>
<span id="cb19-413"><a href="#cb19-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-414"><a href="#cb19-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The histogram shows the frequency of observations at different yield levels, highlighting where most countries cluster.</span>
<span id="cb19-415"><a href="#cb19-415" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The density plot smooths the distribution, making it easier to identify the central tendency and spread.</span>
<span id="cb19-416"><a href="#cb19-416" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The combined plot allows us to see both the actual data distribution (histogram) and the underlying probability density (curve).</span>
<span id="cb19-417"><a href="#cb19-417" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The right-skewed shape indicates that while most countries have moderate yields, a few achieve exceptionally high productivity.</span>
<span id="cb19-418"><a href="#cb19-418" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multiple peaks (if present) might suggest distinct groups of countries with different agricultural technologies or growing conditions.</span>
<span id="cb19-419"><a href="#cb19-419" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>These visualizations help identify outliers and understand the overall pattern of global wheat production efficiency.</span>
<span id="cb19-420"><a href="#cb19-420" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-421"><a href="#cb19-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-422"><a href="#cb19-422" aria-hidden="true" tabindex="-1"></a><span class="fu">### Box Plots</span></span>
<span id="cb19-423"><a href="#cb19-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-424"><a href="#cb19-424" aria-hidden="true" tabindex="-1"></a>Box plots are excellent for comparing distributions across groups:</span>
<span id="cb19-425"><a href="#cb19-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-428"><a href="#cb19-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-429"><a href="#cb19-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplots-visualizing</span></span>
<span id="cb19-430"><a href="#cb19-430" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap:</span></span>
<span id="cb19-431"><a href="#cb19-431" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Country comparison boxplot"</span></span>
<span id="cb19-432"><a href="#cb19-432" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Boxplot with jittered observations"</span></span>
<span id="cb19-433"><a href="#cb19-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-434"><a href="#cb19-434" aria-hidden="true" tabindex="-1"></a><span class="co"># Select a few major countries for comparison</span></span>
<span id="cb19-435"><a href="#cb19-435" aria-hidden="true" tabindex="-1"></a>major_wheat_producers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Russia"</span>, <span class="st">"France"</span>, <span class="st">"Australia"</span>)</span>
<span id="cb19-436"><a href="#cb19-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-437"><a href="#cb19-437" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for these countries and recent years</span></span>
<span id="cb19-438"><a href="#cb19-438" aria-hidden="true" tabindex="-1"></a>recent_wheat_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-439"><a href="#cb19-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Entity <span class="sc">%in%</span> major_wheat_producers,</span>
<span id="cb19-440"><a href="#cb19-440" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">&gt;=</span> <span class="dv">2000</span>,</span>
<span id="cb19-441"><a href="#cb19-441" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>))</span>
<span id="cb19-442"><a href="#cb19-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-443"><a href="#cb19-443" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot of wheat yields by country</span></span>
<span id="cb19-444"><a href="#cb19-444" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recent_wheat_data, <span class="fu">aes</span>(<span class="at">x =</span> Entity, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-445"><a href="#cb19-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb19-446"><a href="#cb19-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yields by Country (2000-present)"</span>,</span>
<span id="cb19-447"><a href="#cb19-447" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb19-448"><a href="#cb19-448" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb19-449"><a href="#cb19-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-450"><a href="#cb19-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb19-451"><a href="#cb19-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-452"><a href="#cb19-452" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced box plot with jittered points</span></span>
<span id="cb19-453"><a href="#cb19-453" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recent_wheat_data, <span class="fu">aes</span>(<span class="at">x =</span> Entity, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-454"><a href="#cb19-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-455"><a href="#cb19-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb19-456"><a href="#cb19-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yields by Country (2000-present)"</span>,</span>
<span id="cb19-457"><a href="#cb19-457" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb19-458"><a href="#cb19-458" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb19-459"><a href="#cb19-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-460"><a href="#cb19-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb19-461"><a href="#cb19-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-462"><a href="#cb19-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-463"><a href="#cb19-463" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-464"><a href="#cb19-464" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-465"><a href="#cb19-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-466"><a href="#cb19-466" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to create and enhance box plots for comparing distributions:</span>
<span id="cb19-467"><a href="#cb19-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-468"><a href="#cb19-468" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we select major wheat-producing countries for comparison and filter for recent data (since 2000).</span>
<span id="cb19-469"><a href="#cb19-469" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The basic box plot:</span>
<span id="cb19-470"><a href="#cb19-470" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_boxplot()`</span> creates a box-and-whisker plot for each country</span>
<span id="cb19-471"><a href="#cb19-471" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Each box shows the median (middle line), interquartile range (IQR, the box), and whiskers extending to 1.5 × IQR</span>
<span id="cb19-472"><a href="#cb19-472" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Points beyond the whiskers represent outliers</span>
<span id="cb19-473"><a href="#cb19-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-474"><a href="#cb19-474" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The enhanced box plot adds:</span>
<span id="cb19-475"><a href="#cb19-475" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_jitter()`</span> to display individual data points with slight horizontal displacement</span>
<span id="cb19-476"><a href="#cb19-476" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This combination shows both the summary statistics (box plot) and the raw data distribution (points)</span>
<span id="cb19-477"><a href="#cb19-477" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`angle = 45, hjust = 1`</span> rotates country labels for better readability</span>
<span id="cb19-478"><a href="#cb19-478" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-479"><a href="#cb19-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-480"><a href="#cb19-480" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-481"><a href="#cb19-481" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-482"><a href="#cb19-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-483"><a href="#cb19-483" aria-hidden="true" tabindex="-1"></a>The box plots reveal important comparisons between major wheat-producing countries:</span>
<span id="cb19-484"><a href="#cb19-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-485"><a href="#cb19-485" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The median line in each box shows the typical yield for each country, allowing direct comparison of central tendency.</span>
<span id="cb19-486"><a href="#cb19-486" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The height of each box (IQR) indicates the variability of yields within each country over the time period.</span>
<span id="cb19-487"><a href="#cb19-487" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Whisker length reflects the range of typical yields, while outlier points show exceptional years.</span>
<span id="cb19-488"><a href="#cb19-488" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Countries with higher boxes generally have more variable production, possibly due to climate fluctuations or changing agricultural practices.</span>
<span id="cb19-489"><a href="#cb19-489" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The jittered points reveal the actual distribution and density of observations for each country.</span>
<span id="cb19-490"><a href="#cb19-490" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>These comparisons help identify which countries have the most consistent and productive wheat cultivation systems, providing insights for agricultural policy and development.</span>
<span id="cb19-491"><a href="#cb19-491" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-492"><a href="#cb19-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-493"><a href="#cb19-493" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bar Charts</span></span>
<span id="cb19-494"><a href="#cb19-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-495"><a href="#cb19-495" aria-hidden="true" tabindex="-1"></a>Bar charts are useful for visualizing categorical data:</span>
<span id="cb19-496"><a href="#cb19-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-499"><a href="#cb19-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-500"><a href="#cb19-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-barchart-distributions</span></span>
<span id="cb19-501"><a href="#cb19-501" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Top 10 countries by average wheat yield"</span></span>
<span id="cb19-502"><a href="#cb19-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-503"><a href="#cb19-503" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average wheat yield by country for the last decade</span></span>
<span id="cb19-504"><a href="#cb19-504" aria-hidden="true" tabindex="-1"></a>recent_avg_yields <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-505"><a href="#cb19-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2010</span>, <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-506"><a href="#cb19-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Entity) <span class="sc">%&gt;%</span></span>
<span id="cb19-507"><a href="#cb19-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_wheat_yield =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-508"><a href="#cb19-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_wheat_yield)) <span class="sc">%&gt;%</span></span>
<span id="cb19-509"><a href="#cb19-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)  <span class="co"># Top 10 countries</span></span>
<span id="cb19-510"><a href="#cb19-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-511"><a href="#cb19-511" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart of average wheat yields</span></span>
<span id="cb19-512"><a href="#cb19-512" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recent_avg_yields, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Entity, avg_wheat_yield), <span class="at">y =</span> avg_wheat_yield)) <span class="sc">+</span></span>
<span id="cb19-513"><a href="#cb19-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb19-514"><a href="#cb19-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Countries by Average Wheat Yield (2010-present)"</span>,</span>
<span id="cb19-515"><a href="#cb19-515" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb19-516"><a href="#cb19-516" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Wheat Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb19-517"><a href="#cb19-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-518"><a href="#cb19-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb19-519"><a href="#cb19-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-520"><a href="#cb19-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-521"><a href="#cb19-521" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-522"><a href="#cb19-522" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-523"><a href="#cb19-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-524"><a href="#cb19-524" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to create a bar chart for visualizing categorical data:</span>
<span id="cb19-525"><a href="#cb19-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-526"><a href="#cb19-526" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we calculate the average wheat yield by country for the last decade (2010-present).</span>
<span id="cb19-527"><a href="#cb19-527" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>We then select the top 10 countries by average yield.</span>
<span id="cb19-528"><a href="#cb19-528" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The bar chart:</span>
<span id="cb19-529"><a href="#cb19-529" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_bar(stat = "identity")`</span> creates a bar for each country, with height proportional to average yield</span>
<span id="cb19-530"><a href="#cb19-530" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`reorder(Entity, avg_wheat_yield)`</span> sorts the countries by average yield in descending order</span>
<span id="cb19-531"><a href="#cb19-531" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`fill = "darkgreen"`</span> sets the bar color</span>
<span id="cb19-532"><a href="#cb19-532" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`theme(axis.text.x = element_text(angle = 45, hjust = 1))`</span> rotates country labels for better readability</span>
<span id="cb19-533"><a href="#cb19-533" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-534"><a href="#cb19-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-535"><a href="#cb19-535" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-536"><a href="#cb19-536" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-537"><a href="#cb19-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-538"><a href="#cb19-538" aria-hidden="true" tabindex="-1"></a>The bar chart reveals the top 10 countries by average wheat yield:</span>
<span id="cb19-539"><a href="#cb19-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-540"><a href="#cb19-540" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The height of each bar represents the average yield for each country.</span>
<span id="cb19-541"><a href="#cb19-541" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The countries are sorted in descending order by average yield, making it easy to identify the most productive nations.</span>
<span id="cb19-542"><a href="#cb19-542" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This visualization helps identify which countries have the most efficient wheat cultivation systems, providing insights for agricultural policy and development.</span>
<span id="cb19-543"><a href="#cb19-543" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The bar chart can also be used to compare the average yields of different countries, helping to identify potential areas for improvement.</span>
<span id="cb19-544"><a href="#cb19-544" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-545"><a href="#cb19-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-546"><a href="#cb19-546" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploring Relationships</span></span>
<span id="cb19-547"><a href="#cb19-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-548"><a href="#cb19-548" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scatter Plots</span></span>
<span id="cb19-549"><a href="#cb19-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-550"><a href="#cb19-550" aria-hidden="true" tabindex="-1"></a>Scatter plots help visualize relationships between two continuous variables:</span>
<span id="cb19-551"><a href="#cb19-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-554"><a href="#cb19-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-555"><a href="#cb19-555" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatter-relationships</span></span>
<span id="cb19-556"><a href="#cb19-556" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap:</span></span>
<span id="cb19-557"><a href="#cb19-557" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Relationship between wheat and rice yields"</span></span>
<span id="cb19-558"><a href="#cb19-558" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Wheat vs rice yields by continent"</span></span>
<span id="cb19-559"><a href="#cb19-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-560"><a href="#cb19-560" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's compare wheat and rice yields</span></span>
<span id="cb19-561"><a href="#cb19-561" aria-hidden="true" tabindex="-1"></a>crop_yields_filtered <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-562"><a href="#cb19-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>), <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-563"><a href="#cb19-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2000</span>)</span>
<span id="cb19-564"><a href="#cb19-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-565"><a href="#cb19-565" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic scatter plot</span></span>
<span id="cb19-566"><a href="#cb19-566" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_yields_filtered, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-567"><a href="#cb19-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb19-568"><a href="#cb19-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Wheat and Rice Yields"</span>,</span>
<span id="cb19-569"><a href="#cb19-569" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span id="cb19-570"><a href="#cb19-570" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Rice Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb19-571"><a href="#cb19-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb19-572"><a href="#cb19-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-573"><a href="#cb19-573" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with color by continent (we'll need to add continent information)</span></span>
<span id="cb19-574"><a href="#cb19-574" aria-hidden="true" tabindex="-1"></a><span class="co"># For demonstration, let's create a simple mapping for a few countries</span></span>
<span id="cb19-575"><a href="#cb19-575" aria-hidden="true" tabindex="-1"></a>continent_mapping <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-576"><a href="#cb19-576" aria-hidden="true" tabindex="-1"></a>  <span class="at">Entity =</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"Canada"</span>, <span class="st">"Mexico"</span>,</span>
<span id="cb19-577"><a href="#cb19-577" aria-hidden="true" tabindex="-1"></a>             <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Japan"</span>,</span>
<span id="cb19-578"><a href="#cb19-578" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Germany"</span>, <span class="st">"France"</span>, <span class="st">"United Kingdom"</span>,</span>
<span id="cb19-579"><a href="#cb19-579" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Brazil"</span>, <span class="st">"Argentina"</span>, <span class="st">"Chile"</span>,</span>
<span id="cb19-580"><a href="#cb19-580" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Egypt"</span>, <span class="st">"Nigeria"</span>, <span class="st">"South Africa"</span>,</span>
<span id="cb19-581"><a href="#cb19-581" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Australia"</span>, <span class="st">"New Zealand"</span>),</span>
<span id="cb19-582"><a href="#cb19-582" aria-hidden="true" tabindex="-1"></a>  <span class="at">Continent =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"North America"</span>, <span class="dv">3</span>),</span>
<span id="cb19-583"><a href="#cb19-583" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Asia"</span>, <span class="dv">3</span>),</span>
<span id="cb19-584"><a href="#cb19-584" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Europe"</span>, <span class="dv">3</span>),</span>
<span id="cb19-585"><a href="#cb19-585" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"South America"</span>, <span class="dv">3</span>),</span>
<span id="cb19-586"><a href="#cb19-586" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Africa"</span>, <span class="dv">3</span>),</span>
<span id="cb19-587"><a href="#cb19-587" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Oceania"</span>, <span class="dv">2</span>))</span>
<span id="cb19-588"><a href="#cb19-588" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-589"><a href="#cb19-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-590"><a href="#cb19-590" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with our dataset</span></span>
<span id="cb19-591"><a href="#cb19-591" aria-hidden="true" tabindex="-1"></a>crop_yields_with_continent <span class="ot">&lt;-</span> crop_yields_filtered <span class="sc">%&gt;%</span></span>
<span id="cb19-592"><a href="#cb19-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(continent_mapping, <span class="at">by =</span> <span class="st">"Entity"</span>)</span>
<span id="cb19-593"><a href="#cb19-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-594"><a href="#cb19-594" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with color by continent</span></span>
<span id="cb19-595"><a href="#cb19-595" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_yields_with_continent, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">color =</span> Continent)) <span class="sc">+</span></span>
<span id="cb19-596"><a href="#cb19-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb19-597"><a href="#cb19-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Wheat and Rice Yields by Continent"</span>,</span>
<span id="cb19-598"><a href="#cb19-598" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span id="cb19-599"><a href="#cb19-599" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Rice Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb19-600"><a href="#cb19-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb19-601"><a href="#cb19-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-602"><a href="#cb19-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-603"><a href="#cb19-603" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-604"><a href="#cb19-604" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-605"><a href="#cb19-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-606"><a href="#cb19-606" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to create scatter plots for exploring relationships:</span>
<span id="cb19-607"><a href="#cb19-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-608"><a href="#cb19-608" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we filter the data to include only observations with non-missing values for wheat and rice yields, and only consider recent data (since 2000).</span>
<span id="cb19-609"><a href="#cb19-609" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The basic scatter plot:</span>
<span id="cb19-610"><a href="#cb19-610" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_point()`</span> creates a scatter plot of wheat yields vs. rice yields</span>
<span id="cb19-611"><a href="#cb19-611" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`alpha = 0.5`</span> sets the transparency of the points</span>
<span id="cb19-612"><a href="#cb19-612" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`color = "darkgreen"`</span> sets the color of the points</span>
<span id="cb19-613"><a href="#cb19-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-614"><a href="#cb19-614" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The scatter plot with color by continent:</span>
<span id="cb19-615"><a href="#cb19-615" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>We create a simple mapping of countries to continents using <span class="in">`tibble()`</span>.</span>
<span id="cb19-616"><a href="#cb19-616" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>We join this mapping with our dataset using <span class="in">`inner_join()`</span>.</span>
<span id="cb19-617"><a href="#cb19-617" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>We create a scatter plot with color by continent using <span class="in">`geom_point(aes(color = Continent))`</span>.</span>
<span id="cb19-618"><a href="#cb19-618" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-619"><a href="#cb19-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-620"><a href="#cb19-620" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-621"><a href="#cb19-621" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-622"><a href="#cb19-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-623"><a href="#cb19-623" aria-hidden="true" tabindex="-1"></a>The scatter plots reveal the relationship between wheat and rice yields:</span>
<span id="cb19-624"><a href="#cb19-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-625"><a href="#cb19-625" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The basic scatter plot shows the overall relationship between wheat and rice yields.</span>
<span id="cb19-626"><a href="#cb19-626" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The scatter plot with color by continent reveals how the relationship varies across different continents.</span>
<span id="cb19-627"><a href="#cb19-627" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This visualization helps identify patterns and correlations between wheat and rice yields, providing insights for agricultural policy and development.</span>
<span id="cb19-628"><a href="#cb19-628" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The scatter plot can also be used to identify outliers and anomalies in the data.</span>
<span id="cb19-629"><a href="#cb19-629" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-630"><a href="#cb19-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-631"><a href="#cb19-631" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlation Analysis</span></span>
<span id="cb19-632"><a href="#cb19-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-633"><a href="#cb19-633" aria-hidden="true" tabindex="-1"></a>Correlation analysis quantifies the strength and direction of relationships between variables:</span>
<span id="cb19-634"><a href="#cb19-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-637"><a href="#cb19-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-638"><a href="#cb19-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-correlation-matrix</span></span>
<span id="cb19-639"><a href="#cb19-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Correlation matrix of crop yields"</span></span>
<span id="cb19-640"><a href="#cb19-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-641"><a href="#cb19-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Select numeric columns for correlation analysis</span></span>
<span id="cb19-642"><a href="#cb19-642" aria-hidden="true" tabindex="-1"></a>crop_numeric <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-643"><a href="#cb19-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Soybeans (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Potatoes (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Beans (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-644"><a href="#cb19-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb19-645"><a href="#cb19-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-646"><a href="#cb19-646" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix</span></span>
<span id="cb19-647"><a href="#cb19-647" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(crop_numeric)</span>
<span id="cb19-648"><a href="#cb19-648" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cor_matrix, <span class="dv">2</span>)</span>
<span id="cb19-649"><a href="#cb19-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-650"><a href="#cb19-650" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize correlation matrix</span></span>
<span id="cb19-651"><a href="#cb19-651" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb19-652"><a href="#cb19-652" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"circle"</span>, <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb19-653"><a href="#cb19-653" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb19-654"><a href="#cb19-654" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Correlation Matrix of Crop Yields"</span>)</span>
<span id="cb19-655"><a href="#cb19-655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-656"><a href="#cb19-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-657"><a href="#cb19-657" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-658"><a href="#cb19-658" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-659"><a href="#cb19-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-660"><a href="#cb19-660" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform correlation analysis:</span>
<span id="cb19-661"><a href="#cb19-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-662"><a href="#cb19-662" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we select the numeric columns of interest for correlation analysis.</span>
<span id="cb19-663"><a href="#cb19-663" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>We remove any missing values using <span class="in">`na.omit()`</span>.</span>
<span id="cb19-664"><a href="#cb19-664" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>We calculate the correlation matrix using <span class="in">`cor()`</span>.</span>
<span id="cb19-665"><a href="#cb19-665" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>We round the correlation matrix to 2 decimal places using <span class="in">`round()`</span>.</span>
<span id="cb19-666"><a href="#cb19-666" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>We visualize the correlation matrix using <span class="in">`corrplot()`</span>.</span>
<span id="cb19-667"><a href="#cb19-667" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-668"><a href="#cb19-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-669"><a href="#cb19-669" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-670"><a href="#cb19-670" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-671"><a href="#cb19-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-672"><a href="#cb19-672" aria-hidden="true" tabindex="-1"></a>The correlation matrix reveals the strength and direction of relationships between variables:</span>
<span id="cb19-673"><a href="#cb19-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-674"><a href="#cb19-674" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The correlation matrix shows the correlation coefficients between each pair of variables.</span>
<span id="cb19-675"><a href="#cb19-675" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The correlation coefficients range from -1 (perfect negative correlation) to 1 (perfect positive correlation).</span>
<span id="cb19-676"><a href="#cb19-676" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This visualization helps identify strong correlations between variables, providing insights for agricultural policy and development.</span>
<span id="cb19-677"><a href="#cb19-677" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The correlation matrix can also be used to identify potential multicollinearity issues in regression analysis.</span>
<span id="cb19-678"><a href="#cb19-678" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-679"><a href="#cb19-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-680"><a href="#cb19-680" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pair Plots</span></span>
<span id="cb19-681"><a href="#cb19-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-682"><a href="#cb19-682" aria-hidden="true" tabindex="-1"></a>Pair plots provide a comprehensive view of relationships between multiple variables:</span>
<span id="cb19-683"><a href="#cb19-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-686"><a href="#cb19-686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-687"><a href="#cb19-687" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pair-plots</span></span>
<span id="cb19-688"><a href="#cb19-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap:</span></span>
<span id="cb19-689"><a href="#cb19-689" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Basic pair plot of crop yields"</span></span>
<span id="cb19-690"><a href="#cb19-690" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Enhanced pair plot with GGally"</span></span>
<span id="cb19-691"><a href="#cb19-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-692"><a href="#cb19-692" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic pair plot</span></span>
<span id="cb19-693"><a href="#cb19-693" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(crop_numeric, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb19-694"><a href="#cb19-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-695"><a href="#cb19-695" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced pair plot with GGally</span></span>
<span id="cb19-696"><a href="#cb19-696" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb19-697"><a href="#cb19-697" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(crop_numeric) <span class="sc">+</span></span>
<span id="cb19-698"><a href="#cb19-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-699"><a href="#cb19-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationships Between Different Crop Yields"</span>)</span>
<span id="cb19-700"><a href="#cb19-700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-701"><a href="#cb19-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-702"><a href="#cb19-702" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-703"><a href="#cb19-703" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-704"><a href="#cb19-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-705"><a href="#cb19-705" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to create pair plots:</span>
<span id="cb19-706"><a href="#cb19-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-707"><a href="#cb19-707" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we create a basic pair plot using <span class="in">`pairs()`</span>.</span>
<span id="cb19-708"><a href="#cb19-708" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>We then create an enhanced pair plot using <span class="in">`ggpairs()`</span> from the GGally package.</span>
<span id="cb19-709"><a href="#cb19-709" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The enhanced pair plot includes histograms, scatter plots, and correlation coefficients for each pair of variables.</span>
<span id="cb19-710"><a href="#cb19-710" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-711"><a href="#cb19-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-712"><a href="#cb19-712" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-713"><a href="#cb19-713" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-714"><a href="#cb19-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-715"><a href="#cb19-715" aria-hidden="true" tabindex="-1"></a>The pair plots reveal the relationships between multiple variables:</span>
<span id="cb19-716"><a href="#cb19-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-717"><a href="#cb19-717" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The pair plots show the relationships between each pair of variables.</span>
<span id="cb19-718"><a href="#cb19-718" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The histograms and scatter plots provide a visual representation of the relationships.</span>
<span id="cb19-719"><a href="#cb19-719" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The correlation coefficients provide a quantitative measure of the strength and direction of the relationships.</span>
<span id="cb19-720"><a href="#cb19-720" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This visualization helps identify patterns and correlations between multiple variables, providing insights for agricultural policy and development.</span>
<span id="cb19-721"><a href="#cb19-721" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-722"><a href="#cb19-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-723"><a href="#cb19-723" aria-hidden="true" tabindex="-1"></a><span class="fu">## Identifying Outliers and Anomalies</span></span>
<span id="cb19-724"><a href="#cb19-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-725"><a href="#cb19-725" aria-hidden="true" tabindex="-1"></a><span class="fu">### Box Plots for Outlier Detection</span></span>
<span id="cb19-726"><a href="#cb19-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-727"><a href="#cb19-727" aria-hidden="true" tabindex="-1"></a>Box plots can help identify potential outliers:</span>
<span id="cb19-728"><a href="#cb19-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-731"><a href="#cb19-731" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-732"><a href="#cb19-732" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-outlier-detection</span></span>
<span id="cb19-733"><a href="#cb19-733" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Box plot showing potential outliers in wheat yields"</span></span>
<span id="cb19-734"><a href="#cb19-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-735"><a href="#cb19-735" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot to identify outliers in wheat yield</span></span>
<span id="cb19-736"><a href="#cb19-736" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_yields, <span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb19-737"><a href="#cb19-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-738"><a href="#cb19-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Box Plot of Wheat Yields with Potential Outliers"</span>,</span>
<span id="cb19-739"><a href="#cb19-739" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb19-740"><a href="#cb19-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb19-741"><a href="#cb19-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-742"><a href="#cb19-742" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify potential outliers</span></span>
<span id="cb19-743"><a href="#cb19-743" aria-hidden="true" tabindex="-1"></a>wheat_outliers <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-744"><a href="#cb19-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-745"><a href="#cb19-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-746"><a href="#cb19-746" aria-hidden="true" tabindex="-1"></a>    <span class="at">q1 =</span> <span class="fu">quantile</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="fl">0.25</span>),</span>
<span id="cb19-747"><a href="#cb19-747" aria-hidden="true" tabindex="-1"></a>    <span class="at">q3 =</span> <span class="fu">quantile</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="fl">0.75</span>),</span>
<span id="cb19-748"><a href="#cb19-748" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr =</span> q3 <span class="sc">-</span> q1,</span>
<span id="cb19-749"><a href="#cb19-749" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_bound =</span> q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr,</span>
<span id="cb19-750"><a href="#cb19-750" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_bound =</span> q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr,</span>
<span id="cb19-751"><a href="#cb19-751" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_outlier =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">&lt;</span> lower_bound <span class="sc">|</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">&gt;</span> upper_bound</span>
<span id="cb19-752"><a href="#cb19-752" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-753"><a href="#cb19-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_outlier) <span class="sc">%&gt;%</span></span>
<span id="cb19-754"><a href="#cb19-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb19-755"><a href="#cb19-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-756"><a href="#cb19-756" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the outliers</span></span>
<span id="cb19-757"><a href="#cb19-757" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wheat_outliers, <span class="dv">10</span>)</span>
<span id="cb19-758"><a href="#cb19-758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-759"><a href="#cb19-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-760"><a href="#cb19-760" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-761"><a href="#cb19-761" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-762"><a href="#cb19-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-763"><a href="#cb19-763" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to use box plots for outlier detection:</span>
<span id="cb19-764"><a href="#cb19-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-765"><a href="#cb19-765" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we create a box plot of wheat yields using <span class="in">`geom_boxplot()`</span>.</span>
<span id="cb19-766"><a href="#cb19-766" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>We then identify potential outliers using the interquartile range (IQR) method.</span>
<span id="cb19-767"><a href="#cb19-767" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>We calculate the lower and upper bounds for outliers using <span class="in">`q1 - 1.5 * iqr`</span> and <span class="in">`q3 + 1.5 * iqr`</span>, respectively.</span>
<span id="cb19-768"><a href="#cb19-768" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>We identify observations that fall outside these bounds as potential outliers.</span>
<span id="cb19-769"><a href="#cb19-769" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-770"><a href="#cb19-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-771"><a href="#cb19-771" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-772"><a href="#cb19-772" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-773"><a href="#cb19-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-774"><a href="#cb19-774" aria-hidden="true" tabindex="-1"></a>The box plot and outlier detection reveal potential outliers:</span>
<span id="cb19-775"><a href="#cb19-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-776"><a href="#cb19-776" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The box plot shows the distribution of wheat yields, with potential outliers indicated by points outside the whiskers.</span>
<span id="cb19-777"><a href="#cb19-777" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The outlier detection identifies observations that fall outside the lower and upper bounds.</span>
<span id="cb19-778"><a href="#cb19-778" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This visualization helps identify potential errors or anomalies in the data, providing insights for data cleaning and quality control.</span>
<span id="cb19-779"><a href="#cb19-779" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-780"><a href="#cb19-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-781"><a href="#cb19-781" aria-hidden="true" tabindex="-1"></a><span class="fu">### Z-Scores for Outlier Detection</span></span>
<span id="cb19-782"><a href="#cb19-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-783"><a href="#cb19-783" aria-hidden="true" tabindex="-1"></a>Z-scores can also help identify outliers:</span>
<span id="cb19-784"><a href="#cb19-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-787"><a href="#cb19-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-788"><a href="#cb19-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: zscore-outliers</span></span>
<span id="cb19-789"><a href="#cb19-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-790"><a href="#cb19-790" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate z-scores for wheat yields</span></span>
<span id="cb19-791"><a href="#cb19-791" aria-hidden="true" tabindex="-1"></a>wheat_z_scores <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-792"><a href="#cb19-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-793"><a href="#cb19-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-794"><a href="#cb19-794" aria-hidden="true" tabindex="-1"></a>    <span class="at">wheat_mean =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>),</span>
<span id="cb19-795"><a href="#cb19-795" aria-hidden="true" tabindex="-1"></a>    <span class="at">wheat_sd =</span> <span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>),</span>
<span id="cb19-796"><a href="#cb19-796" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_score =</span> (<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">-</span> wheat_mean) <span class="sc">/</span> wheat_sd,</span>
<span id="cb19-797"><a href="#cb19-797" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_extreme =</span> <span class="fu">abs</span>(z_score) <span class="sc">&gt;</span> <span class="dv">3</span></span>
<span id="cb19-798"><a href="#cb19-798" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-799"><a href="#cb19-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-800"><a href="#cb19-800" aria-hidden="true" tabindex="-1"></a><span class="co"># Display extreme values (z-score &gt; 3 or &lt; -3)</span></span>
<span id="cb19-801"><a href="#cb19-801" aria-hidden="true" tabindex="-1"></a>wheat_extremes <span class="ot">&lt;-</span> wheat_z_scores <span class="sc">%&gt;%</span></span>
<span id="cb19-802"><a href="#cb19-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is_extreme) <span class="sc">%&gt;%</span></span>
<span id="cb19-803"><a href="#cb19-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, z_score) <span class="sc">%&gt;%</span></span>
<span id="cb19-804"><a href="#cb19-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(z_score)))</span>
<span id="cb19-805"><a href="#cb19-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-806"><a href="#cb19-806" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wheat_extremes, <span class="dv">10</span>)</span>
<span id="cb19-807"><a href="#cb19-807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-808"><a href="#cb19-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-809"><a href="#cb19-809" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-810"><a href="#cb19-810" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-811"><a href="#cb19-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-812"><a href="#cb19-812" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to use z-scores for outlier detection:</span>
<span id="cb19-813"><a href="#cb19-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-814"><a href="#cb19-814" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we calculate the mean and standard deviation of wheat yields using <span class="in">`mean()`</span> and <span class="in">`sd()`</span>, respectively.</span>
<span id="cb19-815"><a href="#cb19-815" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>We then calculate the z-scores for each observation using <span class="in">`(x - mean) / sd`</span>.</span>
<span id="cb19-816"><a href="#cb19-816" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>We identify observations with absolute z-scores greater than 3 as extreme values.</span>
<span id="cb19-817"><a href="#cb19-817" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-818"><a href="#cb19-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-819"><a href="#cb19-819" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-820"><a href="#cb19-820" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-821"><a href="#cb19-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-822"><a href="#cb19-822" aria-hidden="true" tabindex="-1"></a>The z-scores reveal extreme values:</span>
<span id="cb19-823"><a href="#cb19-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-824"><a href="#cb19-824" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The z-scores show the number of standard deviations from the mean for each observation.</span>
<span id="cb19-825"><a href="#cb19-825" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The extreme values are identified by their absolute z-scores greater than 3.</span>
<span id="cb19-826"><a href="#cb19-826" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This visualization helps identify potential outliers or anomalies in the data, providing insights for data cleaning and quality control.</span>
<span id="cb19-827"><a href="#cb19-827" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-828"><a href="#cb19-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-829"><a href="#cb19-829" aria-hidden="true" tabindex="-1"></a><span class="fu">## Time Series Exploration</span></span>
<span id="cb19-830"><a href="#cb19-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-831"><a href="#cb19-831" aria-hidden="true" tabindex="-1"></a>Agricultural data often contains important temporal patterns:</span>
<span id="cb19-832"><a href="#cb19-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-835"><a href="#cb19-835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-836"><a href="#cb19-836" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-time-series</span></span>
<span id="cb19-837"><a href="#cb19-837" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Wheat yield trends over time for major producers"</span></span>
<span id="cb19-838"><a href="#cb19-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-839"><a href="#cb19-839" aria-hidden="true" tabindex="-1"></a><span class="co"># Select a few countries for time series analysis</span></span>
<span id="cb19-840"><a href="#cb19-840" aria-hidden="true" tabindex="-1"></a>countries_for_ts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"France"</span>)</span>
<span id="cb19-841"><a href="#cb19-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-842"><a href="#cb19-842" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for these countries</span></span>
<span id="cb19-843"><a href="#cb19-843" aria-hidden="true" tabindex="-1"></a>wheat_ts_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb19-844"><a href="#cb19-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Entity <span class="sc">%in%</span> countries_for_ts, <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-845"><a href="#cb19-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1960</span>)</span>
<span id="cb19-846"><a href="#cb19-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-847"><a href="#cb19-847" aria-hidden="true" tabindex="-1"></a><span class="co"># Time series plot</span></span>
<span id="cb19-848"><a href="#cb19-848" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wheat_ts_data, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">color =</span> Entity)) <span class="sc">+</span></span>
<span id="cb19-849"><a href="#cb19-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-850"><a href="#cb19-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-851"><a href="#cb19-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yield Trends Over Time"</span>,</span>
<span id="cb19-852"><a href="#cb19-852" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb19-853"><a href="#cb19-853" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb19-854"><a href="#cb19-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-855"><a href="#cb19-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>)</span>
<span id="cb19-856"><a href="#cb19-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-857"><a href="#cb19-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-858"><a href="#cb19-858" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-859"><a href="#cb19-859" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-860"><a href="#cb19-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-861"><a href="#cb19-861" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to create a time series plot:</span>
<span id="cb19-862"><a href="#cb19-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-863"><a href="#cb19-863" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we select a few countries for time series analysis.</span>
<span id="cb19-864"><a href="#cb19-864" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>We filter the data for these countries and non-missing wheat yields.</span>
<span id="cb19-865"><a href="#cb19-865" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>We create a time series plot using <span class="in">`geom_line()`</span> and <span class="in">`geom_point()`</span>.</span>
<span id="cb19-866"><a href="#cb19-866" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>We add a title, x-axis label, and y-axis label using <span class="in">`labs()`</span>.</span>
<span id="cb19-867"><a href="#cb19-867" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-868"><a href="#cb19-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-869"><a href="#cb19-869" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-870"><a href="#cb19-870" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-871"><a href="#cb19-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-872"><a href="#cb19-872" aria-hidden="true" tabindex="-1"></a>The time series plot reveals temporal patterns:</span>
<span id="cb19-873"><a href="#cb19-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-874"><a href="#cb19-874" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The time series plot shows the trends in wheat yields over time for each country.</span>
<span id="cb19-875"><a href="#cb19-875" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The plot reveals patterns such as increasing or decreasing trends, seasonality, or anomalies.</span>
<span id="cb19-876"><a href="#cb19-876" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This visualization helps identify temporal patterns and correlations in the data, providing insights for agricultural policy and development.</span>
<span id="cb19-877"><a href="#cb19-877" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-878"><a href="#cb19-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-879"><a href="#cb19-879" aria-hidden="true" tabindex="-1"></a><span class="fu">## Missing Data Analysis</span></span>
<span id="cb19-880"><a href="#cb19-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-881"><a href="#cb19-881" aria-hidden="true" tabindex="-1"></a>Understanding patterns of missing data is crucial:</span>
<span id="cb19-882"><a href="#cb19-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-885"><a href="#cb19-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-886"><a href="#cb19-886" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-missing-data</span></span>
<span id="cb19-887"><a href="#cb19-887" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap:</span></span>
<span id="cb19-888"><a href="#cb19-888" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Missing values by variable"</span></span>
<span id="cb19-889"><a href="#cb19-889" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Missing data pattern visualization"</span></span>
<span id="cb19-890"><a href="#cb19-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-891"><a href="#cb19-891" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values in each column</span></span>
<span id="cb19-892"><a href="#cb19-892" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(crop_yields))</span>
<span id="cb19-893"><a href="#cb19-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-894"><a href="#cb19-894" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing data patterns</span></span>
<span id="cb19-895"><a href="#cb19-895" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"naniar"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb19-896"><a href="#cb19-896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(naniar)</span>
<span id="cb19-897"><a href="#cb19-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-898"><a href="#cb19-898" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a visualization of missing data</span></span>
<span id="cb19-899"><a href="#cb19-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_miss_var</span>(crop_yields)</span>
<span id="cb19-900"><a href="#cb19-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-901"><a href="#cb19-901" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a matrix showing missing data patterns</span></span>
<span id="cb19-902"><a href="#cb19-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vis_miss</span>(crop_yields[, <span class="fu">c</span>(<span class="st">"Entity"</span>, <span class="st">"Year"</span>, <span class="st">"Wheat (tonnes per hectare)"</span>, <span class="st">"Rice (tonnes per hectare)"</span>, <span class="st">"Maize (tonnes per hectare)"</span>)])</span>
<span id="cb19-903"><a href="#cb19-903" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb19-904"><a href="#cb19-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"The 'naniar' package is not installed. Install it with install.packages('naniar') to visualize missing data patterns."</span>)</span>
<span id="cb19-905"><a href="#cb19-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-906"><a href="#cb19-906" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Alternative: simple summary of missing data</span></span>
<span id="cb19-907"><a href="#cb19-907" aria-hidden="true" tabindex="-1"></a>  missing_summary <span class="ot">&lt;-</span> <span class="fu">sapply</span>(crop_yields, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb19-908"><a href="#cb19-908" aria-hidden="true" tabindex="-1"></a>  missing_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-909"><a href="#cb19-909" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="fu">names</span>(missing_summary),</span>
<span id="cb19-910"><a href="#cb19-910" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing_Count =</span> missing_summary,</span>
<span id="cb19-911"><a href="#cb19-911" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing_Percent =</span> <span class="fu">round</span>(missing_summary <span class="sc">/</span> <span class="fu">nrow</span>(crop_yields) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb19-912"><a href="#cb19-912" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-913"><a href="#cb19-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-914"><a href="#cb19-914" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the summary</span></span>
<span id="cb19-915"><a href="#cb19-915" aria-hidden="true" tabindex="-1"></a>  missing_df <span class="ot">&lt;-</span> missing_df[<span class="fu">order</span>(<span class="sc">-</span>missing_df<span class="sc">$</span>Missing_Count), ]</span>
<span id="cb19-916"><a href="#cb19-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(missing_df, <span class="dv">10</span>)</span>
<span id="cb19-917"><a href="#cb19-917" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-918"><a href="#cb19-918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-919"><a href="#cb19-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-920"><a href="#cb19-920" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-921"><a href="#cb19-921" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-922"><a href="#cb19-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-923"><a href="#cb19-923" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to analyze missing data:</span>
<span id="cb19-924"><a href="#cb19-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-925"><a href="#cb19-925" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we check for missing values in each column using <span class="in">`colSums(is.na())`</span>.</span>
<span id="cb19-926"><a href="#cb19-926" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>We then visualize missing data patterns using <span class="in">`gg_miss_var()`</span> and <span class="in">`vis_miss()`</span> from the naniar package.</span>
<span id="cb19-927"><a href="#cb19-927" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>If the naniar package is not installed, we provide an alternative summary of missing data using <span class="in">`sapply()`</span> and <span class="in">`data.frame()`</span>.</span>
<span id="cb19-928"><a href="#cb19-928" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-929"><a href="#cb19-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-930"><a href="#cb19-930" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-931"><a href="#cb19-931" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-932"><a href="#cb19-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-933"><a href="#cb19-933" aria-hidden="true" tabindex="-1"></a>The missing data analysis reveals patterns of missingness:</span>
<span id="cb19-934"><a href="#cb19-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-935"><a href="#cb19-935" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The summary of missing data shows the number and percentage of missing values in each column.</span>
<span id="cb19-936"><a href="#cb19-936" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The visualization of missing data patterns reveals the distribution of missing values across different variables.</span>
<span id="cb19-937"><a href="#cb19-937" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This analysis helps identify potential issues with data quality and informs strategies for handling missing data.</span>
<span id="cb19-938"><a href="#cb19-938" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-939"><a href="#cb19-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-940"><a href="#cb19-940" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb19-941"><a href="#cb19-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-942"><a href="#cb19-942" aria-hidden="true" tabindex="-1"></a>This chapter has demonstrated various techniques for exploratory data analysis using a real agricultural dataset. We've covered:</span>
<span id="cb19-943"><a href="#cb19-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-944"><a href="#cb19-944" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Computing and interpreting descriptive statistics</span>
<span id="cb19-945"><a href="#cb19-945" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Creating and analyzing frequency tables</span>
<span id="cb19-946"><a href="#cb19-946" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Visualizing distributions with histograms, density plots, and box plots</span>
<span id="cb19-947"><a href="#cb19-947" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Exploring relationships with scatter plots and correlation analysis</span>
<span id="cb19-948"><a href="#cb19-948" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Identifying outliers and anomalies</span>
<span id="cb19-949"><a href="#cb19-949" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Analyzing time series patterns</span>
<span id="cb19-950"><a href="#cb19-950" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Examining missing data</span>
<span id="cb19-951"><a href="#cb19-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-952"><a href="#cb19-952" aria-hidden="true" tabindex="-1"></a>These techniques provide a foundation for understanding your data before proceeding to more advanced analyses. By thoroughly exploring your data, you can make informed decisions about appropriate statistical methods and generate meaningful hypotheses for testing.</span>
<span id="cb19-953"><a href="#cb19-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-954"><a href="#cb19-954" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb19-955"><a href="#cb19-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-956"><a href="#cb19-956" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Load the plant biodiversity dataset from <span class="in">`docs/data/ecology/biodiversity.csv`</span> and perform a comprehensive exploratory analysis.</span>
<span id="cb19-957"><a href="#cb19-957" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Create a histogram and density plot for another crop in the dataset. How does its distribution compare to wheat?</span>
<span id="cb19-958"><a href="#cb19-958" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Investigate the relationship between potato yields and latitude (you'll need to find or create a dataset with latitude information).</span>
<span id="cb19-959"><a href="#cb19-959" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Identify countries with the most significant improvement in crop yields over time.</span>
<span id="cb19-960"><a href="#cb19-960" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Create a time series plot showing the ratio of wheat to rice yields over time for major producing countries.</span>
<span id="cb19-961"><a href="#cb19-961" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Perform the same exploratory analyses in R for the spatial dataset in <span class="in">`docs/data/geography/spatial.csv`</span>.</span>
<span id="cb19-962"><a href="#cb19-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-965"><a href="#cb19-965" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-966"><a href="#cb19-966" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-conservation-status</span></span>
<span id="cb19-967"><a href="#cb19-967" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Conservation status of plant species by region"</span></span>
<span id="cb19-968"><a href="#cb19-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-969"><a href="#cb19-969" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb19-970"><a href="#cb19-970" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb19-971"><a href="#cb19-971" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-972"><a href="#cb19-972" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)  <span class="co"># For colorblind-friendly palettes</span></span>
<span id="cb19-973"><a href="#cb19-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-974"><a href="#cb19-974" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sample plant biodiversity dataset since the original is not available</span></span>
<span id="cb19-975"><a href="#cb19-975" aria-hidden="true" tabindex="-1"></a><span class="co"># This simulates conservation status data across different regions</span></span>
<span id="cb19-976"><a href="#cb19-976" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb19-977"><a href="#cb19-977" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"North America"</span>, <span class="st">"South America"</span>, <span class="st">"Europe"</span>, <span class="st">"Africa"</span>, <span class="st">"Asia"</span>, <span class="st">"Oceania"</span>)</span>
<span id="cb19-978"><a href="#cb19-978" aria-hidden="true" tabindex="-1"></a>statuses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Least Concern"</span>, <span class="st">"Near Threatened"</span>, <span class="st">"Vulnerable"</span>, <span class="st">"Endangered"</span>, <span class="st">"Critically Endangered"</span>)</span>
<span id="cb19-979"><a href="#cb19-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-980"><a href="#cb19-980" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data with 200 observations</span></span>
<span id="cb19-981"><a href="#cb19-981" aria-hidden="true" tabindex="-1"></a>plant_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-982"><a href="#cb19-982" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">sample</span>(regions, <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-983"><a href="#cb19-983" aria-hidden="true" tabindex="-1"></a>  <span class="at">conservation_status =</span> <span class="fu">sample</span>(statuses, <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-984"><a href="#cb19-984" aria-hidden="true" tabindex="-1"></a>                                <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>))</span>
<span id="cb19-985"><a href="#cb19-985" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-986"><a href="#cb19-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-987"><a href="#cb19-987" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a professional theme for all plots</span></span>
<span id="cb19-988"><a href="#cb19-988" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-989"><a href="#cb19-989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb19-990"><a href="#cb19-990" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb19-991"><a href="#cb19-991" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb19-992"><a href="#cb19-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb19-993"><a href="#cb19-993" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb19-994"><a href="#cb19-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-995"><a href="#cb19-995" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar chart of conservation status</span></span>
<span id="cb19-996"><a href="#cb19-996" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plant_data, <span class="fu">aes</span>(<span class="at">x =</span> region, <span class="at">fill =</span> conservation_status)) <span class="sc">+</span></span>
<span id="cb19-997"><a href="#cb19-997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb19-998"><a href="#cb19-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb19-999"><a href="#cb19-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-1000"><a href="#cb19-1000" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Conservation Status of Plant Species by Region"</span>,</span>
<span id="cb19-1001"><a href="#cb19-1001" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Region"</span>,</span>
<span id="cb19-1002"><a href="#cb19-1002" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Species"</span>,</span>
<span id="cb19-1003"><a href="#cb19-1003" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Conservation Status"</span></span>
<span id="cb19-1004"><a href="#cb19-1004" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-1005"><a href="#cb19-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb19-1006"><a href="#cb19-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb19-1007"><a href="#cb19-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1008"><a href="#cb19-1008" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb19-1009"><a href="#cb19-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb19-1010"><a href="#cb19-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1011"><a href="#cb19-1011" aria-hidden="true" tabindex="-1"></a>This code demonstrates professional visualization techniques:</span>
<span id="cb19-1012"><a href="#cb19-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1013"><a href="#cb19-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Package Setup**:</span>
<span id="cb19-1014"><a href="#cb19-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`tidyverse`</span> for data manipulation</span>
<span id="cb19-1015"><a href="#cb19-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`ggplot2`</span> for creating plots</span>
<span id="cb19-1016"><a href="#cb19-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`viridis`</span> for colorblind-friendly color palettes</span>
<span id="cb19-1017"><a href="#cb19-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1018"><a href="#cb19-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Theme Customization**:</span>
<span id="cb19-1019"><a href="#cb19-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`theme_set()`</span> applies consistent styling</span>
<span id="cb19-1020"><a href="#cb19-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Customizes text appearance for titles and labels</span>
<span id="cb19-1021"><a href="#cb19-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Ensures professional look across all plots</span>
<span id="cb19-1022"><a href="#cb19-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1023"><a href="#cb19-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Plot Construction**:</span>
<span id="cb19-1024"><a href="#cb19-1024" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`ggplot()`</span> creates the base plot</span>
<span id="cb19-1025"><a href="#cb19-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`aes()`</span> defines aesthetic mappings</span>
<span id="cb19-1026"><a href="#cb19-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_bar()`</span> creates stacked bars</span>
<span id="cb19-1027"><a href="#cb19-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`scale_fill_viridis_d()`</span> applies colorblind-friendly colors</span>
<span id="cb19-1028"><a href="#cb19-1028" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-1029"><a href="#cb19-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1030"><a href="#cb19-1030" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb19-1031"><a href="#cb19-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb19-1032"><a href="#cb19-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1033"><a href="#cb19-1033" aria-hidden="true" tabindex="-1"></a>The visualization reveals important patterns:</span>
<span id="cb19-1034"><a href="#cb19-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1035"><a href="#cb19-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Regional Distribution**:</span>
<span id="cb19-1036"><a href="#cb19-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Different regions show varying numbers of species</span>
<span id="cb19-1037"><a href="#cb19-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Some regions have more diverse plant communities</span>
<span id="cb19-1038"><a href="#cb19-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Conservation status varies across regions</span>
<span id="cb19-1039"><a href="#cb19-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1040"><a href="#cb19-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Conservation Status**:</span>
<span id="cb19-1041"><a href="#cb19-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Proportion of threatened species varies by region</span>
<span id="cb19-1042"><a href="#cb19-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Some regions have better conservation outcomes</span>
<span id="cb19-1043"><a href="#cb19-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Areas needing conservation attention are visible</span>
<span id="cb19-1044"><a href="#cb19-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1045"><a href="#cb19-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Data Quality**:</span>
<span id="cb19-1046"><a href="#cb19-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Completeness of conservation status data</span>
<span id="cb19-1047"><a href="#cb19-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Potential gaps in monitoring</span>
<span id="cb19-1048"><a href="#cb19-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Regional differences in data collection</span>
<span id="cb19-1049"><a href="#cb19-1049" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-1050"><a href="#cb19-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1051"><a href="#cb19-1051" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb19-1052"><a href="#cb19-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">## PROFESSIONAL TIP: Visualization Best Practices</span></span>
<span id="cb19-1053"><a href="#cb19-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1054"><a href="#cb19-1054" aria-hidden="true" tabindex="-1"></a>When creating scientific visualizations:</span>
<span id="cb19-1055"><a href="#cb19-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1056"><a href="#cb19-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Design Principles**:</span>
<span id="cb19-1057"><a href="#cb19-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Use clear, readable fonts</span>
<span id="cb19-1058"><a href="#cb19-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Choose appropriate color schemes</span>
<span id="cb19-1059"><a href="#cb19-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Maintain consistent styling</span>
<span id="cb19-1060"><a href="#cb19-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Include informative titles and labels</span>
<span id="cb19-1061"><a href="#cb19-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1062"><a href="#cb19-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Accessibility**:</span>
<span id="cb19-1063"><a href="#cb19-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Use colorblind-friendly palettes</span>
<span id="cb19-1064"><a href="#cb19-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Ensure sufficient contrast</span>
<span id="cb19-1065"><a href="#cb19-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Provide clear legends</span>
<span id="cb19-1066"><a href="#cb19-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Consider alternative text</span>
<span id="cb19-1067"><a href="#cb19-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1068"><a href="#cb19-1068" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Data Representation**:</span>
<span id="cb19-1069"><a href="#cb19-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Choose appropriate plot types</span>
<span id="cb19-1070"><a href="#cb19-1070" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Scale axes appropriately</span>
<span id="cb19-1071"><a href="#cb19-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Handle missing data clearly</span>
<span id="cb19-1072"><a href="#cb19-1072" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Consider data density</span>
<span id="cb19-1073"><a href="#cb19-1073" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb19-1074"><a href="#cb19-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1075"><a href="#cb19-1075" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chapter Summary</span></span>
<span id="cb19-1076"><a href="#cb19-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1077"><a href="#cb19-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Concepts</span></span>
<span id="cb19-1078"><a href="#cb19-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1079"><a href="#cb19-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Descriptive Statistics**: Measures of central tendency (mean, median) and dispersion (SD, IQR) summarize data properties</span>
<span id="cb19-1080"><a href="#cb19-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Data Distributions**: Visualizing distributions helps identify skewness, multimodality, and outliers</span>
<span id="cb19-1081"><a href="#cb19-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Relationships**: Scatter plots and correlation matrices reveal associations between variables</span>
<span id="cb19-1082"><a href="#cb19-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Outliers**: Identifying extreme values is crucial for data quality and robust analysis</span>
<span id="cb19-1083"><a href="#cb19-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Missing Data**: Understanding missingness patterns informs appropriate handling strategies</span>
<span id="cb19-1084"><a href="#cb19-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1085"><a href="#cb19-1085" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Functions Learned</span></span>
<span id="cb19-1086"><a href="#cb19-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1087"><a href="#cb19-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`summarize()`</span> - Calculate summary statistics</span>
<span id="cb19-1088"><a href="#cb19-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_histogram()`</span> / <span class="in">`geom_density()`</span> - Visualize distributions</span>
<span id="cb19-1089"><a href="#cb19-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_boxplot()`</span> - Compare distributions and identify outliers</span>
<span id="cb19-1090"><a href="#cb19-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_point()`</span> - Create scatter plots</span>
<span id="cb19-1091"><a href="#cb19-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`cor()`</span> - Calculate correlation coefficients</span>
<span id="cb19-1092"><a href="#cb19-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`pairs()`</span> / <span class="in">`ggpairs()`</span> - Create pair plots for multiple variables</span>
<span id="cb19-1093"><a href="#cb19-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`is.na()`</span> - Detect missing values</span>
<span id="cb19-1094"><a href="#cb19-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1095"><a href="#cb19-1095" aria-hidden="true" tabindex="-1"></a><span class="fu">### Next Steps</span></span>
<span id="cb19-1096"><a href="#cb19-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1097"><a href="#cb19-1097" aria-hidden="true" tabindex="-1"></a>In the next chapter, we will move from exploration to inference, learning how to formulate and test scientific hypotheses using statistical methods.</span>
<span id="cb19-1098"><a href="#cb19-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1099"><a href="#cb19-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb19-1100"><a href="#cb19-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1101"><a href="#cb19-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Descriptive Statistics**: Calculate the mean, median, and standard deviation for a continuous variable in your own dataset.</span>
<span id="cb19-1102"><a href="#cb19-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Distribution Visualization**: Create a histogram and density plot for the same variable. Describe the shape of the distribution.</span>
<span id="cb19-1103"><a href="#cb19-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Group Comparison**: Use box plots to compare the distribution of a continuous variable across different groups (e.g., species, treatments).</span>
<span id="cb19-1104"><a href="#cb19-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Correlation Analysis**: Calculate the correlation matrix for a set of continuous variables and visualize it using a heatmap or pair plot.</span>
<span id="cb19-1105"><a href="#cb19-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Outlier Detection**: Identify potential outliers in your dataset using the IQR method or Z-scores.</span>
<span id="cb19-1106"><a href="#cb19-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>**Missing Data**: Visualize missing data patterns in your dataset and discuss potential reasons for missingness.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2024-2025 Jimmy Moses</p>
</div>   
    <div class="nav-footer-center">
<p>⚠️ <strong>FIRST DRAFT</strong> (First published 2024, Updated 2025) ⚠️</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jm0535/dains/edit/main/chapters/03-exploratory-analysis.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jm0535/dains/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/jm0535/dains/blob/main/chapters/03-exploratory-analysis.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>