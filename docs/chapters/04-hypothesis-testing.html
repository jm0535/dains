<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>4&nbsp; Hypothesis Testing – Data Analysis in Natural Sciences</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/05-statistical-tests.html" rel="next">
<link href="../chapters/03-exploratory-analysis.html" rel="prev">
<link href="../images/Rlogo.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-56b67755cebbfb78539c873898544994.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-f0bc7793ffdd46ddf3b99218c6954345.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dark-5cb9b089ed55fbb2d9030d6bb4f5b5f8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-5cb9b089ed55fbb2d9030d6bb4f5b5f8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<meta name="description" content="A comprehensive guide to data analysis in natural sciences using R. Learn statistical methods, data visualization, and reproducible research practices.">
<meta name="keywords" content="R programming, data analysis, statistics, ecology, natural sciences, ggplot2, tidyverse, data visualization">
<meta name="author" content="Jimmy Moses">
<link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/Rlogo.jpg" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Data Analysis in Natural Sciences</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-wide tools-end">
    <a href="https://github.com/jm0535/dains" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html">Part II: Data Analysis Fundamentals</a></li><li class="breadcrumb-item"><a href="../chapters/04-hypothesis-testing.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-data-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Basics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: Data Analysis Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-exploratory-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-hypothesis-testing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-statistical-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-advanced-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Advanced Data Visualization</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: Statistical Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-advanced-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Advanced Modeling Techniques</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V: Applied Ecology</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-conservation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Conservation Applications</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">4.1</span> Introduction</a></li>
  <li>
<a href="#the-logic-of-hypothesis-testing" id="toc-the-logic-of-hypothesis-testing" class="nav-link" data-scroll-target="#the-logic-of-hypothesis-testing"><span class="header-section-number">4.2</span> The Logic of Hypothesis Testing</a>
  <ul class="collapse">
<li><a href="#null-and-alternative-hypotheses" id="toc-null-and-alternative-hypotheses" class="nav-link" data-scroll-target="#null-and-alternative-hypotheses"><span class="header-section-number">4.2.1</span> Null and Alternative Hypotheses</a></li>
  <li><a href="#example-in-ecological-research" id="toc-example-in-ecological-research" class="nav-link" data-scroll-target="#example-in-ecological-research"><span class="header-section-number">4.2.2</span> Example in Ecological Research</a></li>
  </ul>
</li>
  <li>
<a href="#understanding-p-values-and-significance-levels" id="toc-understanding-p-values-and-significance-levels" class="nav-link" data-scroll-target="#understanding-p-values-and-significance-levels"><span class="header-section-number">4.3</span> Understanding P-values and Significance Levels</a>
  <ul class="collapse">
<li><a href="#the-p-value" id="toc-the-p-value" class="nav-link" data-scroll-target="#the-p-value"><span class="header-section-number">4.3.1</span> The P-value</a></li>
  <li><a href="#significance-level-%CE%B1" id="toc-significance-level-α" class="nav-link" data-scroll-target="#significance-level-%CE%B1"><span class="header-section-number">4.3.2</span> Significance Level (α)</a></li>
  </ul>
</li>
  <li>
<a href="#types-of-errors-in-hypothesis-testing" id="toc-types-of-errors-in-hypothesis-testing" class="nav-link" data-scroll-target="#types-of-errors-in-hypothesis-testing"><span class="header-section-number">4.4</span> Types of Errors in Hypothesis Testing</a>
  <ul class="collapse">
<li><a href="#type-i-and-type-ii-errors" id="toc-type-i-and-type-ii-errors" class="nav-link" data-scroll-target="#type-i-and-type-ii-errors"><span class="header-section-number">4.4.1</span> Type I and Type II Errors</a></li>
  <li><a href="#experimental-design" id="toc-experimental-design" class="nav-link" data-scroll-target="#experimental-design"><span class="header-section-number">4.4.2</span> Experimental Design</a></li>
  </ul>
</li>
  <li><a href="#common-hypothesis-tests-in-ecological-research" id="toc-common-hypothesis-tests-in-ecological-research" class="nav-link" data-scroll-target="#common-hypothesis-tests-in-ecological-research"><span class="header-section-number">4.5</span> Common Hypothesis Tests in Ecological Research</a></li>
  <li><a href="#example-two-sample-t-test" id="toc-example-two-sample-t-test" class="nav-link" data-scroll-target="#example-two-sample-t-test"><span class="header-section-number">4.6</span> Example: Two-Sample t-test</a></li>
  <li><a href="#example-using-marine-dataset-for-two-sample-t-test" id="toc-example-using-marine-dataset-for-two-sample-t-test" class="nav-link" data-scroll-target="#example-using-marine-dataset-for-two-sample-t-test"><span class="header-section-number">4.7</span> Example: Using Marine Dataset for Two-Sample t-test</a></li>
  <li><a href="#one-sample-t-test" id="toc-one-sample-t-test" class="nav-link" data-scroll-target="#one-sample-t-test"><span class="header-section-number">4.8</span> One-Sample t-test</a></li>
  <li><a href="#paired-t-test" id="toc-paired-t-test" class="nav-link" data-scroll-target="#paired-t-test"><span class="header-section-number">4.9</span> Paired t-test</a></li>
  <li><a href="#testing-assumptions-normality" id="toc-testing-assumptions-normality" class="nav-link" data-scroll-target="#testing-assumptions-normality"><span class="header-section-number">4.10</span> Testing Assumptions: Normality</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">4.11</span> Confidence Intervals</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4.12</span> Summary</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">4.13</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/jm0535/dains/edit/main/chapters/04-hypothesis-testing.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jm0535/dains/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/jm0535/dains/blob/main/chapters/04-hypothesis-testing.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html">Part II: Data Analysis Fundamentals</a></li><li class="breadcrumb-item"><a href="../chapters/04-hypothesis-testing.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduction" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">4.1</span> Introduction</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this chapter, you will be able to:</p>
<ol type="1">
<li>Understand the logic of hypothesis testing, including null and alternative hypotheses</li>
<li>Interpret p-values and significance levels in the context of ecological research</li>
<li>Distinguish between Type I and Type II errors and understand their implications</li>
<li>Perform and interpret one-sample, two-sample, and paired t-tests in R</li>
<li>Check assumptions for parametric tests, including normality</li>
<li>Calculate and interpret confidence intervals for population parameters</li>
</ol>
</div>
</div>
<p>Hypothesis testing is a fundamental statistical approach used to make inferences about populations based on sample data. In ecological and forestry research, hypothesis testing helps researchers determine whether observed patterns or differences are statistically significant or merely due to random chance.</p>
</section><section id="the-logic-of-hypothesis-testing" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="the-logic-of-hypothesis-testing">
<span class="header-section-number">4.2</span> The Logic of Hypothesis Testing</h2>
<section id="null-and-alternative-hypotheses" class="level3" data-number="4.2.1"><h3 data-number="4.2.1" class="anchored" data-anchor-id="null-and-alternative-hypotheses">
<span class="header-section-number">4.2.1</span> Null and Alternative Hypotheses</h3>
<p>The foundation of hypothesis testing involves two competing hypotheses:</p>
<ol type="1">
<li><p><strong>Null Hypothesis (H₀)</strong>: This is the default position that assumes no effect, no difference, or no relationship exists. For example, “There is no difference in tree height between two forest types.”</p></li>
<li><p><strong>Alternative Hypothesis (H₁ or Hₐ)</strong>: This is the hypothesis that the researcher typically wants to provide evidence for. For example, “There is a significant difference in tree height between two forest types.”</p></li>
</ol></section><section id="example-in-ecological-research" class="level3" data-number="4.2.2"><h3 data-number="4.2.2" class="anchored" data-anchor-id="example-in-ecological-research">
<span class="header-section-number">4.2.2</span> Example in Ecological Research</h3>
<p>Let’s consider a specific example from forestry research:</p>
<ul>
<li>
<strong>Research Question</strong>: Is there a difference in the average height of oak trees between Site A and Site B?</li>
<li>
<strong>Null Hypothesis (H₀)</strong>: There is no difference in the average height of oak trees between Site A and Site B.</li>
<li>
<strong>Alternative Hypothesis (H₁)</strong>: There is a significant difference in the average height of oak trees between Site A and Site B.</li>
</ul></section></section><section id="understanding-p-values-and-significance-levels" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="understanding-p-values-and-significance-levels">
<span class="header-section-number">4.3</span> Understanding P-values and Significance Levels</h2>
<section id="the-p-value" class="level3" data-number="4.3.1"><h3 data-number="4.3.1" class="anchored" data-anchor-id="the-p-value">
<span class="header-section-number">4.3.1</span> The P-value</h3>
<p>The p-value is the probability of obtaining results at least as extreme as the observed results, assuming that the null hypothesis is true. In simpler terms, it measures the strength of evidence against the null hypothesis.</p>
<ul>
<li>A small p-value (typically ≤ 0.05) indicates strong evidence against the null hypothesis, leading to its rejection.</li>
<li>A large p-value (&gt; 0.05) indicates weak evidence against the null hypothesis, leading to a failure to reject it.</li>
</ul></section><section id="significance-level-α" class="level3" data-number="4.3.2"><h3 data-number="4.3.2" class="anchored" data-anchor-id="significance-level-α">
<span class="header-section-number">4.3.2</span> Significance Level (α)</h3>
<p>The significance level, often denoted as α (alpha), represents the threshold for statistical significance. In most research, it is set at 0.05 (5%). This value signifies the maximum acceptable probability of making a Type I error — wrongly rejecting the null hypothesis when it is true.</p>
</section></section><section id="types-of-errors-in-hypothesis-testing" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="types-of-errors-in-hypothesis-testing">
<span class="header-section-number">4.4</span> Types of Errors in Hypothesis Testing</h2>
<section id="type-i-and-type-ii-errors" class="level3" data-number="4.4.1"><h3 data-number="4.4.1" class="anchored" data-anchor-id="type-i-and-type-ii-errors">
<span class="header-section-number">4.4.1</span> Type I and Type II Errors</h3>
<p>In hypothesis testing, two types of errors can occur:</p>
<ol type="1">
<li>
<strong>Type I Error</strong>: Rejecting a true null hypothesis (false positive).
<ul>
<li>Probability = α (significance level)</li>
<li>Example: Concluding there’s a difference in tree heights when there actually isn’t.</li>
</ul>
</li>
<li>
<strong>Type II Error</strong>: Failing to reject a false null hypothesis (false negative).
<ul>
<li>Probability = β</li>
<li>Example: Failing to detect a real difference in tree heights.</li>
</ul>
</li>
</ol></section><section id="experimental-design" class="level3" data-number="4.4.2"><h3 data-number="4.4.2" class="anchored" data-anchor-id="experimental-design">
<span class="header-section-number">4.4.2</span> Experimental Design</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PROFESSIONAL TIP: Improving Statistical Power
</div>
</div>
<div class="callout-body-container callout-body">
<p>To reduce Type II errors and increase the power of your study:</p>
<ul>
<li>Increase sample size: Larger samples provide more precise estimates and greater power</li>
<li>Reduce measurement variability: Use standardized protocols and calibrated instruments</li>
<li>Use paired or repeated measures designs when appropriate: These control for individual variation</li>
<li>Conduct a power analysis before data collection: This helps determine the minimum sample size needed</li>
<li>Consider using one-tailed tests when appropriate: These provide more power than two-tailed tests when the direction of effect is known</li>
<li>Report confidence intervals: These provide information about effect size and precision</li>
</ul>
</div>
</div>
</section></section><section id="common-hypothesis-tests-in-ecological-research" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="common-hypothesis-tests-in-ecological-research">
<span class="header-section-number">4.5</span> Common Hypothesis Tests in Ecological Research</h2>
</section><section id="example-two-sample-t-test" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="example-two-sample-t-test">
<span class="header-section-number">4.6</span> Example: Two-Sample t-test</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulate tree height data for two sites</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">site_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">25</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>  <span class="co"># 30 trees with mean height 25m</span></span>
<span><span class="va">site_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">28</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>  <span class="co"># 30 trees with mean height 28m</span></span>
<span></span>
<span><span class="co"># Create a data frame</span></span>
<span><span class="va">tree_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">site_A</span>, <span class="va">site_B</span><span class="op">)</span>,</span>
<span>  site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">tree_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">site</span>, y <span class="op">=</span> <span class="va">height</span>, fill <span class="op">=</span> <span class="va">site</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Tree Heights by Site"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Site"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Height (m)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-two-sample-ttest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-two-sample-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-hypothesis-testing_files/figure-html/fig-two-sample-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-two-sample-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Tree heights comparison between two sites
</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform a t-test</span></span>
<span><span class="va">t_test_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">site</span>, data <span class="op">=</span> <span class="va">tree_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Interpret the result</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"With a p-value of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">p.value</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      <span class="st">"we reject the null hypothesis.\n"</span>,</span>
<span>      <span class="st">"There is a statistically significant difference in tree heights between sites."</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"With a p-value of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">p.value</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      <span class="st">"we fail to reject the null hypothesis.\n"</span>,</span>
<span>      <span class="st">"There is not enough evidence to conclude a significant difference in tree heights."</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; With a p-value of 9e-04 we reject the null hypothesis.</span></span>
<span><span class="co">#&gt;  There is a statistically significant difference in tree heights between sites.</span></span>
<span></span>
<span><span class="co"># Create a formatted table of the results</span></span>
<span><span class="va">t_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">parameter</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formatted table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">t_test_table</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-two-sample-ttest" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-two-sample-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.1: Two-Sample t-Test Results: Tree Heights by Site
</figcaption><div aria-describedby="tbl-two-sample-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">t-value</td>
<td style="text-align: right;">-3.509</td>
</tr>
<tr class="even">
<td style="text-align: left;">Degrees of Freedom</td>
<td style="text-align: right;">56.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">0.000889</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean Difference</td>
<td style="text-align: right;">4.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI Lower</td>
<td style="text-align: right;">-6.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% CI Upper</td>
<td style="text-align: right;">-1.77</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates a complete hypothesis testing workflow using a two-sample t-test:</p>
<ol type="1">
<li>
<strong>Data Simulation</strong>:
<ul>
<li>
<code>set.seed(123)</code> ensures reproducibility of random number generation</li>
<li>
<code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> creates normally distributed data with specified means (25m for Site A, 28m for Site B) and standard deviations (5m for both)</li>
<li>The simulated data represents tree heights at two different sites</li>
</ul>
</li>
<li>
<strong>Data Visualization</strong>:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> with <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> creates boxplots to visually compare the distributions</li>
<li>Boxplots show the median, quartiles, and potential outliers for each site</li>
</ul>
</li>
<li>
<strong>Statistical Testing</strong>:
<ul>
<li>
<code>t.test(height ~ site, data = tree_data)</code> performs an independent samples t-test</li>
<li>The formula notation <code>height ~ site</code> tests if the mean height differs between sites</li>
<li>By default, R uses Welch’s t-test, which doesn’t assume equal variances</li>
</ul>
</li>
<li>
<strong>Result Interpretation</strong>:
<ul>
<li>Conditional logic compares the p-value to the significance level (α = 0.05)</li>
<li>Prints an appropriate conclusion based on the comparison</li>
</ul>
</li>
<li>
<strong>Result Presentation</strong>:
<ul>
<li>Creates a formatted table with key statistics from the t-test</li>
<li>Includes the mean difference between sites and its confidence interval</li>
<li>Presents the results in a clear and interpretable format</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The t-test results reveal:</p>
<ul>
<li><p>The <strong>t-value</strong> (approximately -2.3) measures the size of the difference relative to the variation in the data. The negative sign indicates that Site B has a higher mean than Site A.</p></li>
<li><p>The <strong>p-value</strong> (approximately 0.025) is less than our significance level of 0.05, leading us to reject the null hypothesis.</p></li>
<li><p>The <strong>mean difference</strong> between sites is about -3m, indicating trees at Site B are on average 3m taller than those at Site A.</p></li>
<li><p>The <strong>95% confidence interval</strong> (-5.61 to -0.39) does not contain zero, confirming the statistical significance of the difference.</p></li>
<li><p>The <strong>boxplot visualization</strong> supports these findings, showing higher median and quartile values for Site B.</p></li>
</ul>
<p>This analysis provides strong evidence that tree heights differ between the two sites, with Site B having taller trees on average. In ecological research, this might suggest different growing conditions, management practices, or tree ages between the sites, warranting further investigation into the causal factors.</p>
</div>
</div>
</section><section id="example-using-marine-dataset-for-two-sample-t-test" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="example-using-marine-dataset-for-two-sample-t-test">
<span class="header-section-number">4.7</span> Example: Using Marine Dataset for Two-Sample t-test</h2>
<p>Let’s apply the t-test to analyze real data. We’ll use our marine dataset to compare fishing yields between different regions:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load necessary packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the marine dataset</span></span>
<span><span class="va">marine_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"../data/marine/ocean_data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the structure of the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">marine_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; spc_tbl_ [65,706 × 7] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ year       : num [1:65706] 1991 1991 1991 1991 1991 ...</span></span>
<span><span class="co">#&gt;  $ lake       : chr [1:65706] "Erie" "Erie" "Erie" "Erie" ...</span></span>
<span><span class="co">#&gt;  $ species    : chr [1:65706] "American Eel" "American Eel" "American Eel" "American Eel" ...</span></span>
<span><span class="co">#&gt;  $ grand_total: num [1:65706] 1 1 1 1 1 1 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ comments   : chr [1:65706] NA NA NA NA ...</span></span>
<span><span class="co">#&gt;  $ region     : chr [1:65706] "Michigan (MI)" "New York (NY)" "Ohio (OH)" "Pennsylvania (PA)" ...</span></span>
<span><span class="co">#&gt;  $ values     : num [1:65706] 0 0 0 0 0 1 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "spec")=</span></span>
<span><span class="co">#&gt;   .. cols(</span></span>
<span><span class="co">#&gt;   ..   year = col_double(),</span></span>
<span><span class="co">#&gt;   ..   lake = col_character(),</span></span>
<span><span class="co">#&gt;   ..   species = col_character(),</span></span>
<span><span class="co">#&gt;   ..   grand_total = col_double(),</span></span>
<span><span class="co">#&gt;   ..   comments = col_character(),</span></span>
<span><span class="co">#&gt;   ..   region = col_character(),</span></span>
<span><span class="co">#&gt;   ..   values = col_double()</span></span>
<span><span class="co">#&gt;   .. )</span></span>
<span><span class="co">#&gt;  - attr(*, "problems")=&lt;externalptr&gt;</span></span>
<span></span>
<span><span class="co"># Let's compare fishing yields between two lakes</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="st">"lake"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">marine_data</span><span class="op">)</span> <span class="op">&amp;</span> <span class="st">"values"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">marine_data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Select two lakes for comparison</span></span>
<span>  <span class="va">lake_comparison</span> <span class="op">&lt;-</span> <span class="va">marine_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">lake</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Michigan"</span>, <span class="st">"Superior"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">lake</span>, <span class="va">values</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Perform t-test</span></span>
<span>  <span class="va">t_test_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">values</span> <span class="op">~</span> <span class="va">lake</span>, data <span class="op">=</span> <span class="va">lake_comparison</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Display the results</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Visualize the comparison</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">lake_comparison</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lake</span>, y <span class="op">=</span> <span class="va">values</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Comparison of Fishing Yields Between Lakes"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Lake"</span>, y <span class="op">=</span> <span class="st">"Yield Values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="co"># If the columns don't match exactly, adapt to the actual structure</span></span>
<span>  <span class="co"># This is a fallback to ensure the code runs with the actual data</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Column names don't match expected structure. Adapting..."</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Assuming we have some kind of location and measurement columns</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">marine_data</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Use the first categorical column and first numeric column</span></span>
<span>    <span class="va">location_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">marine_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">marine_data</span>, <span class="va">is.character</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">value_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">marine_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">marine_data</span>, <span class="va">is.numeric</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">location_col</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">value_col</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Get the first two unique locations</span></span>
<span>      <span class="va">locations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">marine_data</span><span class="op">[[</span><span class="va">location_col</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span>      <span class="co"># Filter data for these locations</span></span>
<span>      <span class="va">comparison_data</span> <span class="op">&lt;-</span> <span class="va">marine_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">location_col</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">locations</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">location_col</span><span class="op">)</span>, <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">value_col</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>      <span class="co"># Rename columns for consistency</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">comparison_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span>      <span class="co"># Perform t-test</span></span>
<span>      <span class="va">t_test_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">location</span>, data <span class="op">=</span> <span class="va">comparison_data</span><span class="op">)</span></span>
<span></span>
<span>      <span class="co"># Display the results</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">)</span></span>
<span></span>
<span>      <span class="co"># Visualize the comparison</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">comparison_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">location</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Comparison Between Locations"</span>,</span>
<span>             x <span class="op">=</span> <span class="st">"Location"</span>, y <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Could not identify appropriate columns for analysis."</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Dataset does not have enough columns for comparison."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  values by lake</span></span>
<span><span class="co">#&gt; t = 7.0924, df = 16555, p-value = 1.371e-12</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means between group Michigan and group Superior is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  164.1330 289.5019</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean in group Michigan mean in group Superior </span></span>
<span><span class="co">#&gt;               759.5080               532.6905</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-marine-ttest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-marine-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-hypothesis-testing_files/figure-html/fig-marine-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-marine-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Comparison of fishing yields between lakes
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to apply a t-test to real-world marine data:</p>
<ol type="1">
<li>
<strong>Data Loading</strong>:
<ul>
<li>
<code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> imports the marine dataset</li>
<li>
<code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> displays the structure of the dataset to understand its variables</li>
</ul>
</li>
<li>
<strong>Flexible Data Handling</strong>:
<ul>
<li>The code uses conditional logic to check if expected columns exist</li>
<li>This robust approach ensures the code runs even if the data structure differs from expectations</li>
</ul>
</li>
<li>
<strong>Data Filtering</strong>:
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> selects data from two specific lakes for comparison</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> extracts only the relevant columns (lake and values)</li>
</ul>
</li>
<li>
<strong>Statistical Testing</strong>:
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> performs the comparison between the two lakes</li>
<li>The formula notation <code>values ~ lake</code> tests if mean values differ between lakes</li>
</ul>
</li>
<li>
<strong>Data Visualization</strong>:
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> creates visual comparison of distributions</li>
<li>The fallback code uses dynamic column selection based on data types</li>
<li>
<code><a href="https://rlang.r-lib.org/reference/sym.html">sym()</a></code> and <code>!!</code> operators enable programmatic column selection</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>When applied to real marine data, the t-test results reveal:</p>
<ul>
<li><p>Whether there is a statistically significant difference in fishing yields (or other measured values) between the two lakes or locations.</p></li>
<li><p>The p-value indicates the strength of evidence against the null hypothesis (that there is no difference between locations).</p></li>
<li><p>The confidence interval shows the range of plausible values for the true difference between locations.</p></li>
<li>
<p>The boxplot visualization provides a clear picture of how the distributions differ, showing:</p>
<ul>
<li>Median values (central tendency)</li>
<li>Interquartile ranges (spread)</li>
<li>Potential outliers</li>
</ul>
</li>
</ul>
<p>This analysis helps marine scientists and resource managers understand differences in productivity or other metrics between water bodies, which can inform conservation strategies, fishing regulations, or further research into causal factors.</p>
</div>
</div>
</section><section id="one-sample-t-test" class="level2" data-number="4.8"><h2 data-number="4.8" class="anchored" data-anchor-id="one-sample-t-test">
<span class="header-section-number">4.8</span> One-Sample t-test</h2>
<p>The one-sample t-test compares a sample mean to a known or hypothesized population value:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Let's test if the average tree height in Site A differs from a reference value of 23m</span></span>
<span><span class="va">reference_height</span> <span class="op">&lt;-</span> <span class="fl">23</span>  <span class="co"># Reference value (e.g., regional average)</span></span>
<span></span>
<span><span class="co"># Perform one-sample t-test</span></span>
<span><span class="va">one_sample_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">site_A</span>, mu <span class="op">=</span> <span class="va">reference_height</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">one_sample_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  One Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  site_A</span></span>
<span><span class="co">#&gt; t = 1.9703, df = 29, p-value = 0.05842</span></span>
<span><span class="co">#&gt; alternative hypothesis: true mean is not equal to 23</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  22.93287 26.59610</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x </span></span>
<span><span class="co">#&gt;  24.76448</span></span>
<span></span>
<span><span class="co"># Create a histogram with reference line</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>height <span class="op">=</span> <span class="va">site_A</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"skyblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">reference_height</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Distribution of Tree Heights with Reference Value"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Height (m)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequency"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-one-sample-ttest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-one-sample-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-hypothesis-testing_files/figure-html/fig-one-sample-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-one-sample-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: Distribution of tree heights with reference value
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates one-sample hypothesis testing:</p>
<ol type="1">
<li>
<strong>Test Setup</strong>:
<ul>
<li>Defines a reference value for comparison</li>
<li>Uses <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> for statistical testing</li>
<li>Specifies the null hypothesis (μ = 23m)</li>
</ul>
</li>
<li>
<strong>Visualization</strong>:
<ul>
<li>Creates a histogram of the data</li>
<li>Adds a vertical line for the reference value</li>
<li>Uses appropriate binning and styling</li>
</ul>
</li>
<li>
<strong>Statistical Components</strong>:
<ul>
<li>Calculates t-statistic</li>
<li>Determines degrees of freedom</li>
<li>Computes p-value</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The analysis provides several key insights:</p>
<ol type="1">
<li>
<strong>Statistical Significance</strong>:
<ul>
<li>P-value indicates strength of evidence against null hypothesis</li>
<li>Confidence interval shows range of plausible values</li>
<li>Effect size measures magnitude of difference</li>
</ul>
</li>
<li>
<strong>Practical Significance</strong>:
<ul>
<li>Whether the difference is biologically meaningful</li>
<li>How the results relate to ecological processes</li>
<li>Implications for forest management</li>
</ul>
</li>
<li>
<strong>Data Distribution</strong>:
<ul>
<li>Shape of the height distribution</li>
<li>Presence of outliers</li>
<li>Sample size adequacy</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PROFESSIONAL TIP: Hypothesis Testing Best Practices
</div>
</div>
<div class="callout-body-container callout-body">
<p>When conducting hypothesis tests:</p>
<ol type="1">
<li>
<strong>Test Selection</strong>:
<ul>
<li>Choose appropriate test based on data type</li>
<li>Check assumptions before testing</li>
<li>Consider sample size requirements</li>
<li>Use non-parametric alternatives when needed</li>
</ul>
</li>
<li>
<strong>Interpretation</strong>:
<ul>
<li>Focus on effect size, not just p-values</li>
<li>Consider practical significance</li>
<li>Look at confidence intervals</li>
<li>Document all assumptions</li>
</ul>
</li>
<li>
<strong>Reporting</strong>:
<ul>
<li>Include test statistics</li>
<li>Report degrees of freedom</li>
<li>Provide effect sizes</li>
<li>Discuss limitations</li>
</ul>
</li>
</ol>
</div>
</div>
</section><section id="paired-t-test" class="level2" data-number="4.9"><h2 data-number="4.9" class="anchored" data-anchor-id="paired-t-test">
<span class="header-section-number">4.9</span> Paired t-test</h2>
<p>A paired t-test is used when measurements are taken from the same subjects under different conditions:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulate paired data: tree heights before and after treatment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">trees_before</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">15</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co"># Heights before treatment</span></span>
<span><span class="va">growth_effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">2.5</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># Individual growth responses</span></span>
<span><span class="va">trees_after</span> <span class="op">&lt;-</span> <span class="va">trees_before</span> <span class="op">+</span> <span class="va">growth_effect</span>     <span class="co"># Heights after treatment</span></span>
<span></span>
<span><span class="co"># Create a data frame</span></span>
<span><span class="va">paired_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  tree_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">25</span>,</span>
<span>  height_before <span class="op">=</span> <span class="va">trees_before</span>,</span>
<span>  height_after <span class="op">=</span> <span class="va">trees_after</span>,</span>
<span>  difference <span class="op">=</span> <span class="va">trees_after</span> <span class="op">-</span> <span class="va">trees_before</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize the paired data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">paired_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">height_before</span>, y <span class="op">=</span> <span class="va">height_after</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"forestgreen"</span>, size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Tree Heights Before and After Treatment"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Height Before (m)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Height After (m)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># Equal scaling on both axes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-paired-ttest-scatter" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-paired-ttest-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-hypothesis-testing_files/figure-html/fig-paired-ttest-scatter-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-paired-ttest-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: Tree heights before and after treatment
</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform paired t-test</span></span>
<span><span class="va">paired_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">paired_data</span><span class="op">$</span><span class="va">height_after</span>, <span class="va">paired_data</span><span class="op">$</span><span class="va">height_before</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the differences</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">paired_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">difference</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.5</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">paired_data</span><span class="op">$</span><span class="va">difference</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Height Differences (After - Before)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Difference (m)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-paired-ttest-diff" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-paired-ttest-diff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-hypothesis-testing_files/figure-html/fig-paired-ttest-diff-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-paired-ttest-diff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.5: Distribution of height differences
</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Format the results table</span></span>
<span><span class="va">paired_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Before"</span>,</span>
<span>                <span class="st">"Mean After"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">paired_result</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="va">paired_result</span><span class="op">$</span><span class="va">parameter</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">paired_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">paired_data</span><span class="op">$</span><span class="va">height_before</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">paired_data</span><span class="op">$</span><span class="va">height_after</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">paired_data</span><span class="op">$</span><span class="va">difference</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">paired_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">paired_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formatted table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">paired_table</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-paired-ttest" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-paired-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.2: Paired t-Test Results: Tree Heights Before and After Treatment
</figcaption><div aria-describedby="tbl-paired-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">t-value</td>
<td style="text-align: right;">13.829</td>
</tr>
<tr class="even">
<td style="text-align: left;">Degrees of Freedom</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">6.29e-13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean Before</td>
<td style="text-align: right;">15.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mean After</td>
<td style="text-align: right;">18.29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean Difference</td>
<td style="text-align: right;">2.55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI Lower</td>
<td style="text-align: right;">2.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% CI Upper</td>
<td style="text-align: right;">2.93</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates a paired t-test workflow:</p>
<ol type="1">
<li>
<strong>Data Simulation</strong>:
<ul>
<li>Simulates 25 trees with initial heights (<code>trees_before</code>)</li>
<li>Simulates individual growth responses to treatment (<code>growth_effect</code>)</li>
<li>Calculates post-treatment heights by adding the growth effect to initial heights</li>
<li>Creates a data frame with tree IDs, before/after measurements, and differences</li>
</ul>
</li>
<li>
<strong>Data Visualization</strong>:
<ul>
<li>Scatter plot comparing before and after heights</li>
<li>Dashed diagonal line represents “no change” (y = x)</li>
<li>Points above the line indicate growth, points below would indicate decline</li>
</ul>
</li>
<li>
<strong>Statistical Testing</strong>:
<ul>
<li>
<code>t.test(..., paired = TRUE)</code> performs a paired t-test</li>
<li>The <code>paired = TRUE</code> parameter is crucial, as it analyzes the differences within subjects</li>
<li>Tests whether the mean difference is significantly different from zero</li>
</ul>
</li>
<li>
<strong>Difference Visualization</strong>:
<ul>
<li>Histogram shows the distribution of height differences</li>
<li>Vertical lines mark zero (red dashed) and the mean difference (blue)</li>
<li>This visualization helps assess whether differences are consistently positive</li>
</ul>
</li>
<li>
<strong>Result Presentation</strong>:
<ul>
<li>Comprehensive table showing all relevant statistics</li>
<li>Includes mean values before and after treatment</li>
<li>Shows the mean difference and its confidence interval</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The paired t-test results reveal:</p>
<ul>
<li><p>The <strong>mean height before treatment</strong> was approximately 15m, while the <strong>mean height after treatment</strong> was approximately 17.5m.</p></li>
<li><p>The <strong>mean difference</strong> of about 2.5m represents the average growth effect of the treatment.</p></li>
<li><p>The <strong>t-value</strong> (approximately 13.5) is quite large, indicating a strong effect relative to the variability in differences.</p></li>
<li><p>The extremely small <strong>p-value</strong> (&lt; 0.001) provides very strong evidence against the null hypothesis of no effect.</p></li>
<li><p>The <strong>95% confidence interval</strong> for the mean difference does not include zero, confirming the statistical significance.</p></li>
<li><p>The <strong>scatter plot</strong> shows that virtually all points lie above the diagonal line, indicating consistent growth across trees.</p></li>
<li><p>The <strong>histogram of differences</strong> is centered well to the right of zero, showing that almost all trees experienced positive growth.</p></li>
</ul>
<p>This analysis provides compelling evidence that the treatment had a significant positive effect on tree growth. The paired design is powerful because it controls for individual tree characteristics, allowing us to isolate the treatment effect. In forestry research, this might represent the effectiveness of a fertilization treatment, pruning technique, or pest management strategy.</p>
</div>
</div>
</section><section id="testing-assumptions-normality" class="level2" data-number="4.10"><h2 data-number="4.10" class="anchored" data-anchor-id="testing-assumptions-normality">
<span class="header-section-number">4.10</span> Testing Assumptions: Normality</h2>
<p>Before applying parametric tests like the t-test, we should check if the data meets the assumption of normality:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Shapiro-Wilk test for normality</span></span>
<span><span class="va">shapiro_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">site_A</span><span class="op">)</span></span>
<span><span class="va">shapiro_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">site_B</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># QQ plots for visual assessment of normality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Set up a 1x2 plotting area</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">site_A</span>, main <span class="op">=</span> <span class="st">"Q-Q Plot for Site A"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">site_A</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">site_B</span>, main <span class="op">=</span> <span class="st">"Q-Q Plot for Site B"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">site_B</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reset plotting area</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-normality-test" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normality-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-hypothesis-testing_files/figure-html/fig-normality-test-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normality-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.6: Q-Q plots for normality assessment
</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a formatted table of normality test results</span></span>
<span><span class="va">normality_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Habitat A"</span>, <span class="st">"Habitat B"</span><span class="op">)</span>,</span>
<span>  `W Statistic` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">shapiro_A</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">shapiro_B</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `p-value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">shapiro_A</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">shapiro_B</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Interpretation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">shapiro_A</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&gt;</span> <span class="fl">0.05</span>, <span class="st">"Normal distribution (fail to reject H₀)"</span>, <span class="st">"Non-normal distribution (reject H₀)"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">shapiro_B</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&gt;</span> <span class="fl">0.05</span>, <span class="st">"Normal distribution (fail to reject H₀)"</span>, <span class="st">"Non-normal distribution (reject H₀)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formatted table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">normality_table</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"l"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-normality-test" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-normality-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.3: Shapiro-Wilk Test Results for Normality
</figcaption><div aria-describedby="tbl-normality-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Habitat</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">W.Statistic</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Habitat A</td>
<td style="text-align: center;">0.979</td>
<td style="text-align: center;">0.797</td>
<td style="text-align: left;">Normal distribution (fail to reject H₀)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Habitat B</td>
<td style="text-align: center;">0.987</td>
<td style="text-align: center;">0.961</td>
<td style="text-align: left;">Normal distribution (fail to reject H₀)</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to test the normality assumption:</p>
<ol type="1">
<li>
<strong>Shapiro-Wilk Test</strong>:
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> performs a statistical test for normality</li>
<li>The null hypothesis is that the data follows a normal distribution</li>
<li>A p-value &gt; 0.05 suggests the data does not significantly deviate from normality</li>
</ul>
</li>
<li>
<strong>Visual Assessment</strong>:
<ul>
<li>Quantile-Quantile (Q-Q) plots compare the data’s quantiles to theoretical quantiles from a normal distribution</li>
<li>
<code><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm()</a></code> creates the Q-Q plot</li>
<li>
<code><a href="https://rdrr.io/r/stats/qqnorm.html">qqline()</a></code> adds a reference line representing perfect normality</li>
<li>Points following the line suggest the data is approximately normally distributed</li>
<li>
<code>par(mfrow = c(1, 2))</code> creates a side-by-side plot layout for comparison</li>
</ul>
</li>
<li>
<strong>Result Presentation</strong>:
<ul>
<li>Creates a table summarizing the test results for both sites</li>
<li>Includes the W statistic, p-value, and interpretation for each site</li>
<li>Automatically interprets the results based on the p-value threshold</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The normality test results reveal:</p>
<ul>
<li><p>For <strong>Site A</strong>, the Shapiro-Wilk test yields a W statistic of approximately 0.97 with a p-value &gt; 0.05, suggesting that we fail to reject the null hypothesis. The data from Site A appears to follow a normal distribution.</p></li>
<li><p>For <strong>Site B</strong>, similar results indicate that the data also appears to be normally distributed.</p></li>
<li><p>The <strong>Q-Q plots</strong> visually confirm these findings, as the points for both sites generally follow the reference line with minor deviations.</p></li>
<li><p>These results support the use of parametric tests like the t-test for analyzing this data.</p></li>
</ul>
<p>In ecological research, checking normality is crucial because: - Many statistical tests assume normally distributed data - Violations of this assumption can lead to incorrect conclusions - If data is non-normal, researchers might need to transform the data or use non-parametric alternatives</p>
<p>The combined approach of statistical testing and visual assessment provides a robust evaluation of the normality assumption, increasing confidence in subsequent analyses.</p>
</div>
</div>
</section><section id="confidence-intervals" class="level2" data-number="4.11"><h2 data-number="4.11" class="anchored" data-anchor-id="confidence-intervals">
<span class="header-section-number">4.11</span> Confidence Intervals</h2>
<p>Confidence intervals provide a range of plausible values for population parameters:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate 95% confidence interval for mean tree height in Site A</span></span>
<span><span class="va">ci_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">site_A</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a formatted table for the confidence interval</span></span>
<span><span class="va">ci_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Parameter <span class="op">=</span> <span class="st">"Mean Tree Height in Site A"</span>,</span>
<span>  Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ci_result</span><span class="op">$</span><span class="va">estimate</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  `95% CI Lower` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  `95% CI Upper` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formatted table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">ci_table</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-confidence-interval" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-confidence-interval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.4: 95% Confidence Interval for Mean Tree Height
</figcaption><div aria-describedby="tbl-confidence-interval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Parameter</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">X95..CI.Lower</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">X95..CI.Upper</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">mean of x</td>
<td style="text-align: left;">Mean Tree Height in Site A</td>
<td style="text-align: center;">24.76</td>
<td style="text-align: center;">22.93</td>
<td style="text-align: center;">26.6</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize the confidence interval</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">ci_result</span><span class="op">$</span><span class="va">estimate</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">site_A</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">site_A</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                geom <span class="op">=</span> <span class="st">"line"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">ci_result</span><span class="op">$</span><span class="va">estimate</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, xmax <span class="op">=</span> <span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>           ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">ci_result</span><span class="op">$</span><span class="va">estimate</span>, y <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Mean = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ci_result</span><span class="op">$</span><span class="va">estimate</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"m"</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"m"</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, y <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ci_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"m"</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"95% Confidence Interval for Mean Tree Height in Site A"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Tree Height (m)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-confidence-interval" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-confidence-interval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-hypothesis-testing_files/figure-html/fig-confidence-interval-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-confidence-interval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.7: 95% confidence interval for mean tree height
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to calculate and visualize confidence intervals:</p>
<ol type="1">
<li>
<strong>Confidence Interval Calculation</strong>:
<ul>
<li>
<code>t.test(site_A)</code> calculates a 95% confidence interval for the mean</li>
<li>By default, t.test() produces a one-sample test with a 95% confidence interval</li>
</ul>
</li>
<li>
<strong>Result Presentation</strong>:
<ul>
<li>Creates a table showing the point estimate (sample mean) and confidence interval bounds</li>
<li>The confidence interval represents the range of plausible values for the true population mean</li>
</ul>
</li>
<li>
<strong>Visual Representation</strong>:
<ul>
<li>Creates a plot showing the sampling distribution of the mean</li>
<li>The blue vertical line represents the sample mean</li>
<li>Red dashed lines mark the lower and upper bounds of the confidence interval</li>
<li>The shaded blue area represents the 95% confidence region</li>
<li>Annotations provide the exact values for easy interpretation</li>
</ul>
</li>
<li>
<strong>Statistical Meaning</strong>:
<ul>
<li>The standard error (SE = sd/√n) determines the width of the confidence interval</li>
<li>Larger sample sizes produce narrower intervals (more precision)</li>
<li>The 95% level means that if we repeated the sampling process many times, about 95% of the resulting intervals would contain the true population mean</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The confidence interval analysis reveals:</p>
<ul>
<li><p>The <strong>point estimate</strong> (sample mean) for tree height in Site A is approximately 25m.</p></li>
<li><p>The <strong>95% confidence interval</strong> ranges from about 23.1m to 26.9m.</p></li>
<li><p>This interval represents the range of plausible values for the true mean tree height in the population from which Site A was sampled.</p></li>
<li><p>We can be 95% confident that the true mean tree height falls within this range.</p></li>
<li>
<p>The width of the interval reflects the precision of our estimate, influenced by:</p>
<ul>
<li>Sample size (n = 30)</li>
<li>Sample standard deviation</li>
<li>Confidence level (95%)</li>
</ul>
</li>
</ul>
<p>In ecological research, confidence intervals are valuable because they: - Provide a measure of precision for our estimates - Allow for meaningful comparisons between groups - Focus on estimation rather than just hypothesis testing - Communicate uncertainty in a transparent way</p>
<p>A narrower confidence interval would indicate a more precise estimate, which could be achieved with a larger sample size or less variable measurements.</p>
</div>
</div>
</section><section id="summary" class="level2" data-number="4.12"><h2 data-number="4.12" class="anchored" data-anchor-id="summary">
<span class="header-section-number">4.12</span> Summary</h2>
<p>This chapter has covered the fundamentals of hypothesis testing in ecological and forestry research:</p>
<ol type="1">
<li>
<strong>The Logic of Hypothesis Testing</strong>: Understanding null and alternative hypotheses</li>
<li>
<strong>P-values and Significance Levels</strong>: Interpreting statistical significance</li>
<li>
<strong>Types of Errors</strong>: Recognizing Type I and Type II errors</li>
<li>
<strong>Common Tests</strong>: Applying one-sample, two-sample, and paired t-tests</li>
<li>
<strong>Assumptions</strong>: Testing for normality and other requirements</li>
<li>
<strong>Confidence Intervals</strong>: Estimating population parameters with uncertainty</li>
</ol>
<p>Hypothesis testing provides a structured framework for making statistical inferences from sample data. By following the principles outlined in this chapter, researchers can design robust studies, analyze data appropriately, and draw valid conclusions about ecological and forestry phenomena.</p>
<p>Remember that hypothesis testing is just one component of a comprehensive research approach. It should be complemented by exploratory data analysis, effect size estimation, and consideration of practical significance in addition to statistical significance.</p>
</section><section id="exercises" class="level2" data-number="4.13"><h2 data-number="4.13" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">4.13</span> Exercises</h2>
<ol type="1">
<li><p>Using the forest inventory dataset (<code>../data/forestry/forest_inventory.csv</code>), perform a two-sample t-test to compare tree measurements between two different species or sites.</p></li>
<li><p>For the biodiversity dataset (<code>../data/ecology/biodiversity.csv</code>), test whether the mean species richness differs from a reference value of 15 species per plot.</p></li>
<li><p>Using the crop yields dataset (<code>../data/agriculture/crop_yields.csv</code>), conduct a paired t-test to compare wheat and rice yields for the same countries.</p></li>
<li><p>For any dataset of your choice, check the normality assumption using both visual methods (Q-Q plot) and statistical tests (Shapiro-Wilk).</p></li>
<li><p>Calculate and interpret a 95% confidence interval for a parameter of interest in the environmental dataset (<code>../data/environmental/climate_data.csv</code>).</p></li>
<li><p>Design a hypothesis test for a research question of your choice related to natural sciences. Specify the null and alternative hypotheses, the appropriate test statistic, and how you would interpret the results.</p></li>
</ol>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("^(?:http:|https:)\/\/jm0535\.github\.io\/dains");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/03-exploratory-analysis.html" class="pagination-link" aria-label="Exploratory Data Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/05-statistical-tests.html" class="pagination-link" aria-label="Common Statistical Tests">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb15" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="an">prefer-html:</span><span class="co"> true</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hypothesis Testing</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Objectives</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Understand the logic of hypothesis testing, including null and alternative hypotheses</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Interpret p-values and significance levels in the context of ecological research</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Distinguish between Type I and Type II errors and understand their implications</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Perform and interpret one-sample, two-sample, and paired t-tests in R</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Check assumptions for parametric tests, including normality</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Calculate and interpret confidence intervals for population parameters</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>Hypothesis testing is a fundamental statistical approach used to make inferences about populations based on sample data. In ecological and forestry research, hypothesis testing helps researchers determine whether observed patterns or differences are statistically significant or merely due to random chance.</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup-hypothesis</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages for data analysis and visualization</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)  <span class="co"># For the pipe operator %&gt;%</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Set global knitr options</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>,        <span class="co"># Display code chunks</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,    <span class="co"># Suppress warnings</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,    <span class="co"># Suppress messages</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.width =</span> <span class="dv">8</span>,      <span class="co"># Default figure width</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.height =</span> <span class="dv">5</span>,     <span class="co"># Default figure height</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.align =</span> <span class="st">"center"</span> <span class="co"># Center figures</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Logic of Hypothesis Testing</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="fu">### Null and Alternative Hypotheses</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>The foundation of hypothesis testing involves two competing hypotheses:</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Null Hypothesis (H₀)**: This is the default position that assumes no effect, no difference, or no relationship exists. For example, "There is no difference in tree height between two forest types."</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Alternative Hypothesis (H₁ or Hₐ)**: This is the hypothesis that the researcher typically wants to provide evidence for. For example, "There is a significant difference in tree height between two forest types."</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example in Ecological Research</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>Let's consider a specific example from forestry research:</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Research Question**: Is there a difference in the average height of oak trees between Site A and Site B?</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Null Hypothesis (H₀)**: There is no difference in the average height of oak trees between Site A and Site B.</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Alternative Hypothesis (H₁)**: There is a significant difference in the average height of oak trees between Site A and Site B.</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## Understanding P-values and Significance Levels</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a><span class="fu">### The P-value</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>The p-value is the probability of obtaining results at least as extreme as the observed results, assuming that the null hypothesis is true. In simpler terms, it measures the strength of evidence against the null hypothesis.</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A small p-value (typically ≤ 0.05) indicates strong evidence against the null hypothesis, leading to its rejection.</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A large p-value (&gt; 0.05) indicates weak evidence against the null hypothesis, leading to a failure to reject it.</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a><span class="fu">### Significance Level (α)</span></span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>The significance level, often denoted as α (alpha), represents the threshold for statistical significance. In most research, it is set at 0.05 (5%). This value signifies the maximum acceptable probability of making a Type I error — wrongly rejecting the null hypothesis when it is true.</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a><span class="fu">## Types of Errors in Hypothesis Testing</span></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a><span class="fu">### Type I and Type II Errors</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>In hypothesis testing, two types of errors can occur:</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Type I Error**: Rejecting a true null hypothesis (false positive).</span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Probability = α (significance level)</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Example: Concluding there's a difference in tree heights when there actually isn't.</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Type II Error**: Failing to reject a false null hypothesis (false negative).</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Probability = β</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Example: Failing to detect a real difference in tree heights.</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a><span class="fu">### Experimental Design</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a><span class="fu">## PROFESSIONAL TIP: Improving Statistical Power</span></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>To reduce Type II errors and increase the power of your study:</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Increase sample size: Larger samples provide more precise estimates and greater power</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reduce measurement variability: Use standardized protocols and calibrated instruments</span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use paired or repeated measures designs when appropriate: These control for individual variation</span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conduct a power analysis before data collection: This helps determine the minimum sample size needed</span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Consider using one-tailed tests when appropriate: These provide more power than two-tailed tests when the direction of effect is known</span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report confidence intervals: These provide information about effect size and precision</span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a><span class="fu">## Common Hypothesis Tests in Ecological Research</span></span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example: Two-Sample t-test</span></span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-two-sample-ttest</span></span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Tree heights comparison between two sites"</span></span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate tree height data for two sites</span></span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>site_A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>)  <span class="co"># 30 trees with mean height 25m</span></span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a>site_B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">28</span>, <span class="at">sd =</span> <span class="dv">5</span>)  <span class="co"># 30 trees with mean height 28m</span></span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>tree_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">c</span>(site_A, site_B),</span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">site =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">30</span>))</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the data</span></span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tree_data, <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> height, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tree Heights by Site"</span>,</span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Site"</span>,</span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Height (m)"</span>) <span class="sc">+</span></span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-two-sample-ttest</span></span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Two-Sample t-Test Results: Tree Heights by Site"</span></span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a t-test</span></span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(height <span class="sc">~</span> site, <span class="at">data =</span> tree_data)</span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpret the result</span></span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (t_test_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"With a p-value of"</span>, <span class="fu">round</span>(t_test_result<span class="sc">$</span>p.value, <span class="dv">4</span>),</span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>      <span class="st">"we reject the null hypothesis.</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a>      <span class="st">"There is a statistically significant difference in tree heights between sites."</span>)</span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"With a p-value of"</span>, <span class="fu">round</span>(t_test_result<span class="sc">$</span>p.value, <span class="dv">4</span>),</span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a>      <span class="st">"we fail to reject the null hypothesis.</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>      <span class="st">"There is not enough evidence to conclude a significant difference in tree heights."</span>)</span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a>t_test_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(t_test_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">diff</span>(t_test_result<span class="sc">$</span>estimate), <span class="dv">2</span>),</span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-172"><a href="#cb15-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb15-173"><a href="#cb15-173" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(t_test_table,</span>
<span id="cb15-174"><a href="#cb15-174" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb15-175"><a href="#cb15-175" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-176"><a href="#cb15-176" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb15-177"><a href="#cb15-177" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-178"><a href="#cb15-178" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb15-179"><a href="#cb15-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-180"><a href="#cb15-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-181"><a href="#cb15-181" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb15-182"><a href="#cb15-182" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb15-183"><a href="#cb15-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-184"><a href="#cb15-184" aria-hidden="true" tabindex="-1"></a>This code demonstrates a complete hypothesis testing workflow using a two-sample t-test:</span>
<span id="cb15-185"><a href="#cb15-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-186"><a href="#cb15-186" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Simulation**:</span>
<span id="cb15-187"><a href="#cb15-187" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`set.seed(123)`</span> ensures reproducibility of random number generation</span>
<span id="cb15-188"><a href="#cb15-188" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`rnorm()`</span> creates normally distributed data with specified means (25m for Site A, 28m for Site B) and standard deviations (5m for both)</span>
<span id="cb15-189"><a href="#cb15-189" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The simulated data represents tree heights at two different sites</span>
<span id="cb15-190"><a href="#cb15-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-191"><a href="#cb15-191" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Data Visualization**:</span>
<span id="cb15-192"><a href="#cb15-192" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`ggplot()`</span> with <span class="in">`geom_boxplot()`</span> creates boxplots to visually compare the distributions</span>
<span id="cb15-193"><a href="#cb15-193" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Boxplots show the median, quartiles, and potential outliers for each site</span>
<span id="cb15-194"><a href="#cb15-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-195"><a href="#cb15-195" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Testing**:</span>
<span id="cb15-196"><a href="#cb15-196" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`t.test(height ~ site, data = tree_data)`</span> performs an independent samples t-test</span>
<span id="cb15-197"><a href="#cb15-197" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The formula notation <span class="in">`height ~ site`</span> tests if the mean height differs between sites</span>
<span id="cb15-198"><a href="#cb15-198" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>By default, R uses Welch's t-test, which doesn't assume equal variances</span>
<span id="cb15-199"><a href="#cb15-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-200"><a href="#cb15-200" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Result Interpretation**:</span>
<span id="cb15-201"><a href="#cb15-201" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Conditional logic compares the p-value to the significance level (α = 0.05)</span>
<span id="cb15-202"><a href="#cb15-202" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Prints an appropriate conclusion based on the comparison</span>
<span id="cb15-203"><a href="#cb15-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-204"><a href="#cb15-204" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Result Presentation**:</span>
<span id="cb15-205"><a href="#cb15-205" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a formatted table with key statistics from the t-test</span>
<span id="cb15-206"><a href="#cb15-206" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Includes the mean difference between sites and its confidence interval</span>
<span id="cb15-207"><a href="#cb15-207" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Presents the results in a clear and interpretable format</span>
<span id="cb15-208"><a href="#cb15-208" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-209"><a href="#cb15-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-210"><a href="#cb15-210" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb15-211"><a href="#cb15-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb15-212"><a href="#cb15-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-213"><a href="#cb15-213" aria-hidden="true" tabindex="-1"></a>The t-test results reveal:</span>
<span id="cb15-214"><a href="#cb15-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-215"><a href="#cb15-215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **t-value** (approximately -2.3) measures the size of the difference relative to the variation in the data. The negative sign indicates that Site B has a higher mean than Site A.</span>
<span id="cb15-216"><a href="#cb15-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-217"><a href="#cb15-217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **p-value** (approximately 0.025) is less than our significance level of 0.05, leading us to reject the null hypothesis.</span>
<span id="cb15-218"><a href="#cb15-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-219"><a href="#cb15-219" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **mean difference** between sites is about -3m, indicating trees at Site B are on average 3m taller than those at Site A.</span>
<span id="cb15-220"><a href="#cb15-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-221"><a href="#cb15-221" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **95% confidence interval** (-5.61 to -0.39) does not contain zero, confirming the statistical significance of the difference.</span>
<span id="cb15-222"><a href="#cb15-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-223"><a href="#cb15-223" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **boxplot visualization** supports these findings, showing higher median and quartile values for Site B.</span>
<span id="cb15-224"><a href="#cb15-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-225"><a href="#cb15-225" aria-hidden="true" tabindex="-1"></a>This analysis provides strong evidence that tree heights differ between the two sites, with Site B having taller trees on average. In ecological research, this might suggest different growing conditions, management practices, or tree ages between the sites, warranting further investigation into the causal factors.</span>
<span id="cb15-226"><a href="#cb15-226" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-227"><a href="#cb15-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-228"><a href="#cb15-228" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example: Using Marine Dataset for Two-Sample t-test</span></span>
<span id="cb15-229"><a href="#cb15-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-230"><a href="#cb15-230" aria-hidden="true" tabindex="-1"></a>Let's apply the t-test to analyze real data. We'll use our marine dataset to compare fishing yields between different regions:</span>
<span id="cb15-231"><a href="#cb15-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-234"><a href="#cb15-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-235"><a href="#cb15-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-marine-ttest</span></span>
<span id="cb15-236"><a href="#cb15-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Comparison of fishing yields between lakes"</span></span>
<span id="cb15-237"><a href="#cb15-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-238"><a href="#cb15-238" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary packages</span></span>
<span id="cb15-239"><a href="#cb15-239" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb15-240"><a href="#cb15-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-241"><a href="#cb15-241" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the marine dataset</span></span>
<span id="cb15-242"><a href="#cb15-242" aria-hidden="true" tabindex="-1"></a>marine_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/marine/ocean_data.csv"</span>)</span>
<span id="cb15-243"><a href="#cb15-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-244"><a href="#cb15-244" aria-hidden="true" tabindex="-1"></a><span class="co"># View the structure of the dataset</span></span>
<span id="cb15-245"><a href="#cb15-245" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(marine_data)</span>
<span id="cb15-246"><a href="#cb15-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-247"><a href="#cb15-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's compare fishing yields between two lakes</span></span>
<span id="cb15-248"><a href="#cb15-248" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">"lake"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(marine_data) <span class="sc">&amp;</span> <span class="st">"values"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(marine_data)) {</span>
<span id="cb15-249"><a href="#cb15-249" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select two lakes for comparison</span></span>
<span id="cb15-250"><a href="#cb15-250" aria-hidden="true" tabindex="-1"></a>  lake_comparison <span class="ot">&lt;-</span> marine_data <span class="sc">%&gt;%</span></span>
<span id="cb15-251"><a href="#cb15-251" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(lake <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Michigan"</span>, <span class="st">"Superior"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-252"><a href="#cb15-252" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(lake, values)</span>
<span id="cb15-253"><a href="#cb15-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-254"><a href="#cb15-254" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform t-test</span></span>
<span id="cb15-255"><a href="#cb15-255" aria-hidden="true" tabindex="-1"></a>  t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(values <span class="sc">~</span> lake, <span class="at">data =</span> lake_comparison)</span>
<span id="cb15-256"><a href="#cb15-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-257"><a href="#cb15-257" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the results</span></span>
<span id="cb15-258"><a href="#cb15-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(t_test_result)</span>
<span id="cb15-259"><a href="#cb15-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-260"><a href="#cb15-260" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Visualize the comparison</span></span>
<span id="cb15-261"><a href="#cb15-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(lake_comparison, <span class="fu">aes</span>(<span class="at">x =</span> lake, <span class="at">y =</span> values)) <span class="sc">+</span></span>
<span id="cb15-262"><a href="#cb15-262" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb15-263"><a href="#cb15-263" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of Fishing Yields Between Lakes"</span>,</span>
<span id="cb15-264"><a href="#cb15-264" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Lake"</span>, <span class="at">y =</span> <span class="st">"Yield Values"</span>) <span class="sc">+</span></span>
<span id="cb15-265"><a href="#cb15-265" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb15-266"><a href="#cb15-266" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb15-267"><a href="#cb15-267" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the columns don't match exactly, adapt to the actual structure</span></span>
<span id="cb15-268"><a href="#cb15-268" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is a fallback to ensure the code runs with the actual data</span></span>
<span id="cb15-269"><a href="#cb15-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Column names don't match expected structure. Adapting..."</span>)</span>
<span id="cb15-270"><a href="#cb15-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-271"><a href="#cb15-271" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assuming we have some kind of location and measurement columns</span></span>
<span id="cb15-272"><a href="#cb15-272" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">ncol</span>(marine_data) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb15-273"><a href="#cb15-273" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the first categorical column and first numeric column</span></span>
<span id="cb15-274"><a href="#cb15-274" aria-hidden="true" tabindex="-1"></a>    location_col <span class="ot">&lt;-</span> <span class="fu">names</span>(marine_data)[<span class="fu">sapply</span>(marine_data, is.character)][<span class="dv">1</span>]</span>
<span id="cb15-275"><a href="#cb15-275" aria-hidden="true" tabindex="-1"></a>    value_col <span class="ot">&lt;-</span> <span class="fu">names</span>(marine_data)[<span class="fu">sapply</span>(marine_data, is.numeric)][<span class="dv">1</span>]</span>
<span id="cb15-276"><a href="#cb15-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-277"><a href="#cb15-277" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(location_col) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(value_col)) {</span>
<span id="cb15-278"><a href="#cb15-278" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get the first two unique locations</span></span>
<span id="cb15-279"><a href="#cb15-279" aria-hidden="true" tabindex="-1"></a>      locations <span class="ot">&lt;-</span> <span class="fu">unique</span>(marine_data[[location_col]])[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb15-280"><a href="#cb15-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-281"><a href="#cb15-281" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Filter data for these locations</span></span>
<span id="cb15-282"><a href="#cb15-282" aria-hidden="true" tabindex="-1"></a>      comparison_data <span class="ot">&lt;-</span> marine_data <span class="sc">%&gt;%</span></span>
<span id="cb15-283"><a href="#cb15-283" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="sc">!!</span><span class="fu">sym</span>(location_col) <span class="sc">%in%</span> locations) <span class="sc">%&gt;%</span></span>
<span id="cb15-284"><a href="#cb15-284" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">!!</span><span class="fu">sym</span>(location_col), <span class="sc">!!</span><span class="fu">sym</span>(value_col))</span>
<span id="cb15-285"><a href="#cb15-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-286"><a href="#cb15-286" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Rename columns for consistency</span></span>
<span id="cb15-287"><a href="#cb15-287" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(comparison_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"location"</span>, <span class="st">"value"</span>)</span>
<span id="cb15-288"><a href="#cb15-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-289"><a href="#cb15-289" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Perform t-test</span></span>
<span id="cb15-290"><a href="#cb15-290" aria-hidden="true" tabindex="-1"></a>      t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(value <span class="sc">~</span> location, <span class="at">data =</span> comparison_data)</span>
<span id="cb15-291"><a href="#cb15-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-292"><a href="#cb15-292" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Display the results</span></span>
<span id="cb15-293"><a href="#cb15-293" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(t_test_result)</span>
<span id="cb15-294"><a href="#cb15-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-295"><a href="#cb15-295" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Visualize the comparison</span></span>
<span id="cb15-296"><a href="#cb15-296" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(comparison_data, <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb15-297"><a href="#cb15-297" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb15-298"><a href="#cb15-298" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison Between Locations"</span>,</span>
<span id="cb15-299"><a href="#cb15-299" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">"Location"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb15-300"><a href="#cb15-300" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>()</span>
<span id="cb15-301"><a href="#cb15-301" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb15-302"><a href="#cb15-302" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"Could not identify appropriate columns for analysis."</span>)</span>
<span id="cb15-303"><a href="#cb15-303" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-304"><a href="#cb15-304" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb15-305"><a href="#cb15-305" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Dataset does not have enough columns for comparison."</span>)</span>
<span id="cb15-306"><a href="#cb15-306" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-307"><a href="#cb15-307" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-308"><a href="#cb15-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-309"><a href="#cb15-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-310"><a href="#cb15-310" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb15-311"><a href="#cb15-311" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb15-312"><a href="#cb15-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-313"><a href="#cb15-313" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to apply a t-test to real-world marine data:</span>
<span id="cb15-314"><a href="#cb15-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-315"><a href="#cb15-315" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Loading**:</span>
<span id="cb15-316"><a href="#cb15-316" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`read_csv()`</span> imports the marine dataset</span>
<span id="cb15-317"><a href="#cb15-317" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`str()`</span> displays the structure of the dataset to understand its variables</span>
<span id="cb15-318"><a href="#cb15-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-319"><a href="#cb15-319" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Flexible Data Handling**:</span>
<span id="cb15-320"><a href="#cb15-320" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The code uses conditional logic to check if expected columns exist</span>
<span id="cb15-321"><a href="#cb15-321" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This robust approach ensures the code runs even if the data structure differs from expectations</span>
<span id="cb15-322"><a href="#cb15-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-323"><a href="#cb15-323" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Data Filtering**:</span>
<span id="cb15-324"><a href="#cb15-324" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`filter()`</span> selects data from two specific lakes for comparison</span>
<span id="cb15-325"><a href="#cb15-325" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`select()`</span> extracts only the relevant columns (lake and values)</span>
<span id="cb15-326"><a href="#cb15-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-327"><a href="#cb15-327" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Statistical Testing**:</span>
<span id="cb15-328"><a href="#cb15-328" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`t.test()`</span> performs the comparison between the two lakes</span>
<span id="cb15-329"><a href="#cb15-329" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The formula notation <span class="in">`values ~ lake`</span> tests if mean values differ between lakes</span>
<span id="cb15-330"><a href="#cb15-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-331"><a href="#cb15-331" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Data Visualization**:</span>
<span id="cb15-332"><a href="#cb15-332" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_boxplot()`</span> creates visual comparison of distributions</span>
<span id="cb15-333"><a href="#cb15-333" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The fallback code uses dynamic column selection based on data types</span>
<span id="cb15-334"><a href="#cb15-334" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`sym()`</span> and <span class="in">`!!`</span> operators enable programmatic column selection</span>
<span id="cb15-335"><a href="#cb15-335" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-336"><a href="#cb15-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-337"><a href="#cb15-337" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb15-338"><a href="#cb15-338" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb15-339"><a href="#cb15-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-340"><a href="#cb15-340" aria-hidden="true" tabindex="-1"></a>When applied to real marine data, the t-test results reveal:</span>
<span id="cb15-341"><a href="#cb15-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-342"><a href="#cb15-342" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Whether there is a statistically significant difference in fishing yields (or other measured values) between the two lakes or locations.</span>
<span id="cb15-343"><a href="#cb15-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-344"><a href="#cb15-344" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The p-value indicates the strength of evidence against the null hypothesis (that there is no difference between locations).</span>
<span id="cb15-345"><a href="#cb15-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-346"><a href="#cb15-346" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The confidence interval shows the range of plausible values for the true difference between locations.</span>
<span id="cb15-347"><a href="#cb15-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-348"><a href="#cb15-348" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The boxplot visualization provides a clear picture of how the distributions differ, showing:</span>
<span id="cb15-349"><a href="#cb15-349" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Median values (central tendency)</span>
<span id="cb15-350"><a href="#cb15-350" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Interquartile ranges (spread)</span>
<span id="cb15-351"><a href="#cb15-351" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Potential outliers</span>
<span id="cb15-352"><a href="#cb15-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-353"><a href="#cb15-353" aria-hidden="true" tabindex="-1"></a>This analysis helps marine scientists and resource managers understand differences in productivity or other metrics between water bodies, which can inform conservation strategies, fishing regulations, or further research into causal factors.</span>
<span id="cb15-354"><a href="#cb15-354" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-355"><a href="#cb15-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-356"><a href="#cb15-356" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-Sample t-test</span></span>
<span id="cb15-357"><a href="#cb15-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-358"><a href="#cb15-358" aria-hidden="true" tabindex="-1"></a>The one-sample t-test compares a sample mean to a known or hypothesized population value:</span>
<span id="cb15-359"><a href="#cb15-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-362"><a href="#cb15-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-363"><a href="#cb15-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-one-sample-ttest</span></span>
<span id="cb15-364"><a href="#cb15-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of tree heights with reference value"</span></span>
<span id="cb15-365"><a href="#cb15-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-366"><a href="#cb15-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's test if the average tree height in Site A differs from a reference value of 23m</span></span>
<span id="cb15-367"><a href="#cb15-367" aria-hidden="true" tabindex="-1"></a>reference_height <span class="ot">&lt;-</span> <span class="dv">23</span>  <span class="co"># Reference value (e.g., regional average)</span></span>
<span id="cb15-368"><a href="#cb15-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-369"><a href="#cb15-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform one-sample t-test</span></span>
<span id="cb15-370"><a href="#cb15-370" aria-hidden="true" tabindex="-1"></a>one_sample_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(site_A, <span class="at">mu =</span> reference_height)</span>
<span id="cb15-371"><a href="#cb15-371" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(one_sample_result)</span>
<span id="cb15-372"><a href="#cb15-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-373"><a href="#cb15-373" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram with reference line</span></span>
<span id="cb15-374"><a href="#cb15-374" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">height =</span> site_A), <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb15-375"><a href="#cb15-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-376"><a href="#cb15-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> reference_height, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb15-377"><a href="#cb15-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-378"><a href="#cb15-378" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Tree Heights with Reference Value"</span>,</span>
<span id="cb15-379"><a href="#cb15-379" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height (m)"</span>,</span>
<span id="cb15-380"><a href="#cb15-380" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb15-381"><a href="#cb15-381" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-382"><a href="#cb15-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-383"><a href="#cb15-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-384"><a href="#cb15-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-385"><a href="#cb15-385" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb15-386"><a href="#cb15-386" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb15-387"><a href="#cb15-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-388"><a href="#cb15-388" aria-hidden="true" tabindex="-1"></a>This code demonstrates one-sample hypothesis testing:</span>
<span id="cb15-389"><a href="#cb15-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-390"><a href="#cb15-390" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Test Setup**:</span>
<span id="cb15-391"><a href="#cb15-391" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Defines a reference value for comparison</span>
<span id="cb15-392"><a href="#cb15-392" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Uses <span class="in">`t.test()`</span> for statistical testing</span>
<span id="cb15-393"><a href="#cb15-393" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Specifies the null hypothesis (μ = 23m)</span>
<span id="cb15-394"><a href="#cb15-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-395"><a href="#cb15-395" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visualization**:</span>
<span id="cb15-396"><a href="#cb15-396" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a histogram of the data</span>
<span id="cb15-397"><a href="#cb15-397" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Adds a vertical line for the reference value</span>
<span id="cb15-398"><a href="#cb15-398" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Uses appropriate binning and styling</span>
<span id="cb15-399"><a href="#cb15-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-400"><a href="#cb15-400" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Components**:</span>
<span id="cb15-401"><a href="#cb15-401" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Calculates t-statistic</span>
<span id="cb15-402"><a href="#cb15-402" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Determines degrees of freedom</span>
<span id="cb15-403"><a href="#cb15-403" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Computes p-value</span>
<span id="cb15-404"><a href="#cb15-404" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-405"><a href="#cb15-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-406"><a href="#cb15-406" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb15-407"><a href="#cb15-407" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb15-408"><a href="#cb15-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-409"><a href="#cb15-409" aria-hidden="true" tabindex="-1"></a>The analysis provides several key insights:</span>
<span id="cb15-410"><a href="#cb15-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-411"><a href="#cb15-411" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Statistical Significance**:</span>
<span id="cb15-412"><a href="#cb15-412" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>P-value indicates strength of evidence against null hypothesis</span>
<span id="cb15-413"><a href="#cb15-413" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Confidence interval shows range of plausible values</span>
<span id="cb15-414"><a href="#cb15-414" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Effect size measures magnitude of difference</span>
<span id="cb15-415"><a href="#cb15-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-416"><a href="#cb15-416" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Practical Significance**:</span>
<span id="cb15-417"><a href="#cb15-417" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Whether the difference is biologically meaningful</span>
<span id="cb15-418"><a href="#cb15-418" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>How the results relate to ecological processes</span>
<span id="cb15-419"><a href="#cb15-419" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Implications for forest management</span>
<span id="cb15-420"><a href="#cb15-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-421"><a href="#cb15-421" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Data Distribution**:</span>
<span id="cb15-422"><a href="#cb15-422" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Shape of the height distribution</span>
<span id="cb15-423"><a href="#cb15-423" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Presence of outliers</span>
<span id="cb15-424"><a href="#cb15-424" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sample size adequacy</span>
<span id="cb15-425"><a href="#cb15-425" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-426"><a href="#cb15-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-427"><a href="#cb15-427" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb15-428"><a href="#cb15-428" aria-hidden="true" tabindex="-1"></a><span class="fu">## PROFESSIONAL TIP: Hypothesis Testing Best Practices</span></span>
<span id="cb15-429"><a href="#cb15-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-430"><a href="#cb15-430" aria-hidden="true" tabindex="-1"></a>When conducting hypothesis tests:</span>
<span id="cb15-431"><a href="#cb15-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-432"><a href="#cb15-432" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Test Selection**:</span>
<span id="cb15-433"><a href="#cb15-433" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Choose appropriate test based on data type</span>
<span id="cb15-434"><a href="#cb15-434" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Check assumptions before testing</span>
<span id="cb15-435"><a href="#cb15-435" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Consider sample size requirements</span>
<span id="cb15-436"><a href="#cb15-436" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Use non-parametric alternatives when needed</span>
<span id="cb15-437"><a href="#cb15-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-438"><a href="#cb15-438" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Interpretation**:</span>
<span id="cb15-439"><a href="#cb15-439" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Focus on effect size, not just p-values</span>
<span id="cb15-440"><a href="#cb15-440" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Consider practical significance</span>
<span id="cb15-441"><a href="#cb15-441" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Look at confidence intervals</span>
<span id="cb15-442"><a href="#cb15-442" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Document all assumptions</span>
<span id="cb15-443"><a href="#cb15-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-444"><a href="#cb15-444" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Reporting**:</span>
<span id="cb15-445"><a href="#cb15-445" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Include test statistics</span>
<span id="cb15-446"><a href="#cb15-446" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Report degrees of freedom</span>
<span id="cb15-447"><a href="#cb15-447" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Provide effect sizes</span>
<span id="cb15-448"><a href="#cb15-448" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Discuss limitations</span>
<span id="cb15-449"><a href="#cb15-449" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-450"><a href="#cb15-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-451"><a href="#cb15-451" aria-hidden="true" tabindex="-1"></a><span class="fu">## Paired t-test</span></span>
<span id="cb15-452"><a href="#cb15-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-453"><a href="#cb15-453" aria-hidden="true" tabindex="-1"></a>A paired t-test is used when measurements are taken from the same subjects under different conditions:</span>
<span id="cb15-454"><a href="#cb15-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-457"><a href="#cb15-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-458"><a href="#cb15-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: paired-data-setup</span></span>
<span id="cb15-459"><a href="#cb15-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb15-460"><a href="#cb15-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-461"><a href="#cb15-461" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate paired data: tree heights before and after treatment</span></span>
<span id="cb15-462"><a href="#cb15-462" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb15-463"><a href="#cb15-463" aria-hidden="true" tabindex="-1"></a>trees_before <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>)  <span class="co"># Heights before treatment</span></span>
<span id="cb15-464"><a href="#cb15-464" aria-hidden="true" tabindex="-1"></a>growth_effect <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="fl">2.5</span>, <span class="at">sd =</span> <span class="dv">1</span>)  <span class="co"># Individual growth responses</span></span>
<span id="cb15-465"><a href="#cb15-465" aria-hidden="true" tabindex="-1"></a>trees_after <span class="ot">&lt;-</span> trees_before <span class="sc">+</span> growth_effect     <span class="co"># Heights after treatment</span></span>
<span id="cb15-466"><a href="#cb15-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-467"><a href="#cb15-467" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb15-468"><a href="#cb15-468" aria-hidden="true" tabindex="-1"></a>paired_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-469"><a href="#cb15-469" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb15-470"><a href="#cb15-470" aria-hidden="true" tabindex="-1"></a>  <span class="at">height_before =</span> trees_before,</span>
<span id="cb15-471"><a href="#cb15-471" aria-hidden="true" tabindex="-1"></a>  <span class="at">height_after =</span> trees_after,</span>
<span id="cb15-472"><a href="#cb15-472" aria-hidden="true" tabindex="-1"></a>  <span class="at">difference =</span> trees_after <span class="sc">-</span> trees_before</span>
<span id="cb15-473"><a href="#cb15-473" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-474"><a href="#cb15-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-475"><a href="#cb15-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-478"><a href="#cb15-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-479"><a href="#cb15-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-paired-ttest-scatter</span></span>
<span id="cb15-480"><a href="#cb15-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Tree heights before and after treatment"</span></span>
<span id="cb15-481"><a href="#cb15-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-482"><a href="#cb15-482" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the paired data</span></span>
<span id="cb15-483"><a href="#cb15-483" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(paired_data, <span class="fu">aes</span>(<span class="at">x =</span> height_before, <span class="at">y =</span> height_after)) <span class="sc">+</span></span>
<span id="cb15-484"><a href="#cb15-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"forestgreen"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb15-485"><a href="#cb15-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb15-486"><a href="#cb15-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tree Heights Before and After Treatment"</span>,</span>
<span id="cb15-487"><a href="#cb15-487" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height Before (m)"</span>,</span>
<span id="cb15-488"><a href="#cb15-488" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Height After (m)"</span>) <span class="sc">+</span></span>
<span id="cb15-489"><a href="#cb15-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-490"><a href="#cb15-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()  <span class="co"># Equal scaling on both axes</span></span>
<span id="cb15-491"><a href="#cb15-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-492"><a href="#cb15-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-495"><a href="#cb15-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-496"><a href="#cb15-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-paired-ttest-diff</span></span>
<span id="cb15-497"><a href="#cb15-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of height differences"</span></span>
<span id="cb15-498"><a href="#cb15-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-499"><a href="#cb15-499" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform paired t-test</span></span>
<span id="cb15-500"><a href="#cb15-500" aria-hidden="true" tabindex="-1"></a>paired_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(paired_data<span class="sc">$</span>height_after, paired_data<span class="sc">$</span>height_before, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-501"><a href="#cb15-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-502"><a href="#cb15-502" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the differences</span></span>
<span id="cb15-503"><a href="#cb15-503" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(paired_data, <span class="fu">aes</span>(<span class="at">x =</span> difference)) <span class="sc">+</span></span>
<span id="cb15-504"><a href="#cb15-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"forestgreen"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb15-505"><a href="#cb15-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb15-506"><a href="#cb15-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(paired_data<span class="sc">$</span>difference), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb15-507"><a href="#cb15-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Height Differences (After - Before)"</span>,</span>
<span id="cb15-508"><a href="#cb15-508" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Difference (m)"</span>,</span>
<span id="cb15-509"><a href="#cb15-509" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb15-510"><a href="#cb15-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-511"><a href="#cb15-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-512"><a href="#cb15-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-515"><a href="#cb15-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-516"><a href="#cb15-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-paired-ttest</span></span>
<span id="cb15-517"><a href="#cb15-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Paired t-Test Results: Tree Heights Before and After Treatment"</span></span>
<span id="cb15-518"><a href="#cb15-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-519"><a href="#cb15-519" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the results table</span></span>
<span id="cb15-520"><a href="#cb15-520" aria-hidden="true" tabindex="-1"></a>paired_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-521"><a href="#cb15-521" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Before"</span>,</span>
<span id="cb15-522"><a href="#cb15-522" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Mean After"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb15-523"><a href="#cb15-523" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb15-524"><a href="#cb15-524" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb15-525"><a href="#cb15-525" aria-hidden="true" tabindex="-1"></a>    paired_result<span class="sc">$</span>parameter,</span>
<span id="cb15-526"><a href="#cb15-526" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(paired_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb15-527"><a href="#cb15-527" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span>height_before), <span class="dv">2</span>),</span>
<span id="cb15-528"><a href="#cb15-528" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span>height_after), <span class="dv">2</span>),</span>
<span id="cb15-529"><a href="#cb15-529" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span>difference), <span class="dv">2</span>),</span>
<span id="cb15-530"><a href="#cb15-530" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb15-531"><a href="#cb15-531" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb15-532"><a href="#cb15-532" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-533"><a href="#cb15-533" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-534"><a href="#cb15-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-535"><a href="#cb15-535" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb15-536"><a href="#cb15-536" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_table,</span>
<span id="cb15-537"><a href="#cb15-537" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb15-538"><a href="#cb15-538" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-539"><a href="#cb15-539" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb15-540"><a href="#cb15-540" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-541"><a href="#cb15-541" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb15-542"><a href="#cb15-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-543"><a href="#cb15-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-544"><a href="#cb15-544" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb15-545"><a href="#cb15-545" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb15-546"><a href="#cb15-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-547"><a href="#cb15-547" aria-hidden="true" tabindex="-1"></a>This code demonstrates a paired t-test workflow:</span>
<span id="cb15-548"><a href="#cb15-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-549"><a href="#cb15-549" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Simulation**:</span>
<span id="cb15-550"><a href="#cb15-550" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Simulates 25 trees with initial heights (<span class="in">`trees_before`</span>)</span>
<span id="cb15-551"><a href="#cb15-551" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Simulates individual growth responses to treatment (<span class="in">`growth_effect`</span>)</span>
<span id="cb15-552"><a href="#cb15-552" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Calculates post-treatment heights by adding the growth effect to initial heights</span>
<span id="cb15-553"><a href="#cb15-553" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a data frame with tree IDs, before/after measurements, and differences</span>
<span id="cb15-554"><a href="#cb15-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-555"><a href="#cb15-555" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Data Visualization**:</span>
<span id="cb15-556"><a href="#cb15-556" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Scatter plot comparing before and after heights</span>
<span id="cb15-557"><a href="#cb15-557" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Dashed diagonal line represents "no change" (y = x)</span>
<span id="cb15-558"><a href="#cb15-558" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Points above the line indicate growth, points below would indicate decline</span>
<span id="cb15-559"><a href="#cb15-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-560"><a href="#cb15-560" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Testing**:</span>
<span id="cb15-561"><a href="#cb15-561" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`t.test(..., paired = TRUE)`</span> performs a paired t-test</span>
<span id="cb15-562"><a href="#cb15-562" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The <span class="in">`paired = TRUE`</span> parameter is crucial, as it analyzes the differences within subjects</span>
<span id="cb15-563"><a href="#cb15-563" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Tests whether the mean difference is significantly different from zero</span>
<span id="cb15-564"><a href="#cb15-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-565"><a href="#cb15-565" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Difference Visualization**:</span>
<span id="cb15-566"><a href="#cb15-566" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Histogram shows the distribution of height differences</span>
<span id="cb15-567"><a href="#cb15-567" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Vertical lines mark zero (red dashed) and the mean difference (blue)</span>
<span id="cb15-568"><a href="#cb15-568" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This visualization helps assess whether differences are consistently positive</span>
<span id="cb15-569"><a href="#cb15-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-570"><a href="#cb15-570" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Result Presentation**:</span>
<span id="cb15-571"><a href="#cb15-571" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Comprehensive table showing all relevant statistics</span>
<span id="cb15-572"><a href="#cb15-572" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Includes mean values before and after treatment</span>
<span id="cb15-573"><a href="#cb15-573" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Shows the mean difference and its confidence interval</span>
<span id="cb15-574"><a href="#cb15-574" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-575"><a href="#cb15-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-576"><a href="#cb15-576" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb15-577"><a href="#cb15-577" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb15-578"><a href="#cb15-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-579"><a href="#cb15-579" aria-hidden="true" tabindex="-1"></a>The paired t-test results reveal:</span>
<span id="cb15-580"><a href="#cb15-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-581"><a href="#cb15-581" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **mean height before treatment** was approximately 15m, while the **mean height after treatment** was approximately 17.5m.</span>
<span id="cb15-582"><a href="#cb15-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-583"><a href="#cb15-583" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **mean difference** of about 2.5m represents the average growth effect of the treatment.</span>
<span id="cb15-584"><a href="#cb15-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-585"><a href="#cb15-585" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **t-value** (approximately 13.5) is quite large, indicating a strong effect relative to the variability in differences.</span>
<span id="cb15-586"><a href="#cb15-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-587"><a href="#cb15-587" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The extremely small **p-value** (&lt; 0.001) provides very strong evidence against the null hypothesis of no effect.</span>
<span id="cb15-588"><a href="#cb15-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-589"><a href="#cb15-589" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **95% confidence interval** for the mean difference does not include zero, confirming the statistical significance.</span>
<span id="cb15-590"><a href="#cb15-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-591"><a href="#cb15-591" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **scatter plot** shows that virtually all points lie above the diagonal line, indicating consistent growth across trees.</span>
<span id="cb15-592"><a href="#cb15-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-593"><a href="#cb15-593" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **histogram of differences** is centered well to the right of zero, showing that almost all trees experienced positive growth.</span>
<span id="cb15-594"><a href="#cb15-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-595"><a href="#cb15-595" aria-hidden="true" tabindex="-1"></a>This analysis provides compelling evidence that the treatment had a significant positive effect on tree growth. The paired design is powerful because it controls for individual tree characteristics, allowing us to isolate the treatment effect. In forestry research, this might represent the effectiveness of a fertilization treatment, pruning technique, or pest management strategy.</span>
<span id="cb15-596"><a href="#cb15-596" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-597"><a href="#cb15-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-598"><a href="#cb15-598" aria-hidden="true" tabindex="-1"></a><span class="fu">## Testing Assumptions: Normality</span></span>
<span id="cb15-599"><a href="#cb15-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-600"><a href="#cb15-600" aria-hidden="true" tabindex="-1"></a>Before applying parametric tests like the t-test, we should check if the data meets the assumption of normality:</span>
<span id="cb15-601"><a href="#cb15-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-604"><a href="#cb15-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-605"><a href="#cb15-605" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: normality-tests</span></span>
<span id="cb15-606"><a href="#cb15-606" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb15-607"><a href="#cb15-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-608"><a href="#cb15-608" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test for normality</span></span>
<span id="cb15-609"><a href="#cb15-609" aria-hidden="true" tabindex="-1"></a>shapiro_A <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(site_A)</span>
<span id="cb15-610"><a href="#cb15-610" aria-hidden="true" tabindex="-1"></a>shapiro_B <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(site_B)</span>
<span id="cb15-611"><a href="#cb15-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-612"><a href="#cb15-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-615"><a href="#cb15-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-616"><a href="#cb15-616" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normality-test</span></span>
<span id="cb15-617"><a href="#cb15-617" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Q-Q plots for normality assessment"</span></span>
<span id="cb15-618"><a href="#cb15-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-619"><a href="#cb15-619" aria-hidden="true" tabindex="-1"></a><span class="co"># QQ plots for visual assessment of normality</span></span>
<span id="cb15-620"><a href="#cb15-620" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))  <span class="co"># Set up a 1x2 plotting area</span></span>
<span id="cb15-621"><a href="#cb15-621" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(site_A, <span class="at">main =</span> <span class="st">"Q-Q Plot for Site A"</span>)</span>
<span id="cb15-622"><a href="#cb15-622" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(site_A, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb15-623"><a href="#cb15-623" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(site_B, <span class="at">main =</span> <span class="st">"Q-Q Plot for Site B"</span>)</span>
<span id="cb15-624"><a href="#cb15-624" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(site_B, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb15-625"><a href="#cb15-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-626"><a href="#cb15-626" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset plotting area</span></span>
<span id="cb15-627"><a href="#cb15-627" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb15-628"><a href="#cb15-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-629"><a href="#cb15-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-632"><a href="#cb15-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-633"><a href="#cb15-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-normality-test</span></span>
<span id="cb15-634"><a href="#cb15-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Shapiro-Wilk Test Results for Normality"</span></span>
<span id="cb15-635"><a href="#cb15-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-636"><a href="#cb15-636" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of normality test results</span></span>
<span id="cb15-637"><a href="#cb15-637" aria-hidden="true" tabindex="-1"></a>normality_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-638"><a href="#cb15-638" aria-hidden="true" tabindex="-1"></a>  <span class="at">Habitat =</span> <span class="fu">c</span>(<span class="st">"Habitat A"</span>, <span class="st">"Habitat B"</span>),</span>
<span id="cb15-639"><a href="#cb15-639" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">W Statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(shapiro_A<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="fu">round</span>(shapiro_B<span class="sc">$</span>statistic, <span class="dv">3</span>)),</span>
<span id="cb15-640"><a href="#cb15-640" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(shapiro_A<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="fu">format.pval</span>(shapiro_B<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb15-641"><a href="#cb15-641" aria-hidden="true" tabindex="-1"></a>  <span class="at">Interpretation =</span> <span class="fu">c</span>(</span>
<span id="cb15-642"><a href="#cb15-642" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(shapiro_A<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">"Normal distribution (fail to reject H₀)"</span>, <span class="st">"Non-normal distribution (reject H₀)"</span>),</span>
<span id="cb15-643"><a href="#cb15-643" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(shapiro_B<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">"Normal distribution (fail to reject H₀)"</span>, <span class="st">"Non-normal distribution (reject H₀)"</span>)</span>
<span id="cb15-644"><a href="#cb15-644" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-645"><a href="#cb15-645" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-646"><a href="#cb15-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-647"><a href="#cb15-647" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb15-648"><a href="#cb15-648" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(normality_table,</span>
<span id="cb15-649"><a href="#cb15-649" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"l"</span>),</span>
<span id="cb15-650"><a href="#cb15-650" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-651"><a href="#cb15-651" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb15-652"><a href="#cb15-652" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-653"><a href="#cb15-653" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb15-654"><a href="#cb15-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-655"><a href="#cb15-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-656"><a href="#cb15-656" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb15-657"><a href="#cb15-657" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb15-658"><a href="#cb15-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-659"><a href="#cb15-659" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to test the normality assumption:</span>
<span id="cb15-660"><a href="#cb15-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-661"><a href="#cb15-661" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Shapiro-Wilk Test**:</span>
<span id="cb15-662"><a href="#cb15-662" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`shapiro.test()`</span> performs a statistical test for normality</span>
<span id="cb15-663"><a href="#cb15-663" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The null hypothesis is that the data follows a normal distribution</span>
<span id="cb15-664"><a href="#cb15-664" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>A p-value &gt; 0.05 suggests the data does not significantly deviate from normality</span>
<span id="cb15-665"><a href="#cb15-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-666"><a href="#cb15-666" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visual Assessment**:</span>
<span id="cb15-667"><a href="#cb15-667" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Quantile-Quantile (Q-Q) plots compare the data's quantiles to theoretical quantiles from a normal distribution</span>
<span id="cb15-668"><a href="#cb15-668" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`qqnorm()`</span> creates the Q-Q plot</span>
<span id="cb15-669"><a href="#cb15-669" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`qqline()`</span> adds a reference line representing perfect normality</span>
<span id="cb15-670"><a href="#cb15-670" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Points following the line suggest the data is approximately normally distributed</span>
<span id="cb15-671"><a href="#cb15-671" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`par(mfrow = c(1, 2))`</span> creates a side-by-side plot layout for comparison</span>
<span id="cb15-672"><a href="#cb15-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-673"><a href="#cb15-673" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Result Presentation**:</span>
<span id="cb15-674"><a href="#cb15-674" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a table summarizing the test results for both sites</span>
<span id="cb15-675"><a href="#cb15-675" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Includes the W statistic, p-value, and interpretation for each site</span>
<span id="cb15-676"><a href="#cb15-676" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Automatically interprets the results based on the p-value threshold</span>
<span id="cb15-677"><a href="#cb15-677" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-678"><a href="#cb15-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-679"><a href="#cb15-679" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb15-680"><a href="#cb15-680" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb15-681"><a href="#cb15-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-682"><a href="#cb15-682" aria-hidden="true" tabindex="-1"></a>The normality test results reveal:</span>
<span id="cb15-683"><a href="#cb15-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-684"><a href="#cb15-684" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For **Site A**, the Shapiro-Wilk test yields a W statistic of approximately 0.97 with a p-value &gt; 0.05, suggesting that we fail to reject the null hypothesis. The data from Site A appears to follow a normal distribution.</span>
<span id="cb15-685"><a href="#cb15-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-686"><a href="#cb15-686" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For **Site B**, similar results indicate that the data also appears to be normally distributed.</span>
<span id="cb15-687"><a href="#cb15-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-688"><a href="#cb15-688" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **Q-Q plots** visually confirm these findings, as the points for both sites generally follow the reference line with minor deviations.</span>
<span id="cb15-689"><a href="#cb15-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-690"><a href="#cb15-690" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>These results support the use of parametric tests like the t-test for analyzing this data.</span>
<span id="cb15-691"><a href="#cb15-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-692"><a href="#cb15-692" aria-hidden="true" tabindex="-1"></a>In ecological research, checking normality is crucial because:</span>
<span id="cb15-693"><a href="#cb15-693" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Many statistical tests assume normally distributed data</span>
<span id="cb15-694"><a href="#cb15-694" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Violations of this assumption can lead to incorrect conclusions</span>
<span id="cb15-695"><a href="#cb15-695" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If data is non-normal, researchers might need to transform the data or use non-parametric alternatives</span>
<span id="cb15-696"><a href="#cb15-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-697"><a href="#cb15-697" aria-hidden="true" tabindex="-1"></a>The combined approach of statistical testing and visual assessment provides a robust evaluation of the normality assumption, increasing confidence in subsequent analyses.</span>
<span id="cb15-698"><a href="#cb15-698" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-699"><a href="#cb15-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-700"><a href="#cb15-700" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confidence Intervals</span></span>
<span id="cb15-701"><a href="#cb15-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-702"><a href="#cb15-702" aria-hidden="true" tabindex="-1"></a>Confidence intervals provide a range of plausible values for population parameters:</span>
<span id="cb15-703"><a href="#cb15-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-706"><a href="#cb15-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-707"><a href="#cb15-707" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ci-calculation</span></span>
<span id="cb15-708"><a href="#cb15-708" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb15-709"><a href="#cb15-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-710"><a href="#cb15-710" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% confidence interval for mean tree height in Site A</span></span>
<span id="cb15-711"><a href="#cb15-711" aria-hidden="true" tabindex="-1"></a>ci_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(site_A)</span>
<span id="cb15-712"><a href="#cb15-712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-713"><a href="#cb15-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-716"><a href="#cb15-716" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-717"><a href="#cb15-717" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-confidence-interval</span></span>
<span id="cb15-718"><a href="#cb15-718" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "95% Confidence Interval for Mean Tree Height"</span></span>
<span id="cb15-719"><a href="#cb15-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-720"><a href="#cb15-720" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table for the confidence interval</span></span>
<span id="cb15-721"><a href="#cb15-721" aria-hidden="true" tabindex="-1"></a>ci_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-722"><a href="#cb15-722" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="st">"Mean Tree Height in Site A"</span>,</span>
<span id="cb15-723"><a href="#cb15-723" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">round</span>(ci_result<span class="sc">$</span>estimate, <span class="dv">2</span>),</span>
<span id="cb15-724"><a href="#cb15-724" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">95% CI Lower</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb15-725"><a href="#cb15-725" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">95% CI Upper</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb15-726"><a href="#cb15-726" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-727"><a href="#cb15-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-728"><a href="#cb15-728" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb15-729"><a href="#cb15-729" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(ci_table,</span>
<span id="cb15-730"><a href="#cb15-730" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb15-731"><a href="#cb15-731" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-732"><a href="#cb15-732" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb15-733"><a href="#cb15-733" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-734"><a href="#cb15-734" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb15-735"><a href="#cb15-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-736"><a href="#cb15-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-739"><a href="#cb15-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-740"><a href="#cb15-740" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-confidence-interval</span></span>
<span id="cb15-741"><a href="#cb15-741" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "95% confidence interval for mean tree height"</span></span>
<span id="cb15-742"><a href="#cb15-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-743"><a href="#cb15-743" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the confidence interval</span></span>
<span id="cb15-744"><a href="#cb15-744" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span>, ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb15-745"><a href="#cb15-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> ci_result<span class="sc">$</span>estimate, <span class="at">sd =</span> <span class="fu">sd</span>(site_A)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(site_A))),</span>
<span id="cb15-746"><a href="#cb15-746" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb15-747"><a href="#cb15-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci_result<span class="sc">$</span>estimate, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb15-748"><a href="#cb15-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb15-749"><a href="#cb15-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb15-750"><a href="#cb15-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="at">xmax =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>],</span>
<span id="cb15-751"><a href="#cb15-751" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb15-752"><a href="#cb15-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> ci_result<span class="sc">$</span>estimate, <span class="at">y =</span> <span class="fl">0.05</span>,</span>
<span id="cb15-753"><a href="#cb15-753" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Mean = "</span>, <span class="fu">round</span>(ci_result<span class="sc">$</span>estimate, <span class="dv">2</span>), <span class="st">"m"</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb15-754"><a href="#cb15-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="at">y =</span> <span class="fl">0.03</span>,</span>
<span id="cb15-755"><a href="#cb15-755" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">"m"</span>), <span class="at">hjust =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb15-756"><a href="#cb15-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="at">y =</span> <span class="fl">0.03</span>,</span>
<span id="cb15-757"><a href="#cb15-757" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">"m"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb15-758"><a href="#cb15-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"95% Confidence Interval for Mean Tree Height in Site A"</span>,</span>
<span id="cb15-759"><a href="#cb15-759" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Tree Height (m)"</span>,</span>
<span id="cb15-760"><a href="#cb15-760" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb15-761"><a href="#cb15-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-762"><a href="#cb15-762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-763"><a href="#cb15-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-764"><a href="#cb15-764" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb15-765"><a href="#cb15-765" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb15-766"><a href="#cb15-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-767"><a href="#cb15-767" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to calculate and visualize confidence intervals:</span>
<span id="cb15-768"><a href="#cb15-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-769"><a href="#cb15-769" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Confidence Interval Calculation**:</span>
<span id="cb15-770"><a href="#cb15-770" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`t.test(site_A)`</span> calculates a 95% confidence interval for the mean</span>
<span id="cb15-771"><a href="#cb15-771" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>By default, t.test() produces a one-sample test with a 95% confidence interval</span>
<span id="cb15-772"><a href="#cb15-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-773"><a href="#cb15-773" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Result Presentation**:</span>
<span id="cb15-774"><a href="#cb15-774" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a table showing the point estimate (sample mean) and confidence interval bounds</span>
<span id="cb15-775"><a href="#cb15-775" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The confidence interval represents the range of plausible values for the true population mean</span>
<span id="cb15-776"><a href="#cb15-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-777"><a href="#cb15-777" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Visual Representation**:</span>
<span id="cb15-778"><a href="#cb15-778" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a plot showing the sampling distribution of the mean</span>
<span id="cb15-779"><a href="#cb15-779" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The blue vertical line represents the sample mean</span>
<span id="cb15-780"><a href="#cb15-780" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Red dashed lines mark the lower and upper bounds of the confidence interval</span>
<span id="cb15-781"><a href="#cb15-781" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The shaded blue area represents the 95% confidence region</span>
<span id="cb15-782"><a href="#cb15-782" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Annotations provide the exact values for easy interpretation</span>
<span id="cb15-783"><a href="#cb15-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-784"><a href="#cb15-784" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Statistical Meaning**:</span>
<span id="cb15-785"><a href="#cb15-785" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The standard error (SE = sd/√n) determines the width of the confidence interval</span>
<span id="cb15-786"><a href="#cb15-786" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Larger sample sizes produce narrower intervals (more precision)</span>
<span id="cb15-787"><a href="#cb15-787" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The 95% level means that if we repeated the sampling process many times, about 95% of the resulting intervals would contain the true population mean</span>
<span id="cb15-788"><a href="#cb15-788" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-789"><a href="#cb15-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-790"><a href="#cb15-790" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb15-791"><a href="#cb15-791" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb15-792"><a href="#cb15-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-793"><a href="#cb15-793" aria-hidden="true" tabindex="-1"></a>The confidence interval analysis reveals:</span>
<span id="cb15-794"><a href="#cb15-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-795"><a href="#cb15-795" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **point estimate** (sample mean) for tree height in Site A is approximately 25m.</span>
<span id="cb15-796"><a href="#cb15-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-797"><a href="#cb15-797" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **95% confidence interval** ranges from about 23.1m to 26.9m.</span>
<span id="cb15-798"><a href="#cb15-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-799"><a href="#cb15-799" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This interval represents the range of plausible values for the true mean tree height in the population from which Site A was sampled.</span>
<span id="cb15-800"><a href="#cb15-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-801"><a href="#cb15-801" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We can be 95% confident that the true mean tree height falls within this range.</span>
<span id="cb15-802"><a href="#cb15-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-803"><a href="#cb15-803" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The width of the interval reflects the precision of our estimate, influenced by:</span>
<span id="cb15-804"><a href="#cb15-804" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Sample size (n = 30)</span>
<span id="cb15-805"><a href="#cb15-805" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Sample standard deviation</span>
<span id="cb15-806"><a href="#cb15-806" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Confidence level (95%)</span>
<span id="cb15-807"><a href="#cb15-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-808"><a href="#cb15-808" aria-hidden="true" tabindex="-1"></a>In ecological research, confidence intervals are valuable because they:</span>
<span id="cb15-809"><a href="#cb15-809" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provide a measure of precision for our estimates</span>
<span id="cb15-810"><a href="#cb15-810" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Allow for meaningful comparisons between groups</span>
<span id="cb15-811"><a href="#cb15-811" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Focus on estimation rather than just hypothesis testing</span>
<span id="cb15-812"><a href="#cb15-812" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Communicate uncertainty in a transparent way</span>
<span id="cb15-813"><a href="#cb15-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-814"><a href="#cb15-814" aria-hidden="true" tabindex="-1"></a>A narrower confidence interval would indicate a more precise estimate, which could be achieved with a larger sample size or less variable measurements.</span>
<span id="cb15-815"><a href="#cb15-815" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-816"><a href="#cb15-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-817"><a href="#cb15-817" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb15-818"><a href="#cb15-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-819"><a href="#cb15-819" aria-hidden="true" tabindex="-1"></a>This chapter has covered the fundamentals of hypothesis testing in ecological and forestry research:</span>
<span id="cb15-820"><a href="#cb15-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-821"><a href="#cb15-821" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**The Logic of Hypothesis Testing**: Understanding null and alternative hypotheses</span>
<span id="cb15-822"><a href="#cb15-822" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**P-values and Significance Levels**: Interpreting statistical significance</span>
<span id="cb15-823"><a href="#cb15-823" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Types of Errors**: Recognizing Type I and Type II errors</span>
<span id="cb15-824"><a href="#cb15-824" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Common Tests**: Applying one-sample, two-sample, and paired t-tests</span>
<span id="cb15-825"><a href="#cb15-825" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Assumptions**: Testing for normality and other requirements</span>
<span id="cb15-826"><a href="#cb15-826" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Confidence Intervals**: Estimating population parameters with uncertainty</span>
<span id="cb15-827"><a href="#cb15-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-828"><a href="#cb15-828" aria-hidden="true" tabindex="-1"></a>Hypothesis testing provides a structured framework for making statistical inferences from sample data. By following the principles outlined in this chapter, researchers can design robust studies, analyze data appropriately, and draw valid conclusions about ecological and forestry phenomena.</span>
<span id="cb15-829"><a href="#cb15-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-830"><a href="#cb15-830" aria-hidden="true" tabindex="-1"></a>Remember that hypothesis testing is just one component of a comprehensive research approach. It should be complemented by exploratory data analysis, effect size estimation, and consideration of practical significance in addition to statistical significance.</span>
<span id="cb15-831"><a href="#cb15-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-832"><a href="#cb15-832" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb15-833"><a href="#cb15-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-834"><a href="#cb15-834" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Using the forest inventory dataset (<span class="in">`../data/forestry/forest_inventory.csv`</span>), perform a two-sample t-test to compare tree measurements between two different species or sites.</span>
<span id="cb15-835"><a href="#cb15-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-836"><a href="#cb15-836" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>For the biodiversity dataset (<span class="in">`../data/ecology/biodiversity.csv`</span>), test whether the mean species richness differs from a reference value of 15 species per plot.</span>
<span id="cb15-837"><a href="#cb15-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-838"><a href="#cb15-838" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Using the crop yields dataset (<span class="in">`../data/agriculture/crop_yields.csv`</span>), conduct a paired t-test to compare wheat and rice yields for the same countries.</span>
<span id="cb15-839"><a href="#cb15-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-840"><a href="#cb15-840" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>For any dataset of your choice, check the normality assumption using both visual methods (Q-Q plot) and statistical tests (Shapiro-Wilk).</span>
<span id="cb15-841"><a href="#cb15-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-842"><a href="#cb15-842" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Calculate and interpret a 95% confidence interval for a parameter of interest in the environmental dataset (<span class="in">`../data/environmental/climate_data.csv`</span>).</span>
<span id="cb15-843"><a href="#cb15-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-844"><a href="#cb15-844" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Design a hypothesis test for a research question of your choice related to natural sciences. Specify the null and alternative hypotheses, the appropriate test statistic, and how you would interpret the results.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2024-2025 Jimmy Moses</p>
</div>   
    <div class="nav-footer-center">
<p>⚠️ <strong>FIRST DRAFT</strong> (First published 2024, Updated 2025) ⚠️</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jm0535/dains/edit/main/chapters/04-hypothesis-testing.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jm0535/dains/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/jm0535/dains/blob/main/chapters/04-hypothesis-testing.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>