<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Common Statistical Tests – Data Analysis in Natural Sciences: An R-Based Approach</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/06-visualization.html" rel="next">
<link href="../chapters/04-hypothesis-testing.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-a0649ace7b9e9e15dfb5fe311d767a49.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-494121dfa8658343c03537e94414993d.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dark-6c5314280c86e53d2a1a2ca4c5fd5b4a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-6c5314280c86e53d2a1a2ca4c5fd5b4a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html">Data Analysis Fundamentals</a></li><li class="breadcrumb-item"><a href="../chapters/05-statistical-tests.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Data Analysis in Natural Sciences: An R-Based Approach</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jm0535/data-analysis-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About This Book</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-data-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Basics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Analysis Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-exploratory-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-statistical-tests.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-advanced-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Advanced Data Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-conservation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Conservation Applications</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">5.1</span> Introduction</a></li>
  <li><a href="#choosing-the-right-statistical-test" id="toc-choosing-the-right-statistical-test" class="nav-link" data-scroll-target="#choosing-the-right-statistical-test"><span class="header-section-number">5.2</span> Choosing the Right Statistical Test</a>
  <ul class="collapse">
  <li><a href="#decision-tree-for-common-tests" id="toc-decision-tree-for-common-tests" class="nav-link" data-scroll-target="#decision-tree-for-common-tests"><span class="header-section-number">5.2.1</span> Decision Tree for Common Tests</a></li>
  </ul></li>
  <li><a href="#parametric-vs.-non-parametric-tests" id="toc-parametric-vs.-non-parametric-tests" class="nav-link" data-scroll-target="#parametric-vs.-non-parametric-tests"><span class="header-section-number">5.3</span> Parametric vs.&nbsp;Non-Parametric Tests</a>
  <ul class="collapse">
  <li><a href="#parametric-tests" id="toc-parametric-tests" class="nav-link" data-scroll-target="#parametric-tests"><span class="header-section-number">5.3.1</span> Parametric Tests</a></li>
  <li><a href="#non-parametric-tests" id="toc-non-parametric-tests" class="nav-link" data-scroll-target="#non-parametric-tests"><span class="header-section-number">5.3.2</span> Non-Parametric Tests</a></li>
  <li><a href="#checking-assumptions" id="toc-checking-assumptions" class="nav-link" data-scroll-target="#checking-assumptions"><span class="header-section-number">5.3.3</span> Checking Assumptions</a></li>
  </ul></li>
  <li><a href="#tests-for-comparing-groups" id="toc-tests-for-comparing-groups" class="nav-link" data-scroll-target="#tests-for-comparing-groups"><span class="header-section-number">5.4</span> Tests for Comparing Groups</a>
  <ul class="collapse">
  <li><a href="#t-tests" id="toc-t-tests" class="nav-link" data-scroll-target="#t-tests"><span class="header-section-number">5.4.1</span> t-Tests</a></li>
  <li><a href="#analysis-of-variance-anova" id="toc-analysis-of-variance-anova" class="nav-link" data-scroll-target="#analysis-of-variance-anova"><span class="header-section-number">5.4.2</span> Analysis of Variance (ANOVA)</a></li>
  <li><a href="#non-parametric-alternatives" id="toc-non-parametric-alternatives" class="nav-link" data-scroll-target="#non-parametric-alternatives"><span class="header-section-number">5.4.3</span> Non-Parametric Alternatives</a></li>
  </ul></li>
  <li><a href="#tests-for-relationships" id="toc-tests-for-relationships" class="nav-link" data-scroll-target="#tests-for-relationships"><span class="header-section-number">5.5</span> Tests for Relationships</a>
  <ul class="collapse">
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis"><span class="header-section-number">5.5.1</span> Correlation Analysis</a></li>
  <li><a href="#regression-analysis" id="toc-regression-analysis" class="nav-link" data-scroll-target="#regression-analysis"><span class="header-section-number">5.5.2</span> Regression Analysis</a></li>
  </ul></li>
  <li><a href="#tests-for-categorical-data" id="toc-tests-for-categorical-data" class="nav-link" data-scroll-target="#tests-for-categorical-data"><span class="header-section-number">5.6</span> Tests for Categorical Data</a>
  <ul class="collapse">
  <li><a href="#chi-square-test" id="toc-chi-square-test" class="nav-link" data-scroll-target="#chi-square-test"><span class="header-section-number">5.6.1</span> Chi-Square Test</a></li>
  </ul></li>
  <li><a href="#tests-for-trends-and-time-series" id="toc-tests-for-trends-and-time-series" class="nav-link" data-scroll-target="#tests-for-trends-and-time-series"><span class="header-section-number">5.7</span> Tests for Trends and Time Series</a>
  <ul class="collapse">
  <li><a href="#time-series-analysis" id="toc-time-series-analysis" class="nav-link" data-scroll-target="#time-series-analysis"><span class="header-section-number">5.7.1</span> Time Series Analysis</a></li>
  <li><a href="#mann-kendall-trend-test" id="toc-mann-kendall-trend-test" class="nav-link" data-scroll-target="#mann-kendall-trend-test"><span class="header-section-number">5.7.2</span> Mann-Kendall Trend Test</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">5.8</span> Summary</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">5.9</span> Exercises</a></li>
  <li><a href="#enhanced-statistical-tests-chapter" id="toc-enhanced-statistical-tests-chapter" class="nav-link" data-scroll-target="#enhanced-statistical-tests-chapter"><span class="header-section-number">5.10</span> Enhanced Statistical Tests Chapter</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html">Data Analysis Fundamentals</a></li><li class="breadcrumb-item"><a href="../chapters/05-statistical-tests.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">5.1</span> Introduction</h2>
<p>This chapter explores common statistical tests used in natural sciences research. Building on the hypothesis testing framework introduced in the previous chapter, we’ll examine specific tests for different research scenarios and data types.</p>
</section>
<section id="choosing-the-right-statistical-test" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="choosing-the-right-statistical-test"><span class="header-section-number">5.2</span> Choosing the Right Statistical Test</h2>
<p>Selecting the appropriate statistical test depends on several factors:</p>
<ol type="1">
<li><strong>Research Question</strong>: What you’re trying to determine</li>
<li><strong>Data Type</strong>: Categorical, continuous, or ordinal</li>
<li><strong>Number of Groups</strong>: One, two, or multiple groups</li>
<li><strong>Data Distribution</strong>: Normal or non-normal</li>
<li><strong>Independence</strong>: Whether observations are independent or related</li>
</ol>
<section id="decision-tree-for-common-tests" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="decision-tree-for-common-tests"><span class="header-section-number">5.2.1</span> Decision Tree for Common Tests</h3>
<p><strong>Decision Tree for Selecting Statistical Tests:</strong></p>
<ol type="1">
<li><strong>For One Variable:</strong>
<ul>
<li><strong>One Sample:</strong>
<ul>
<li>Normal, Continuous → One-Sample t-Test</li>
<li>Non-normal, Continuous → Wilcoxon Signed-Rank Test</li>
<li>Categorical → Binomial Test</li>
</ul></li>
<li><strong>Two Samples:</strong>
<ul>
<li>Normal, Continuous, Independent → Independent t-Test</li>
<li>Normal, Continuous, Related → Paired t-Test</li>
<li>Non-normal, Continuous, Independent → Mann-Whitney U Test</li>
<li>Non-normal, Continuous, Related → Wilcoxon Signed-Rank Test</li>
<li>Categorical, Independent → Chi-Square Test</li>
<li>Categorical, Related → McNemar Test</li>
</ul></li>
<li><strong>Multiple Samples:</strong>
<ul>
<li>Normal, Continuous, Independent → ANOVA</li>
<li>Normal, Continuous, Related → Repeated Measures ANOVA</li>
<li>Non-normal, Continuous, Independent → Kruskal-Wallis Test</li>
<li>Non-normal, Continuous, Related → Friedman Test</li>
<li>Categorical → Chi-Square Test</li>
</ul></li>
</ul></li>
<li><strong>For Two Variables:</strong>
<ul>
<li>Normal, Continuous → Pearson Correlation</li>
<li>Non-normal or Ordinal → Spearman Correlation</li>
<li>Continuous Predictor &amp; Outcome → Linear Regression</li>
<li>Continuous Predictor, Binary Outcome → Logistic Regression</li>
</ul></li>
<li><strong>For Multiple Variables:</strong>
<ul>
<li>Multiple Continuous Outcomes → MANOVA</li>
<li>Dimension Reduction → Principal Component Analysis</li>
<li>Grouping → Cluster Analysis</li>
</ul></li>
</ol>
</section>
</section>
<section id="parametric-vs.-non-parametric-tests" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="parametric-vs.-non-parametric-tests"><span class="header-section-number">5.3</span> Parametric vs.&nbsp;Non-Parametric Tests</h2>
<section id="parametric-tests" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="parametric-tests"><span class="header-section-number">5.3.1</span> Parametric Tests</h3>
<p>Parametric tests make assumptions about the underlying population distribution, typically that the data follows a normal distribution. Common parametric tests include:</p>
<ul>
<li>t-tests</li>
<li>ANOVA</li>
<li>Pearson correlation</li>
<li>Linear regression</li>
</ul>
</section>
<section id="non-parametric-tests" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="non-parametric-tests"><span class="header-section-number">5.3.2</span> Non-Parametric Tests</h3>
<p>Non-parametric tests make fewer assumptions about the population distribution and are useful when data doesn’t meet the assumptions of parametric tests. Common non-parametric tests include:</p>
<ul>
<li>Mann-Whitney U test</li>
<li>Wilcoxon signed-rank test</li>
<li>Kruskal-Wallis test</li>
<li>Spearman correlation</li>
</ul>
</section>
<section id="checking-assumptions" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="checking-assumptions"><span class="header-section-number">5.3.3</span> Checking Assumptions</h3>
<p>Before applying a parametric test, it’s essential to check if your data meets the necessary assumptions. Let’s use our crop yield dataset to demonstrate:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the crop yield dataset</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>crop_yields <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/agriculture/crop_yields.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View column names to see how R has formatted them</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(crop_yields)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Entity"                           "Code"                            
 [3] "Year"                             "Wheat (tonnes per hectare)"      
 [5] "Rice (tonnes per hectare)"        "Maize (tonnes per hectare)"      
 [7] "Soybeans (tonnes per hectare)"    "Potatoes (tonnes per hectare)"   
 [9] "Beans (tonnes per hectare)"       "Peas (tonnes per hectare)"       
[11] "Cassava (tonnes per hectare)"     "Barley (tonnes per hectare)"     
[13] "Cocoa beans (tonnes per hectare)" "Bananas (tonnes per hectare)"    </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract wheat yields for analysis</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>wheat_yields <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first few rows</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wheat_yields), </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Sample of Wheat Yield Data"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sample of Wheat Yield Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Entity</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Wheat (tonnes per hectare)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1961</td>
<td style="text-align: right;">1.0220</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1962</td>
<td style="text-align: right;">0.9735</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1963</td>
<td style="text-align: right;">0.8317</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1964</td>
<td style="text-align: right;">0.9510</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1965</td>
<td style="text-align: right;">0.9723</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1966</td>
<td style="text-align: right;">0.8666</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for normality</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual methods</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">main =</span> <span class="st">"Histogram of Wheat Yields"</span>, <span class="at">xlab =</span> <span class="st">"Yield (tonnes/hectare)"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>); <span class="fu">qqline</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-statistical-tests_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical test for normality</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>shapiro_result <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">sample</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="fu">min</span>(<span class="dv">5000</span>, <span class="fu">length</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>))))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>shapiro_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"W-value"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(shapiro_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(shapiro_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(shapiro_table, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Shapiro-Wilk Normality Test Results: Wheat Yields"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Shapiro-Wilk Normality Test Results: Wheat Yields</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">W</td>
<td style="text-align: left;">W-value</td>
<td style="text-align: right;">0.87</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="tests-for-comparing-groups" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="tests-for-comparing-groups"><span class="header-section-number">5.4</span> Tests for Comparing Groups</h2>
<section id="t-tests" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="t-tests"><span class="header-section-number">5.4.1</span> t-Tests</h3>
<section id="independent-samples-t-test" class="level4" data-number="5.4.1.1">
<h4 data-number="5.4.1.1" class="anchored" data-anchor-id="independent-samples-t-test"><span class="header-section-number">5.4.1.1</span> Independent Samples t-Test</h4>
<p>Used to compare means between two independent groups. Let’s compare wheat yields between two time periods:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two groups: early period (before 2000) and recent period (2000 onwards)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>crop_yields_grouped <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> Year <span class="sc">&gt;=</span> <span class="dv">1960</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period =</span> <span class="fu">ifelse</span>(Year <span class="sc">&lt;</span> <span class="dv">2000</span>, <span class="st">"Early Period (pre-2000)"</span>, <span class="st">"Recent Period (2000+)"</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the data</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_yields_grouped, <span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">fill =</span> period)) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yields by Time Period"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Period"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-statistical-tests_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform independent samples t-test using formula interface with backticks</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> period, <span class="at">data =</span> crop_yields_grouped)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>t_test_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(t_test_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">diff</span>(t_test_result<span class="sc">$</span>estimate), <span class="dv">2</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(t_test_table, </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Independent Samples t-Test Results: Wheat Yields by Time Period"</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Independent Samples t-Test Results: Wheat Yields by Time Period</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">t-value</td>
<td style="text-align: right;">-22.335</td>
</tr>
<tr class="even">
<td style="text-align: left;">Degrees of Freedom</td>
<td style="text-align: right;">4970.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean Difference</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI Lower</td>
<td style="text-align: right;">-0.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% CI Upper</td>
<td style="text-align: right;">-0.82</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics by period</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>period_summary <span class="ot">&lt;-</span> crop_yields_grouped <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(period) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">round</span>(<span class="fu">min</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics table</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(period_summary, </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics: Wheat Yields by Time Period"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Summary Statistics: Wheat Yields by Time Period</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">period</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Early Period (pre-2000)</td>
<td style="text-align: center;">5177</td>
<td style="text-align: right;">2.11</td>
<td style="text-align: right;">1.47</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">9.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Recent Period (2000+)</td>
<td style="text-align: center;">2924</td>
<td style="text-align: right;">3.01</td>
<td style="text-align: right;">1.88</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">10.67</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="paired-samples-t-test" class="level4" data-number="5.4.1.2">
<h4 data-number="5.4.1.2" class="anchored" data-anchor-id="paired-samples-t-test"><span class="header-section-number">5.4.1.2</span> Paired Samples t-Test</h4>
<p>Used to compare means between two related groups. Let’s compare wheat and rice yields for the same countries and years:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for paired t-test</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>paired_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first few rows</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(paired_data), </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Sample of Paired Crop Yield Data"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sample of Paired Crop Yield Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Entity</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Wheat (tonnes per hectare)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rice (tonnes per hectare)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1961</td>
<td style="text-align: right;">1.0220</td>
<td style="text-align: right;">1.5190</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1962</td>
<td style="text-align: right;">0.9735</td>
<td style="text-align: right;">1.5190</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1963</td>
<td style="text-align: right;">0.8317</td>
<td style="text-align: right;">1.5190</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1964</td>
<td style="text-align: right;">0.9510</td>
<td style="text-align: right;">1.7273</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1965</td>
<td style="text-align: right;">0.9723</td>
<td style="text-align: right;">1.7273</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1966</td>
<td style="text-align: right;">0.8666</td>
<td style="text-align: right;">1.5180</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the paired data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>paired_data_long <span class="ot">&lt;-</span> paired_data <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Crop"</span>, <span class="at">values_to =</span> <span class="st">"Yield"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(paired_data_long, <span class="fu">aes</span>(<span class="at">x =</span> Crop, <span class="at">y =</span> Yield, <span class="at">fill =</span> Crop)) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of Wheat and Rice Yields"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Crop Type"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-statistical-tests_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform paired t-test using vectors directly</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>paired_t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">paired =</span> <span class="cn">TRUE</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>paired_t_test_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(paired_t_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">-</span> paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_t_test_table, </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Paired Samples t-Test Results: Wheat vs. Rice Yields"</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Paired Samples t-Test Results: Wheat vs. Rice Yields</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">t-value</td>
<td style="text-align: right;">-61.854</td>
</tr>
<tr class="even">
<td style="text-align: left;">Degrees of Freedom</td>
<td style="text-align: right;">5725</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean Difference</td>
<td style="text-align: right;">-1.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI Lower</td>
<td style="text-align: right;">-1.57</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% CI Upper</td>
<td style="text-align: right;">-1.47</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary statistics table</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>paired_summary <span class="ot">&lt;-</span> paired_data <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Wheat</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD Wheat</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Rice</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD Rice</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Difference</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD Difference</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics table</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_summary, </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics: Wheat vs. Rice Yields"</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="dv">7</span>),</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Summary Statistics: Wheat vs. Rice Yields</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Wheat</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD Wheat</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Rice</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD Rice</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Difference</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">5726</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">3.55</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">-1.52</td>
<td style="text-align: right;">1.86</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="analysis-of-variance-anova" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="analysis-of-variance-anova"><span class="header-section-number">5.4.2</span> Analysis of Variance (ANOVA)</h3>
<p>ANOVA is used to compare means among three or more independent groups. Let’s compare crop yields across different continents:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of countries to continents (simplified for demonstration)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>continent_mapping <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Entity =</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"Canada"</span>, <span class="st">"Mexico"</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Japan"</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Germany"</span>, <span class="st">"France"</span>, <span class="st">"United Kingdom"</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Brazil"</span>, <span class="st">"Argentina"</span>, <span class="st">"Chile"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Egypt"</span>, <span class="st">"Nigeria"</span>, <span class="st">"South Africa"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Australia"</span>, <span class="st">"New Zealand"</span>),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Continent =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"North America"</span>, <span class="dv">3</span>), </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Asia"</span>, <span class="dv">3</span>), </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Europe"</span>, <span class="dv">3</span>), </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"South America"</span>, <span class="dv">3</span>),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Africa"</span>, <span class="dv">3</span>),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Oceania"</span>, <span class="dv">2</span>))</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with crop yields data</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>continental_yields <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(continent_mapping, <span class="at">by =</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> Year <span class="sc">&gt;=</span> <span class="dv">2000</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize wheat yields by continent</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(continental_yields, <span class="fu">aes</span>(<span class="at">x =</span> Continent, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">fill =</span> Continent)) <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yields by Continent (2000-present)"</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent"</span>,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-statistical-tests_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> Continent, <span class="at">data =</span> continental_yields)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>anova_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_result)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted ANOVA table</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>anova_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Source =</span> <span class="fu">c</span>(<span class="st">"Continent"</span>, <span class="st">"Residuals"</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">DF =</span> <span class="fu">c</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Df"</span>]][<span class="dv">1</span>], anova_summary[[<span class="dv">1</span>]][[<span class="st">"Df"</span>]][<span class="dv">2</span>]),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Sum Sq"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Sum Sq"</span>]][<span class="dv">2</span>], <span class="dv">2</span>)),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Mean Sq</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Mean Sq"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Mean Sq"</span>]][<span class="dv">2</span>], <span class="dv">2</span>)),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">F value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"F value"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="cn">NA</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Pr(&gt;F)"</span>]][<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">3</span>), <span class="cn">NA</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the ANOVA table</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(anova_df, </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"ANOVA Results: Wheat Yields by Continent"</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>ANOVA Results: Wheat Yields by Continent</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Source</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">DF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum.Sq</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean.Sq</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr..F.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Continent</td>
<td style="text-align: center;">5</td>
<td style="text-align: right;">698.63</td>
<td style="text-align: right;">139.73</td>
<td style="text-align: right;">48.64</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: center;">317</td>
<td style="text-align: right;">910.68</td>
<td style="text-align: right;">2.87</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc test to identify which groups differ</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Tukey HSD results to a data frame</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>tukey_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tukey_result<span class="sc">$</span>Continent)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>tukey_df<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">rownames</span>(tukey_df)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>tukey_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(tukey_df, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cols =</span> <span class="sc">-</span>comparison, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">names_to =</span> <span class="st">"Continent2"</span>, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">values_to =</span> <span class="st">"p_value"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>tukey_long <span class="ot">&lt;-</span> tukey_long <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value)) <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Comparison =</span> <span class="fu">paste</span>(comparison, <span class="st">"vs"</span>, Continent2),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p adj</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(p_value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Significant =</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Comparison, <span class="st">`</span><span class="at">p adj</span><span class="st">`</span>, Significant)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the Tukey HSD results</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tukey_long, </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Tukey HSD Post-hoc Test Results: Pairwise Comparisons of Continents"</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Tukey HSD Post-hoc Test Results: Pairwise Comparisons of Continents</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Comparison</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p adj</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Significant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Asia-Africa vs diff</td>
<td style="text-align: center;">0.277598</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Asia-Africa vs lwr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Asia-Africa vs upr</td>
<td style="text-align: center;">1.187921</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Asia-Africa vs p adj</td>
<td style="text-align: center;">0.952392</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Europe-Africa vs diff</td>
<td style="text-align: center;">3.894058</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Europe-Africa vs lwr</td>
<td style="text-align: center;">2.983736</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Europe-Africa vs upr</td>
<td style="text-align: center;">4.804380</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Europe-Africa vs p adj</td>
<td style="text-align: center;">1.08e-12</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">North America-Africa vs diff</td>
<td style="text-align: center;">0.060698</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America-Africa vs lwr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">North America-Africa vs upr</td>
<td style="text-align: center;">0.971021</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America-Africa vs p adj</td>
<td style="text-align: center;">0.999965</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania-Africa vs diff</td>
<td style="text-align: center;">1.368446</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oceania-Africa vs lwr</td>
<td style="text-align: center;">0.350675</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania-Africa vs upr</td>
<td style="text-align: center;">2.386218</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oceania-Africa vs p adj</td>
<td style="text-align: center;">0.001931</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South America-Africa vs diff</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America-Africa vs lwr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South America-Africa vs upr</td>
<td style="text-align: center;">0.692550</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America-Africa vs p adj</td>
<td style="text-align: center;">0.983428</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Europe-Asia vs diff</td>
<td style="text-align: center;">3.616460</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Europe-Asia vs lwr</td>
<td style="text-align: center;">2.706137</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Europe-Asia vs upr</td>
<td style="text-align: center;">4.526782</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Europe-Asia vs p adj</td>
<td style="text-align: center;">1.09e-12</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">North America-Asia vs diff</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America-Asia vs lwr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">North America-Asia vs upr</td>
<td style="text-align: center;">0.693422</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America-Asia vs p adj</td>
<td style="text-align: center;">0.983724</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania-Asia vs diff</td>
<td style="text-align: center;">1.090848</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oceania-Asia vs lwr</td>
<td style="text-align: center;">0.073077</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania-Asia vs upr</td>
<td style="text-align: center;">2.108620</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oceania-Asia vs p adj</td>
<td style="text-align: center;">0.027650</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South America-Asia vs diff</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America-Asia vs lwr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South America-Asia vs upr</td>
<td style="text-align: center;">0.414952</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America-Asia vs p adj</td>
<td style="text-align: center;">0.625365</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">North America-Europe vs diff</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America-Europe vs lwr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">North America-Europe vs upr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America-Europe vs p adj</td>
<td style="text-align: center;">1.08e-12</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania-Europe vs diff</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oceania-Europe vs lwr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania-Europe vs upr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oceania-Europe vs p adj</td>
<td style="text-align: center;">1.13e-10</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South America-Europe vs diff</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America-Europe vs lwr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South America-Europe vs upr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America-Europe vs p adj</td>
<td style="text-align: center;">1.08e-12</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania-North America vs diff</td>
<td style="text-align: center;">1.307748</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oceania-North America vs lwr</td>
<td style="text-align: center;">0.289977</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania-North America vs upr</td>
<td style="text-align: center;">2.325520</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oceania-North America vs p adj</td>
<td style="text-align: center;">0.003642</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South America-North America vs diff</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America-North America vs lwr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South America-North America vs upr</td>
<td style="text-align: center;">0.631852</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America-North America vs p adj</td>
<td style="text-align: center;">0.951763</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South America-Oceania vs diff</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America-Oceania vs lwr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South America-Oceania vs upr</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America-Oceania vs p adj</td>
<td style="text-align: center;">0.000159</td>
<td style="text-align: center;">Yes</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary statistics table by continent</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>continent_summary <span class="ot">&lt;-</span> continental_yields <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Continent) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">round</span>(<span class="fu">min</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics table</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(continent_summary, </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics: Wheat Yields by Continent"</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Summary Statistics: Wheat Yields by Continent</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Continent</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Africa</td>
<td style="text-align: center;">57</td>
<td style="text-align: right;">3.54</td>
<td style="text-align: right;">2.24</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">6.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Asia</td>
<td style="text-align: center;">57</td>
<td style="text-align: right;">3.82</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">5.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Europe</td>
<td style="text-align: center;">57</td>
<td style="text-align: right;">7.43</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">5.29</td>
<td style="text-align: right;">8.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America</td>
<td style="text-align: center;">57</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">5.66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania</td>
<td style="text-align: center;">38</td>
<td style="text-align: right;">4.91</td>
<td style="text-align: right;">3.26</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">9.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">South America</td>
<td style="text-align: center;">57</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">6.21</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="non-parametric-alternatives" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="non-parametric-alternatives"><span class="header-section-number">5.4.3</span> Non-Parametric Alternatives</h3>
<section id="mann-whitney-u-test" class="level4" data-number="5.4.3.1">
<h4 data-number="5.4.3.1" class="anchored" data-anchor-id="mann-whitney-u-test"><span class="header-section-number">5.4.3.1</span> Mann-Whitney U Test</h4>
<p>The Mann-Whitney U test (also called Wilcoxon rank-sum test) is a non-parametric alternative to the independent samples t-test:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the same time period groups as before</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>wilcox_test <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> period, <span class="at">data =</span> crop_yields_grouped)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>wilcox_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"W-value"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    wilcox_test<span class="sc">$</span>statistic,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(wilcox_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(wilcox_table, </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Mann-Whitney U Test Results: Wheat Yields by Time Period"</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Mann-Whitney U Test Results: Wheat Yields by Time Period</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">W</td>
<td style="text-align: left;">W-value</td>
<td style="text-align: right;">5031267.5</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="kruskal-wallis-test" class="level4" data-number="5.4.3.2">
<h4 data-number="5.4.3.2" class="anchored" data-anchor-id="kruskal-wallis-test"><span class="header-section-number">5.4.3.2</span> Kruskal-Wallis Test</h4>
<p>The Kruskal-Wallis test is a non-parametric alternative to ANOVA:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the same continental data as before</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>kruskal_result <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> Continent, <span class="at">data =</span> continental_yields)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>kruskal_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(kruskal_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    kruskal_result<span class="sc">$</span>parameter,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(kruskal_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(kruskal_table, </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Kruskal-Wallis Test Results: Wheat Yields by Continent"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Kruskal-Wallis Test Results: Wheat Yields by Continent</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kruskal-Wallis chi-squared</td>
<td style="text-align: left;">Chi-squared</td>
<td style="text-align: right;">120.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">df</td>
<td style="text-align: left;">Degrees of Freedom</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc test for Kruskal-Wallis</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"dunn.test"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dunn.test)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  dunn_result <span class="ot">&lt;-</span> <span class="fu">dunn.test</span>(continental_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, continental_yields<span class="sc">$</span>Continent, <span class="at">method =</span> <span class="st">"bonferroni"</span>, <span class="at">kw =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame from the dunn test results</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  dunn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Comparison =</span> dunn_result<span class="sc">$</span>comparisons,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Z statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(dunn_result<span class="sc">$</span>Z, <span class="dv">2</span>),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">P value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(dunn_result<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Adjusted P</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(dunn_result<span class="sc">$</span>P.adjusted, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Significant =</span> <span class="fu">ifelse</span>(dunn_result<span class="sc">$</span>P.adjusted <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the formatted dunn test results</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(dunn_df, </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Dunn's Post-hoc Test Results: Pairwise Comparisons of Continents"</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Alternative: pairwise Wilcoxon tests</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  pairwise_result <span class="ot">&lt;-</span> <span class="fu">pairwise.wilcox.test</span>(continental_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, continental_yields<span class="sc">$</span>Continent, </span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert matrix to data frame</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  pairwise_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pairwise_result<span class="sc">$</span>p.value)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  pairwise_df<span class="sc">$</span>Continent1 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(pairwise_df)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  pairwise_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(pairwise_df, </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>                               <span class="at">cols =</span> <span class="sc">-</span>Continent1, </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_to =</span> <span class="st">"Continent2"</span>, </span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>                               <span class="at">values_to =</span> <span class="st">"p_value"</span>)</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out NA values and format</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  pairwise_long <span class="ot">&lt;-</span> pairwise_long <span class="sc">%&gt;%</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value)) <span class="sc">%&gt;%</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">Comparison =</span> <span class="fu">paste</span>(Continent1, <span class="st">"vs"</span>, Continent2),</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">P value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(p_value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">Significant =</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Comparison, <span class="st">`</span><span class="at">P value</span><span class="st">`</span>, Significant)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the formatted pairwise Wilcoxon test results</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(pairwise_long, </span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Pairwise Wilcoxon Test Results with Bonferroni Correction"</span>,</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Kruskal-Wallis rank sum test

data: x and group
Kruskal-Wallis chi-squared = 120.1715, df = 5, p-value = 0

                           Comparison of x by group                            
                                 (Bonferroni)                                  
Col Mean-|
Row Mean |     Africa       Asia     Europe   North Am    Oceania
---------+-------------------------------------------------------
    Asia |  -1.814776
         |     0.5217
         |
  Europe |  -9.079400  -7.264623
         |    0.0000*    0.0000*
         |
North Am |  -0.948758   0.866018   8.130641
         |     1.0000     1.0000    0.0000*
         |
 Oceania |  -2.181366  -0.558180   5.939496  -1.332770
         |     0.2187     1.0000    0.0000*     1.0000
         |
South Am |   0.300874   2.115651   9.380275   1.249633   2.450476
         |     1.0000     0.2578    0.0000*     1.0000     0.1070

alpha = 0.05
Reject Ho if p &lt;= alpha/2</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Dunn's Post-hoc Test Results: Pairwise Comparisons of Continents</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Comparison</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Z.statistic</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">P.value</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Adjusted.P</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Significant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Africa - Asia</td>
<td style="text-align: right;">-1.81</td>
<td style="text-align: center;">0.03478</td>
<td style="text-align: center;">0.522</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Africa - Europe</td>
<td style="text-align: right;">-9.08</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Asia - Europe</td>
<td style="text-align: right;">-7.26</td>
<td style="text-align: center;">1.87e-13</td>
<td style="text-align: center;">2.81e-12</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">Africa - North America</td>
<td style="text-align: right;">-0.95</td>
<td style="text-align: center;">0.17137</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Asia - North America</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: center;">0.19324</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Europe - North America</td>
<td style="text-align: right;">8.13</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">3.20e-15</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Africa - Oceania</td>
<td style="text-align: right;">-2.18</td>
<td style="text-align: center;">0.01458</td>
<td style="text-align: center;">0.219</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Asia - Oceania</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: center;">0.28836</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Europe - Oceania</td>
<td style="text-align: right;">5.94</td>
<td style="text-align: center;">1.43e-09</td>
<td style="text-align: center;">2.14e-08</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America - Oceania</td>
<td style="text-align: right;">-1.33</td>
<td style="text-align: center;">0.09130</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Africa - South America</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: center;">0.38175</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Asia - South America</td>
<td style="text-align: right;">2.12</td>
<td style="text-align: center;">0.01719</td>
<td style="text-align: center;">0.258</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Europe - South America</td>
<td style="text-align: right;">9.38</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America - South America</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: center;">0.10572</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania - South America</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: center;">0.00713</td>
<td style="text-align: center;">0.107</td>
<td style="text-align: center;">No</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
</section>
<section id="tests-for-relationships" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="tests-for-relationships"><span class="header-section-number">5.5</span> Tests for Relationships</h2>
<section id="correlation-analysis" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="correlation-analysis"><span class="header-section-number">5.5.1</span> Correlation Analysis</h3>
<section id="pearson-correlation" class="level4" data-number="5.5.1.1">
<h4 data-number="5.5.1.1" class="anchored" data-anchor-id="pearson-correlation"><span class="header-section-number">5.5.1.1</span> Pearson Correlation</h4>
<p>Pearson correlation measures the linear relationship between two continuous variables:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine correlation between wheat and maize yields</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>crop_correlation <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the relationship</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_correlation, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship Between Wheat and Maize Yields"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Maize Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-statistical-tests_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pearson correlation</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cor_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>cor_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Correlation Coefficient (r)"</span>, <span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    cor_result<span class="sc">$</span>parameter,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(cor_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cor_table, </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Pearson Correlation Results: Wheat and Maize Yields"</span>,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Pearson Correlation Results: Wheat and Maize Yields</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Correlation Coefficient (r)</td>
<td style="text-align: right;">0.501</td>
</tr>
<tr class="even">
<td style="text-align: left;">t-value</td>
<td style="text-align: right;">49.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Degrees of Freedom</td>
<td style="text-align: right;">7378</td>
</tr>
<tr class="even">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI Lower</td>
<td style="text-align: right;">0.484</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% CI Upper</td>
<td style="text-align: right;">0.518</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="spearman-correlation" class="level4" data-number="5.5.1.2">
<h4 data-number="5.5.1.2" class="anchored" data-anchor-id="spearman-correlation"><span class="header-section-number">5.5.1.2</span> Spearman Correlation</h4>
<p>Spearman correlation is a non-parametric measure of rank correlation:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Spearman correlation</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>spearman_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>spearman_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Correlation Coefficient (rho)"</span>, <span class="st">"S-value"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(spearman_result<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(spearman_result<span class="sc">$</span>statistic, <span class="at">scientific =</span> <span class="cn">FALSE</span>),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(spearman_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(spearman_table, </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Spearman Correlation Results: Wheat and Maize Yields"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Spearman Correlation Results: Wheat and Maize Yields</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rho</td>
<td style="text-align: left;">Correlation Coefficient (rho)</td>
<td style="text-align: right;">0.633</td>
</tr>
<tr class="even">
<td style="text-align: left;">S</td>
<td style="text-align: left;">S-value</td>
<td style="text-align: right;">24618249591</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a comparison table of correlation methods</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>correlation_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Correlation Method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Pearson"</span>, <span class="st">"Spearman"</span>),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Correlation Coefficient</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(cor_result<span class="sc">$</span>estimate, <span class="dv">3</span>), <span class="fu">round</span>(spearman_result<span class="sc">$</span>estimate, <span class="dv">3</span>)),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(cor_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="fu">format.pval</span>(spearman_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Interpretation</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">abs</span>(cor_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="st">"Strong"</span>, <span class="fu">ifelse</span>(<span class="fu">abs</span>(cor_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="st">"Moderate"</span>, <span class="st">"Weak"</span>)),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">abs</span>(spearman_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="st">"Strong"</span>, <span class="fu">ifelse</span>(<span class="fu">abs</span>(spearman_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="st">"Moderate"</span>, <span class="st">"Weak"</span>))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the comparison table</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(correlation_comparison, </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Comparison of Correlation Methods"</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Comparison of Correlation Methods</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Correlation.Method</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Correlation.Coefficient</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cor</td>
<td style="text-align: left;">Pearson</td>
<td style="text-align: center;">0.501</td>
<td style="text-align: center;">&lt;2e-16</td>
<td style="text-align: center;">Moderate</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho</td>
<td style="text-align: left;">Spearman</td>
<td style="text-align: center;">0.633</td>
<td style="text-align: center;">&lt;2e-16</td>
<td style="text-align: center;">Moderate</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="regression-analysis" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="regression-analysis"><span class="header-section-number">5.5.2</span> Regression Analysis</h3>
<section id="linear-regression" class="level4" data-number="5.5.2.1">
<h4 data-number="5.5.2.1" class="anchored" data-anchor-id="linear-regression"><span class="header-section-number">5.5.2.1</span> Linear Regression</h4>
<p>Linear regression models the relationship between a dependent variable and one or more independent variables:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataset with year as predictor for wheat yields</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>time_series_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Entity <span class="sc">==</span> <span class="st">"United States"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the trend</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(time_series_data, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yield Trends in the United States"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-statistical-tests_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> Year, <span class="at">data =</span> time_series_data)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>lm_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_model)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the regression coefficients</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>coef_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"Year"</span>),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>], <span class="dv">3</span>), <span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>], <span class="dv">3</span>)),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Std. Error</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dv">3</span>), <span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dv">3</span>)),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">t value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">3</span>], <span class="dv">2</span>), <span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">3</span>], <span class="dv">2</span>)),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Pr(&gt;|t|)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">4</span>], <span class="at">digits =</span> <span class="dv">3</span>), <span class="fu">format.pval</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">4</span>], <span class="at">digits =</span> <span class="dv">3</span>))</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the coefficients table</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(coef_table, </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Linear Regression Coefficients: Wheat Yield by Year"</span>,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Linear Regression Coefficients: Wheat Yield by Year</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std..Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr...t..</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-48.466</td>
<td style="text-align: right;">2.571</td>
<td style="text-align: right;">-18.85</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">19.81</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the model summary statistics</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>model_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"R-squared"</span>, <span class="st">"Adjusted R-squared"</span>, <span class="st">"F-statistic"</span>, <span class="st">"DF"</span>, <span class="st">"p-value"</span>, <span class="st">"Residual Standard Error"</span>),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>r.squared, <span class="dv">3</span>),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(lm_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], <span class="st">","</span>, lm_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>]),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(<span class="fu">pf</span>(lm_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], lm_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], lm_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>), <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>sigma, <span class="dv">3</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the model summary statistics table</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(model_stats, </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Linear Regression Model Summary Statistics"</span>,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Linear Regression Model Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R-squared</td>
<td style="text-align: right;">0.875</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adjusted R-squared</td>
<td style="text-align: right;">0.873</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F-statistic</td>
<td style="text-align: right;">392.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">DF</td>
<td style="text-align: right;">1 , 56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual Standard Error</td>
<td style="text-align: right;">0.165</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check assumptions</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-statistical-tests_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multiple-regression" class="level4" data-number="5.5.2.2">
<h4 data-number="5.5.2.2" class="anchored" data-anchor-id="multiple-regression"><span class="header-section-number">5.5.2.2</span> Multiple Regression</h4>
<p>Multiple regression includes more than one predictor variable:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataset with multiple predictors</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>multi_crop_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform multiple regression</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>multi_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span> <span class="sc">+</span> Year, <span class="at">data =</span> multi_crop_data)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>multi_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(multi_model)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the regression coefficients</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>multi_coef_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"Rice (tonnes per hectare)"</span>, <span class="st">"Maize (tonnes per hectare)"</span>, <span class="st">"Year"</span>),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">round</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Std. Error</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">t value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">3</span>], <span class="dv">2</span>),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Pr(&gt;|t|)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>], <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significance =</span> <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"***"</span>, </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="st">"**"</span>, </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.1</span>, <span class="st">"."</span>, <span class="st">""</span>))))</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the coefficients table</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(multi_coef_table, </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Multiple Regression Coefficients: Predicting Wheat Yield"</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"c"</span>),</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_footnote</span>(<span class="st">"Significance codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"</span>, <span class="at">notation =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Multiple Regression Coefficients: Predicting Wheat Yield</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std..Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr...t..</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Significance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-21.612</td>
<td style="text-align: right;">1.776</td>
<td style="text-align: right;">-12.17</td>
<td style="text-align: right;">&lt;2e-16</td>
<td style="text-align: center;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">`Rice (tonnes per hectare)`</td>
<td style="text-align: left;">Rice (tonnes per hectare)</td>
<td style="text-align: right;">-0.005</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">0.577</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">`Maize (tonnes per hectare)`</td>
<td style="text-align: left;">Maize (tonnes per hectare)</td>
<td style="text-align: right;">0.279</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">32.78</td>
<td style="text-align: right;">&lt;2e-16</td>
<td style="text-align: center;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year</td>
<td style="text-align: left;">Year</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">12.81</td>
<td style="text-align: right;">&lt;2e-16</td>
<td style="text-align: center;">***</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0; border: 0;"><sup></sup> Significance codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"></td>
</tr>
</tfoot>

</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the model summary statistics</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>multi_model_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"R-squared"</span>, <span class="st">"Adjusted R-squared"</span>, <span class="st">"F-statistic"</span>, <span class="st">"DF"</span>, <span class="st">"p-value"</span>, <span class="st">"Residual Standard Error"</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>r.squared, <span class="dv">3</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(multi_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], <span class="st">","</span>, multi_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>]),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(<span class="fu">pf</span>(multi_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], multi_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], multi_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>), <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>sigma, <span class="dv">3</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the model summary statistics table</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(multi_model_stats, </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Multiple Regression Model Summary Statistics"</span>,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Multiple Regression Model Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R-squared</td>
<td style="text-align: right;">0.341</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adjusted R-squared</td>
<td style="text-align: right;">0.341</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F-statistic</td>
<td style="text-align: right;">987.24</td>
</tr>
<tr class="even">
<td style="text-align: left;">DF</td>
<td style="text-align: right;">3 , 5722</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual Standard Error</td>
<td style="text-align: right;">1.025</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
</section>
<section id="tests-for-categorical-data" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="tests-for-categorical-data"><span class="header-section-number">5.6</span> Tests for Categorical Data</h2>
<section id="chi-square-test" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="chi-square-test"><span class="header-section-number">5.6.1</span> Chi-Square Test</h3>
<p>The Chi-Square test examines the association between categorical variables. Let’s use our biodiversity dataset:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the biodiversity dataset</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plants <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/ecology/biodiversity.csv"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a contingency table of red list categories by plant group</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">"red_list_category"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(plants) <span class="sc">&amp;</span> <span class="st">"group"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(plants)) {</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a contingency table</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(plants<span class="sc">$</span>red_list_category, plants<span class="sc">$</span>group)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># View the table</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(contingency_table, </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Contingency Table: Red List Categories by Plant Group"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform Chi-Square test</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  chi_sq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  chi_sq_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(chi_sq_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>      chi_sq_result<span class="sc">$</span>parameter,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format.pval</span>(chi_sq_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the Chi-Square test results</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(chi_sq_table, </span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Chi-Square Test Results: Association Between Red List Categories and Plant Groups"</span>,</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Examine residuals to understand the pattern of association</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>  chi_sq_residuals <span class="ot">&lt;-</span> chi_sq_result<span class="sc">$</span>residuals</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the residuals in a more suitable format for display</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>  residuals_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(chi_sq_residuals)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>  residuals_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame.table</span>(residuals_matrix)</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(residuals_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Category"</span>, <span class="st">"Group"</span>, <span class="st">"Residual"</span>)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>  residuals_df<span class="sc">$</span>Residual <span class="ot">&lt;-</span> <span class="fu">round</span>(residuals_df<span class="sc">$</span>Residual, <span class="dv">2</span>)</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the residuals table</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(residuals_df,</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Standardized Residuals: Association Between Red List Categories and Plant Groups"</span>,</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the expected columns don't exist, create a demonstration with available data</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Required columns not found. Creating a demonstration with available columns."</span>)</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify categorical columns</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>  categorical_cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(plants, <span class="cf">function</span>(x) <span class="fu">is.character</span>(x) <span class="sc">||</span> <span class="fu">is.factor</span>(x))</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>  cat_col_names <span class="ot">&lt;-</span> <span class="fu">names</span>(plants)[categorical_cols]</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(cat_col_names) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select the first two categorical columns</span></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>    col1 <span class="ot">&lt;-</span> cat_col_names[<span class="dv">1</span>]</span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>    col2 <span class="ot">&lt;-</span> cat_col_names[<span class="dv">2</span>]</span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a contingency table</span></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>    contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(plants[[col1]], plants[[col2]])</span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># View the table</span></span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(contingency_table, </span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>                 <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Contingency Table:"</span>, col1, <span class="st">"by"</span>, col2),</span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>                 <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>                 <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>      kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>                               <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>                               <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform Chi-Square test if appropriate</span></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">min</span>(<span class="fu">dim</span>(contingency_table)) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(contingency_table) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>      chi_sq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>      chi_sq_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a>          <span class="fu">round</span>(chi_sq_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a>          chi_sq_result<span class="sc">$</span>parameter,</span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a>          <span class="fu">format.pval</span>(chi_sq_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Display the Chi-Square test results</span></span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a>      knitr<span class="sc">::</span><span class="fu">kable</span>(chi_sq_table, </span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a>                   <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Chi-Square Test Results: Association Between"</span>, col1, <span class="st">"and"</span>, col2),</span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a>                   <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a>                   <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a>        kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">"Contingency table not suitable for Chi-Square test."</span>)</span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Not enough categorical columns found for Chi-Square test demonstration."</span>)</span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Standardized Residuals: Association Between Red List Categories and Plant Groups</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Category</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Group</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Residual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Algae</td>
<td style="text-align: right;">0.24</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Algae</td>
<td style="text-align: right;">-0.62</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Conifer</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Conifer</td>
<td style="text-align: right;">-0.36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Cycad</td>
<td style="text-align: right;">-1.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Cycad</td>
<td style="text-align: right;">2.90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Ferns and Allies</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Ferns and Allies</td>
<td style="text-align: right;">-0.53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Flowering Plant</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Flowering Plant</td>
<td style="text-align: right;">-0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Mosses</td>
<td style="text-align: right;">0.28</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Mosses</td>
<td style="text-align: right;">-0.72</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="tests-for-trends-and-time-series" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="tests-for-trends-and-time-series"><span class="header-section-number">5.7</span> Tests for Trends and Time Series</h2>
<section id="time-series-analysis" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="time-series-analysis"><span class="header-section-number">5.7.1</span> Time Series Analysis</h3>
<p>Time series analysis examines data collected over time to identify patterns, trends, and seasonal effects:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a time series of wheat yields for a specific country</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>us_wheat <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Entity <span class="sc">==</span> <span class="st">"United States"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to time series object</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"zoo"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(zoo)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  wheat_ts <span class="ot">&lt;-</span> <span class="fu">zoo</span>(us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, us_wheat<span class="sc">$</span>Year)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the time series</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(wheat_ts, <span class="at">main =</span> <span class="st">"US Wheat Yields Over Time"</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add trend line</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(us_wheat<span class="sc">$</span>Year, us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Basic plot if zoo package is not available</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(us_wheat<span class="sc">$</span>Year, us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">"US Wheat Yields Over Time"</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add trend line</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(us_wheat<span class="sc">$</span>Year, us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-statistical-tests_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mann-kendall-trend-test" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="mann-kendall-trend-test"><span class="header-section-number">5.7.2</span> Mann-Kendall Trend Test</h3>
<p>The Mann-Kendall test is a non-parametric test for identifying trends in time series data:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Mann-Kendall trend test</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"Kendall"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(Kendall)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  mk_test <span class="ot">&lt;-</span> Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  mk_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Tau"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(mk_test<span class="sc">$</span>tau, <span class="dv">3</span>),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format.pval</span>(mk_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the Mann-Kendall test results</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(mk_table, </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Mann-Kendall Trend Test Results: US Wheat Yields"</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"The Kendall package is not installed. Install it with install.packages('Kendall') to run the Mann-Kendall trend test."</span>)</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Mann-Kendall Trend Test Results: US Wheat Yields</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Tau</td>
<td style="text-align: right;">0.798</td>
</tr>
<tr class="even">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">0.798</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="summary" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="summary"><span class="header-section-number">5.8</span> Summary</h2>
<p>This chapter has demonstrated a variety of statistical tests using real agricultural and biodiversity datasets. We’ve covered:</p>
<ol type="1">
<li><strong>Tests for comparing groups</strong>:
<ul>
<li>t-tests for comparing two groups</li>
<li>ANOVA for comparing multiple groups</li>
<li>Non-parametric alternatives when data doesn’t meet parametric assumptions</li>
</ul></li>
<li><strong>Tests for relationships</strong>:
<ul>
<li>Correlation analysis to measure the strength of relationships</li>
<li>Regression analysis to model relationships between variables</li>
</ul></li>
<li><strong>Tests for categorical data</strong>:
<ul>
<li>Chi-Square test for examining associations between categorical variables</li>
</ul></li>
<li><strong>Tests for time series data</strong>:
<ul>
<li>Time series analysis for identifying patterns over time</li>
<li>Mann-Kendall test for detecting trends</li>
</ul></li>
</ol>
<p>When conducting statistical tests, remember to: - Clearly define your research question - Check if your data meets the assumptions of the test - Choose the appropriate test based on your data type and research question - Interpret results in the context of your research question - Consider the practical significance, not just statistical significance</p>
</section>
<section id="exercises" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="exercises"><span class="header-section-number">5.9</span> Exercises</h2>
<ol type="1">
<li><p>Using the crop yield dataset, compare maize yields between continents using both ANOVA and the Kruskal-Wallis test. Which is more appropriate and why?</p></li>
<li><p>Examine the relationship between potato and rice yields using correlation analysis. Calculate both Pearson and Spearman correlations and explain which is more appropriate.</p></li>
<li><p>Using the biodiversity dataset, investigate whether there’s an association between conservation status and another categorical variable of your choice.</p></li>
<li><p>Perform a time series analysis of wheat yields for China and compare the trend with that of the United States.</p></li>
<li><p>Using the animal dataset (<code>../data/entomology/insects.csv</code>), compare two groups using an appropriate statistical test.</p></li>
<li><p>Create a multiple regression model to predict coffee quality scores using the coffee economics dataset (<code>../data/economics/economic.csv</code>).</p></li>
</ol>
</section>
<section id="enhanced-statistical-tests-chapter" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="enhanced-statistical-tests-chapter"><span class="header-section-number">5.10</span> Enhanced Statistical Tests Chapter</h2>
<p>The enhanced visualizations and tables for this chapter are available in a separate file to ensure compatibility with the book rendering process.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jm0535\.github\.io\/data-analysis-book\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/04-hypothesis-testing.html" class="pagination-link" aria-label="Hypothesis Testing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/06-visualization.html" class="pagination-link" aria-label="Data Visualization">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb34" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="an">prefer-html:</span><span class="co"> true</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Common Statistical Tests</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages for data analysis and visualization</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)  <span class="co"># For the pipe operator %&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)  <span class="co"># For data reshaping functions</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set global knitr options</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>,        <span class="co"># Display code chunks</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,    <span class="co"># Suppress warnings</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,    <span class="co"># Suppress messages</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.width =</span> <span class="dv">8</span>,      <span class="co"># Default figure width</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.height =</span> <span class="dv">5</span>,     <span class="co"># Default figure height</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.align =</span> <span class="st">"center"</span> <span class="co"># Center figures</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>This chapter explores common statistical tests used in natural sciences research. Building on the hypothesis testing framework introduced in the previous chapter, we'll examine specific tests for different research scenarios and data types.</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Choosing the Right Statistical Test</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>Selecting the appropriate statistical test depends on several factors:</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Research Question**: What you're trying to determine</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Data Type**: Categorical, continuous, or ordinal</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Number of Groups**: One, two, or multiple groups</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Data Distribution**: Normal or non-normal</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Independence**: Whether observations are independent or related</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a><span class="fu">### Decision Tree for Common Tests</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Decision tree for selecting appropriate statistical tests"</span></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a><span class="co"># This code requires the DiagrammeR package</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a><span class="co"># If you want to run this code, first install the package with:</span></span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("DiagrammeR")</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">"</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="st">digraph test_selection {</span></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a><span class="st">  # Node definitions</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a><span class="st">  node [shape = rectangle, fontname = 'Arial', fontsize = 10, style = filled, fillcolor = lightblue]</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a><span class="st">  start [label = 'Research Question', fillcolor = lightgreen]</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a><span class="st">  # First level: Number of variables</span></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a><span class="st">  one_var [label = 'One Variable']</span></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a><span class="st">  two_var [label = 'Two Variables']</span></span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a><span class="st">  multi_var [label = 'Multiple Variables']</span></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a><span class="st">  # Second level for one variable</span></span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a><span class="st">  one_sample [label = 'One Sample']</span></span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a><span class="st">  two_sample [label = 'Two Samples']</span></span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a><span class="st">  multi_sample [label = 'Multiple Samples']</span></span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a><span class="st">  # Tests for one variable</span></span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a><span class="st">  t_test [label = 'One-Sample t-Test</span><span class="sc">\\</span><span class="st">n(Normal, Continuous)']</span></span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a><span class="st">  wilcox [label = 'Wilcoxon Signed-Rank</span><span class="sc">\\</span><span class="st">n(Non-normal, Continuous)']</span></span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a><span class="st">  binom [label = 'Binomial Test</span><span class="sc">\\</span><span class="st">n(Categorical)']</span></span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a><span class="st">  # Tests for two variables - two samples</span></span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a><span class="st">  ind_t [label = 'Independent t-Test</span><span class="sc">\\</span><span class="st">n(Normal, Continuous)']</span></span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a><span class="st">  paired_t [label = 'Paired t-Test</span><span class="sc">\\</span><span class="st">n(Normal, Continuous, Related)']</span></span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a><span class="st">  mann [label = 'Mann-Whitney U</span><span class="sc">\\</span><span class="st">n(Non-normal, Continuous)']</span></span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a><span class="st">  wilcox_paired [label = 'Wilcoxon Signed-Rank</span><span class="sc">\\</span><span class="st">n(Non-normal, Continuous, Related)']</span></span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a><span class="st">  chi_sq [label = 'Chi-Square Test</span><span class="sc">\\</span><span class="st">n(Categorical)']</span></span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a><span class="st">  mcnemar [label = 'McNemar Test</span><span class="sc">\\</span><span class="st">n(Categorical, Related)']</span></span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a><span class="st">  # Tests for multiple samples</span></span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a><span class="st">  anova [label = 'ANOVA</span><span class="sc">\\</span><span class="st">n(Normal, Continuous)']</span></span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a><span class="st">  rm_anova [label = 'Repeated Measures ANOVA</span><span class="sc">\\</span><span class="st">n(Normal, Continuous, Related)']</span></span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a><span class="st">  kruskal [label = 'Kruskal-Wallis</span><span class="sc">\\</span><span class="st">n(Non-normal, Continuous)']</span></span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a><span class="st">  friedman [label = 'Friedman Test</span><span class="sc">\\</span><span class="st">n(Non-normal, Continuous, Related)']</span></span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a><span class="st">  chi_sq_multi [label = 'Chi-Square Test</span><span class="sc">\\</span><span class="st">n(Categorical)']</span></span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a><span class="st">  # Tests for relationships</span></span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a><span class="st">  pearson [label = 'Pearson Correlation</span><span class="sc">\\</span><span class="st">n(Normal, Continuous)']</span></span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a><span class="st">  spearman [label = 'Spearman Correlation</span><span class="sc">\\</span><span class="st">n(Non-normal or Ordinal)']</span></span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a><span class="st">  linear_reg [label = 'Linear Regression</span><span class="sc">\\</span><span class="st">n(Continuous Predictor &amp; Outcome)']</span></span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a><span class="st">  logistic [label = 'Logistic Regression</span><span class="sc">\\</span><span class="st">n(Continuous Predictor, Binary Outcome)']</span></span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-99"><a href="#cb34-99" aria-hidden="true" tabindex="-1"></a><span class="st">  # Multiple variables</span></span>
<span id="cb34-100"><a href="#cb34-100" aria-hidden="true" tabindex="-1"></a><span class="st">  manova [label = 'MANOVA</span><span class="sc">\\</span><span class="st">n(Multiple Continuous Outcomes)']</span></span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a><span class="st">  pca [label = 'Principal Component Analysis</span><span class="sc">\\</span><span class="st">n(Dimension Reduction)']</span></span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a><span class="st">  cluster [label = 'Cluster Analysis</span><span class="sc">\\</span><span class="st">n(Grouping)']</span></span>
<span id="cb34-103"><a href="#cb34-103" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-104"><a href="#cb34-104" aria-hidden="true" tabindex="-1"></a><span class="st">  # Connections</span></span>
<span id="cb34-105"><a href="#cb34-105" aria-hidden="true" tabindex="-1"></a><span class="st">  start -&gt; {one_var two_var multi_var}</span></span>
<span id="cb34-106"><a href="#cb34-106" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-107"><a href="#cb34-107" aria-hidden="true" tabindex="-1"></a><span class="st">  one_var -&gt; {one_sample two_sample multi_sample}</span></span>
<span id="cb34-108"><a href="#cb34-108" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-109"><a href="#cb34-109" aria-hidden="true" tabindex="-1"></a><span class="st">  one_sample -&gt; {t_test wilcox binom}</span></span>
<span id="cb34-110"><a href="#cb34-110" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-111"><a href="#cb34-111" aria-hidden="true" tabindex="-1"></a><span class="st">  two_sample -&gt; {ind_t paired_t mann wilcox_paired chi_sq mcnemar}</span></span>
<span id="cb34-112"><a href="#cb34-112" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-113"><a href="#cb34-113" aria-hidden="true" tabindex="-1"></a><span class="st">  multi_sample -&gt; {anova rm_anova kruskal friedman chi_sq_multi}</span></span>
<span id="cb34-114"><a href="#cb34-114" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-115"><a href="#cb34-115" aria-hidden="true" tabindex="-1"></a><span class="st">  two_var -&gt; {pearson spearman linear_reg logistic}</span></span>
<span id="cb34-116"><a href="#cb34-116" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb34-117"><a href="#cb34-117" aria-hidden="true" tabindex="-1"></a><span class="st">  multi_var -&gt; {manova pca cluster}</span></span>
<span id="cb34-118"><a href="#cb34-118" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb34-119"><a href="#cb34-119" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb34-120"><a href="#cb34-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-121"><a href="#cb34-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-122"><a href="#cb34-122" aria-hidden="true" tabindex="-1"></a>**Decision Tree for Selecting Statistical Tests:**</span>
<span id="cb34-123"><a href="#cb34-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-124"><a href="#cb34-124" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**For One Variable:**</span>
<span id="cb34-125"><a href="#cb34-125" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**One Sample:**</span>
<span id="cb34-126"><a href="#cb34-126" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Normal, Continuous → One-Sample t-Test</span>
<span id="cb34-127"><a href="#cb34-127" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Non-normal, Continuous → Wilcoxon Signed-Rank Test</span>
<span id="cb34-128"><a href="#cb34-128" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Categorical → Binomial Test</span>
<span id="cb34-129"><a href="#cb34-129" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb34-130"><a href="#cb34-130" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Two Samples:**</span>
<span id="cb34-131"><a href="#cb34-131" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Normal, Continuous, Independent → Independent t-Test</span>
<span id="cb34-132"><a href="#cb34-132" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Normal, Continuous, Related → Paired t-Test</span>
<span id="cb34-133"><a href="#cb34-133" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Non-normal, Continuous, Independent → Mann-Whitney U Test</span>
<span id="cb34-134"><a href="#cb34-134" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Non-normal, Continuous, Related → Wilcoxon Signed-Rank Test</span>
<span id="cb34-135"><a href="#cb34-135" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Categorical, Independent → Chi-Square Test</span>
<span id="cb34-136"><a href="#cb34-136" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Categorical, Related → McNemar Test</span>
<span id="cb34-137"><a href="#cb34-137" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb34-138"><a href="#cb34-138" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Multiple Samples:**</span>
<span id="cb34-139"><a href="#cb34-139" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Normal, Continuous, Independent → ANOVA</span>
<span id="cb34-140"><a href="#cb34-140" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Normal, Continuous, Related → Repeated Measures ANOVA</span>
<span id="cb34-141"><a href="#cb34-141" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Non-normal, Continuous, Independent → Kruskal-Wallis Test</span>
<span id="cb34-142"><a href="#cb34-142" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Non-normal, Continuous, Related → Friedman Test</span>
<span id="cb34-143"><a href="#cb34-143" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Categorical → Chi-Square Test</span>
<span id="cb34-144"><a href="#cb34-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-145"><a href="#cb34-145" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**For Two Variables:**</span>
<span id="cb34-146"><a href="#cb34-146" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Normal, Continuous → Pearson Correlation</span>
<span id="cb34-147"><a href="#cb34-147" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Non-normal or Ordinal → Spearman Correlation</span>
<span id="cb34-148"><a href="#cb34-148" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Continuous Predictor &amp; Outcome → Linear Regression</span>
<span id="cb34-149"><a href="#cb34-149" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Continuous Predictor, Binary Outcome → Logistic Regression</span>
<span id="cb34-150"><a href="#cb34-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-151"><a href="#cb34-151" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**For Multiple Variables:**</span>
<span id="cb34-152"><a href="#cb34-152" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Multiple Continuous Outcomes → MANOVA</span>
<span id="cb34-153"><a href="#cb34-153" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Dimension Reduction → Principal Component Analysis</span>
<span id="cb34-154"><a href="#cb34-154" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Grouping → Cluster Analysis</span>
<span id="cb34-155"><a href="#cb34-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-156"><a href="#cb34-156" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parametric vs. Non-Parametric Tests</span></span>
<span id="cb34-157"><a href="#cb34-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-158"><a href="#cb34-158" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parametric Tests</span></span>
<span id="cb34-159"><a href="#cb34-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-160"><a href="#cb34-160" aria-hidden="true" tabindex="-1"></a>Parametric tests make assumptions about the underlying population distribution, typically that the data follows a normal distribution. Common parametric tests include:</span>
<span id="cb34-161"><a href="#cb34-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-162"><a href="#cb34-162" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>t-tests</span>
<span id="cb34-163"><a href="#cb34-163" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ANOVA</span>
<span id="cb34-164"><a href="#cb34-164" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Pearson correlation</span>
<span id="cb34-165"><a href="#cb34-165" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Linear regression</span>
<span id="cb34-166"><a href="#cb34-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-167"><a href="#cb34-167" aria-hidden="true" tabindex="-1"></a><span class="fu">### Non-Parametric Tests</span></span>
<span id="cb34-168"><a href="#cb34-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-169"><a href="#cb34-169" aria-hidden="true" tabindex="-1"></a>Non-parametric tests make fewer assumptions about the population distribution and are useful when data doesn't meet the assumptions of parametric tests. Common non-parametric tests include:</span>
<span id="cb34-170"><a href="#cb34-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-171"><a href="#cb34-171" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mann-Whitney U test</span>
<span id="cb34-172"><a href="#cb34-172" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Wilcoxon signed-rank test</span>
<span id="cb34-173"><a href="#cb34-173" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Kruskal-Wallis test</span>
<span id="cb34-174"><a href="#cb34-174" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Spearman correlation</span>
<span id="cb34-175"><a href="#cb34-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-176"><a href="#cb34-176" aria-hidden="true" tabindex="-1"></a><span class="fu">### Checking Assumptions</span></span>
<span id="cb34-177"><a href="#cb34-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-178"><a href="#cb34-178" aria-hidden="true" tabindex="-1"></a>Before applying a parametric test, it's essential to check if your data meets the necessary assumptions. Let's use our crop yield dataset to demonstrate:</span>
<span id="cb34-179"><a href="#cb34-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-182"><a href="#cb34-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-183"><a href="#cb34-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb34-184"><a href="#cb34-184" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb34-185"><a href="#cb34-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-186"><a href="#cb34-186" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the crop yield dataset</span></span>
<span id="cb34-187"><a href="#cb34-187" aria-hidden="true" tabindex="-1"></a>crop_yields <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/agriculture/crop_yields.csv"</span>)</span>
<span id="cb34-188"><a href="#cb34-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-189"><a href="#cb34-189" aria-hidden="true" tabindex="-1"></a><span class="co"># View column names to see how R has formatted them</span></span>
<span id="cb34-190"><a href="#cb34-190" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(crop_yields)</span>
<span id="cb34-191"><a href="#cb34-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-192"><a href="#cb34-192" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract wheat yields for analysis</span></span>
<span id="cb34-193"><a href="#cb34-193" aria-hidden="true" tabindex="-1"></a>wheat_yields <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb34-194"><a href="#cb34-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-195"><a href="#cb34-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb34-196"><a href="#cb34-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-197"><a href="#cb34-197" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first few rows</span></span>
<span id="cb34-198"><a href="#cb34-198" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wheat_yields), </span>
<span id="cb34-199"><a href="#cb34-199" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Sample of Wheat Yield Data"</span>,</span>
<span id="cb34-200"><a href="#cb34-200" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-201"><a href="#cb34-201" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-202"><a href="#cb34-202" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-203"><a href="#cb34-203" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-204"><a href="#cb34-204" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-205"><a href="#cb34-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-206"><a href="#cb34-206" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for normality</span></span>
<span id="cb34-207"><a href="#cb34-207" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual methods</span></span>
<span id="cb34-208"><a href="#cb34-208" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb34-209"><a href="#cb34-209" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">main =</span> <span class="st">"Histogram of Wheat Yields"</span>, <span class="at">xlab =</span> <span class="st">"Yield (tonnes/hectare)"</span>)</span>
<span id="cb34-210"><a href="#cb34-210" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>); <span class="fu">qqline</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb34-211"><a href="#cb34-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-212"><a href="#cb34-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical test for normality</span></span>
<span id="cb34-213"><a href="#cb34-213" aria-hidden="true" tabindex="-1"></a>shapiro_result <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">sample</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="fu">min</span>(<span class="dv">5000</span>, <span class="fu">length</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>))))</span>
<span id="cb34-214"><a href="#cb34-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-215"><a href="#cb34-215" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb34-216"><a href="#cb34-216" aria-hidden="true" tabindex="-1"></a>shapiro_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-217"><a href="#cb34-217" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"W-value"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb34-218"><a href="#cb34-218" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-219"><a href="#cb34-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(shapiro_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb34-220"><a href="#cb34-220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(shapiro_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-221"><a href="#cb34-221" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-222"><a href="#cb34-222" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-223"><a href="#cb34-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-224"><a href="#cb34-224" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb34-225"><a href="#cb34-225" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(shapiro_table, </span>
<span id="cb34-226"><a href="#cb34-226" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Shapiro-Wilk Normality Test Results: Wheat Yields"</span>,</span>
<span id="cb34-227"><a href="#cb34-227" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-228"><a href="#cb34-228" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-229"><a href="#cb34-229" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-230"><a href="#cb34-230" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-231"><a href="#cb34-231" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-232"><a href="#cb34-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-233"><a href="#cb34-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-234"><a href="#cb34-234" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tests for Comparing Groups</span></span>
<span id="cb34-235"><a href="#cb34-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-236"><a href="#cb34-236" aria-hidden="true" tabindex="-1"></a><span class="fu">### t-Tests</span></span>
<span id="cb34-237"><a href="#cb34-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-238"><a href="#cb34-238" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Independent Samples t-Test</span></span>
<span id="cb34-239"><a href="#cb34-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-240"><a href="#cb34-240" aria-hidden="true" tabindex="-1"></a>Used to compare means between two independent groups. Let's compare wheat yields between two time periods:</span>
<span id="cb34-241"><a href="#cb34-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-244"><a href="#cb34-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-245"><a href="#cb34-245" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two groups: early period (before 2000) and recent period (2000 onwards)</span></span>
<span id="cb34-246"><a href="#cb34-246" aria-hidden="true" tabindex="-1"></a>crop_yields_grouped <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb34-247"><a href="#cb34-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> Year <span class="sc">&gt;=</span> <span class="dv">1960</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-248"><a href="#cb34-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period =</span> <span class="fu">ifelse</span>(Year <span class="sc">&lt;</span> <span class="dv">2000</span>, <span class="st">"Early Period (pre-2000)"</span>, <span class="st">"Recent Period (2000+)"</span>))</span>
<span id="cb34-249"><a href="#cb34-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-250"><a href="#cb34-250" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the data</span></span>
<span id="cb34-251"><a href="#cb34-251" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_yields_grouped, <span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">fill =</span> period)) <span class="sc">+</span></span>
<span id="cb34-252"><a href="#cb34-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb34-253"><a href="#cb34-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yields by Time Period"</span>,</span>
<span id="cb34-254"><a href="#cb34-254" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Period"</span>,</span>
<span id="cb34-255"><a href="#cb34-255" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb34-256"><a href="#cb34-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-257"><a href="#cb34-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb34-258"><a href="#cb34-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-259"><a href="#cb34-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform independent samples t-test using formula interface with backticks</span></span>
<span id="cb34-260"><a href="#cb34-260" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> period, <span class="at">data =</span> crop_yields_grouped)</span>
<span id="cb34-261"><a href="#cb34-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-262"><a href="#cb34-262" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb34-263"><a href="#cb34-263" aria-hidden="true" tabindex="-1"></a>t_test_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-264"><a href="#cb34-264" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb34-265"><a href="#cb34-265" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-266"><a href="#cb34-266" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb34-267"><a href="#cb34-267" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb34-268"><a href="#cb34-268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(t_test_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-269"><a href="#cb34-269" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">diff</span>(t_test_result<span class="sc">$</span>estimate), <span class="dv">2</span>),</span>
<span id="cb34-270"><a href="#cb34-270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb34-271"><a href="#cb34-271" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb34-272"><a href="#cb34-272" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-273"><a href="#cb34-273" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-274"><a href="#cb34-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-275"><a href="#cb34-275" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb34-276"><a href="#cb34-276" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(t_test_table, </span>
<span id="cb34-277"><a href="#cb34-277" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Independent Samples t-Test Results: Wheat Yields by Time Period"</span>,</span>
<span id="cb34-278"><a href="#cb34-278" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-279"><a href="#cb34-279" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-280"><a href="#cb34-280" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-281"><a href="#cb34-281" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-282"><a href="#cb34-282" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-283"><a href="#cb34-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-284"><a href="#cb34-284" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics by period</span></span>
<span id="cb34-285"><a href="#cb34-285" aria-hidden="true" tabindex="-1"></a>period_summary <span class="ot">&lt;-</span> crop_yields_grouped <span class="sc">%&gt;%</span></span>
<span id="cb34-286"><a href="#cb34-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(period) <span class="sc">%&gt;%</span></span>
<span id="cb34-287"><a href="#cb34-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb34-288"><a href="#cb34-288" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb34-289"><a href="#cb34-289" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-290"><a href="#cb34-290" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-291"><a href="#cb34-291" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">round</span>(<span class="fu">min</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-292"><a href="#cb34-292" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb34-293"><a href="#cb34-293" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-294"><a href="#cb34-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-295"><a href="#cb34-295" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics table</span></span>
<span id="cb34-296"><a href="#cb34-296" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(period_summary, </span>
<span id="cb34-297"><a href="#cb34-297" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics: Wheat Yields by Time Period"</span>,</span>
<span id="cb34-298"><a href="#cb34-298" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-299"><a href="#cb34-299" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-300"><a href="#cb34-300" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-301"><a href="#cb34-301" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-302"><a href="#cb34-302" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-303"><a href="#cb34-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-304"><a href="#cb34-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-305"><a href="#cb34-305" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Paired Samples t-Test</span></span>
<span id="cb34-306"><a href="#cb34-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-307"><a href="#cb34-307" aria-hidden="true" tabindex="-1"></a>Used to compare means between two related groups. Let's compare wheat and rice yields for the same countries and years:</span>
<span id="cb34-308"><a href="#cb34-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-311"><a href="#cb34-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-312"><a href="#cb34-312" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for paired t-test</span></span>
<span id="cb34-313"><a href="#cb34-313" aria-hidden="true" tabindex="-1"></a>paired_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb34-314"><a href="#cb34-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-315"><a href="#cb34-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb34-316"><a href="#cb34-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-317"><a href="#cb34-317" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first few rows</span></span>
<span id="cb34-318"><a href="#cb34-318" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(paired_data), </span>
<span id="cb34-319"><a href="#cb34-319" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Sample of Paired Crop Yield Data"</span>,</span>
<span id="cb34-320"><a href="#cb34-320" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-321"><a href="#cb34-321" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-322"><a href="#cb34-322" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-323"><a href="#cb34-323" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-324"><a href="#cb34-324" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-325"><a href="#cb34-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-326"><a href="#cb34-326" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the paired data</span></span>
<span id="cb34-327"><a href="#cb34-327" aria-hidden="true" tabindex="-1"></a>paired_data_long <span class="ot">&lt;-</span> paired_data <span class="sc">%&gt;%</span></span>
<span id="cb34-328"><a href="#cb34-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Crop"</span>, <span class="at">values_to =</span> <span class="st">"Yield"</span>)</span>
<span id="cb34-329"><a href="#cb34-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-330"><a href="#cb34-330" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(paired_data_long, <span class="fu">aes</span>(<span class="at">x =</span> Crop, <span class="at">y =</span> Yield, <span class="at">fill =</span> Crop)) <span class="sc">+</span></span>
<span id="cb34-331"><a href="#cb34-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb34-332"><a href="#cb34-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of Wheat and Rice Yields"</span>,</span>
<span id="cb34-333"><a href="#cb34-333" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Crop Type"</span>,</span>
<span id="cb34-334"><a href="#cb34-334" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb34-335"><a href="#cb34-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb34-336"><a href="#cb34-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-337"><a href="#cb34-337" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform paired t-test using vectors directly</span></span>
<span id="cb34-338"><a href="#cb34-338" aria-hidden="true" tabindex="-1"></a>paired_t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(</span>
<span id="cb34-339"><a href="#cb34-339" aria-hidden="true" tabindex="-1"></a>  paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, </span>
<span id="cb34-340"><a href="#cb34-340" aria-hidden="true" tabindex="-1"></a>  paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, </span>
<span id="cb34-341"><a href="#cb34-341" aria-hidden="true" tabindex="-1"></a>  <span class="at">paired =</span> <span class="cn">TRUE</span></span>
<span id="cb34-342"><a href="#cb34-342" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-343"><a href="#cb34-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-344"><a href="#cb34-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb34-345"><a href="#cb34-345" aria-hidden="true" tabindex="-1"></a>paired_t_test_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-346"><a href="#cb34-346" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb34-347"><a href="#cb34-347" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-348"><a href="#cb34-348" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb34-349"><a href="#cb34-349" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb34-350"><a href="#cb34-350" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(paired_t_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-351"><a href="#cb34-351" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">-</span> paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-352"><a href="#cb34-352" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb34-353"><a href="#cb34-353" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb34-354"><a href="#cb34-354" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-355"><a href="#cb34-355" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-356"><a href="#cb34-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-357"><a href="#cb34-357" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb34-358"><a href="#cb34-358" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_t_test_table, </span>
<span id="cb34-359"><a href="#cb34-359" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Paired Samples t-Test Results: Wheat vs. Rice Yields"</span>,</span>
<span id="cb34-360"><a href="#cb34-360" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-361"><a href="#cb34-361" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-362"><a href="#cb34-362" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-363"><a href="#cb34-363" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-364"><a href="#cb34-364" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-365"><a href="#cb34-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-366"><a href="#cb34-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary statistics table</span></span>
<span id="cb34-367"><a href="#cb34-367" aria-hidden="true" tabindex="-1"></a>paired_summary <span class="ot">&lt;-</span> paired_data <span class="sc">%&gt;%</span></span>
<span id="cb34-368"><a href="#cb34-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb34-369"><a href="#cb34-369" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb34-370"><a href="#cb34-370" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Wheat</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-371"><a href="#cb34-371" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD Wheat</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-372"><a href="#cb34-372" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Rice</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-373"><a href="#cb34-373" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD Rice</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-374"><a href="#cb34-374" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Difference</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-375"><a href="#cb34-375" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD Difference</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb34-376"><a href="#cb34-376" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-377"><a href="#cb34-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-378"><a href="#cb34-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics table</span></span>
<span id="cb34-379"><a href="#cb34-379" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_summary, </span>
<span id="cb34-380"><a href="#cb34-380" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics: Wheat vs. Rice Yields"</span>,</span>
<span id="cb34-381"><a href="#cb34-381" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="dv">7</span>),</span>
<span id="cb34-382"><a href="#cb34-382" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-383"><a href="#cb34-383" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-384"><a href="#cb34-384" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-385"><a href="#cb34-385" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-386"><a href="#cb34-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-387"><a href="#cb34-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-388"><a href="#cb34-388" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of Variance (ANOVA)</span></span>
<span id="cb34-389"><a href="#cb34-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-390"><a href="#cb34-390" aria-hidden="true" tabindex="-1"></a>ANOVA is used to compare means among three or more independent groups. Let's compare crop yields across different continents:</span>
<span id="cb34-391"><a href="#cb34-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-394"><a href="#cb34-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-395"><a href="#cb34-395" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of countries to continents (simplified for demonstration)</span></span>
<span id="cb34-396"><a href="#cb34-396" aria-hidden="true" tabindex="-1"></a>continent_mapping <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-397"><a href="#cb34-397" aria-hidden="true" tabindex="-1"></a>  <span class="at">Entity =</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"Canada"</span>, <span class="st">"Mexico"</span>, </span>
<span id="cb34-398"><a href="#cb34-398" aria-hidden="true" tabindex="-1"></a>             <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Japan"</span>, </span>
<span id="cb34-399"><a href="#cb34-399" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Germany"</span>, <span class="st">"France"</span>, <span class="st">"United Kingdom"</span>, </span>
<span id="cb34-400"><a href="#cb34-400" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Brazil"</span>, <span class="st">"Argentina"</span>, <span class="st">"Chile"</span>,</span>
<span id="cb34-401"><a href="#cb34-401" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Egypt"</span>, <span class="st">"Nigeria"</span>, <span class="st">"South Africa"</span>,</span>
<span id="cb34-402"><a href="#cb34-402" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Australia"</span>, <span class="st">"New Zealand"</span>),</span>
<span id="cb34-403"><a href="#cb34-403" aria-hidden="true" tabindex="-1"></a>  <span class="at">Continent =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"North America"</span>, <span class="dv">3</span>), </span>
<span id="cb34-404"><a href="#cb34-404" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Asia"</span>, <span class="dv">3</span>), </span>
<span id="cb34-405"><a href="#cb34-405" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Europe"</span>, <span class="dv">3</span>), </span>
<span id="cb34-406"><a href="#cb34-406" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"South America"</span>, <span class="dv">3</span>),</span>
<span id="cb34-407"><a href="#cb34-407" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Africa"</span>, <span class="dv">3</span>),</span>
<span id="cb34-408"><a href="#cb34-408" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Oceania"</span>, <span class="dv">2</span>))</span>
<span id="cb34-409"><a href="#cb34-409" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-410"><a href="#cb34-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-411"><a href="#cb34-411" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with crop yields data</span></span>
<span id="cb34-412"><a href="#cb34-412" aria-hidden="true" tabindex="-1"></a>continental_yields <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb34-413"><a href="#cb34-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(continent_mapping, <span class="at">by =</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-414"><a href="#cb34-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> Year <span class="sc">&gt;=</span> <span class="dv">2000</span>)</span>
<span id="cb34-415"><a href="#cb34-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-416"><a href="#cb34-416" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize wheat yields by continent</span></span>
<span id="cb34-417"><a href="#cb34-417" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(continental_yields, <span class="fu">aes</span>(<span class="at">x =</span> Continent, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">fill =</span> Continent)) <span class="sc">+</span></span>
<span id="cb34-418"><a href="#cb34-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb34-419"><a href="#cb34-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yields by Continent (2000-present)"</span>,</span>
<span id="cb34-420"><a href="#cb34-420" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent"</span>,</span>
<span id="cb34-421"><a href="#cb34-421" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb34-422"><a href="#cb34-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-423"><a href="#cb34-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb34-424"><a href="#cb34-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-425"><a href="#cb34-425" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA</span></span>
<span id="cb34-426"><a href="#cb34-426" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> Continent, <span class="at">data =</span> continental_yields)</span>
<span id="cb34-427"><a href="#cb34-427" aria-hidden="true" tabindex="-1"></a>anova_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_result)</span>
<span id="cb34-428"><a href="#cb34-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-429"><a href="#cb34-429" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted ANOVA table</span></span>
<span id="cb34-430"><a href="#cb34-430" aria-hidden="true" tabindex="-1"></a>anova_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-431"><a href="#cb34-431" aria-hidden="true" tabindex="-1"></a>  <span class="at">Source =</span> <span class="fu">c</span>(<span class="st">"Continent"</span>, <span class="st">"Residuals"</span>),</span>
<span id="cb34-432"><a href="#cb34-432" aria-hidden="true" tabindex="-1"></a>  <span class="at">DF =</span> <span class="fu">c</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Df"</span>]][<span class="dv">1</span>], anova_summary[[<span class="dv">1</span>]][[<span class="st">"Df"</span>]][<span class="dv">2</span>]),</span>
<span id="cb34-433"><a href="#cb34-433" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Sum Sq"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Sum Sq"</span>]][<span class="dv">2</span>], <span class="dv">2</span>)),</span>
<span id="cb34-434"><a href="#cb34-434" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Mean Sq</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Mean Sq"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Mean Sq"</span>]][<span class="dv">2</span>], <span class="dv">2</span>)),</span>
<span id="cb34-435"><a href="#cb34-435" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">F value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"F value"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="cn">NA</span>),</span>
<span id="cb34-436"><a href="#cb34-436" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Pr(&gt;F)"</span>]][<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">3</span>), <span class="cn">NA</span>)</span>
<span id="cb34-437"><a href="#cb34-437" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-438"><a href="#cb34-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-439"><a href="#cb34-439" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the ANOVA table</span></span>
<span id="cb34-440"><a href="#cb34-440" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(anova_df, </span>
<span id="cb34-441"><a href="#cb34-441" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"ANOVA Results: Wheat Yields by Continent"</span>,</span>
<span id="cb34-442"><a href="#cb34-442" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-443"><a href="#cb34-443" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-444"><a href="#cb34-444" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-445"><a href="#cb34-445" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-446"><a href="#cb34-446" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-447"><a href="#cb34-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-448"><a href="#cb34-448" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc test to identify which groups differ</span></span>
<span id="cb34-449"><a href="#cb34-449" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb34-450"><a href="#cb34-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-451"><a href="#cb34-451" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Tukey HSD results to a data frame</span></span>
<span id="cb34-452"><a href="#cb34-452" aria-hidden="true" tabindex="-1"></a>tukey_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tukey_result<span class="sc">$</span>Continent)</span>
<span id="cb34-453"><a href="#cb34-453" aria-hidden="true" tabindex="-1"></a>tukey_df<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">rownames</span>(tukey_df)</span>
<span id="cb34-454"><a href="#cb34-454" aria-hidden="true" tabindex="-1"></a>tukey_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(tukey_df, </span>
<span id="cb34-455"><a href="#cb34-455" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cols =</span> <span class="sc">-</span>comparison, </span>
<span id="cb34-456"><a href="#cb34-456" aria-hidden="true" tabindex="-1"></a>                           <span class="at">names_to =</span> <span class="st">"Continent2"</span>, </span>
<span id="cb34-457"><a href="#cb34-457" aria-hidden="true" tabindex="-1"></a>                           <span class="at">values_to =</span> <span class="st">"p_value"</span>)</span>
<span id="cb34-458"><a href="#cb34-458" aria-hidden="true" tabindex="-1"></a>tukey_long <span class="ot">&lt;-</span> tukey_long <span class="sc">%&gt;%</span></span>
<span id="cb34-459"><a href="#cb34-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value)) <span class="sc">%&gt;%</span></span>
<span id="cb34-460"><a href="#cb34-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-461"><a href="#cb34-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">Comparison =</span> <span class="fu">paste</span>(comparison, <span class="st">"vs"</span>, Continent2),</span>
<span id="cb34-462"><a href="#cb34-462" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p adj</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(p_value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-463"><a href="#cb34-463" aria-hidden="true" tabindex="-1"></a>    <span class="at">Significant =</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb34-464"><a href="#cb34-464" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-465"><a href="#cb34-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Comparison, <span class="st">`</span><span class="at">p adj</span><span class="st">`</span>, Significant)</span>
<span id="cb34-466"><a href="#cb34-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-467"><a href="#cb34-467" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the Tukey HSD results</span></span>
<span id="cb34-468"><a href="#cb34-468" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tukey_long, </span>
<span id="cb34-469"><a href="#cb34-469" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Tukey HSD Post-hoc Test Results: Pairwise Comparisons of Continents"</span>,</span>
<span id="cb34-470"><a href="#cb34-470" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb34-471"><a href="#cb34-471" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-472"><a href="#cb34-472" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-473"><a href="#cb34-473" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-474"><a href="#cb34-474" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-475"><a href="#cb34-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-476"><a href="#cb34-476" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary statistics table by continent</span></span>
<span id="cb34-477"><a href="#cb34-477" aria-hidden="true" tabindex="-1"></a>continent_summary <span class="ot">&lt;-</span> continental_yields <span class="sc">%&gt;%</span></span>
<span id="cb34-478"><a href="#cb34-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Continent) <span class="sc">%&gt;%</span></span>
<span id="cb34-479"><a href="#cb34-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb34-480"><a href="#cb34-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb34-481"><a href="#cb34-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-482"><a href="#cb34-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-483"><a href="#cb34-483" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">round</span>(<span class="fu">min</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb34-484"><a href="#cb34-484" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb34-485"><a href="#cb34-485" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-486"><a href="#cb34-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-487"><a href="#cb34-487" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics table</span></span>
<span id="cb34-488"><a href="#cb34-488" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(continent_summary, </span>
<span id="cb34-489"><a href="#cb34-489" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics: Wheat Yields by Continent"</span>,</span>
<span id="cb34-490"><a href="#cb34-490" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-491"><a href="#cb34-491" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-492"><a href="#cb34-492" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-493"><a href="#cb34-493" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-494"><a href="#cb34-494" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-495"><a href="#cb34-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-496"><a href="#cb34-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-497"><a href="#cb34-497" aria-hidden="true" tabindex="-1"></a><span class="fu">### Non-Parametric Alternatives</span></span>
<span id="cb34-498"><a href="#cb34-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-499"><a href="#cb34-499" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mann-Whitney U Test</span></span>
<span id="cb34-500"><a href="#cb34-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-501"><a href="#cb34-501" aria-hidden="true" tabindex="-1"></a>The Mann-Whitney U test (also called Wilcoxon rank-sum test) is a non-parametric alternative to the independent samples t-test:</span>
<span id="cb34-502"><a href="#cb34-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-505"><a href="#cb34-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-506"><a href="#cb34-506" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the same time period groups as before</span></span>
<span id="cb34-507"><a href="#cb34-507" aria-hidden="true" tabindex="-1"></a>wilcox_test <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> period, <span class="at">data =</span> crop_yields_grouped)</span>
<span id="cb34-508"><a href="#cb34-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-509"><a href="#cb34-509" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb34-510"><a href="#cb34-510" aria-hidden="true" tabindex="-1"></a>wilcox_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-511"><a href="#cb34-511" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"W-value"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb34-512"><a href="#cb34-512" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-513"><a href="#cb34-513" aria-hidden="true" tabindex="-1"></a>    wilcox_test<span class="sc">$</span>statistic,</span>
<span id="cb34-514"><a href="#cb34-514" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(wilcox_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-515"><a href="#cb34-515" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-516"><a href="#cb34-516" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-517"><a href="#cb34-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-518"><a href="#cb34-518" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb34-519"><a href="#cb34-519" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(wilcox_table, </span>
<span id="cb34-520"><a href="#cb34-520" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Mann-Whitney U Test Results: Wheat Yields by Time Period"</span>,</span>
<span id="cb34-521"><a href="#cb34-521" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-522"><a href="#cb34-522" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-523"><a href="#cb34-523" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-524"><a href="#cb34-524" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-525"><a href="#cb34-525" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-526"><a href="#cb34-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-527"><a href="#cb34-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-528"><a href="#cb34-528" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Kruskal-Wallis Test</span></span>
<span id="cb34-529"><a href="#cb34-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-530"><a href="#cb34-530" aria-hidden="true" tabindex="-1"></a>The Kruskal-Wallis test is a non-parametric alternative to ANOVA:</span>
<span id="cb34-531"><a href="#cb34-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-534"><a href="#cb34-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-535"><a href="#cb34-535" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the same continental data as before</span></span>
<span id="cb34-536"><a href="#cb34-536" aria-hidden="true" tabindex="-1"></a>kruskal_result <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> Continent, <span class="at">data =</span> continental_yields)</span>
<span id="cb34-537"><a href="#cb34-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-538"><a href="#cb34-538" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb34-539"><a href="#cb34-539" aria-hidden="true" tabindex="-1"></a>kruskal_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-540"><a href="#cb34-540" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb34-541"><a href="#cb34-541" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-542"><a href="#cb34-542" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(kruskal_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb34-543"><a href="#cb34-543" aria-hidden="true" tabindex="-1"></a>    kruskal_result<span class="sc">$</span>parameter,</span>
<span id="cb34-544"><a href="#cb34-544" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(kruskal_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-545"><a href="#cb34-545" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-546"><a href="#cb34-546" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-547"><a href="#cb34-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-548"><a href="#cb34-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb34-549"><a href="#cb34-549" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(kruskal_table, </span>
<span id="cb34-550"><a href="#cb34-550" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Kruskal-Wallis Test Results: Wheat Yields by Continent"</span>,</span>
<span id="cb34-551"><a href="#cb34-551" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-552"><a href="#cb34-552" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-553"><a href="#cb34-553" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-554"><a href="#cb34-554" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-555"><a href="#cb34-555" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-556"><a href="#cb34-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-557"><a href="#cb34-557" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc test for Kruskal-Wallis</span></span>
<span id="cb34-558"><a href="#cb34-558" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"dunn.test"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb34-559"><a href="#cb34-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dunn.test)</span>
<span id="cb34-560"><a href="#cb34-560" aria-hidden="true" tabindex="-1"></a>  dunn_result <span class="ot">&lt;-</span> <span class="fu">dunn.test</span>(continental_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, continental_yields<span class="sc">$</span>Continent, <span class="at">method =</span> <span class="st">"bonferroni"</span>, <span class="at">kw =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-561"><a href="#cb34-561" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-562"><a href="#cb34-562" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame from the dunn test results</span></span>
<span id="cb34-563"><a href="#cb34-563" aria-hidden="true" tabindex="-1"></a>  dunn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-564"><a href="#cb34-564" aria-hidden="true" tabindex="-1"></a>    <span class="at">Comparison =</span> dunn_result<span class="sc">$</span>comparisons,</span>
<span id="cb34-565"><a href="#cb34-565" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Z statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(dunn_result<span class="sc">$</span>Z, <span class="dv">2</span>),</span>
<span id="cb34-566"><a href="#cb34-566" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">P value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(dunn_result<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-567"><a href="#cb34-567" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Adjusted P</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(dunn_result<span class="sc">$</span>P.adjusted, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-568"><a href="#cb34-568" aria-hidden="true" tabindex="-1"></a>    <span class="at">Significant =</span> <span class="fu">ifelse</span>(dunn_result<span class="sc">$</span>P.adjusted <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb34-569"><a href="#cb34-569" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-570"><a href="#cb34-570" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-571"><a href="#cb34-571" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the formatted dunn test results</span></span>
<span id="cb34-572"><a href="#cb34-572" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(dunn_df, </span>
<span id="cb34-573"><a href="#cb34-573" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Dunn's Post-hoc Test Results: Pairwise Comparisons of Continents"</span>,</span>
<span id="cb34-574"><a href="#cb34-574" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb34-575"><a href="#cb34-575" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-576"><a href="#cb34-576" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-577"><a href="#cb34-577" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-578"><a href="#cb34-578" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-579"><a href="#cb34-579" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb34-580"><a href="#cb34-580" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Alternative: pairwise Wilcoxon tests</span></span>
<span id="cb34-581"><a href="#cb34-581" aria-hidden="true" tabindex="-1"></a>  pairwise_result <span class="ot">&lt;-</span> <span class="fu">pairwise.wilcox.test</span>(continental_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, continental_yields<span class="sc">$</span>Continent, </span>
<span id="cb34-582"><a href="#cb34-582" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb34-583"><a href="#cb34-583" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-584"><a href="#cb34-584" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert matrix to data frame</span></span>
<span id="cb34-585"><a href="#cb34-585" aria-hidden="true" tabindex="-1"></a>  pairwise_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pairwise_result<span class="sc">$</span>p.value)</span>
<span id="cb34-586"><a href="#cb34-586" aria-hidden="true" tabindex="-1"></a>  pairwise_df<span class="sc">$</span>Continent1 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(pairwise_df)</span>
<span id="cb34-587"><a href="#cb34-587" aria-hidden="true" tabindex="-1"></a>  pairwise_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(pairwise_df, </span>
<span id="cb34-588"><a href="#cb34-588" aria-hidden="true" tabindex="-1"></a>                               <span class="at">cols =</span> <span class="sc">-</span>Continent1, </span>
<span id="cb34-589"><a href="#cb34-589" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_to =</span> <span class="st">"Continent2"</span>, </span>
<span id="cb34-590"><a href="#cb34-590" aria-hidden="true" tabindex="-1"></a>                               <span class="at">values_to =</span> <span class="st">"p_value"</span>)</span>
<span id="cb34-591"><a href="#cb34-591" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-592"><a href="#cb34-592" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out NA values and format</span></span>
<span id="cb34-593"><a href="#cb34-593" aria-hidden="true" tabindex="-1"></a>  pairwise_long <span class="ot">&lt;-</span> pairwise_long <span class="sc">%&gt;%</span></span>
<span id="cb34-594"><a href="#cb34-594" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value)) <span class="sc">%&gt;%</span></span>
<span id="cb34-595"><a href="#cb34-595" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb34-596"><a href="#cb34-596" aria-hidden="true" tabindex="-1"></a>      <span class="at">Comparison =</span> <span class="fu">paste</span>(Continent1, <span class="st">"vs"</span>, Continent2),</span>
<span id="cb34-597"><a href="#cb34-597" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">P value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(p_value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-598"><a href="#cb34-598" aria-hidden="true" tabindex="-1"></a>      <span class="at">Significant =</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb34-599"><a href="#cb34-599" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb34-600"><a href="#cb34-600" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Comparison, <span class="st">`</span><span class="at">P value</span><span class="st">`</span>, Significant)</span>
<span id="cb34-601"><a href="#cb34-601" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-602"><a href="#cb34-602" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the formatted pairwise Wilcoxon test results</span></span>
<span id="cb34-603"><a href="#cb34-603" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(pairwise_long, </span>
<span id="cb34-604"><a href="#cb34-604" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Pairwise Wilcoxon Test Results with Bonferroni Correction"</span>,</span>
<span id="cb34-605"><a href="#cb34-605" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb34-606"><a href="#cb34-606" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-607"><a href="#cb34-607" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-608"><a href="#cb34-608" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-609"><a href="#cb34-609" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-610"><a href="#cb34-610" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-611"><a href="#cb34-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-612"><a href="#cb34-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-613"><a href="#cb34-613" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tests for Relationships</span></span>
<span id="cb34-614"><a href="#cb34-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-615"><a href="#cb34-615" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlation Analysis</span></span>
<span id="cb34-616"><a href="#cb34-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-617"><a href="#cb34-617" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pearson Correlation</span></span>
<span id="cb34-618"><a href="#cb34-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-619"><a href="#cb34-619" aria-hidden="true" tabindex="-1"></a>Pearson correlation measures the linear relationship between two continuous variables:</span>
<span id="cb34-620"><a href="#cb34-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-623"><a href="#cb34-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-624"><a href="#cb34-624" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine correlation between wheat and maize yields</span></span>
<span id="cb34-625"><a href="#cb34-625" aria-hidden="true" tabindex="-1"></a>crop_correlation <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb34-626"><a href="#cb34-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-627"><a href="#cb34-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb34-628"><a href="#cb34-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-629"><a href="#cb34-629" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the relationship</span></span>
<span id="cb34-630"><a href="#cb34-630" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_correlation, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb34-631"><a href="#cb34-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb34-632"><a href="#cb34-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb34-633"><a href="#cb34-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship Between Wheat and Maize Yields"</span>,</span>
<span id="cb34-634"><a href="#cb34-634" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span id="cb34-635"><a href="#cb34-635" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Maize Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb34-636"><a href="#cb34-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb34-637"><a href="#cb34-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-638"><a href="#cb34-638" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pearson correlation</span></span>
<span id="cb34-639"><a href="#cb34-639" aria-hidden="true" tabindex="-1"></a>cor_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb34-640"><a href="#cb34-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-641"><a href="#cb34-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb34-642"><a href="#cb34-642" aria-hidden="true" tabindex="-1"></a>cor_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-643"><a href="#cb34-643" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Correlation Coefficient (r)"</span>, <span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb34-644"><a href="#cb34-644" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-645"><a href="#cb34-645" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb34-646"><a href="#cb34-646" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb34-647"><a href="#cb34-647" aria-hidden="true" tabindex="-1"></a>    cor_result<span class="sc">$</span>parameter,</span>
<span id="cb34-648"><a href="#cb34-648" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(cor_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-649"><a href="#cb34-649" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb34-650"><a href="#cb34-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb34-651"><a href="#cb34-651" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-652"><a href="#cb34-652" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-653"><a href="#cb34-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-654"><a href="#cb34-654" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb34-655"><a href="#cb34-655" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cor_table, </span>
<span id="cb34-656"><a href="#cb34-656" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Pearson Correlation Results: Wheat and Maize Yields"</span>,</span>
<span id="cb34-657"><a href="#cb34-657" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-658"><a href="#cb34-658" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-659"><a href="#cb34-659" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-660"><a href="#cb34-660" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-661"><a href="#cb34-661" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-662"><a href="#cb34-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-663"><a href="#cb34-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-664"><a href="#cb34-664" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Spearman Correlation</span></span>
<span id="cb34-665"><a href="#cb34-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-666"><a href="#cb34-666" aria-hidden="true" tabindex="-1"></a>Spearman correlation is a non-parametric measure of rank correlation:</span>
<span id="cb34-667"><a href="#cb34-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-670"><a href="#cb34-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-671"><a href="#cb34-671" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Spearman correlation</span></span>
<span id="cb34-672"><a href="#cb34-672" aria-hidden="true" tabindex="-1"></a>spearman_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb34-673"><a href="#cb34-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-674"><a href="#cb34-674" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb34-675"><a href="#cb34-675" aria-hidden="true" tabindex="-1"></a>spearman_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-676"><a href="#cb34-676" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Correlation Coefficient (rho)"</span>, <span class="st">"S-value"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb34-677"><a href="#cb34-677" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-678"><a href="#cb34-678" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(spearman_result<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb34-679"><a href="#cb34-679" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(spearman_result<span class="sc">$</span>statistic, <span class="at">scientific =</span> <span class="cn">FALSE</span>),</span>
<span id="cb34-680"><a href="#cb34-680" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(spearman_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-681"><a href="#cb34-681" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-682"><a href="#cb34-682" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-683"><a href="#cb34-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-684"><a href="#cb34-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb34-685"><a href="#cb34-685" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(spearman_table, </span>
<span id="cb34-686"><a href="#cb34-686" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Spearman Correlation Results: Wheat and Maize Yields"</span>,</span>
<span id="cb34-687"><a href="#cb34-687" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-688"><a href="#cb34-688" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-689"><a href="#cb34-689" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-690"><a href="#cb34-690" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-691"><a href="#cb34-691" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-692"><a href="#cb34-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-693"><a href="#cb34-693" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a comparison table of correlation methods</span></span>
<span id="cb34-694"><a href="#cb34-694" aria-hidden="true" tabindex="-1"></a>correlation_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-695"><a href="#cb34-695" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Correlation Method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Pearson"</span>, <span class="st">"Spearman"</span>),</span>
<span id="cb34-696"><a href="#cb34-696" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Correlation Coefficient</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(cor_result<span class="sc">$</span>estimate, <span class="dv">3</span>), <span class="fu">round</span>(spearman_result<span class="sc">$</span>estimate, <span class="dv">3</span>)),</span>
<span id="cb34-697"><a href="#cb34-697" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(cor_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="fu">format.pval</span>(spearman_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb34-698"><a href="#cb34-698" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Interpretation</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb34-699"><a href="#cb34-699" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">abs</span>(cor_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="st">"Strong"</span>, <span class="fu">ifelse</span>(<span class="fu">abs</span>(cor_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="st">"Moderate"</span>, <span class="st">"Weak"</span>)),</span>
<span id="cb34-700"><a href="#cb34-700" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">abs</span>(spearman_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="st">"Strong"</span>, <span class="fu">ifelse</span>(<span class="fu">abs</span>(spearman_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="st">"Moderate"</span>, <span class="st">"Weak"</span>))</span>
<span id="cb34-701"><a href="#cb34-701" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-702"><a href="#cb34-702" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-703"><a href="#cb34-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-704"><a href="#cb34-704" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the comparison table</span></span>
<span id="cb34-705"><a href="#cb34-705" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(correlation_comparison, </span>
<span id="cb34-706"><a href="#cb34-706" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Comparison of Correlation Methods"</span>,</span>
<span id="cb34-707"><a href="#cb34-707" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb34-708"><a href="#cb34-708" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-709"><a href="#cb34-709" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-710"><a href="#cb34-710" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-711"><a href="#cb34-711" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-712"><a href="#cb34-712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-713"><a href="#cb34-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-714"><a href="#cb34-714" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression Analysis</span></span>
<span id="cb34-715"><a href="#cb34-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-716"><a href="#cb34-716" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Linear Regression</span></span>
<span id="cb34-717"><a href="#cb34-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-718"><a href="#cb34-718" aria-hidden="true" tabindex="-1"></a>Linear regression models the relationship between a dependent variable and one or more independent variables:</span>
<span id="cb34-719"><a href="#cb34-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-722"><a href="#cb34-722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-723"><a href="#cb34-723" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataset with year as predictor for wheat yields</span></span>
<span id="cb34-724"><a href="#cb34-724" aria-hidden="true" tabindex="-1"></a>time_series_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb34-725"><a href="#cb34-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Entity <span class="sc">==</span> <span class="st">"United States"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-726"><a href="#cb34-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year)</span>
<span id="cb34-727"><a href="#cb34-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-728"><a href="#cb34-728" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the trend</span></span>
<span id="cb34-729"><a href="#cb34-729" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(time_series_data, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb34-730"><a href="#cb34-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-731"><a href="#cb34-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb34-732"><a href="#cb34-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yield Trends in the United States"</span>,</span>
<span id="cb34-733"><a href="#cb34-733" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb34-734"><a href="#cb34-734" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb34-735"><a href="#cb34-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb34-736"><a href="#cb34-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-737"><a href="#cb34-737" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb34-738"><a href="#cb34-738" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> Year, <span class="at">data =</span> time_series_data)</span>
<span id="cb34-739"><a href="#cb34-739" aria-hidden="true" tabindex="-1"></a>lm_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_model)</span>
<span id="cb34-740"><a href="#cb34-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-741"><a href="#cb34-741" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the regression coefficients</span></span>
<span id="cb34-742"><a href="#cb34-742" aria-hidden="true" tabindex="-1"></a>coef_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-743"><a href="#cb34-743" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"Year"</span>),</span>
<span id="cb34-744"><a href="#cb34-744" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>], <span class="dv">3</span>), <span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>], <span class="dv">3</span>)),</span>
<span id="cb34-745"><a href="#cb34-745" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Std. Error</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dv">3</span>), <span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dv">3</span>)),</span>
<span id="cb34-746"><a href="#cb34-746" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">t value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">3</span>], <span class="dv">2</span>), <span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">3</span>], <span class="dv">2</span>)),</span>
<span id="cb34-747"><a href="#cb34-747" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Pr(&gt;|t|)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">4</span>], <span class="at">digits =</span> <span class="dv">3</span>), <span class="fu">format.pval</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">4</span>], <span class="at">digits =</span> <span class="dv">3</span>))</span>
<span id="cb34-748"><a href="#cb34-748" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-749"><a href="#cb34-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-750"><a href="#cb34-750" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the coefficients table</span></span>
<span id="cb34-751"><a href="#cb34-751" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(coef_table, </span>
<span id="cb34-752"><a href="#cb34-752" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Linear Regression Coefficients: Wheat Yield by Year"</span>,</span>
<span id="cb34-753"><a href="#cb34-753" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-754"><a href="#cb34-754" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-755"><a href="#cb34-755" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-756"><a href="#cb34-756" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-757"><a href="#cb34-757" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-758"><a href="#cb34-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-759"><a href="#cb34-759" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the model summary statistics</span></span>
<span id="cb34-760"><a href="#cb34-760" aria-hidden="true" tabindex="-1"></a>model_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-761"><a href="#cb34-761" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"R-squared"</span>, <span class="st">"Adjusted R-squared"</span>, <span class="st">"F-statistic"</span>, <span class="st">"DF"</span>, <span class="st">"p-value"</span>, <span class="st">"Residual Standard Error"</span>),</span>
<span id="cb34-762"><a href="#cb34-762" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-763"><a href="#cb34-763" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>r.squared, <span class="dv">3</span>),</span>
<span id="cb34-764"><a href="#cb34-764" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>),</span>
<span id="cb34-765"><a href="#cb34-765" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb34-766"><a href="#cb34-766" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(lm_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], <span class="st">","</span>, lm_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>]),</span>
<span id="cb34-767"><a href="#cb34-767" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(<span class="fu">pf</span>(lm_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], lm_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], lm_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>), <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-768"><a href="#cb34-768" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>sigma, <span class="dv">3</span>)</span>
<span id="cb34-769"><a href="#cb34-769" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-770"><a href="#cb34-770" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-771"><a href="#cb34-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-772"><a href="#cb34-772" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the model summary statistics table</span></span>
<span id="cb34-773"><a href="#cb34-773" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(model_stats, </span>
<span id="cb34-774"><a href="#cb34-774" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Linear Regression Model Summary Statistics"</span>,</span>
<span id="cb34-775"><a href="#cb34-775" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-776"><a href="#cb34-776" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-777"><a href="#cb34-777" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-778"><a href="#cb34-778" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-779"><a href="#cb34-779" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-780"><a href="#cb34-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-781"><a href="#cb34-781" aria-hidden="true" tabindex="-1"></a><span class="co"># Check assumptions</span></span>
<span id="cb34-782"><a href="#cb34-782" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb34-783"><a href="#cb34-783" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_model)</span>
<span id="cb34-784"><a href="#cb34-784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-785"><a href="#cb34-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-786"><a href="#cb34-786" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Multiple Regression</span></span>
<span id="cb34-787"><a href="#cb34-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-788"><a href="#cb34-788" aria-hidden="true" tabindex="-1"></a>Multiple regression includes more than one predictor variable:</span>
<span id="cb34-789"><a href="#cb34-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-792"><a href="#cb34-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-793"><a href="#cb34-793" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataset with multiple predictors</span></span>
<span id="cb34-794"><a href="#cb34-794" aria-hidden="true" tabindex="-1"></a>multi_crop_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb34-795"><a href="#cb34-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-796"><a href="#cb34-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb34-797"><a href="#cb34-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-798"><a href="#cb34-798" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform multiple regression</span></span>
<span id="cb34-799"><a href="#cb34-799" aria-hidden="true" tabindex="-1"></a>multi_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span> <span class="sc">+</span> Year, <span class="at">data =</span> multi_crop_data)</span>
<span id="cb34-800"><a href="#cb34-800" aria-hidden="true" tabindex="-1"></a>multi_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(multi_model)</span>
<span id="cb34-801"><a href="#cb34-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-802"><a href="#cb34-802" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the regression coefficients</span></span>
<span id="cb34-803"><a href="#cb34-803" aria-hidden="true" tabindex="-1"></a>multi_coef_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-804"><a href="#cb34-804" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"Rice (tonnes per hectare)"</span>, <span class="st">"Maize (tonnes per hectare)"</span>, <span class="st">"Year"</span>),</span>
<span id="cb34-805"><a href="#cb34-805" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">round</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb34-806"><a href="#cb34-806" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Std. Error</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb34-807"><a href="#cb34-807" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">t value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">3</span>], <span class="dv">2</span>),</span>
<span id="cb34-808"><a href="#cb34-808" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Pr(&gt;|t|)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>], <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-809"><a href="#cb34-809" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significance =</span> <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"***"</span>, </span>
<span id="cb34-810"><a href="#cb34-810" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="st">"**"</span>, </span>
<span id="cb34-811"><a href="#cb34-811" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>, </span>
<span id="cb34-812"><a href="#cb34-812" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.1</span>, <span class="st">"."</span>, <span class="st">""</span>))))</span>
<span id="cb34-813"><a href="#cb34-813" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-814"><a href="#cb34-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-815"><a href="#cb34-815" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the coefficients table</span></span>
<span id="cb34-816"><a href="#cb34-816" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(multi_coef_table, </span>
<span id="cb34-817"><a href="#cb34-817" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Multiple Regression Coefficients: Predicting Wheat Yield"</span>,</span>
<span id="cb34-818"><a href="#cb34-818" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"c"</span>),</span>
<span id="cb34-819"><a href="#cb34-819" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-820"><a href="#cb34-820" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-821"><a href="#cb34-821" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-822"><a href="#cb34-822" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-823"><a href="#cb34-823" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_footnote</span>(<span class="st">"Significance codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"</span>, <span class="at">notation =</span> <span class="st">"none"</span>)</span>
<span id="cb34-824"><a href="#cb34-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-825"><a href="#cb34-825" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the model summary statistics</span></span>
<span id="cb34-826"><a href="#cb34-826" aria-hidden="true" tabindex="-1"></a>multi_model_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-827"><a href="#cb34-827" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"R-squared"</span>, <span class="st">"Adjusted R-squared"</span>, <span class="st">"F-statistic"</span>, <span class="st">"DF"</span>, <span class="st">"p-value"</span>, <span class="st">"Residual Standard Error"</span>),</span>
<span id="cb34-828"><a href="#cb34-828" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-829"><a href="#cb34-829" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>r.squared, <span class="dv">3</span>),</span>
<span id="cb34-830"><a href="#cb34-830" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>),</span>
<span id="cb34-831"><a href="#cb34-831" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb34-832"><a href="#cb34-832" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(multi_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], <span class="st">","</span>, multi_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>]),</span>
<span id="cb34-833"><a href="#cb34-833" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(<span class="fu">pf</span>(multi_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], multi_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], multi_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>), <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb34-834"><a href="#cb34-834" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>sigma, <span class="dv">3</span>)</span>
<span id="cb34-835"><a href="#cb34-835" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-836"><a href="#cb34-836" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-837"><a href="#cb34-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-838"><a href="#cb34-838" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the model summary statistics table</span></span>
<span id="cb34-839"><a href="#cb34-839" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(multi_model_stats, </span>
<span id="cb34-840"><a href="#cb34-840" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Multiple Regression Model Summary Statistics"</span>,</span>
<span id="cb34-841"><a href="#cb34-841" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-842"><a href="#cb34-842" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-843"><a href="#cb34-843" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-844"><a href="#cb34-844" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-845"><a href="#cb34-845" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-846"><a href="#cb34-846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-847"><a href="#cb34-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-848"><a href="#cb34-848" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tests for Categorical Data</span></span>
<span id="cb34-849"><a href="#cb34-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-850"><a href="#cb34-850" aria-hidden="true" tabindex="-1"></a><span class="fu">### Chi-Square Test</span></span>
<span id="cb34-851"><a href="#cb34-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-852"><a href="#cb34-852" aria-hidden="true" tabindex="-1"></a>The Chi-Square test examines the association between categorical variables. Let's use our biodiversity dataset:</span>
<span id="cb34-853"><a href="#cb34-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-856"><a href="#cb34-856" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-857"><a href="#cb34-857" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the biodiversity dataset</span></span>
<span id="cb34-858"><a href="#cb34-858" aria-hidden="true" tabindex="-1"></a>plants <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/ecology/biodiversity.csv"</span>)</span>
<span id="cb34-859"><a href="#cb34-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-860"><a href="#cb34-860" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a contingency table of red list categories by plant group</span></span>
<span id="cb34-861"><a href="#cb34-861" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">"red_list_category"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(plants) <span class="sc">&amp;</span> <span class="st">"group"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(plants)) {</span>
<span id="cb34-862"><a href="#cb34-862" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a contingency table</span></span>
<span id="cb34-863"><a href="#cb34-863" aria-hidden="true" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(plants<span class="sc">$</span>red_list_category, plants<span class="sc">$</span>group)</span>
<span id="cb34-864"><a href="#cb34-864" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-865"><a href="#cb34-865" aria-hidden="true" tabindex="-1"></a>  <span class="co"># View the table</span></span>
<span id="cb34-866"><a href="#cb34-866" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(contingency_table, </span>
<span id="cb34-867"><a href="#cb34-867" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Contingency Table: Red List Categories by Plant Group"</span>,</span>
<span id="cb34-868"><a href="#cb34-868" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb34-869"><a href="#cb34-869" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-870"><a href="#cb34-870" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-871"><a href="#cb34-871" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-872"><a href="#cb34-872" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-873"><a href="#cb34-873" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-874"><a href="#cb34-874" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform Chi-Square test</span></span>
<span id="cb34-875"><a href="#cb34-875" aria-hidden="true" tabindex="-1"></a>  chi_sq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span>
<span id="cb34-876"><a href="#cb34-876" aria-hidden="true" tabindex="-1"></a>  chi_sq_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-877"><a href="#cb34-877" aria-hidden="true" tabindex="-1"></a>    <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb34-878"><a href="#cb34-878" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-879"><a href="#cb34-879" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(chi_sq_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb34-880"><a href="#cb34-880" aria-hidden="true" tabindex="-1"></a>      chi_sq_result<span class="sc">$</span>parameter,</span>
<span id="cb34-881"><a href="#cb34-881" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format.pval</span>(chi_sq_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-882"><a href="#cb34-882" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-883"><a href="#cb34-883" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-884"><a href="#cb34-884" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-885"><a href="#cb34-885" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the Chi-Square test results</span></span>
<span id="cb34-886"><a href="#cb34-886" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(chi_sq_table, </span>
<span id="cb34-887"><a href="#cb34-887" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Chi-Square Test Results: Association Between Red List Categories and Plant Groups"</span>,</span>
<span id="cb34-888"><a href="#cb34-888" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-889"><a href="#cb34-889" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-890"><a href="#cb34-890" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-891"><a href="#cb34-891" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-892"><a href="#cb34-892" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-893"><a href="#cb34-893" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-894"><a href="#cb34-894" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Examine residuals to understand the pattern of association</span></span>
<span id="cb34-895"><a href="#cb34-895" aria-hidden="true" tabindex="-1"></a>  chi_sq_residuals <span class="ot">&lt;-</span> chi_sq_result<span class="sc">$</span>residuals</span>
<span id="cb34-896"><a href="#cb34-896" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-897"><a href="#cb34-897" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the residuals in a more suitable format for display</span></span>
<span id="cb34-898"><a href="#cb34-898" aria-hidden="true" tabindex="-1"></a>  residuals_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(chi_sq_residuals)</span>
<span id="cb34-899"><a href="#cb34-899" aria-hidden="true" tabindex="-1"></a>  residuals_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame.table</span>(residuals_matrix)</span>
<span id="cb34-900"><a href="#cb34-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(residuals_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Category"</span>, <span class="st">"Group"</span>, <span class="st">"Residual"</span>)</span>
<span id="cb34-901"><a href="#cb34-901" aria-hidden="true" tabindex="-1"></a>  residuals_df<span class="sc">$</span>Residual <span class="ot">&lt;-</span> <span class="fu">round</span>(residuals_df<span class="sc">$</span>Residual, <span class="dv">2</span>)</span>
<span id="cb34-902"><a href="#cb34-902" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-903"><a href="#cb34-903" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the residuals table</span></span>
<span id="cb34-904"><a href="#cb34-904" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(residuals_df,</span>
<span id="cb34-905"><a href="#cb34-905" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Standardized Residuals: Association Between Red List Categories and Plant Groups"</span>,</span>
<span id="cb34-906"><a href="#cb34-906" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-907"><a href="#cb34-907" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-908"><a href="#cb34-908" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb34-909"><a href="#cb34-909" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-910"><a href="#cb34-910" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-911"><a href="#cb34-911" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb34-912"><a href="#cb34-912" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the expected columns don't exist, create a demonstration with available data</span></span>
<span id="cb34-913"><a href="#cb34-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Required columns not found. Creating a demonstration with available columns."</span>)</span>
<span id="cb34-914"><a href="#cb34-914" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-915"><a href="#cb34-915" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify categorical columns</span></span>
<span id="cb34-916"><a href="#cb34-916" aria-hidden="true" tabindex="-1"></a>  categorical_cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(plants, <span class="cf">function</span>(x) <span class="fu">is.character</span>(x) <span class="sc">||</span> <span class="fu">is.factor</span>(x))</span>
<span id="cb34-917"><a href="#cb34-917" aria-hidden="true" tabindex="-1"></a>  cat_col_names <span class="ot">&lt;-</span> <span class="fu">names</span>(plants)[categorical_cols]</span>
<span id="cb34-918"><a href="#cb34-918" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-919"><a href="#cb34-919" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(cat_col_names) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb34-920"><a href="#cb34-920" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select the first two categorical columns</span></span>
<span id="cb34-921"><a href="#cb34-921" aria-hidden="true" tabindex="-1"></a>    col1 <span class="ot">&lt;-</span> cat_col_names[<span class="dv">1</span>]</span>
<span id="cb34-922"><a href="#cb34-922" aria-hidden="true" tabindex="-1"></a>    col2 <span class="ot">&lt;-</span> cat_col_names[<span class="dv">2</span>]</span>
<span id="cb34-923"><a href="#cb34-923" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-924"><a href="#cb34-924" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a contingency table</span></span>
<span id="cb34-925"><a href="#cb34-925" aria-hidden="true" tabindex="-1"></a>    contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(plants[[col1]], plants[[col2]])</span>
<span id="cb34-926"><a href="#cb34-926" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-927"><a href="#cb34-927" aria-hidden="true" tabindex="-1"></a>    <span class="co"># View the table</span></span>
<span id="cb34-928"><a href="#cb34-928" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(contingency_table, </span>
<span id="cb34-929"><a href="#cb34-929" aria-hidden="true" tabindex="-1"></a>                 <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Contingency Table:"</span>, col1, <span class="st">"by"</span>, col2),</span>
<span id="cb34-930"><a href="#cb34-930" aria-hidden="true" tabindex="-1"></a>                 <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb34-931"><a href="#cb34-931" aria-hidden="true" tabindex="-1"></a>                 <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-932"><a href="#cb34-932" aria-hidden="true" tabindex="-1"></a>      kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-933"><a href="#cb34-933" aria-hidden="true" tabindex="-1"></a>                               <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-934"><a href="#cb34-934" aria-hidden="true" tabindex="-1"></a>                               <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-935"><a href="#cb34-935" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-936"><a href="#cb34-936" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform Chi-Square test if appropriate</span></span>
<span id="cb34-937"><a href="#cb34-937" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">min</span>(<span class="fu">dim</span>(contingency_table)) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(contingency_table) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb34-938"><a href="#cb34-938" aria-hidden="true" tabindex="-1"></a>      chi_sq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-939"><a href="#cb34-939" aria-hidden="true" tabindex="-1"></a>      chi_sq_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-940"><a href="#cb34-940" aria-hidden="true" tabindex="-1"></a>        <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb34-941"><a href="#cb34-941" aria-hidden="true" tabindex="-1"></a>        <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-942"><a href="#cb34-942" aria-hidden="true" tabindex="-1"></a>          <span class="fu">round</span>(chi_sq_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb34-943"><a href="#cb34-943" aria-hidden="true" tabindex="-1"></a>          chi_sq_result<span class="sc">$</span>parameter,</span>
<span id="cb34-944"><a href="#cb34-944" aria-hidden="true" tabindex="-1"></a>          <span class="fu">format.pval</span>(chi_sq_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-945"><a href="#cb34-945" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb34-946"><a href="#cb34-946" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-947"><a href="#cb34-947" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-948"><a href="#cb34-948" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Display the Chi-Square test results</span></span>
<span id="cb34-949"><a href="#cb34-949" aria-hidden="true" tabindex="-1"></a>      knitr<span class="sc">::</span><span class="fu">kable</span>(chi_sq_table, </span>
<span id="cb34-950"><a href="#cb34-950" aria-hidden="true" tabindex="-1"></a>                   <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Chi-Square Test Results: Association Between"</span>, col1, <span class="st">"and"</span>, col2),</span>
<span id="cb34-951"><a href="#cb34-951" aria-hidden="true" tabindex="-1"></a>                   <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-952"><a href="#cb34-952" aria-hidden="true" tabindex="-1"></a>                   <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-953"><a href="#cb34-953" aria-hidden="true" tabindex="-1"></a>        kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-954"><a href="#cb34-954" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-955"><a href="#cb34-955" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-956"><a href="#cb34-956" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb34-957"><a href="#cb34-957" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">"Contingency table not suitable for Chi-Square test."</span>)</span>
<span id="cb34-958"><a href="#cb34-958" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-959"><a href="#cb34-959" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb34-960"><a href="#cb34-960" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Not enough categorical columns found for Chi-Square test demonstration."</span>)</span>
<span id="cb34-961"><a href="#cb34-961" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-962"><a href="#cb34-962" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-963"><a href="#cb34-963" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-964"><a href="#cb34-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-965"><a href="#cb34-965" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tests for Trends and Time Series</span></span>
<span id="cb34-966"><a href="#cb34-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-967"><a href="#cb34-967" aria-hidden="true" tabindex="-1"></a><span class="fu">### Time Series Analysis</span></span>
<span id="cb34-968"><a href="#cb34-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-969"><a href="#cb34-969" aria-hidden="true" tabindex="-1"></a>Time series analysis examines data collected over time to identify patterns, trends, and seasonal effects:</span>
<span id="cb34-970"><a href="#cb34-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-973"><a href="#cb34-973" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-974"><a href="#cb34-974" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a time series of wheat yields for a specific country</span></span>
<span id="cb34-975"><a href="#cb34-975" aria-hidden="true" tabindex="-1"></a>us_wheat <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb34-976"><a href="#cb34-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Entity <span class="sc">==</span> <span class="st">"United States"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-977"><a href="#cb34-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year)</span>
<span id="cb34-978"><a href="#cb34-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-979"><a href="#cb34-979" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to time series object</span></span>
<span id="cb34-980"><a href="#cb34-980" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"zoo"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb34-981"><a href="#cb34-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(zoo)</span>
<span id="cb34-982"><a href="#cb34-982" aria-hidden="true" tabindex="-1"></a>  wheat_ts <span class="ot">&lt;-</span> <span class="fu">zoo</span>(us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, us_wheat<span class="sc">$</span>Year)</span>
<span id="cb34-983"><a href="#cb34-983" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-984"><a href="#cb34-984" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the time series</span></span>
<span id="cb34-985"><a href="#cb34-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(wheat_ts, <span class="at">main =</span> <span class="st">"US Wheat Yields Over Time"</span>,</span>
<span id="cb34-986"><a href="#cb34-986" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>)</span>
<span id="cb34-987"><a href="#cb34-987" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-988"><a href="#cb34-988" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add trend line</span></span>
<span id="cb34-989"><a href="#cb34-989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(us_wheat<span class="sc">$</span>Year, us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb34-990"><a href="#cb34-990" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb34-991"><a href="#cb34-991" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Basic plot if zoo package is not available</span></span>
<span id="cb34-992"><a href="#cb34-992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(us_wheat<span class="sc">$</span>Year, us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb34-993"><a href="#cb34-993" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">"US Wheat Yields Over Time"</span>,</span>
<span id="cb34-994"><a href="#cb34-994" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>)</span>
<span id="cb34-995"><a href="#cb34-995" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-996"><a href="#cb34-996" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add trend line</span></span>
<span id="cb34-997"><a href="#cb34-997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(us_wheat<span class="sc">$</span>Year, us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb34-998"><a href="#cb34-998" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-999"><a href="#cb34-999" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1000"><a href="#cb34-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1001"><a href="#cb34-1001" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mann-Kendall Trend Test</span></span>
<span id="cb34-1002"><a href="#cb34-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1003"><a href="#cb34-1003" aria-hidden="true" tabindex="-1"></a>The Mann-Kendall test is a non-parametric test for identifying trends in time series data:</span>
<span id="cb34-1004"><a href="#cb34-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1007"><a href="#cb34-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-1008"><a href="#cb34-1008" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Mann-Kendall trend test</span></span>
<span id="cb34-1009"><a href="#cb34-1009" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"Kendall"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb34-1010"><a href="#cb34-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(Kendall)</span>
<span id="cb34-1011"><a href="#cb34-1011" aria-hidden="true" tabindex="-1"></a>  mk_test <span class="ot">&lt;-</span> Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb34-1012"><a href="#cb34-1012" aria-hidden="true" tabindex="-1"></a>  mk_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-1013"><a href="#cb34-1013" aria-hidden="true" tabindex="-1"></a>    <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Tau"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb34-1014"><a href="#cb34-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb34-1015"><a href="#cb34-1015" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(mk_test<span class="sc">$</span>tau, <span class="dv">3</span>),</span>
<span id="cb34-1016"><a href="#cb34-1016" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format.pval</span>(mk_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb34-1017"><a href="#cb34-1017" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-1018"><a href="#cb34-1018" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-1019"><a href="#cb34-1019" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-1020"><a href="#cb34-1020" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the Mann-Kendall test results</span></span>
<span id="cb34-1021"><a href="#cb34-1021" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(mk_table, </span>
<span id="cb34-1022"><a href="#cb34-1022" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Mann-Kendall Trend Test Results: US Wheat Yields"</span>,</span>
<span id="cb34-1023"><a href="#cb34-1023" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb34-1024"><a href="#cb34-1024" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-1025"><a href="#cb34-1025" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb34-1026"><a href="#cb34-1026" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-1027"><a href="#cb34-1027" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb34-1028"><a href="#cb34-1028" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb34-1029"><a href="#cb34-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"The Kendall package is not installed. Install it with install.packages('Kendall') to run the Mann-Kendall trend test."</span>)</span>
<span id="cb34-1030"><a href="#cb34-1030" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1031"><a href="#cb34-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1032"><a href="#cb34-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1033"><a href="#cb34-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb34-1034"><a href="#cb34-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1035"><a href="#cb34-1035" aria-hidden="true" tabindex="-1"></a>This chapter has demonstrated a variety of statistical tests using real agricultural and biodiversity datasets. We've covered:</span>
<span id="cb34-1036"><a href="#cb34-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1037"><a href="#cb34-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Tests for comparing groups**:</span>
<span id="cb34-1038"><a href="#cb34-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>t-tests for comparing two groups</span>
<span id="cb34-1039"><a href="#cb34-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>ANOVA for comparing multiple groups</span>
<span id="cb34-1040"><a href="#cb34-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Non-parametric alternatives when data doesn't meet parametric assumptions</span>
<span id="cb34-1041"><a href="#cb34-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1042"><a href="#cb34-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Tests for relationships**:</span>
<span id="cb34-1043"><a href="#cb34-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Correlation analysis to measure the strength of relationships</span>
<span id="cb34-1044"><a href="#cb34-1044" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Regression analysis to model relationships between variables</span>
<span id="cb34-1045"><a href="#cb34-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1046"><a href="#cb34-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Tests for categorical data**:</span>
<span id="cb34-1047"><a href="#cb34-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Chi-Square test for examining associations between categorical variables</span>
<span id="cb34-1048"><a href="#cb34-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1049"><a href="#cb34-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Tests for time series data**:</span>
<span id="cb34-1050"><a href="#cb34-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Time series analysis for identifying patterns over time</span>
<span id="cb34-1051"><a href="#cb34-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Mann-Kendall test for detecting trends</span>
<span id="cb34-1052"><a href="#cb34-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1053"><a href="#cb34-1053" aria-hidden="true" tabindex="-1"></a>When conducting statistical tests, remember to:</span>
<span id="cb34-1054"><a href="#cb34-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Clearly define your research question</span>
<span id="cb34-1055"><a href="#cb34-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check if your data meets the assumptions of the test</span>
<span id="cb34-1056"><a href="#cb34-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Choose the appropriate test based on your data type and research question</span>
<span id="cb34-1057"><a href="#cb34-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret results in the context of your research question</span>
<span id="cb34-1058"><a href="#cb34-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Consider the practical significance, not just statistical significance</span>
<span id="cb34-1059"><a href="#cb34-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1060"><a href="#cb34-1060" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb34-1061"><a href="#cb34-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1062"><a href="#cb34-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Using the crop yield dataset, compare maize yields between continents using both ANOVA and the Kruskal-Wallis test. Which is more appropriate and why?</span>
<span id="cb34-1063"><a href="#cb34-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1064"><a href="#cb34-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Examine the relationship between potato and rice yields using correlation analysis. Calculate both Pearson and Spearman correlations and explain which is more appropriate.</span>
<span id="cb34-1065"><a href="#cb34-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1066"><a href="#cb34-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Using the biodiversity dataset, investigate whether there's an association between conservation status and another categorical variable of your choice.</span>
<span id="cb34-1067"><a href="#cb34-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1068"><a href="#cb34-1068" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Perform a time series analysis of wheat yields for China and compare the trend with that of the United States.</span>
<span id="cb34-1069"><a href="#cb34-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1070"><a href="#cb34-1070" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Using the animal dataset (<span class="in">`../data/entomology/insects.csv`</span>), compare two groups using an appropriate statistical test.</span>
<span id="cb34-1071"><a href="#cb34-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1072"><a href="#cb34-1072" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Create a multiple regression model to predict coffee quality scores using the coffee economics dataset (<span class="in">`../data/economics/economic.csv`</span>).</span>
<span id="cb34-1073"><a href="#cb34-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1074"><a href="#cb34-1074" aria-hidden="true" tabindex="-1"></a><span class="fu">## Enhanced Statistical Tests Chapter</span></span>
<span id="cb34-1075"><a href="#cb34-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1076"><a href="#cb34-1076" aria-hidden="true" tabindex="-1"></a>The enhanced visualizations and tables for this chapter are available in a separate file to ensure compatibility with the book rendering process.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>