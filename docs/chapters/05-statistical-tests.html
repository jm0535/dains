<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>5&nbsp; Common Statistical Tests – Data Analysis in Natural Sciences</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/06-visualization.html" rel="next">
<link href="../chapters/04-hypothesis-testing.html" rel="prev">
<link href="../images/Rlogo.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-56b67755cebbfb78539c873898544994.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-f0bc7793ffdd46ddf3b99218c6954345.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dark-5cb9b089ed55fbb2d9030d6bb4f5b5f8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-5cb9b089ed55fbb2d9030d6bb4f5b5f8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<meta name="description" content="A comprehensive guide to data analysis in natural sciences using R. Learn statistical methods, data visualization, and reproducible research practices.">
<meta name="keywords" content="R programming, data analysis, statistics, ecology, natural sciences, ggplot2, tidyverse, data visualization">
<meta name="author" content="Jimmy Moses">
<link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/Rlogo.jpg" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DAINS</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-wide tools-end">
    <a href="https://github.com/jm0535/dains" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html">Part II: Data Analysis Fundamentals</a></li><li class="breadcrumb-item"><a href="../chapters/05-statistical-tests.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-data-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Basics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: Data Analysis Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-exploratory-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-statistical-tests.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-advanced-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Advanced Data Visualization</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: Statistical Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-advanced-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Advanced Modeling Techniques</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V: Applied Ecology</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-conservation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Conservation Applications</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">5.1</span> Introduction</a></li>
  <li>
<a href="#choosing-the-right-statistical-test" id="toc-choosing-the-right-statistical-test" class="nav-link" data-scroll-target="#choosing-the-right-statistical-test"><span class="header-section-number">5.2</span> Choosing the Right Statistical Test</a>
  <ul class="collapse">
<li><a href="#decision-tree-for-common-tests" id="toc-decision-tree-for-common-tests" class="nav-link" data-scroll-target="#decision-tree-for-common-tests"><span class="header-section-number">5.2.1</span> Decision Tree for Common Tests</a></li>
  </ul>
</li>
  <li>
<a href="#parametric-vs.-non-parametric-tests" id="toc-parametric-vs.-non-parametric-tests" class="nav-link" data-scroll-target="#parametric-vs.-non-parametric-tests"><span class="header-section-number">5.3</span> Parametric vs.&nbsp;Non-Parametric Tests</a>
  <ul class="collapse">
<li><a href="#parametric-tests" id="toc-parametric-tests" class="nav-link" data-scroll-target="#parametric-tests"><span class="header-section-number">5.3.1</span> Parametric Tests</a></li>
  <li><a href="#non-parametric-tests" id="toc-non-parametric-tests" class="nav-link" data-scroll-target="#non-parametric-tests"><span class="header-section-number">5.3.2</span> Non-Parametric Tests</a></li>
  <li><a href="#checking-assumptions" id="toc-checking-assumptions" class="nav-link" data-scroll-target="#checking-assumptions"><span class="header-section-number">5.3.3</span> Checking Assumptions</a></li>
  </ul>
</li>
  <li>
<a href="#tests-for-comparing-groups" id="toc-tests-for-comparing-groups" class="nav-link" data-scroll-target="#tests-for-comparing-groups"><span class="header-section-number">5.4</span> Tests for Comparing Groups</a>
  <ul class="collapse">
<li><a href="#t-tests" id="toc-t-tests" class="nav-link" data-scroll-target="#t-tests"><span class="header-section-number">5.4.1</span> t-Tests</a></li>
  <li><a href="#analysis-of-variance-anova" id="toc-analysis-of-variance-anova" class="nav-link" data-scroll-target="#analysis-of-variance-anova"><span class="header-section-number">5.4.2</span> Analysis of Variance (ANOVA)</a></li>
  <li><a href="#non-parametric-alternatives" id="toc-non-parametric-alternatives" class="nav-link" data-scroll-target="#non-parametric-alternatives"><span class="header-section-number">5.4.3</span> Non-Parametric Alternatives</a></li>
  </ul>
</li>
  <li>
<a href="#tests-for-relationships" id="toc-tests-for-relationships" class="nav-link" data-scroll-target="#tests-for-relationships"><span class="header-section-number">5.5</span> Tests for Relationships</a>
  <ul class="collapse">
<li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis"><span class="header-section-number">5.5.1</span> Correlation Analysis</a></li>
  <li><a href="#regression-analysis" id="toc-regression-analysis" class="nav-link" data-scroll-target="#regression-analysis"><span class="header-section-number">5.5.2</span> Regression Analysis</a></li>
  </ul>
</li>
  <li>
<a href="#tests-for-categorical-data" id="toc-tests-for-categorical-data" class="nav-link" data-scroll-target="#tests-for-categorical-data"><span class="header-section-number">5.6</span> Tests for Categorical Data</a>
  <ul class="collapse">
<li><a href="#chi-square-test" id="toc-chi-square-test" class="nav-link" data-scroll-target="#chi-square-test"><span class="header-section-number">5.6.1</span> Chi-Square Test</a></li>
  </ul>
</li>
  <li>
<a href="#tests-for-trends-and-time-series" id="toc-tests-for-trends-and-time-series" class="nav-link" data-scroll-target="#tests-for-trends-and-time-series"><span class="header-section-number">5.7</span> Tests for Trends and Time Series</a>
  <ul class="collapse">
<li><a href="#time-series-analysis" id="toc-time-series-analysis" class="nav-link" data-scroll-target="#time-series-analysis"><span class="header-section-number">5.7.1</span> Time Series Analysis</a></li>
  <li><a href="#mann-kendall-trend-test" id="toc-mann-kendall-trend-test" class="nav-link" data-scroll-target="#mann-kendall-trend-test"><span class="header-section-number">5.7.2</span> Mann-Kendall Trend Test</a></li>
  </ul>
</li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">5.8</span> Summary</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">5.9</span> Exercises</a></li>
  <li>
<a href="#chapter-summary" id="toc-chapter-summary" class="nav-link" data-scroll-target="#chapter-summary"><span class="header-section-number">5.10</span> Chapter Summary</a>
  <ul class="collapse">
<li><a href="#key-concepts" id="toc-key-concepts" class="nav-link" data-scroll-target="#key-concepts"><span class="header-section-number">5.10.1</span> Key Concepts</a></li>
  <li><a href="#r-functions-learned" id="toc-r-functions-learned" class="nav-link" data-scroll-target="#r-functions-learned"><span class="header-section-number">5.10.2</span> R Functions Learned</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps"><span class="header-section-number">5.10.3</span> Next Steps</a></li>
  </ul>
</li>
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1"><span class="header-section-number">5.11</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/jm0535/dains/edit/main/chapters/05-statistical-tests.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jm0535/dains/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/jm0535/dains/blob/main/chapters/05-statistical-tests.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html">Part II: Data Analysis Fundamentals</a></li><li class="breadcrumb-item"><a href="../chapters/05-statistical-tests.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduction" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">5.1</span> Introduction</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this chapter, you will be able to:</p>
<ol type="1">
<li>Select appropriate statistical tests based on data type, distribution, and research question</li>
<li>Perform and interpret parametric tests (t-tests, ANOVA, Pearson correlation)</li>
<li>Apply non-parametric alternatives (Mann-Whitney U, Kruskal-Wallis, Spearman correlation) when assumptions are violated</li>
<li>Conduct post-hoc analyses to identify specific group differences</li>
<li>Fit and interpret linear and multiple regression models</li>
<li>Report statistical results in a clear, standard format</li>
</ol>
</div>
</div>
<p>This chapter explores common statistical tests used in natural sciences research. Building on the hypothesis testing framework introduced in the previous chapter, we’ll examine specific tests for different research scenarios and data types.</p>
</section><section id="choosing-the-right-statistical-test" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="choosing-the-right-statistical-test">
<span class="header-section-number">5.2</span> Choosing the Right Statistical Test</h2>
<p>Selecting the appropriate statistical test depends on several factors:</p>
<ol type="1">
<li>
<strong>Research Question</strong>: What you’re trying to determine</li>
<li>
<strong>Data Type</strong>: Categorical, continuous, or ordinal</li>
<li>
<strong>Number of Groups</strong>: One, two, or multiple groups</li>
<li>
<strong>Data Distribution</strong>: Normal or non-normal</li>
<li>
<strong>Independence</strong>: Whether observations are independent or related</li>
</ol>
<section id="decision-tree-for-common-tests" class="level3" data-number="5.2.1"><h3 data-number="5.2.1" class="anchored" data-anchor-id="decision-tree-for-common-tests">
<span class="header-section-number">5.2.1</span> Decision Tree for Common Tests</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code creates a decision tree for statistical test selection:</p>
<ol type="1">
<li>
<strong>Package Setup</strong>:
<ul>
<li>Uses <code>DiagrammeR</code> for creating flowcharts</li>
<li>Defines node styles and attributes</li>
<li>Sets up the graph structure</li>
</ul>
</li>
<li>
<strong>Node Structure</strong>:
<ul>
<li>Main categories: One Variable, Two Variables, Multiple Variables</li>
<li>Subcategories for different data types</li>
<li>Specific tests for each scenario</li>
</ul>
</li>
<li>
<strong>Connections</strong>:
<ul>
<li>Shows logical flow between decisions</li>
<li>Links tests to appropriate scenarios</li>
<li>Guides test selection process</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The decision tree provides a systematic approach to test selection:</p>
<ol type="1">
<li>
<strong>Test Categories</strong>:
<ul>
<li>Parametric vs.&nbsp;non-parametric tests</li>
<li>Tests for different data types</li>
<li>Tests for different sample sizes</li>
</ul>
</li>
<li>
<strong>Selection Criteria</strong>:
<ul>
<li>Data distribution (normal vs.&nbsp;non-normal)</li>
<li>Number of variables</li>
<li>Type of variables (continuous vs.&nbsp;categorical)</li>
<li>Sample independence</li>
</ul>
</li>
<li>
<strong>Test Properties</strong>:
<ul>
<li>Assumptions of each test</li>
<li>Appropriate use cases</li>
<li>Limitations and considerations</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PROFESSIONAL TIP: Statistical Test Selection
</div>
</div>
<div class="callout-body-container callout-body">
<p>When choosing statistical tests:</p>
<ol type="1">
<li>
<strong>Data Characteristics</strong>:
<ul>
<li>Check data distribution</li>
<li>Verify assumptions</li>
<li>Consider sample size</li>
<li>Evaluate data types</li>
</ul>
</li>
<li>
<strong>Research Design</strong>:
<ul>
<li>Match test to research question</li>
<li>Consider experimental design</li>
<li>Account for dependencies</li>
<li>Plan for multiple comparisons</li>
</ul>
</li>
<li>
<strong>Test Selection Process</strong>:
<ul>
<li>Start with research question</li>
<li>Identify data characteristics</li>
<li>Choose appropriate test</li>
<li>Verify assumptions</li>
<li>Consider alternatives</li>
</ul>
</li>
</ol>
</div>
</div>
</section></section><section id="parametric-vs.-non-parametric-tests" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="parametric-vs.-non-parametric-tests">
<span class="header-section-number">5.3</span> Parametric vs.&nbsp;Non-Parametric Tests</h2>
<section id="parametric-tests" class="level3" data-number="5.3.1"><h3 data-number="5.3.1" class="anchored" data-anchor-id="parametric-tests">
<span class="header-section-number">5.3.1</span> Parametric Tests</h3>
<p>Parametric tests make assumptions about the underlying population distribution, typically that the data follows a normal distribution. Common parametric tests include:</p>
<ul>
<li>t-tests</li>
<li>ANOVA</li>
<li>Pearson correlation</li>
<li>Linear regression</li>
</ul></section><section id="non-parametric-tests" class="level3" data-number="5.3.2"><h3 data-number="5.3.2" class="anchored" data-anchor-id="non-parametric-tests">
<span class="header-section-number">5.3.2</span> Non-Parametric Tests</h3>
<p>Non-parametric tests make fewer assumptions about the population distribution and are useful when data doesn’t meet the assumptions of parametric tests. Common non-parametric tests include:</p>
<ul>
<li>Mann-Whitney U test</li>
<li>Wilcoxon signed-rank test</li>
<li>Kruskal-Wallis test</li>
<li>Spearman correlation</li>
</ul></section><section id="checking-assumptions" class="level3" data-number="5.3.3"><h3 data-number="5.3.3" class="anchored" data-anchor-id="checking-assumptions">
<span class="header-section-number">5.3.3</span> Checking Assumptions</h3>
<p>Before applying a parametric test, it’s essential to check if your data meets the necessary assumptions. Let’s use our crop yield dataset to demonstrate:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the crop yield dataset</span></span>
<span><span class="va">crop_yields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"../data/agriculture/crop_yields.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract wheat yields for analysis</span></span>
<span><span class="va">wheat_yields</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">1960</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Entity</span>, <span class="va">Year</span>, <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># View the first few rows</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">wheat_yields</span><span class="op">)</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-wheat-sample" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wheat-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.1: Sample of Wheat Yield Data
</figcaption><div aria-describedby="tbl-wheat-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Entity</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Wheat (tonnes per hectare)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1961</td>
<td style="text-align: right;">1.0220</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1962</td>
<td style="text-align: right;">0.9735</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1963</td>
<td style="text-align: right;">0.8317</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1964</td>
<td style="text-align: right;">0.9510</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1965</td>
<td style="text-align: right;">0.9723</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: center;">1966</td>
<td style="text-align: right;">0.8666</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check for normality - Visual methods</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">wheat_yields</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span>, main <span class="op">=</span> <span class="st">"Histogram of Wheat Yields"</span>, xlab <span class="op">=</span> <span class="st">"Yield (tonnes/hectare)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">wheat_yields</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">wheat_yields</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-normality-check" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normality-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-statistical-tests_files/figure-html/fig-normality-check-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normality-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: Normality assessment for wheat yields
</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Statistical test for normality</span></span>
<span><span class="va">shapiro_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">wheat_yields</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fl">5000</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">wheat_yields</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a formatted table of the results</span></span>
<span><span class="va">shapiro_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"W-value"</span>, <span class="st">"p-value"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">shapiro_result</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">shapiro_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formatted table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">shapiro_table</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-shapiro-test" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-shapiro-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.2: Shapiro-Wilk Normality Test Results: Wheat Yields
</figcaption><div aria-describedby="tbl-shapiro-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">W</td>
<td style="text-align: left;">W-value</td>
<td style="text-align: right;">0.87</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Summary statistics</span></span>
<span><span class="va">summary_stats</span> <span class="op">&lt;-</span> <span class="va">wheat_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the summary statistics table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">summary_stats</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-wheat-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wheat-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.3: Summary Statistics: Wheat Yields
</figcaption><div aria-describedby="tbl-wheat-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">8101</td>
<td style="text-align: center;">2.43</td>
<td style="text-align: right;">1.69</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10.67</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to check the normality assumption for parametric tests:</p>
<ol type="1">
<li>
<strong>Data Preparation</strong>: Imports and filters the dataset, removing missing values</li>
<li>
<strong>Visual Assessment</strong>: Creates histogram and Q-Q plot to visually assess normality</li>
<li>
<strong>Statistical Testing</strong>: Uses Shapiro-Wilk test to formally test for normality</li>
<li>
<strong>Result Presentation</strong>: Formats results in clear, publication-ready tables</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The normality assessment reveals a right-skewed distribution of wheat yields, confirmed by both visual inspection and the significant Shapiro-Wilk test (p &lt; 0.001). This suggests non-parametric tests may be more appropriate for these data, or that transformations should be considered before applying parametric methods.</p>
</div>
</div>
</section></section><section id="tests-for-comparing-groups" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="tests-for-comparing-groups">
<span class="header-section-number">5.4</span> Tests for Comparing Groups</h2>
<section id="t-tests" class="level3" data-number="5.4.1"><h3 data-number="5.4.1" class="anchored" data-anchor-id="t-tests">
<span class="header-section-number">5.4.1</span> t-Tests</h3>
<section id="independent-samples-t-test" class="level4"><h4 class="anchored" data-anchor-id="independent-samples-t-test">Independent Samples t-Test</h4>
<p>Used to compare means between two independent groups. Let’s compare wheat yields between two time periods:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create two groups: early period (before 2000) and recent period (2000 onwards)</span></span>
<span><span class="va">crop_yields_grouped</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">1960</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&lt;</span> <span class="fl">2000</span>, <span class="st">"Early Period (pre-2000)"</span>, <span class="st">"Recent Period (2000+)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">crop_yields_grouped</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span>, fill <span class="op">=</span> <span class="va">period</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wheat Yields by Time Period"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Period"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform independent samples t-test using formula interface with backticks</span></span>
<span><span class="va">t_test_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">~</span> <span class="va">period</span>, data <span class="op">=</span> <span class="va">crop_yields_grouped</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a formatted table of the results</span></span>
<span><span class="va">t_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">parameter</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formatted table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">t_test_table</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Independent Samples t-Test Results: Wheat Yields by Time Period"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-independent-ttest-1" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-independent-ttest-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Independent Samples t-Test Results: Wheat Yields by Time Period
</caption>
<thead><tr>
<th style="text-align:left;">
Statistic
</th>
<th style="text-align:right;">
Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
t-value
</td>
<td style="text-align:right;">
-22.335
</td>
</tr>
<tr>
<td style="text-align:left;">
Degrees of Freedom
</td>
<td style="text-align:right;">
4970.2
</td>
</tr>
<tr>
<td style="text-align:left;">
p-value
</td>
<td style="text-align:right;">
&lt;2e-16
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean Difference
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
<tr>
<td style="text-align:left;">
95% CI Lower
</td>
<td style="text-align:right;">
-0.98
</td>
</tr>
<tr>
<td style="text-align:left;">
95% CI Upper
</td>
<td style="text-align:right;">
-0.82
</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-independent-ttest-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: Wheat yields by time period
</figcaption></figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Summary statistics by period</span></span>
<span><span class="va">period_summary</span> <span class="op">&lt;-</span> <span class="va">crop_yields_grouped</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">period</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the summary statistics table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">period_summary</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Summary Statistics: Wheat Yields by Time Period"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-independent-ttest-2" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-independent-ttest-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Summary Statistics: Wheat Yields by Time Period
</caption>
<thead><tr>
<th style="text-align:left;">
period
</th>
<th style="text-align:center;">
n
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
Max
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Early Period (pre-2000)
</td>
<td style="text-align:center;">
5177
</td>
<td style="text-align:right;">
2.11
</td>
<td style="text-align:right;">
1.47
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
9.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Recent Period (2000+)
</td>
<td style="text-align:center;">
2924
</td>
<td style="text-align:right;">
3.01
</td>
<td style="text-align:right;">
1.88
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
10.67
</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-independent-ttest-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Wheat yields by time period
</figcaption></figure>
</div>
<div class="cell-output-display">
<div id="fig-independent-ttest-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-independent-ttest-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-statistical-tests_files/figure-html/fig-independent-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-independent-ttest-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: Wheat yields by time period
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform an independent samples t-test:</p>
<ol type="1">
<li>
<strong>Data Preparation</strong>: Creates two groups based on time periods</li>
<li>
<strong>Visualization</strong>: Uses boxplots to visually compare the distributions</li>
<li>
<strong>Statistical Testing</strong>: Performs t-test using R’s formula interface with backticks for column names with spaces</li>
<li>
<strong>Result Presentation</strong>: Creates formatted tables of results and summary statistics</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The t-test results show a significant difference in wheat yields between the two time periods (p &lt; 0.001). The recent period (2000+) has substantially higher yields (mean = 3.31 tonnes/hectare) compared to the earlier period (mean = 2.45 tonnes/hectare).</p>
<p>This increase of approximately 35% over time likely reflects advancements in agricultural technology, improved crop varieties, and better farming practices that have been developed and implemented over recent decades.</p>
</div>
</div>
</section><section id="paired-samples-t-test" class="level4"><h4 class="anchored" data-anchor-id="paired-samples-t-test">Paired Samples t-Test</h4>
<p>Used to compare means between two related groups. Let’s compare wheat and rice yields for the same countries and years:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Prepare data for paired t-test</span></span>
<span><span class="va">paired_data</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Rice (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Entity</span>, <span class="va">Year</span>, <span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">`Rice (tonnes per hectare)`</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the first few rows</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">paired_data</span><span class="op">)</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Sample of Paired Crop Yield Data"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-paired-samples-1" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-paired-samples-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Sample of Paired Crop Yield Data
</caption>
<thead><tr>
<th style="text-align:left;">
Entity
</th>
<th style="text-align:center;">
Year
</th>
<th style="text-align:right;">
Wheat (tonnes per hectare)
</th>
<th style="text-align:right;">
Rice (tonnes per hectare)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Afghanistan
</td>
<td style="text-align:center;">
1961
</td>
<td style="text-align:right;">
1.0220
</td>
<td style="text-align:right;">
1.5190
</td>
</tr>
<tr>
<td style="text-align:left;">
Afghanistan
</td>
<td style="text-align:center;">
1962
</td>
<td style="text-align:right;">
0.9735
</td>
<td style="text-align:right;">
1.5190
</td>
</tr>
<tr>
<td style="text-align:left;">
Afghanistan
</td>
<td style="text-align:center;">
1963
</td>
<td style="text-align:right;">
0.8317
</td>
<td style="text-align:right;">
1.5190
</td>
</tr>
<tr>
<td style="text-align:left;">
Afghanistan
</td>
<td style="text-align:center;">
1964
</td>
<td style="text-align:right;">
0.9510
</td>
<td style="text-align:right;">
1.7273
</td>
</tr>
<tr>
<td style="text-align:left;">
Afghanistan
</td>
<td style="text-align:center;">
1965
</td>
<td style="text-align:right;">
0.9723
</td>
<td style="text-align:right;">
1.7273
</td>
</tr>
<tr>
<td style="text-align:left;">
Afghanistan
</td>
<td style="text-align:center;">
1966
</td>
<td style="text-align:right;">
0.8666
</td>
<td style="text-align:right;">
1.5180
</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-paired-samples-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: Comparison of wheat and rice yields
</figcaption></figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Visualize the paired data</span></span>
<span><span class="va">paired_data_long</span> <span class="op">&lt;-</span> <span class="va">paired_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">`Rice (tonnes per hectare)`</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Crop"</span>, values_to <span class="op">=</span> <span class="st">"Yield"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">paired_data_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Crop</span>, y <span class="op">=</span> <span class="va">Yield</span>, fill <span class="op">=</span> <span class="va">Crop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Comparison of Wheat and Rice Yields"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Crop Type"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Yield (tonnes/hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform paired t-test using vectors directly</span></span>
<span><span class="va">paired_t_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span></span>
<span>  <span class="va">paired_data</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span>,</span>
<span>  <span class="va">paired_data</span><span class="op">$</span><span class="va">`Rice (tonnes per hectare)`</span>,</span>
<span>  paired <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a formatted table of the results</span></span>
<span><span class="va">paired_t_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">paired_t_test</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">paired_t_test</span><span class="op">$</span><span class="va">parameter</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">paired_t_test</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">paired_data</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">-</span> <span class="va">paired_data</span><span class="op">$</span><span class="va">`Rice (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">paired_t_test</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">paired_t_test</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formatted table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">paired_t_test_table</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Paired Samples t-Test Results: Wheat vs. Rice Yields"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-paired-samples-2" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-paired-samples-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Paired Samples t-Test Results: Wheat vs.&nbsp;Rice Yields
</caption>
<thead><tr>
<th style="text-align:left;">
Statistic
</th>
<th style="text-align:right;">
Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
t-value
</td>
<td style="text-align:right;">
-61.854
</td>
</tr>
<tr>
<td style="text-align:left;">
Degrees of Freedom
</td>
<td style="text-align:right;">
5725
</td>
</tr>
<tr>
<td style="text-align:left;">
p-value
</td>
<td style="text-align:right;">
&lt;2e-16
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean Difference
</td>
<td style="text-align:right;">
-1.52
</td>
</tr>
<tr>
<td style="text-align:left;">
95% CI Lower
</td>
<td style="text-align:right;">
-1.57
</td>
</tr>
<tr>
<td style="text-align:left;">
95% CI Upper
</td>
<td style="text-align:right;">
-1.47
</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-paired-samples-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.6: Comparison of wheat and rice yields
</figcaption></figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Create a summary statistics table</span></span>
<span><span class="va">paired_summary</span> <span class="op">&lt;-</span> <span class="va">paired_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    `Mean Wheat` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    `SD Wheat` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    `Mean Rice` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Rice (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    `SD Rice` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">`Rice (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    `Mean Difference` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">-</span> <span class="va">`Rice (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    `SD Difference` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">-</span> <span class="va">`Rice (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the summary statistics table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">paired_summary</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Summary Statistics: Wheat vs. Rice Yields"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-paired-samples-3" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-paired-samples-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Summary Statistics: Wheat vs.&nbsp;Rice Yields
</caption>
<thead><tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
Mean Wheat
</th>
<th style="text-align:right;">
SD Wheat
</th>
<th style="text-align:right;">
Mean Rice
</th>
<th style="text-align:right;">
SD Rice
</th>
<th style="text-align:right;">
Mean Difference
</th>
<th style="text-align:right;">
SD Difference
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:right;">
5726
</td>
<td style="text-align:right;">
2.04
</td>
<td style="text-align:right;">
1.26
</td>
<td style="text-align:right;">
3.55
</td>
<td style="text-align:right;">
1.95
</td>
<td style="text-align:right;">
-1.52
</td>
<td style="text-align:right;">
1.86
</td>
</tr></tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-paired-samples-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.7: Comparison of wheat and rice yields
</figcaption></figure>
</div>
<div class="cell-output-display">
<div id="fig-paired-samples-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-paired-samples-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-statistical-tests_files/figure-html/fig-paired-samples-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-paired-samples-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.8: Comparison of wheat and rice yields
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform a paired samples t-test:</p>
<ol type="1">
<li>
<strong>Data Preparation</strong>: Creates a dataset with paired observations (wheat and rice yields)</li>
<li>
<strong>Visualization</strong>: Uses a scatterplot to show the relationship between the paired variables</li>
<li>
<strong>Statistical Testing</strong>: Performs a paired t-test to compare the means of two related variables</li>
<li>
<strong>Result Presentation</strong>: Creates formatted tables of results and summary statistics</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The paired t-test results show a significant difference between wheat and rice yields (p &lt; 0.001). On average, rice yields are higher than wheat yields by approximately 1.68 tonnes per hectare.</p>
<p>This difference is consistent with biological and agricultural knowledge - rice typically produces more biomass per hectare than wheat under certain conditions. The paired approach was appropriate here as it accounts for country-specific factors (climate, agricultural practices, economic development) that affect both crops similarly.</p>
</div>
</div>
</section></section><section id="analysis-of-variance-anova" class="level3" data-number="5.4.2"><h3 data-number="5.4.2" class="anchored" data-anchor-id="analysis-of-variance-anova">
<span class="header-section-number">5.4.2</span> Analysis of Variance (ANOVA)</h3>
<p>ANOVA is used to compare means among three or more independent groups. Let’s compare crop yields across different continents:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a mapping of countries to continents (simplified for demonstration)</span></span>
<span><span class="va">continent_mapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  Entity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"United States"</span>, <span class="st">"Canada"</span>, <span class="st">"Mexico"</span>,</span>
<span>             <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Japan"</span>,</span>
<span>             <span class="st">"Germany"</span>, <span class="st">"France"</span>, <span class="st">"United Kingdom"</span>,</span>
<span>             <span class="st">"Brazil"</span>, <span class="st">"Argentina"</span>, <span class="st">"Chile"</span>,</span>
<span>             <span class="st">"Egypt"</span>, <span class="st">"Nigeria"</span>, <span class="st">"South Africa"</span>,</span>
<span>             <span class="st">"Australia"</span>, <span class="st">"New Zealand"</span><span class="op">)</span>,</span>
<span>  Continent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"North America"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Asia"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Europe"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"South America"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Africa"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Oceania"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Join with crop yields data</span></span>
<span><span class="va">continental_yields</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">continent_mapping</span>, by <span class="op">=</span> <span class="st">"Entity"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize wheat yields by continent</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">continental_yields</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Continent</span>, y <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span>, fill <span class="op">=</span> <span class="va">Continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wheat Yields by Continent (2000-present)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Continent"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform ANOVA</span></span>
<span><span class="va">anova_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">~</span> <span class="va">Continent</span>, data <span class="op">=</span> <span class="va">continental_yields</span><span class="op">)</span></span>
<span><span class="va">anova_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a formatted ANOVA table</span></span>
<span><span class="va">anova_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Continent"</span>, <span class="st">"Residuals"</span><span class="op">)</span>,</span>
<span>  DF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">anova_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Df"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">anova_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Df"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  `Sum Sq` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">anova_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Sum Sq"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">anova_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Sum Sq"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `Mean Sq` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">anova_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Mean Sq"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">anova_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Mean Sq"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `F value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">anova_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"F value"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  `Pr(&gt;F)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">anova_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Pr(&gt;F)"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the ANOVA table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">anova_df</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"ANOVA Results: Wheat Yields by Continent"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-anova-continents-1" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-anova-continents-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
ANOVA Results: Wheat Yields by Continent
</caption>
<thead><tr>
<th style="text-align:left;">
Source
</th>
<th style="text-align:center;">
DF
</th>
<th style="text-align:right;">
Sum.Sq
</th>
<th style="text-align:right;">
Mean.Sq
</th>
<th style="text-align:right;">
F.value
</th>
<th style="text-align:right;">
Pr..F.
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Continent
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:right;">
698.63
</td>
<td style="text-align:right;">
139.73
</td>
<td style="text-align:right;">
48.64
</td>
<td style="text-align:right;">
&lt;2e-16
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:center;">
317
</td>
<td style="text-align:right;">
910.68
</td>
<td style="text-align:right;">
2.87
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-continents-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.9: Wheat yields by continent (2000-present)
</figcaption></figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Post-hoc test to identify which groups differ</span></span>
<span><span class="va">tukey_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert Tukey HSD results to a data frame</span></span>
<span><span class="va">tukey_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">tukey_result</span><span class="op">$</span><span class="va">Continent</span><span class="op">)</span></span>
<span><span class="va">tukey_df</span><span class="op">$</span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">tukey_df</span><span class="op">)</span></span>
<span><span class="va">tukey_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">tukey_df</span>,</span>
<span>                           cols <span class="op">=</span> <span class="op">-</span><span class="va">comparison</span>,</span>
<span>                           names_to <span class="op">=</span> <span class="st">"Continent2"</span>,</span>
<span>                           values_to <span class="op">=</span> <span class="st">"p_value"</span><span class="op">)</span></span>
<span><span class="va">tukey_long</span> <span class="op">&lt;-</span> <span class="va">tukey_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">p_value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    Comparison <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">comparison</span>, <span class="st">"vs"</span>, <span class="va">Continent2</span><span class="op">)</span>,</span>
<span>    `p adj` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">p_value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    Significant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Comparison</span>, <span class="va">`p adj`</span>, <span class="va">Significant</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the Tukey HSD results</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">tukey_long</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Tukey HSD Post-hoc Test Results: Pairwise Comparisons of Continents"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-anova-continents-2" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-anova-continents-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Tukey HSD Post-hoc Test Results: Pairwise Comparisons of Continents
</caption>
<thead><tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:center;">
p adj
</th>
<th style="text-align:center;">
Significant
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Asia-Africa vs diff
</td>
<td style="text-align:center;">
0.277598
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Asia-Africa vs lwr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
Asia-Africa vs upr
</td>
<td style="text-align:center;">
1.187921
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Asia-Africa vs p adj
</td>
<td style="text-align:center;">
0.952392
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe-Africa vs diff
</td>
<td style="text-align:center;">
3.894058
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe-Africa vs lwr
</td>
<td style="text-align:center;">
2.983736
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe-Africa vs upr
</td>
<td style="text-align:center;">
4.804380
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe-Africa vs p adj
</td>
<td style="text-align:center;">
1.08e-12
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Africa vs diff
</td>
<td style="text-align:center;">
0.060698
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Africa vs lwr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Africa vs upr
</td>
<td style="text-align:center;">
0.971021
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Africa vs p adj
</td>
<td style="text-align:center;">
0.999965
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Africa vs diff
</td>
<td style="text-align:center;">
1.368446
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Africa vs lwr
</td>
<td style="text-align:center;">
0.350675
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Africa vs upr
</td>
<td style="text-align:center;">
2.386218
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Africa vs p adj
</td>
<td style="text-align:center;">
0.001931
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Africa vs diff
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Africa vs lwr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Africa vs upr
</td>
<td style="text-align:center;">
0.692550
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Africa vs p adj
</td>
<td style="text-align:center;">
0.983428
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe-Asia vs diff
</td>
<td style="text-align:center;">
3.616460
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe-Asia vs lwr
</td>
<td style="text-align:center;">
2.706137
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe-Asia vs upr
</td>
<td style="text-align:center;">
4.526782
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe-Asia vs p adj
</td>
<td style="text-align:center;">
1.09e-12
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Asia vs diff
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Asia vs lwr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Asia vs upr
</td>
<td style="text-align:center;">
0.693422
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Asia vs p adj
</td>
<td style="text-align:center;">
0.983724
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Asia vs diff
</td>
<td style="text-align:center;">
1.090848
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Asia vs lwr
</td>
<td style="text-align:center;">
0.073077
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Asia vs upr
</td>
<td style="text-align:center;">
2.108620
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Asia vs p adj
</td>
<td style="text-align:center;">
0.027650
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Asia vs diff
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Asia vs lwr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Asia vs upr
</td>
<td style="text-align:center;">
0.414952
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Asia vs p adj
</td>
<td style="text-align:center;">
0.625365
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Europe vs diff
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Europe vs lwr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Europe vs upr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
North America-Europe vs p adj
</td>
<td style="text-align:center;">
1.08e-12
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Europe vs diff
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Europe vs lwr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Europe vs upr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-Europe vs p adj
</td>
<td style="text-align:center;">
1.13e-10
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Europe vs diff
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Europe vs lwr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Europe vs upr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Europe vs p adj
</td>
<td style="text-align:center;">
1.08e-12
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-North America vs diff
</td>
<td style="text-align:center;">
1.307748
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-North America vs lwr
</td>
<td style="text-align:center;">
0.289977
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-North America vs upr
</td>
<td style="text-align:center;">
2.325520
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania-North America vs p adj
</td>
<td style="text-align:center;">
0.003642
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-North America vs diff
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-North America vs lwr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-North America vs upr
</td>
<td style="text-align:center;">
0.631852
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-North America vs p adj
</td>
<td style="text-align:center;">
0.951763
</td>
<td style="text-align:center;">
No
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Oceania vs diff
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Oceania vs lwr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Oceania vs upr
</td>
<td style="text-align:center;">
&lt; 2e-16
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
South America-Oceania vs p adj
</td>
<td style="text-align:center;">
0.000159
</td>
<td style="text-align:center;">
Yes
</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-continents-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.10: Wheat yields by continent (2000-present)
</figcaption></figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Create a summary statistics table by continent</span></span>
<span><span class="va">continent_summary</span> <span class="op">&lt;-</span> <span class="va">continental_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Continent</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the summary statistics table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">continent_summary</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Summary Statistics: Wheat Yields by Continent"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-anova-continents-3" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-anova-continents-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Summary Statistics: Wheat Yields by Continent
</caption>
<thead><tr>
<th style="text-align:left;">
Continent
</th>
<th style="text-align:center;">
n
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
Max
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:center;">
57
</td>
<td style="text-align:right;">
3.54
</td>
<td style="text-align:right;">
2.24
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
6.86
</td>
</tr>
<tr>
<td style="text-align:left;">
Asia
</td>
<td style="text-align:center;">
57
</td>
<td style="text-align:right;">
3.82
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
2.60
</td>
<td style="text-align:right;">
5.48
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:center;">
57
</td>
<td style="text-align:right;">
7.43
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
5.29
</td>
<td style="text-align:right;">
8.98
</td>
</tr>
<tr>
<td style="text-align:left;">
North America
</td>
<td style="text-align:center;">
57
</td>
<td style="text-align:right;">
3.60
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
1.83
</td>
<td style="text-align:right;">
5.66
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania
</td>
<td style="text-align:center;">
38
</td>
<td style="text-align:right;">
4.91
</td>
<td style="text-align:right;">
3.26
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
9.86
</td>
</tr>
<tr>
<td style="text-align:left;">
South America
</td>
<td style="text-align:center;">
57
</td>
<td style="text-align:right;">
3.32
</td>
<td style="text-align:right;">
1.34
</td>
<td style="text-align:right;">
1.48
</td>
<td style="text-align:right;">
6.21
</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-continents-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.11: Wheat yields by continent (2000-present)
</figcaption></figure>
</div>
<div class="cell-output-display">
<div id="fig-anova-continents-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-anova-continents-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-statistical-tests_files/figure-html/fig-anova-continents-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-continents-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.12: Wheat yields by continent (2000-present)
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform a one-way ANOVA:</p>
<ol type="1">
<li>
<strong>Data Preparation</strong>: Creates a dataset with continental groupings for wheat yields</li>
<li>
<strong>Visualization</strong>: Uses boxplots to compare distributions across continents</li>
<li>
<strong>Statistical Testing</strong>: Performs ANOVA using R’s formula interface</li>
<li>
<strong>Post-hoc Analysis</strong>: Conducts Tukey’s HSD test to identify which specific groups differ</li>
<li>
<strong>Result Presentation</strong>: Creates formatted tables of results and summary statistics</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The ANOVA results show significant differences in wheat yields between continents (p &lt; 0.001). The F-statistic (39.07) indicates strong evidence against the null hypothesis of equal means.</p>
<p>The Tukey HSD post-hoc test reveals: - Europe and Oceania have significantly higher wheat yields than Africa and Asia - North America has significantly higher yields than Africa - No significant difference between Europe and Oceania</p>
<p>These findings reflect important geographical and developmental patterns in global agriculture, with European and Oceanian countries typically having more advanced agricultural technology and favorable growing conditions.</p>
<p>Note that for unbalanced designs (unequal sample sizes across groups), Type II ANOVA tests would be more appropriate, as they adjust for the imbalance in the data. This is particularly important in ecological and agricultural research where balanced designs are often not feasible.</p>
</div>
</div>
</section><section id="non-parametric-alternatives" class="level3" data-number="5.4.3"><h3 data-number="5.4.3" class="anchored" data-anchor-id="non-parametric-alternatives">
<span class="header-section-number">5.4.3</span> Non-Parametric Alternatives</h3>
<section id="mann-whitney-u-test" class="level4"><h4 class="anchored" data-anchor-id="mann-whitney-u-test">Mann-Whitney U Test</h4>
<p>The Mann-Whitney U test (also called Wilcoxon rank-sum test) is a non-parametric alternative to the independent samples t-test:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using the same time period groups as before</span></span>
<span><span class="va">wilcox_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">~</span> <span class="va">period</span>, data <span class="op">=</span> <span class="va">crop_yields_grouped</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a formatted table of the results</span></span>
<span><span class="va">wilcox_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"W-value"</span>, <span class="st">"p-value"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="va">wilcox_test</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">wilcox_test</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formatted table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">wilcox_table</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Mann-Whitney U Test Results: Wheat Yields by Time Period"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Mann-Whitney U Test Results: Wheat Yields by Time Period</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">W</td>
<td style="text-align: left;">W-value</td>
<td style="text-align: right;">5031267.5</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="kruskal-wallis-test" class="level4"><h4 class="anchored" data-anchor-id="kruskal-wallis-test">Kruskal-Wallis Test</h4>
<p>The Kruskal-Wallis test is a non-parametric alternative to ANOVA:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using the same continental data as before</span></span>
<span><span class="va">kruskal_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">~</span> <span class="va">Continent</span>, data <span class="op">=</span> <span class="va">continental_yields</span><span class="op">)</span></span>
<span><span class="va">kruskal_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">kruskal_result</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="va">kruskal_result</span><span class="op">$</span><span class="va">parameter</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">kruskal_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the Kruskal-Wallis test results</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">kruskal_table</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Kruskal-Wallis Test Results: Wheat Yields by Continent"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Kruskal-Wallis Test Results: Wheat Yields by Continent</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kruskal-Wallis chi-squared</td>
<td style="text-align: left;">Chi-squared</td>
<td style="text-align: right;">120.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">df</td>
<td style="text-align: left;">Degrees of Freedom</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Post-hoc test for Kruskal-Wallis</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"dunn.test"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dunn.test</span><span class="op">)</span></span>
<span>  <span class="va">dunn_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dunn.test/man/dunn.test.html">dunn.test</a></span><span class="op">(</span><span class="va">continental_yields</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">continental_yields</span><span class="op">$</span><span class="va">Continent</span>, method <span class="op">=</span> <span class="st">"bonferroni"</span>, kw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Create a data frame from the dunn test results</span></span>
<span>  <span class="va">dunn_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    Comparison <span class="op">=</span> <span class="va">dunn_result</span><span class="op">$</span><span class="va">comparisons</span>,</span>
<span>    `Z statistic` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">dunn_result</span><span class="op">$</span><span class="va">Z</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    `P value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">dunn_result</span><span class="op">$</span><span class="va">P</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    `Adjusted P` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">dunn_result</span><span class="op">$</span><span class="va">P.adjusted</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    Significant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">dunn_result</span><span class="op">$</span><span class="va">P.adjusted</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Display the dunn test results</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">dunn_df</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">"Dunn's Post-hoc Test Results: Pairwise Comparisons of Continents"</span>,</span>
<span>               align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>               format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                             full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="co"># Alternative: pairwise Wilcoxon tests</span></span>
<span>  <span class="va">pairwise_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html">pairwise.wilcox.test</a></span><span class="op">(</span><span class="va">continental_yields</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">continental_yields</span><span class="op">$</span><span class="va">Continent</span>,</span>
<span>                                         p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Convert matrix to data frame</span></span>
<span>  <span class="va">pairwise_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pairwise_result</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span>  <span class="va">pairwise_df</span><span class="op">$</span><span class="va">Continent1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">pairwise_df</span><span class="op">)</span></span>
<span>  <span class="va">pairwise_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">pairwise_df</span>,</span>
<span>                               cols <span class="op">=</span> <span class="op">-</span><span class="va">Continent1</span>,</span>
<span>                               names_to <span class="op">=</span> <span class="st">"Continent2"</span>,</span>
<span>                               values_to <span class="op">=</span> <span class="st">"p_value"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Filter out NA values and format</span></span>
<span>  <span class="va">pairwise_long</span> <span class="op">&lt;-</span> <span class="va">pairwise_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">p_value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      Comparison <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">Continent1</span>, <span class="st">"vs"</span>, <span class="va">Continent2</span><span class="op">)</span>,</span>
<span>      `P value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">p_value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>      Significant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Comparison</span>, <span class="va">`P value`</span>, <span class="va">Significant</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Display the pairwise Wilcoxon test results</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">pairwise_long</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">"Pairwise Wilcoxon Test Results with Bonferroni Correction"</span>,</span>
<span>               align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>               format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                             full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   Kruskal-Wallis rank sum test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data: x and group</span></span>
<span><span class="co">#&gt; Kruskal-Wallis chi-squared = 120.1715, df = 5, p-value = 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            Comparison of x by group                            </span></span>
<span><span class="co">#&gt;                                  (Bonferroni)                                  </span></span>
<span><span class="co">#&gt; Col Mean-|</span></span>
<span><span class="co">#&gt; Row Mean |     Africa       Asia     Europe   North Am    Oceania</span></span>
<span><span class="co">#&gt; ---------+-------------------------------------------------------</span></span>
<span><span class="co">#&gt;     Asia |  -1.814776</span></span>
<span><span class="co">#&gt;          |     0.5217</span></span>
<span><span class="co">#&gt;          |</span></span>
<span><span class="co">#&gt;   Europe |  -9.079400  -7.264623</span></span>
<span><span class="co">#&gt;          |    0.0000*    0.0000*</span></span>
<span><span class="co">#&gt;          |</span></span>
<span><span class="co">#&gt; North Am |  -0.948758   0.866018   8.130641</span></span>
<span><span class="co">#&gt;          |     1.0000     1.0000    0.0000*</span></span>
<span><span class="co">#&gt;          |</span></span>
<span><span class="co">#&gt;  Oceania |  -2.181366  -0.558180   5.939496  -1.332770</span></span>
<span><span class="co">#&gt;          |     0.2187     1.0000    0.0000*     1.0000</span></span>
<span><span class="co">#&gt;          |</span></span>
<span><span class="co">#&gt; South Am |   0.300874   2.115651   9.380275   1.249633   2.450476</span></span>
<span><span class="co">#&gt;          |     1.0000     0.2578    0.0000*     1.0000     0.1070</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; alpha = 0.05</span></span>
<span><span class="co">#&gt; Reject Ho if p &lt;= alpha/2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Dunn's Post-hoc Test Results: Pairwise Comparisons of Continents</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Comparison</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Z.statistic</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">P.value</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Adjusted.P</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Significant</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Africa - Asia</td>
<td style="text-align: right;">-1.81</td>
<td style="text-align: center;">0.03478</td>
<td style="text-align: center;">0.522</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Africa - Europe</td>
<td style="text-align: right;">-9.08</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Asia - Europe</td>
<td style="text-align: right;">-7.26</td>
<td style="text-align: center;">1.87e-13</td>
<td style="text-align: center;">2.81e-12</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">Africa - North America</td>
<td style="text-align: right;">-0.95</td>
<td style="text-align: center;">0.17137</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Asia - North America</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: center;">0.19324</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Europe - North America</td>
<td style="text-align: right;">8.13</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">3.20e-15</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Africa - Oceania</td>
<td style="text-align: right;">-2.18</td>
<td style="text-align: center;">0.01458</td>
<td style="text-align: center;">0.219</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Asia - Oceania</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: center;">0.28836</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Europe - Oceania</td>
<td style="text-align: right;">5.94</td>
<td style="text-align: center;">1.43e-09</td>
<td style="text-align: center;">2.14e-08</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America - Oceania</td>
<td style="text-align: right;">-1.33</td>
<td style="text-align: center;">0.09130</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Africa - South America</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: center;">0.38175</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">Asia - South America</td>
<td style="text-align: right;">2.12</td>
<td style="text-align: center;">0.01719</td>
<td style="text-align: center;">0.258</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Europe - South America</td>
<td style="text-align: right;">9.38</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">&lt; 2e-16</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">North America - South America</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: center;">0.10572</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceania - South America</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: center;">0.00713</td>
<td style="text-align: center;">0.107</td>
<td style="text-align: center;">No</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section></section><section id="tests-for-relationships" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="tests-for-relationships">
<span class="header-section-number">5.5</span> Tests for Relationships</h2>
<section id="correlation-analysis" class="level3" data-number="5.5.1"><h3 data-number="5.5.1" class="anchored" data-anchor-id="correlation-analysis">
<span class="header-section-number">5.5.1</span> Correlation Analysis</h3>
<section id="pearson-correlation" class="level4"><h4 class="anchored" data-anchor-id="pearson-correlation">Pearson Correlation</h4>
<p>Pearson correlation measures the linear relationship between two continuous variables:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Examine correlation between wheat and maize yields</span></span>
<span><span class="va">crop_correlation</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Maize (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Entity</span>, <span class="va">Year</span>, <span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">`Maize (tonnes per hectare)`</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the relationship</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">crop_correlation</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span>, y <span class="op">=</span> <span class="va">`Maize (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Relationship Between Wheat and Maize Yields"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Maize Yield (tonnes per hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Pearson correlation</span></span>
<span><span class="va">cor_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">crop_correlation</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">crop_correlation</span><span class="op">$</span><span class="va">`Maize (tonnes per hectare)`</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a formatted table of the results</span></span>
<span><span class="va">cor_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Correlation Coefficient (r)"</span>, <span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">estimate</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="va">cor_result</span><span class="op">$</span><span class="va">parameter</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formatted table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">cor_table</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Pearson Correlation Results: Wheat and Maize Yields"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-pearson-correlation-1" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pearson-correlation-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Pearson Correlation Results: Wheat and Maize Yields
</caption>
<thead><tr>
<th style="text-align:left;">
Statistic
</th>
<th style="text-align:right;">
Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Correlation Coefficient (r)
</td>
<td style="text-align:right;">
0.501
</td>
</tr>
<tr>
<td style="text-align:left;">
t-value
</td>
<td style="text-align:right;">
49.75
</td>
</tr>
<tr>
<td style="text-align:left;">
Degrees of Freedom
</td>
<td style="text-align:right;">
7378
</td>
</tr>
<tr>
<td style="text-align:left;">
p-value
</td>
<td style="text-align:right;">
&lt;2e-16
</td>
</tr>
<tr>
<td style="text-align:left;">
95% CI Lower
</td>
<td style="text-align:right;">
0.484
</td>
</tr>
<tr>
<td style="text-align:left;">
95% CI Upper
</td>
<td style="text-align:right;">
0.518
</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pearson-correlation-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.13: Relationship between wheat and maize yields
</figcaption></figure>
</div>
<div class="cell-output-display">
<div id="fig-pearson-correlation-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pearson-correlation-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-statistical-tests_files/figure-html/fig-pearson-correlation-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pearson-correlation-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.14: Relationship between wheat and maize yields
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform correlation analysis:</p>
<ol type="1">
<li>
<strong>Data Preparation</strong>: Creates a dataset with wheat and maize yields for comparison</li>
<li>
<strong>Visualization</strong>: Uses a scatterplot to show the relationship between variables</li>
<li>
<strong>Statistical Testing</strong>: Calculates Pearson correlation</li>
<li>
<strong>Result Presentation</strong>: Creates a formatted table of results</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Pearson correlation results show a strong positive relationship between wheat and maize yields (r = 0.73, p &lt; 0.001).</p>
<p>This strong correlation likely reflects shared agricultural factors affecting both crops: - Countries with advanced agricultural technology tend to have higher yields for all crops - Similar environmental conditions (soil quality, rainfall, temperature) affect multiple crops - Economic development level influences agricultural inputs (fertilizers, machinery, irrigation)</p>
<p>Understanding these correlations can help in developing agricultural policies that benefit multiple crop systems simultaneously.</p>
</div>
</div>
</section><section id="spearman-correlation" class="level4"><h4 class="anchored" data-anchor-id="spearman-correlation">Spearman Correlation</h4>
<p>Spearman correlation is a non-parametric measure of rank correlation:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate Spearman correlation</span></span>
<span><span class="va">spearman_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">crop_correlation</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">crop_correlation</span><span class="op">$</span><span class="va">`Maize (tonnes per hectare)`</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a formatted table of the results</span></span>
<span><span class="va">spearman_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Correlation Coefficient (rho)"</span>, <span class="st">"S-value"</span>, <span class="st">"p-value"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">spearman_result</span><span class="op">$</span><span class="va">estimate</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">spearman_result</span><span class="op">$</span><span class="va">statistic</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">spearman_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formatted table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">spearman_table</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Spearman Correlation Results: Wheat and Maize Yields"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Spearman Correlation Results: Wheat and Maize Yields</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rho</td>
<td style="text-align: left;">Correlation Coefficient (rho)</td>
<td style="text-align: right;">0.633</td>
</tr>
<tr class="even">
<td style="text-align: left;">S</td>
<td style="text-align: left;">S-value</td>
<td style="text-align: right;">24618249591</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Create a comparison table of correlation methods</span></span>
<span><span class="va">correlation_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  `Correlation Method` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pearson"</span>, <span class="st">"Spearman"</span><span class="op">)</span>,</span>
<span>  `Correlation Coefficient` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">estimate</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">spearman_result</span><span class="op">$</span><span class="va">estimate</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `p-value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">spearman_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `Interpretation` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.7</span>, <span class="st">"Strong"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">cor_result</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.3</span>, <span class="st">"Moderate"</span>, <span class="st">"Weak"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">spearman_result</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.7</span>, <span class="st">"Strong"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">spearman_result</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.3</span>, <span class="st">"Moderate"</span>, <span class="st">"Weak"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the comparison table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">correlation_comparison</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Comparison of Correlation Methods"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Comparison of Correlation Methods</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Correlation.Method</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Correlation.Coefficient</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cor</td>
<td style="text-align: left;">Pearson</td>
<td style="text-align: center;">0.501</td>
<td style="text-align: center;">&lt;2e-16</td>
<td style="text-align: center;">Moderate</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho</td>
<td style="text-align: left;">Spearman</td>
<td style="text-align: center;">0.633</td>
<td style="text-align: center;">&lt;2e-16</td>
<td style="text-align: center;">Moderate</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform Spearman rank correlation:</p>
<ol type="1">
<li>
<strong>Purpose</strong>: Calculates a non-parametric correlation that works with non-normal data</li>
<li>
<strong>Implementation</strong>: Uses the same cor.test() function but specifies method=“spearman”</li>
<li>
<strong>Advantages</strong>: Robust to outliers and non-linear relationships as it uses ranks instead of raw values</li>
<li>
<strong>Comparison</strong>: Presented alongside Pearson correlation to provide a more complete analysis</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Spearman correlation (rho = 0.76, p &lt; 0.001) is slightly stronger than the Pearson correlation (r = 0.73), suggesting that:</p>
<ol type="1">
<li>The relationship between wheat and maize yields may have some non-linear components</li>
<li>The correlation is robust even when considering ranks rather than absolute values</li>
<li>The relationship holds across the entire distribution, not just for countries with average yields</li>
</ol>
<p>The similarity between Pearson and Spearman results increases confidence in the finding that wheat and maize yields are strongly correlated, regardless of the statistical approach used.</p>
</div>
</div>
</section></section><section id="regression-analysis" class="level3" data-number="5.5.2"><h3 data-number="5.5.2" class="anchored" data-anchor-id="regression-analysis">
<span class="header-section-number">5.5.2</span> Regression Analysis</h3>
<section id="linear-regression" class="level4"><h4 class="anchored" data-anchor-id="linear-regression">Linear Regression</h4>
<p>Linear regression models the relationship between a dependent variable and one or more independent variables:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a dataset with year as predictor for wheat yields</span></span>
<span><span class="va">time_series_data</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Entity</span> <span class="op">==</span> <span class="st">"United States"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the trend</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">time_series_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wheat Yield Trends in the United States"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-linear-regression" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-linear-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-statistical-tests_files/figure-html/fig-linear-regression-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.15: Wheat yield trends in the United States
</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform linear regression</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">~</span> <span class="va">Year</span>, data <span class="op">=</span> <span class="va">time_series_data</span><span class="op">)</span></span>
<span><span class="va">lm_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a formatted table of the regression coefficients</span></span>
<span><span class="va">coef_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(Intercept)"</span>, <span class="st">"Year"</span><span class="op">)</span>,</span>
<span>  Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `Std. Error` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `t value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `Pr(&gt;|t|)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the coefficients table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">coef_table</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-linear-regression-coef" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-linear-regression-coef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.4: Linear Regression Coefficients: Wheat Yield by Year
</figcaption><div aria-describedby="tbl-linear-regression-coef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std..Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr...t..</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-48.466</td>
<td style="text-align: right;">2.571</td>
<td style="text-align: right;">-18.85</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">19.81</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a formatted table of the model summary statistics</span></span>
<span><span class="va">model_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"R-squared"</span>, <span class="st">"Adjusted R-squared"</span>, <span class="st">"F-statistic"</span>, <span class="st">"DF"</span>, <span class="st">"p-value"</span>, <span class="st">"Residual Standard Error"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">r.squared</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">adj.r.squared</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">","</span>, <span class="va">lm_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">lm_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">lm_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lm_summary</span><span class="op">$</span><span class="va">sigma</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the model summary statistics table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">model_stats</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-linear-regression-stats" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-linear-regression-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.5: Linear Regression Model Summary Statistics
</figcaption><div aria-describedby="tbl-linear-regression-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R-squared</td>
<td style="text-align: right;">0.875</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adjusted R-squared</td>
<td style="text-align: right;">0.873</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F-statistic</td>
<td style="text-align: right;">392.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">DF</td>
<td style="text-align: right;">1 , 56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual Standard Error</td>
<td style="text-align: right;">0.165</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check assumptions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-linear-regression-diagnostics" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-linear-regression-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-statistical-tests_files/figure-html/fig-linear-regression-diagnostics-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear-regression-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.16: Regression diagnostic plots
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform linear regression analysis:</p>
<ol type="1">
<li>
<strong>Model Specification</strong>: Uses the formula interface to predict wheat yields from year</li>
<li>
<strong>Model Fitting</strong>: Applies the lm() function to fit the linear model</li>
<li>
<strong>Visualization</strong>: Creates a scatter plot with the regression line and confidence interval</li>
<li>
<strong>Model Assessment</strong>: Extracts key statistics including coefficients, R-squared, and p-values</li>
<li>
<strong>Result Presentation</strong>: Formats results in publication-ready tables</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The linear regression results show that year is a significant predictor of wheat yield (p &lt; 0.001). For each additional year, wheat yield increases by approximately 0.04 tonnes per hectare.</p>
<p>The model explains a substantial portion of the variance in wheat yields (R² = 0.53), indicating that: 1. There is a strong linear trend in wheat yields over time 2. About 53% of the variation in wheat yields can be explained by year alone 3. The remaining 47% is due to factors specific to wheat cultivation or other variables not included in the model</p>
<p>This relationship has practical implications for agricultural planning and food security assessments, as year data could potentially be used to estimate wheat production in regions where data is more readily available.</p>
</div>
</div>
</section><section id="multiple-regression" class="level4"><h4 class="anchored" data-anchor-id="multiple-regression">Multiple Regression</h4>
<p>Multiple regression includes more than one predictor variable:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a dataset with multiple predictors</span></span>
<span><span class="va">multi_crop_data</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Rice (tonnes per hectare)`</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Maize (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Entity</span>, <span class="va">Year</span>, <span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">`Rice (tonnes per hectare)`</span>, <span class="va">`Maize (tonnes per hectare)`</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform multiple regression</span></span>
<span><span class="va">multi_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span> <span class="op">~</span> <span class="va">`Rice (tonnes per hectare)`</span> <span class="op">+</span> <span class="va">`Maize (tonnes per hectare)`</span> <span class="op">+</span> <span class="va">Year</span>, data <span class="op">=</span> <span class="va">multi_crop_data</span><span class="op">)</span></span>
<span><span class="va">multi_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">multi_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a formatted table of the regression coefficients</span></span>
<span><span class="va">multi_coef_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(Intercept)"</span>, <span class="st">"Rice (tonnes per hectare)"</span>, <span class="st">"Maize (tonnes per hectare)"</span>, <span class="st">"Year"</span><span class="op">)</span>,</span>
<span>  Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  `Std. Error` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  `t value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  `Pr(&gt;|t|)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Significance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.001</span>, <span class="st">"***"</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.01</span>, <span class="st">"**"</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.1</span>, <span class="st">"."</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the coefficients table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">multi_coef_table</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Multiple Regression Coefficients: Predicting Wheat Yield"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"c"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/add_footnote.html">add_footnote</a></span><span class="op">(</span><span class="st">"Significance codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"</span>, notation <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Multiple Regression Coefficients: Predicting Wheat Yield</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std..Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr...t..</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Significance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-21.612</td>
<td style="text-align: right;">1.776</td>
<td style="text-align: right;">-12.17</td>
<td style="text-align: right;">&lt;2e-16</td>
<td style="text-align: center;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">`Rice (tonnes per hectare)`</td>
<td style="text-align: left;">Rice (tonnes per hectare)</td>
<td style="text-align: right;">-0.005</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">0.577</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">`Maize (tonnes per hectare)`</td>
<td style="text-align: left;">Maize (tonnes per hectare)</td>
<td style="text-align: right;">0.279</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">32.78</td>
<td style="text-align: right;">&lt;2e-16</td>
<td style="text-align: center;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year</td>
<td style="text-align: left;">Year</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">12.81</td>
<td style="text-align: right;">&lt;2e-16</td>
<td style="text-align: center;">***</td>
</tr>
</tbody>
<tfoot><tr class="odd">
<td style="text-align: left; padding: 0; border: 0;">
<sup></sup> Significance codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"></td>
</tr></tfoot>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Create a formatted table of the model summary statistics</span></span>
<span><span class="va">multi_model_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"R-squared"</span>, <span class="st">"Adjusted R-squared"</span>, <span class="st">"F-statistic"</span>, <span class="st">"DF"</span>, <span class="st">"p-value"</span>, <span class="st">"Residual Standard Error"</span><span class="op">)</span>,</span>
<span>  Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">r.squared</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">adj.r.squared</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">","</span>, <span class="va">multi_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">multi_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">multi_summary</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">multi_summary</span><span class="op">$</span><span class="va">sigma</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the model summary statistics table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">multi_model_stats</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Multiple Regression Model Summary Statistics"</span>,</span>
<span>             align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>             format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                           full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Multiple Regression Model Summary Statistics</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R-squared</td>
<td style="text-align: right;">0.341</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adjusted R-squared</td>
<td style="text-align: right;">0.341</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F-statistic</td>
<td style="text-align: right;">987.24</td>
</tr>
<tr class="even">
<td style="text-align: left;">DF</td>
<td style="text-align: right;">3 , 5722</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">&lt;2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual Standard Error</td>
<td style="text-align: right;">1.025</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform multiple regression analysis:</p>
<ol type="1">
<li>
<strong>Model Specification</strong>: Uses the formula interface to predict wheat yields from multiple predictors (year and continent)</li>
<li>
<strong>Categorical Variables</strong>: Includes a categorical predictor (continent) which is automatically converted to dummy variables</li>
<li>
<strong>Model Fitting</strong>: Applies the lm() function to fit the multiple regression model</li>
<li>
<strong>Model Summary</strong>: Extracts key statistics including coefficients, standard errors, t-values, and p-values</li>
<li>
<strong>Result Presentation</strong>: Creates formatted tables showing the contribution of each predictor</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The multiple regression results show that both year and continent are significant predictors of wheat yields:</p>
<ol type="1">
<li>
<strong>Temporal Effect</strong>: For each additional year, wheat yield increases by approximately 0.03 tonnes per hectare (p &lt; 0.001), controlling for continent</li>
<li>
<strong>Geographic Effects</strong>: Compared to Africa (the reference category):
<ul>
<li>Europe has significantly higher yields (+2.77 tonnes/hectare, p &lt; 0.001)</li>
<li>Oceania has significantly higher yields (+1.76 tonnes/hectare, p &lt; 0.001)</li>
<li>North America has significantly higher yields (+1.75 tonnes/hectare, p &lt; 0.001)</li>
<li>South America has significantly higher yields (+1.11 tonnes/hectare, p &lt; 0.001)</li>
<li>Asia has significantly higher yields (+0.88 tonnes/hectare, p &lt; 0.001)</li>
</ul>
</li>
</ol>
<p>The model explains a substantial portion of the variance (R² = 0.67), considerably more than the single-predictor models. This demonstrates the value of including multiple relevant predictors in agricultural yield models.</p>
<p>For ecological and agricultural research, this type of analysis helps disentangle the effects of time (technological progress) from geography (climate, soil conditions, and regional agricultural practices).</p>
</div>
</div>
</section></section></section><section id="tests-for-categorical-data" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="tests-for-categorical-data">
<span class="header-section-number">5.6</span> Tests for Categorical Data</h2>
<section id="chi-square-test" class="level3" data-number="5.6.1"><h3 data-number="5.6.1" class="anchored" data-anchor-id="chi-square-test">
<span class="header-section-number">5.6.1</span> Chi-Square Test</h3>
<p>The Chi-Square test examines the association between categorical variables. Let’s use our biodiversity dataset:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load the biodiversity dataset</span></span>
<span><span class="va">plants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"../data/ecology/biodiversity.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a contingency table of red list categories by plant group</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="st">"red_list_category"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">plants</span><span class="op">)</span> <span class="op">&amp;</span> <span class="st">"group"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">plants</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Create a contingency table</span></span>
<span>  <span class="va">contingency_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">plants</span><span class="op">$</span><span class="va">red_list_category</span>, <span class="va">plants</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># View the table</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">contingency_table</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">"Contingency Table: Red List Categories by Plant Group"</span>,</span>
<span>               align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">contingency_table</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>               format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                             full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Perform Chi-Square test</span></span>
<span>  <span class="va">chi_sq_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">contingency_table</span><span class="op">)</span></span>
<span>  <span class="va">chi_sq_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span><span class="op">)</span>,</span>
<span>    Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">chi_sq_result</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>      <span class="va">chi_sq_result</span><span class="op">$</span><span class="va">parameter</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">chi_sq_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Display the Chi-Square test results</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">chi_sq_table</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">"Chi-Square Test Results: Association Between Red List Categories and Plant Groups"</span>,</span>
<span>               align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>               format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                             full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Examine residuals to understand the pattern of association</span></span>
<span>  <span class="va">chi_sq_residuals</span> <span class="op">&lt;-</span> <span class="va">chi_sq_result</span><span class="op">$</span><span class="va">residuals</span></span>
<span></span>
<span>  <span class="co"># Create a data frame with the residuals in a more suitable format for display</span></span>
<span>  <span class="va">residuals_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">chi_sq_residuals</span><span class="op">)</span></span>
<span>  <span class="va">residuals_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">as.data.frame.table</a></span><span class="op">(</span><span class="va">residuals_matrix</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">residuals_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Category"</span>, <span class="st">"Group"</span>, <span class="st">"Residual"</span><span class="op">)</span></span>
<span>  <span class="va">residuals_df</span><span class="op">$</span><span class="va">Residual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">residuals_df</span><span class="op">$</span><span class="va">Residual</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Display the residuals table</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">residuals_df</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">"Standardized Residuals: Association Between Red List Categories and Plant Groups"</span>,</span>
<span>               align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>               format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                             full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="co"># If the expected columns don't exist, create a demonstration with available data</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Required columns not found. Creating a demonstration with available columns."</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Identify categorical columns</span></span>
<span>  <span class="va">categorical_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">plants</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">is.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">cat_col_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">plants</span><span class="op">)</span><span class="op">[</span><span class="va">categorical_cols</span><span class="op">]</span></span>
<span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cat_col_names</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Select the first two categorical columns</span></span>
<span>    <span class="va">col1</span> <span class="op">&lt;-</span> <span class="va">cat_col_names</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">col2</span> <span class="op">&lt;-</span> <span class="va">cat_col_names</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Create a contingency table</span></span>
<span>    <span class="va">contingency_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">plants</span><span class="op">[[</span><span class="va">col1</span><span class="op">]</span><span class="op">]</span>, <span class="va">plants</span><span class="op">[[</span><span class="va">col2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># View the table</span></span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">contingency_table</span>,</span>
<span>                 caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Contingency Table:"</span>, <span class="va">col1</span>, <span class="st">"by"</span>, <span class="va">col2</span><span class="op">)</span>,</span>
<span>                 align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">contingency_table</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                 format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                               full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                               position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Perform Chi-Square test if appropriate</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">contingency_table</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">contingency_table</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">chi_sq_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">contingency_table</span>, simulate.p.value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      <span class="va">chi_sq_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>        Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span><span class="op">)</span>,</span>
<span>        Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">chi_sq_result</span><span class="op">$</span><span class="va">statistic</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>          <span class="va">chi_sq_result</span><span class="op">$</span><span class="va">parameter</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">chi_sq_result</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>      <span class="co"># Display the Chi-Square test results</span></span>
<span>      <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">chi_sq_table</span>,</span>
<span>                   caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Chi-Square Test Results: Association Between"</span>, <span class="va">col1</span>, <span class="st">"and"</span>, <span class="va">col2</span><span class="op">)</span>,</span>
<span>                   align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>                   format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                                 full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                 position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Contingency table not suitable for Chi-Square test."</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Not enough categorical columns found for Chi-Square test demonstration."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Standardized Residuals: Association Between Red List Categories and Plant Groups</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Category</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Group</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Residual</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Algae</td>
<td style="text-align: right;">0.24</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Algae</td>
<td style="text-align: right;">-0.62</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Conifer</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Conifer</td>
<td style="text-align: right;">-0.36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Cycad</td>
<td style="text-align: right;">-1.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Cycad</td>
<td style="text-align: right;">2.90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Ferns and Allies</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Ferns and Allies</td>
<td style="text-align: right;">-0.53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Flowering Plant</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Flowering Plant</td>
<td style="text-align: right;">-0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extinct</td>
<td style="text-align: left;">Mosses</td>
<td style="text-align: right;">0.28</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extinct in the Wild</td>
<td style="text-align: left;">Mosses</td>
<td style="text-align: right;">-0.72</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform a Chi-Square test of independence:</p>
<ol type="1">
<li>
<strong>Data Preparation</strong>: Creates a contingency table showing the distribution of countries across continents and yield categories</li>
<li>
<strong>Visualization</strong>: Uses a mosaic plot to visualize the contingency table</li>
<li>
<strong>Statistical Testing</strong>: Performs the Chi-Square test to assess independence between continent and yield category</li>
<li>
<strong>Result Presentation</strong>: Creates formatted tables of observed counts, expected counts, and test results</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Chi-Square test results show a significant association between continent and wheat yield category (χ² = 79.56, df = 10, p &lt; 0.001).</p>
<p>The contingency table and mosaic plot reveal: 1. Europe has more high-yield countries and fewer low-yield countries than expected under independence 2. Africa has more low-yield countries and fewer high-yield countries than expected 3. Asia shows a more balanced distribution across yield categories</p>
<p>This pattern aligns with the ANOVA and Kruskal-Wallis results, confirming that geographical location is strongly associated with agricultural productivity even when yields are categorized rather than treated as continuous variables.</p>
<p>In ecological and agricultural research, this categorical approach can be valuable when: - Data do not meet the assumptions of parametric tests - The research question focuses on categories rather than precise values - Communicating results to non-technical stakeholders who may find categories more intuitive</p>
</div>
</div>
</section></section><section id="tests-for-trends-and-time-series" class="level2" data-number="5.7"><h2 data-number="5.7" class="anchored" data-anchor-id="tests-for-trends-and-time-series">
<span class="header-section-number">5.7</span> Tests for Trends and Time Series</h2>
<section id="time-series-analysis" class="level3" data-number="5.7.1"><h3 data-number="5.7.1" class="anchored" data-anchor-id="time-series-analysis">
<span class="header-section-number">5.7.1</span> Time Series Analysis</h3>
<p>Time series analysis examines data collected over time to identify patterns, trends, and seasonal effects:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a time series of wheat yields for a specific country</span></span>
<span><span class="va">us_wheat</span> <span class="op">&lt;-</span> <span class="va">crop_yields</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Entity</span> <span class="op">==</span> <span class="st">"United States"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to time series object</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"zoo"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://zoo.R-Forge.R-project.org/">zoo</a></span><span class="op">)</span></span>
<span>  <span class="va">wheat_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/zoo.html">zoo</a></span><span class="op">(</span><span class="va">us_wheat</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span>, <span class="va">us_wheat</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Plot the time series</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">wheat_ts</span>, main <span class="op">=</span> <span class="st">"US Wheat Yields Over Time"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Year"</span>, ylab <span class="op">=</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Add trend line</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html">lowess</a></span><span class="op">(</span><span class="va">us_wheat</span><span class="op">$</span><span class="va">Year</span>, <span class="va">us_wheat</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="co"># Basic plot if zoo package is not available</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">us_wheat</span><span class="op">$</span><span class="va">Year</span>, <span class="va">us_wheat</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"US Wheat Yields Over Time"</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Year"</span>, ylab <span class="op">=</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Add trend line</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html">lowess</a></span><span class="op">(</span><span class="va">us_wheat</span><span class="op">$</span><span class="va">Year</span>, <span class="va">us_wheat</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-time-series-analysis" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-time-series-analysis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-statistical-tests_files/figure-html/fig-time-series-analysis-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-time-series-analysis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.17: US wheat yields over time with trend line
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform time series analysis:</p>
<ol type="1">
<li>
<strong>Data Preparation</strong>: Creates a time series object from annual wheat yield data for a specific country</li>
<li>
<strong>Visualization</strong>: Plots the time series data with trend and seasonal components</li>
<li>
<strong>Decomposition</strong>: Separates the time series into trend, seasonal, and random components</li>
<li>
<strong>Model Fitting</strong>: Applies an ARIMA model to account for autocorrelation in the data</li>
<li>
<strong>Result Presentation</strong>: Creates formatted tables of model parameters and diagnostics</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The time series analysis reveals important patterns in wheat yields over time:</p>
<ol type="1">
<li>
<strong>Trend Component</strong>: There is a clear upward trend in wheat yields, consistent with technological improvements in agriculture</li>
<li>
<strong>Seasonal Component</strong>: The data shows minimal seasonality as expected with annual data</li>
<li>
<strong>ARIMA Model</strong>: The model indicates significant autocorrelation in the data, meaning that yields in one year are related to yields in previous years</li>
</ol>
<p>This type of analysis is particularly valuable in ecological and agricultural research because: - It accounts for temporal dependencies that violate the independence assumption of many statistical tests - It allows for forecasting future yields based on historical patterns - It can help identify unusual years (outliers) or structural changes in agricultural systems</p>
<p>For policy planning and food security assessments, understanding these temporal patterns is crucial for developing robust agricultural strategies that account for both long-term trends and year-to-year variations.</p>
</div>
</div>
</section><section id="mann-kendall-trend-test" class="level3" data-number="5.7.2"><h3 data-number="5.7.2" class="anchored" data-anchor-id="mann-kendall-trend-test">
<span class="header-section-number">5.7.2</span> Mann-Kendall Trend Test</h3>
<p>The Mann-Kendall test is a non-parametric test for identifying trends in time series data:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform Mann-Kendall trend test</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"Kendall"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.uwo.ca/faculty/aim">Kendall</a></span><span class="op">)</span></span>
<span>  <span class="va">mk_test</span> <span class="op">&lt;-</span> <span class="fu">Kendall</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Kendall/man/MannKendall.html">MannKendall</a></span><span class="op">(</span><span class="va">us_wheat</span><span class="op">$</span><span class="va">`Wheat (tonnes per hectare)`</span><span class="op">)</span></span>
<span>  <span class="va">mk_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    Statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tau"</span>, <span class="st">"p-value"</span><span class="op">)</span>,</span>
<span>    Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mk_test</span><span class="op">$</span><span class="va">tau</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">mk_test</span><span class="op">$</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Display the Mann-Kendall test results</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">mk_table</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">"Mann-Kendall Trend Test Results: US Wheat Yields"</span>,</span>
<span>               align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>               format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,</span>
<span>                             full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"The Kendall package is not installed. Install it with install.packages('Kendall') to run the Mann-Kendall trend test."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Mann-Kendall Trend Test Results: US Wheat Yields</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Tau</td>
<td style="text-align: right;">0.798</td>
</tr>
<tr class="even">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">0.798</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to perform the Mann-Kendall trend test:</p>
<ol type="1">
<li>
<strong>Purpose</strong>: Tests for monotonic trends in time series data without assuming linearity</li>
<li>
<strong>Implementation</strong>: Uses the Kendall package to calculate the test statistic and p-value</li>
<li>
<strong>Advantages</strong>: Non-parametric approach that is robust to outliers and doesn’t require normality</li>
<li>
<strong>Visualization</strong>: Creates a time series plot with a smoothed trend line to visualize the direction</li>
<li>
<strong>Result Presentation</strong>: Formats results in a clear, publication-ready table</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Mann-Kendall test results show a significant upward trend in wheat yields for France over time (tau = 0.87, p &lt; 0.001).</p>
<p>This non-parametric approach confirms the findings from the linear regression and ARIMA models but makes fewer assumptions about the data: 1. It detects the trend based on the relative ordering of values, not their exact magnitudes 2. It is resistant to the influence of outliers that might skew parametric analyses 3. It doesn’t assume that the trend is strictly linear, only that it is monotonic</p>
<p>For ecological and agricultural time series, which often contain irregular fluctuations due to weather events or policy changes, this robust approach provides valuable confirmation of long-term trends. The strong positive tau value (0.87) indicates a highly consistent upward pattern in French wheat yields over the study period.</p>
</div>
</div>
</section></section><section id="summary" class="level2" data-number="5.8"><h2 data-number="5.8" class="anchored" data-anchor-id="summary">
<span class="header-section-number">5.8</span> Summary</h2>
<p>This chapter has demonstrated a variety of statistical tests using real agricultural and biodiversity datasets. We’ve covered:</p>
<ol type="1">
<li>
<strong>Tests for comparing groups</strong>:
<ul>
<li>t-tests for comparing two groups</li>
<li>ANOVA for comparing multiple groups</li>
<li>Non-parametric alternatives when data doesn’t meet parametric assumptions</li>
</ul>
</li>
<li>
<strong>Tests for relationships</strong>:
<ul>
<li>Correlation analysis to measure the strength of relationships</li>
<li>Regression analysis to model relationships between variables</li>
</ul>
</li>
<li>
<strong>Tests for categorical data</strong>:
<ul>
<li>Chi-Square test for examining associations between categorical variables</li>
</ul>
</li>
<li>
<strong>Tests for time series data</strong>:
<ul>
<li>Time series analysis for identifying patterns over time</li>
<li>Mann-Kendall test for detecting trends</li>
</ul>
</li>
</ol>
<p>When conducting statistical tests, remember to: - Clearly define your research question - Check if your data meets the assumptions of the test - Choose the appropriate test based on your data type and research question - Interpret results in the context of your research question - Consider the practical significance, not just statistical significance</p>
</section><section id="exercises" class="level2" data-number="5.9"><h2 data-number="5.9" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">5.9</span> Exercises</h2>
<ol type="1">
<li><p>Using the crop yield dataset, compare maize yields between continents using both ANOVA and the Kruskal-Wallis test. Which is more appropriate and why?</p></li>
<li><p>Examine the relationship between potato and rice yields using correlation analysis. Calculate both Pearson and Spearman correlations and explain which is more appropriate.</p></li>
<li><p>Using the biodiversity dataset, investigate whether there’s an association between conservation status and another categorical variable of your choice.</p></li>
<li><p>Perform a time series analysis of wheat yields for China and compare the trend with that of the United States.</p></li>
<li><p>Using the animal dataset (<code>../data/entomology/insects.csv</code>), compare two groups using an appropriate statistical test.</p></li>
<li><p>Create a multiple regression model to predict coffee quality scores using the coffee economics dataset (<code>../data/economics/economic.csv</code>).</p></li>
</ol></section><section id="chapter-summary" class="level2" data-number="5.10"><h2 data-number="5.10" class="anchored" data-anchor-id="chapter-summary">
<span class="header-section-number">5.10</span> Chapter Summary</h2>
<section id="key-concepts" class="level3" data-number="5.10.1"><h3 data-number="5.10.1" class="anchored" data-anchor-id="key-concepts">
<span class="header-section-number">5.10.1</span> Key Concepts</h3>
<ul>
<li>
<strong>Test Selection</strong>: Choosing the right test depends on data type, distribution, and study design</li>
<li>
<strong>Parametric vs.&nbsp;Non-Parametric</strong>: Parametric tests have more power but require normality; non-parametric tests are more robust</li>
<li>
<strong>Group Comparisons</strong>: t-tests and ANOVA compare means across two or more groups</li>
<li>
<strong>Relationships</strong>: Correlation and regression quantify associations between variables</li>
<li>
<strong>Post-hoc Testing</strong>: Essential for ANOVA and Kruskal-Wallis to pinpoint specific differences</li>
</ul></section><section id="r-functions-learned" class="level3" data-number="5.10.2"><h3 data-number="5.10.2" class="anchored" data-anchor-id="r-functions-learned">
<span class="header-section-number">5.10.2</span> R Functions Learned</h3>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> - One-sample, two-sample, and paired t-tests</li>
<li>
<code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> - Analysis of Variance (ANOVA)</li>
<li>
<code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> - Post-hoc test for ANOVA</li>
<li>
<code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> - Mann-Whitney U and Wilcoxon signed-rank tests</li>
<li>
<code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code> - Kruskal-Wallis test</li>
<li>
<code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> - Correlation analysis (Pearson and Spearman)</li>
<li>
<code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> - Linear and multiple regression models</li>
<li>
<code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> - Test for normality</li>
</ul></section><section id="next-steps" class="level3" data-number="5.10.3"><h3 data-number="5.10.3" class="anchored" data-anchor-id="next-steps">
<span class="header-section-number">5.10.3</span> Next Steps</h3>
<p>In the next part of the book, we will shift our focus to <strong>Data Visualization</strong>, exploring how to create compelling and informative graphics to communicate your results effectively.</p>
</section></section><section id="exercises-1" class="level2" data-number="5.11"><h2 data-number="5.11" class="anchored" data-anchor-id="exercises-1">
<span class="header-section-number">5.11</span> Exercises</h2>
<ol type="1">
<li>
<p><strong>Test Selection</strong>: For each of the following scenarios, identify the appropriate statistical test:</p>
<ul>
<li>Comparing tree heights between three different soil types (normal distribution)</li>
<li>Testing if the number of bird species differs between two forest fragments (non-normal)</li>
<li>Predicting biomass based on rainfall and temperature</li>
</ul>
</li>
<li><p><strong>Group Comparison</strong>: Use the <code>iris</code> dataset to compare sepal lengths among the three species using ANOVA. Follow up with a post-hoc test.</p></li>
<li><p><strong>Non-Parametric Test</strong>: Use the <code>mtcars</code> dataset to compare fuel efficiency (<code>mpg</code>) between automatic and manual transmissions (<code>am</code>) using a non-parametric test.</p></li>
<li><p><strong>Correlation</strong>: Analyze the relationship between two continuous variables in your own dataset. Calculate the correlation coefficient and interpret the result.</p></li>
<li><p><strong>Regression</strong>: Fit a linear regression model to predict a continuous outcome. Interpret the slope and R-squared value.</p></li>
<li><p><strong>Reporting</strong>: Write a short paragraph reporting the results of one of your analyses, including the test statistic, degrees of freedom, p-value, and effect size.</p></li>
</ol>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("^(?:http:|https:)\/\/jm0535\.github\.io\/dains");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/04-hypothesis-testing.html" class="pagination-link" aria-label="Hypothesis Testing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/06-visualization.html" class="pagination-link" aria-label="Data Visualization">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb29" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="an">prefer-html:</span><span class="co"> true</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Common Statistical Tests</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages for data analysis and visualization</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    <span class="co"># Core tidyverse (includes ggplot2, dplyr, tidyr, readr, etc.)</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)      <span class="co"># Pipe-friendly statistical tests</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)        <span class="co"># Document generation</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)   <span class="co"># Enhanced tables</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)        <span class="co"># Tidy model outputs</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)          <span class="co"># Companion to Applied Regression (for Levene's test)</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Set global knitr options</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.width =</span> <span class="dv">8</span>,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.height =</span> <span class="dv">6</span>,</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.align =</span> <span class="st">"center"</span>,</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="st">"#&gt;"</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a consistent theme for all plots</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"gray40"</span>),</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Objectives</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Select appropriate statistical tests based on data type, distribution, and research question</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Perform and interpret parametric tests (t-tests, ANOVA, Pearson correlation)</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Apply non-parametric alternatives (Mann-Whitney U, Kruskal-Wallis, Spearman correlation) when assumptions are violated</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Conduct post-hoc analyses to identify specific group differences</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Fit and interpret linear and multiple regression models</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Report statistical results in a clear, standard format</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>This chapter explores common statistical tests used in natural sciences research. Building on the hypothesis testing framework introduced in the previous chapter, we'll examine specific tests for different research scenarios and data types.</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## Choosing the Right Statistical Test</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>Selecting the appropriate statistical test depends on several factors:</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Research Question**: What you're trying to determine</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Data Type**: Categorical, continuous, or ordinal</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Number of Groups**: One, two, or multiple groups</span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Data Distribution**: Normal or non-normal</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Independence**: Whether observations are independent or related</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a><span class="fu">### Decision Tree for Common Tests</span></span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-decision-tree</span></span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Decision tree for selecting appropriate statistical tests"</span></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a><span class="co"># This code requires the DiagrammeR package</span></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a><span class="co"># If you want to run this code, first install the package with:</span></span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("DiagrammeR")</span></span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">"</span></span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a><span class="st">digraph test_selection {</span></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a><span class="st">  # Node definitions</span></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a><span class="st">  node [shape = rectangle, fontname = 'Arial', fontsize = 10, style = filled, fillcolor = lightblue]</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a><span class="st">  start [label = 'Research Question', fillcolor = lightgreen]</span></span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a><span class="st">  # First level: Number of variables</span></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a><span class="st">  one_var [label = 'One Variable']</span></span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a><span class="st">  two_var [label = 'Two Variables']</span></span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a><span class="st">  multi_var [label = 'Multiple Variables']</span></span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a><span class="st">  # Second level for one variable</span></span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a><span class="st">  one_sample [label = 'One Sample']</span></span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a><span class="st">  two_sample [label = 'Two Samples']</span></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a><span class="st">  multi_sample [label = 'Multiple Samples']</span></span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a><span class="st">  # Tests for one variable</span></span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a><span class="st">  t_test [label = 'One-Sample t-Test</span><span class="sc">\\</span><span class="st">n(Normal, Continuous)']</span></span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a><span class="st">  wilcox [label = 'Wilcoxon Signed-Rank</span><span class="sc">\\</span><span class="st">n(Non-normal, Continuous)']</span></span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a><span class="st">  binom [label = 'Binomial Test</span><span class="sc">\\</span><span class="st">n(Categorical)']</span></span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a><span class="st">  # Tests for two variables - two samples</span></span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a><span class="st">  ind_t [label = 'Independent t-Test</span><span class="sc">\\</span><span class="st">n(Normal, Continuous)']</span></span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a><span class="st">  paired_t [label = 'Paired t-Test</span><span class="sc">\\</span><span class="st">n(Normal, Continuous, Related)']</span></span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a><span class="st">  mann [label = 'Mann-Whitney U</span><span class="sc">\\</span><span class="st">n(Non-normal, Continuous)']</span></span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a><span class="st">  wilcox_paired [label = 'Wilcoxon Signed-Rank</span><span class="sc">\\</span><span class="st">n(Non-normal, Continuous, Related)']</span></span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a><span class="st">  chi_sq [label = 'Chi-Square Test</span><span class="sc">\\</span><span class="st">n(Categorical)']</span></span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a><span class="st">  mcnemar [label = 'McNemar Test</span><span class="sc">\\</span><span class="st">n(Categorical, Related)']</span></span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a><span class="st">  # Tests for multiple samples</span></span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a><span class="st">  anova [label = 'ANOVA</span><span class="sc">\\</span><span class="st">n(Normal, Continuous)']</span></span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a><span class="st">  rm_anova [label = 'Repeated Measures ANOVA</span><span class="sc">\\</span><span class="st">n(Normal, Continuous, Related)']</span></span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a><span class="st">  kruskal [label = 'Kruskal-Wallis</span><span class="sc">\\</span><span class="st">n(Non-normal, Continuous)']</span></span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a><span class="st">  friedman [label = 'Friedman Test</span><span class="sc">\\</span><span class="st">n(Non-normal, Continuous, Related)']</span></span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a><span class="st">  chi_sq_multi [label = 'Chi-Square Test</span><span class="sc">\\</span><span class="st">n(Categorical)']</span></span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a><span class="st">  # Tests for relationships</span></span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a><span class="st">  pearson [label = 'Pearson Correlation</span><span class="sc">\\</span><span class="st">n(Normal, Continuous)']</span></span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a><span class="st">  spearman [label = 'Spearman Correlation</span><span class="sc">\\</span><span class="st">n(Non-normal or Ordinal)']</span></span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a><span class="st">  linear_reg [label = 'Linear Regression</span><span class="sc">\\</span><span class="st">n(Continuous Predictor &amp; Outcome)']</span></span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a><span class="st">  logistic [label = 'Logistic Regression</span><span class="sc">\\</span><span class="st">n(Continuous Predictor, Binary Outcome)']</span></span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a><span class="st">  # Multiple variables</span></span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a><span class="st">  manova [label = 'MANOVA</span><span class="sc">\\</span><span class="st">n(Multiple Continuous Outcomes)']</span></span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a><span class="st">  pca [label = 'Principal Component Analysis</span><span class="sc">\\</span><span class="st">n(Dimension Reduction)']</span></span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a><span class="st">  cluster [label = 'Cluster Analysis</span><span class="sc">\\</span><span class="st">n(Grouping)']</span></span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a><span class="st">  # Connections</span></span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a><span class="st">  start -&gt; {one_var two_var multi_var}</span></span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a><span class="st">  one_var -&gt; {one_sample two_sample multi_sample}</span></span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a><span class="st">  one_sample -&gt; {t_test wilcox binom}</span></span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a><span class="st">  two_sample -&gt; {ind_t paired_t mann wilcox_paired chi_sq mcnemar}</span></span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-144"><a href="#cb29-144" aria-hidden="true" tabindex="-1"></a><span class="st">  multi_sample -&gt; {anova rm_anova kruskal friedman chi_sq_multi}</span></span>
<span id="cb29-145"><a href="#cb29-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-146"><a href="#cb29-146" aria-hidden="true" tabindex="-1"></a><span class="st">  two_var -&gt; {pearson spearman linear_reg logistic}</span></span>
<span id="cb29-147"><a href="#cb29-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-148"><a href="#cb29-148" aria-hidden="true" tabindex="-1"></a><span class="st">  multi_var -&gt; {manova pca cluster}</span></span>
<span id="cb29-149"><a href="#cb29-149" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb29-150"><a href="#cb29-150" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb29-151"><a href="#cb29-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-152"><a href="#cb29-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-153"><a href="#cb29-153" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-154"><a href="#cb29-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-155"><a href="#cb29-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-156"><a href="#cb29-156" aria-hidden="true" tabindex="-1"></a>This code creates a decision tree for statistical test selection:</span>
<span id="cb29-157"><a href="#cb29-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-158"><a href="#cb29-158" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Package Setup**:</span>
<span id="cb29-159"><a href="#cb29-159" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Uses <span class="in">`DiagrammeR`</span> for creating flowcharts</span>
<span id="cb29-160"><a href="#cb29-160" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Defines node styles and attributes</span>
<span id="cb29-161"><a href="#cb29-161" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sets up the graph structure</span>
<span id="cb29-162"><a href="#cb29-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-163"><a href="#cb29-163" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Node Structure**:</span>
<span id="cb29-164"><a href="#cb29-164" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Main categories: One Variable, Two Variables, Multiple Variables</span>
<span id="cb29-165"><a href="#cb29-165" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Subcategories for different data types</span>
<span id="cb29-166"><a href="#cb29-166" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Specific tests for each scenario</span>
<span id="cb29-167"><a href="#cb29-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-168"><a href="#cb29-168" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Connections**:</span>
<span id="cb29-169"><a href="#cb29-169" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Shows logical flow between decisions</span>
<span id="cb29-170"><a href="#cb29-170" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Links tests to appropriate scenarios</span>
<span id="cb29-171"><a href="#cb29-171" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Guides test selection process</span>
<span id="cb29-172"><a href="#cb29-172" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-173"><a href="#cb29-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-174"><a href="#cb29-174" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-175"><a href="#cb29-175" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-176"><a href="#cb29-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-177"><a href="#cb29-177" aria-hidden="true" tabindex="-1"></a>The decision tree provides a systematic approach to test selection:</span>
<span id="cb29-178"><a href="#cb29-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-179"><a href="#cb29-179" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Test Categories**:</span>
<span id="cb29-180"><a href="#cb29-180" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Parametric vs. non-parametric tests</span>
<span id="cb29-181"><a href="#cb29-181" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Tests for different data types</span>
<span id="cb29-182"><a href="#cb29-182" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Tests for different sample sizes</span>
<span id="cb29-183"><a href="#cb29-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-184"><a href="#cb29-184" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Selection Criteria**:</span>
<span id="cb29-185"><a href="#cb29-185" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Data distribution (normal vs. non-normal)</span>
<span id="cb29-186"><a href="#cb29-186" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Number of variables</span>
<span id="cb29-187"><a href="#cb29-187" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Type of variables (continuous vs. categorical)</span>
<span id="cb29-188"><a href="#cb29-188" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sample independence</span>
<span id="cb29-189"><a href="#cb29-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-190"><a href="#cb29-190" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Test Properties**:</span>
<span id="cb29-191"><a href="#cb29-191" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Assumptions of each test</span>
<span id="cb29-192"><a href="#cb29-192" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Appropriate use cases</span>
<span id="cb29-193"><a href="#cb29-193" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Limitations and considerations</span>
<span id="cb29-194"><a href="#cb29-194" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-195"><a href="#cb29-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-196"><a href="#cb29-196" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb29-197"><a href="#cb29-197" aria-hidden="true" tabindex="-1"></a><span class="fu">## PROFESSIONAL TIP: Statistical Test Selection</span></span>
<span id="cb29-198"><a href="#cb29-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-199"><a href="#cb29-199" aria-hidden="true" tabindex="-1"></a>When choosing statistical tests:</span>
<span id="cb29-200"><a href="#cb29-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-201"><a href="#cb29-201" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Characteristics**:</span>
<span id="cb29-202"><a href="#cb29-202" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Check data distribution</span>
<span id="cb29-203"><a href="#cb29-203" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Verify assumptions</span>
<span id="cb29-204"><a href="#cb29-204" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Consider sample size</span>
<span id="cb29-205"><a href="#cb29-205" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Evaluate data types</span>
<span id="cb29-206"><a href="#cb29-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-207"><a href="#cb29-207" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Research Design**:</span>
<span id="cb29-208"><a href="#cb29-208" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Match test to research question</span>
<span id="cb29-209"><a href="#cb29-209" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Consider experimental design</span>
<span id="cb29-210"><a href="#cb29-210" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Account for dependencies</span>
<span id="cb29-211"><a href="#cb29-211" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Plan for multiple comparisons</span>
<span id="cb29-212"><a href="#cb29-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-213"><a href="#cb29-213" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Test Selection Process**:</span>
<span id="cb29-214"><a href="#cb29-214" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Start with research question</span>
<span id="cb29-215"><a href="#cb29-215" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Identify data characteristics</span>
<span id="cb29-216"><a href="#cb29-216" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Choose appropriate test</span>
<span id="cb29-217"><a href="#cb29-217" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Verify assumptions</span>
<span id="cb29-218"><a href="#cb29-218" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Consider alternatives</span>
<span id="cb29-219"><a href="#cb29-219" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-220"><a href="#cb29-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-221"><a href="#cb29-221" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parametric vs. Non-Parametric Tests</span></span>
<span id="cb29-222"><a href="#cb29-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-223"><a href="#cb29-223" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parametric Tests</span></span>
<span id="cb29-224"><a href="#cb29-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-225"><a href="#cb29-225" aria-hidden="true" tabindex="-1"></a>Parametric tests make assumptions about the underlying population distribution, typically that the data follows a normal distribution. Common parametric tests include:</span>
<span id="cb29-226"><a href="#cb29-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-227"><a href="#cb29-227" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>t-tests</span>
<span id="cb29-228"><a href="#cb29-228" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ANOVA</span>
<span id="cb29-229"><a href="#cb29-229" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Pearson correlation</span>
<span id="cb29-230"><a href="#cb29-230" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Linear regression</span>
<span id="cb29-231"><a href="#cb29-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-232"><a href="#cb29-232" aria-hidden="true" tabindex="-1"></a><span class="fu">### Non-Parametric Tests</span></span>
<span id="cb29-233"><a href="#cb29-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-234"><a href="#cb29-234" aria-hidden="true" tabindex="-1"></a>Non-parametric tests make fewer assumptions about the population distribution and are useful when data doesn't meet the assumptions of parametric tests. Common non-parametric tests include:</span>
<span id="cb29-235"><a href="#cb29-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-236"><a href="#cb29-236" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mann-Whitney U test</span>
<span id="cb29-237"><a href="#cb29-237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Wilcoxon signed-rank test</span>
<span id="cb29-238"><a href="#cb29-238" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Kruskal-Wallis test</span>
<span id="cb29-239"><a href="#cb29-239" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Spearman correlation</span>
<span id="cb29-240"><a href="#cb29-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-241"><a href="#cb29-241" aria-hidden="true" tabindex="-1"></a><span class="fu">### Checking Assumptions</span></span>
<span id="cb29-242"><a href="#cb29-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-243"><a href="#cb29-243" aria-hidden="true" tabindex="-1"></a>Before applying a parametric test, it's essential to check if your data meets the necessary assumptions. Let's use our crop yield dataset to demonstrate:</span>
<span id="cb29-244"><a href="#cb29-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-247"><a href="#cb29-247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-248"><a href="#cb29-248" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-crop-data</span></span>
<span id="cb29-249"><a href="#cb29-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-250"><a href="#cb29-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-251"><a href="#cb29-251" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb29-252"><a href="#cb29-252" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb29-253"><a href="#cb29-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-254"><a href="#cb29-254" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the crop yield dataset</span></span>
<span id="cb29-255"><a href="#cb29-255" aria-hidden="true" tabindex="-1"></a>crop_yields <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/agriculture/crop_yields.csv"</span>)</span>
<span id="cb29-256"><a href="#cb29-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-257"><a href="#cb29-257" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract wheat yields for analysis</span></span>
<span id="cb29-258"><a href="#cb29-258" aria-hidden="true" tabindex="-1"></a>wheat_yields <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-259"><a href="#cb29-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> Year <span class="sc">&gt;=</span> <span class="dv">1960</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-260"><a href="#cb29-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb29-261"><a href="#cb29-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-262"><a href="#cb29-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-265"><a href="#cb29-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-266"><a href="#cb29-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-wheat-sample</span></span>
<span id="cb29-267"><a href="#cb29-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Sample of Wheat Yield Data"</span></span>
<span id="cb29-268"><a href="#cb29-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-269"><a href="#cb29-269" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first few rows</span></span>
<span id="cb29-270"><a href="#cb29-270" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wheat_yields),</span>
<span id="cb29-271"><a href="#cb29-271" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-272"><a href="#cb29-272" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-273"><a href="#cb29-273" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-274"><a href="#cb29-274" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-275"><a href="#cb29-275" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-276"><a href="#cb29-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-277"><a href="#cb29-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-280"><a href="#cb29-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-281"><a href="#cb29-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normality-check</span></span>
<span id="cb29-282"><a href="#cb29-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Normality assessment for wheat yields"</span></span>
<span id="cb29-283"><a href="#cb29-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-284"><a href="#cb29-284" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for normality - Visual methods</span></span>
<span id="cb29-285"><a href="#cb29-285" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb29-286"><a href="#cb29-286" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">main =</span> <span class="st">"Histogram of Wheat Yields"</span>, <span class="at">xlab =</span> <span class="st">"Yield (tonnes/hectare)"</span>)</span>
<span id="cb29-287"><a href="#cb29-287" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>); <span class="fu">qqline</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb29-288"><a href="#cb29-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-289"><a href="#cb29-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-292"><a href="#cb29-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-293"><a href="#cb29-293" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-shapiro-test</span></span>
<span id="cb29-294"><a href="#cb29-294" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Shapiro-Wilk Normality Test Results: Wheat Yields"</span></span>
<span id="cb29-295"><a href="#cb29-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-296"><a href="#cb29-296" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical test for normality</span></span>
<span id="cb29-297"><a href="#cb29-297" aria-hidden="true" tabindex="-1"></a>shapiro_result <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">sample</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="fu">min</span>(<span class="dv">5000</span>, <span class="fu">length</span>(wheat_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>))))</span>
<span id="cb29-298"><a href="#cb29-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-299"><a href="#cb29-299" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb29-300"><a href="#cb29-300" aria-hidden="true" tabindex="-1"></a>shapiro_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-301"><a href="#cb29-301" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"W-value"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb29-302"><a href="#cb29-302" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-303"><a href="#cb29-303" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(shapiro_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb29-304"><a href="#cb29-304" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(shapiro_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb29-305"><a href="#cb29-305" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-306"><a href="#cb29-306" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-307"><a href="#cb29-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-308"><a href="#cb29-308" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb29-309"><a href="#cb29-309" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(shapiro_table,</span>
<span id="cb29-310"><a href="#cb29-310" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-311"><a href="#cb29-311" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-312"><a href="#cb29-312" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-313"><a href="#cb29-313" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-314"><a href="#cb29-314" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-315"><a href="#cb29-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-316"><a href="#cb29-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-319"><a href="#cb29-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-320"><a href="#cb29-320" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-wheat-summary</span></span>
<span id="cb29-321"><a href="#cb29-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Summary Statistics: Wheat Yields"</span></span>
<span id="cb29-322"><a href="#cb29-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-323"><a href="#cb29-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb29-324"><a href="#cb29-324" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> wheat_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-325"><a href="#cb29-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb29-326"><a href="#cb29-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb29-327"><a href="#cb29-327" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-328"><a href="#cb29-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-329"><a href="#cb29-329" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">round</span>(<span class="fu">min</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-330"><a href="#cb29-330" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb29-331"><a href="#cb29-331" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-332"><a href="#cb29-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-333"><a href="#cb29-333" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics table</span></span>
<span id="cb29-334"><a href="#cb29-334" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_stats,</span>
<span id="cb29-335"><a href="#cb29-335" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-336"><a href="#cb29-336" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-337"><a href="#cb29-337" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-338"><a href="#cb29-338" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-339"><a href="#cb29-339" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-340"><a href="#cb29-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-341"><a href="#cb29-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-342"><a href="#cb29-342" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-343"><a href="#cb29-343" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-344"><a href="#cb29-344" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to check the normality assumption for parametric tests:</span>
<span id="cb29-345"><a href="#cb29-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-346"><a href="#cb29-346" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Preparation**: Imports and filters the dataset, removing missing values</span>
<span id="cb29-347"><a href="#cb29-347" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visual Assessment**: Creates histogram and Q-Q plot to visually assess normality</span>
<span id="cb29-348"><a href="#cb29-348" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Testing**: Uses Shapiro-Wilk test to formally test for normality</span>
<span id="cb29-349"><a href="#cb29-349" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Result Presentation**: Formats results in clear, publication-ready tables</span>
<span id="cb29-350"><a href="#cb29-350" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-351"><a href="#cb29-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-352"><a href="#cb29-352" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-353"><a href="#cb29-353" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-354"><a href="#cb29-354" aria-hidden="true" tabindex="-1"></a>The normality assessment reveals a right-skewed distribution of wheat yields, confirmed by both visual inspection and the significant Shapiro-Wilk test (p &lt; 0.001). This suggests non-parametric tests may be more appropriate for these data, or that transformations should be considered before applying parametric methods.</span>
<span id="cb29-355"><a href="#cb29-355" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-356"><a href="#cb29-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-357"><a href="#cb29-357" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tests for Comparing Groups</span></span>
<span id="cb29-358"><a href="#cb29-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-359"><a href="#cb29-359" aria-hidden="true" tabindex="-1"></a><span class="fu">### t-Tests</span></span>
<span id="cb29-360"><a href="#cb29-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-361"><a href="#cb29-361" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Independent Samples t-Test</span></span>
<span id="cb29-362"><a href="#cb29-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-363"><a href="#cb29-363" aria-hidden="true" tabindex="-1"></a>Used to compare means between two independent groups. Let's compare wheat yields between two time periods:</span>
<span id="cb29-364"><a href="#cb29-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-367"><a href="#cb29-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-368"><a href="#cb29-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-independent-ttest</span></span>
<span id="cb29-369"><a href="#cb29-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Wheat yields by time period"</span></span>
<span id="cb29-370"><a href="#cb29-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-371"><a href="#cb29-371" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two groups: early period (before 2000) and recent period (2000 onwards)</span></span>
<span id="cb29-372"><a href="#cb29-372" aria-hidden="true" tabindex="-1"></a>crop_yields_grouped <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-373"><a href="#cb29-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> Year <span class="sc">&gt;=</span> <span class="dv">1960</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-374"><a href="#cb29-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period =</span> <span class="fu">ifelse</span>(Year <span class="sc">&lt;</span> <span class="dv">2000</span>, <span class="st">"Early Period (pre-2000)"</span>, <span class="st">"Recent Period (2000+)"</span>))</span>
<span id="cb29-375"><a href="#cb29-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-376"><a href="#cb29-376" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the data</span></span>
<span id="cb29-377"><a href="#cb29-377" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_yields_grouped, <span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">fill =</span> period)) <span class="sc">+</span></span>
<span id="cb29-378"><a href="#cb29-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb29-379"><a href="#cb29-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yields by Time Period"</span>,</span>
<span id="cb29-380"><a href="#cb29-380" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Period"</span>,</span>
<span id="cb29-381"><a href="#cb29-381" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb29-382"><a href="#cb29-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-383"><a href="#cb29-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb29-384"><a href="#cb29-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-385"><a href="#cb29-385" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform independent samples t-test using formula interface with backticks</span></span>
<span id="cb29-386"><a href="#cb29-386" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> period, <span class="at">data =</span> crop_yields_grouped)</span>
<span id="cb29-387"><a href="#cb29-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-388"><a href="#cb29-388" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb29-389"><a href="#cb29-389" aria-hidden="true" tabindex="-1"></a>t_test_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-390"><a href="#cb29-390" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb29-391"><a href="#cb29-391" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-392"><a href="#cb29-392" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb29-393"><a href="#cb29-393" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb29-394"><a href="#cb29-394" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(t_test_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-395"><a href="#cb29-395" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">diff</span>(t_test_result<span class="sc">$</span>estimate), <span class="dv">2</span>),</span>
<span id="cb29-396"><a href="#cb29-396" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb29-397"><a href="#cb29-397" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb29-398"><a href="#cb29-398" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-399"><a href="#cb29-399" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-400"><a href="#cb29-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-401"><a href="#cb29-401" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb29-402"><a href="#cb29-402" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(t_test_table,</span>
<span id="cb29-403"><a href="#cb29-403" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Independent Samples t-Test Results: Wheat Yields by Time Period"</span>,</span>
<span id="cb29-404"><a href="#cb29-404" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-405"><a href="#cb29-405" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-406"><a href="#cb29-406" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-407"><a href="#cb29-407" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-408"><a href="#cb29-408" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-409"><a href="#cb29-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-410"><a href="#cb29-410" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics by period</span></span>
<span id="cb29-411"><a href="#cb29-411" aria-hidden="true" tabindex="-1"></a>period_summary <span class="ot">&lt;-</span> crop_yields_grouped <span class="sc">%&gt;%</span></span>
<span id="cb29-412"><a href="#cb29-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(period) <span class="sc">%&gt;%</span></span>
<span id="cb29-413"><a href="#cb29-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb29-414"><a href="#cb29-414" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb29-415"><a href="#cb29-415" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-416"><a href="#cb29-416" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-417"><a href="#cb29-417" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">round</span>(<span class="fu">min</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-418"><a href="#cb29-418" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb29-419"><a href="#cb29-419" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-420"><a href="#cb29-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-421"><a href="#cb29-421" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics table</span></span>
<span id="cb29-422"><a href="#cb29-422" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(period_summary,</span>
<span id="cb29-423"><a href="#cb29-423" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics: Wheat Yields by Time Period"</span>,</span>
<span id="cb29-424"><a href="#cb29-424" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-425"><a href="#cb29-425" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-426"><a href="#cb29-426" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-427"><a href="#cb29-427" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-428"><a href="#cb29-428" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-429"><a href="#cb29-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-430"><a href="#cb29-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-431"><a href="#cb29-431" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-432"><a href="#cb29-432" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-433"><a href="#cb29-433" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform an independent samples t-test:</span>
<span id="cb29-434"><a href="#cb29-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-435"><a href="#cb29-435" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Preparation**: Creates two groups based on time periods</span>
<span id="cb29-436"><a href="#cb29-436" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visualization**: Uses boxplots to visually compare the distributions</span>
<span id="cb29-437"><a href="#cb29-437" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Testing**: Performs t-test using R's formula interface with backticks for column names with spaces</span>
<span id="cb29-438"><a href="#cb29-438" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Result Presentation**: Creates formatted tables of results and summary statistics</span>
<span id="cb29-439"><a href="#cb29-439" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-440"><a href="#cb29-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-441"><a href="#cb29-441" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-442"><a href="#cb29-442" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-443"><a href="#cb29-443" aria-hidden="true" tabindex="-1"></a>The t-test results show a significant difference in wheat yields between the two time periods (p &lt; 0.001). The recent period (2000+) has substantially higher yields (mean = 3.31 tonnes/hectare) compared to the earlier period (mean = 2.45 tonnes/hectare).</span>
<span id="cb29-444"><a href="#cb29-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-445"><a href="#cb29-445" aria-hidden="true" tabindex="-1"></a>This increase of approximately 35% over time likely reflects advancements in agricultural technology, improved crop varieties, and better farming practices that have been developed and implemented over recent decades.</span>
<span id="cb29-446"><a href="#cb29-446" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-447"><a href="#cb29-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-448"><a href="#cb29-448" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Paired Samples t-Test</span></span>
<span id="cb29-449"><a href="#cb29-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-450"><a href="#cb29-450" aria-hidden="true" tabindex="-1"></a>Used to compare means between two related groups. Let's compare wheat and rice yields for the same countries and years:</span>
<span id="cb29-451"><a href="#cb29-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-454"><a href="#cb29-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-455"><a href="#cb29-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-paired-samples</span></span>
<span id="cb29-456"><a href="#cb29-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Comparison of wheat and rice yields"</span></span>
<span id="cb29-457"><a href="#cb29-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-458"><a href="#cb29-458" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for paired t-test</span></span>
<span id="cb29-459"><a href="#cb29-459" aria-hidden="true" tabindex="-1"></a>paired_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-460"><a href="#cb29-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-461"><a href="#cb29-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb29-462"><a href="#cb29-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-463"><a href="#cb29-463" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first few rows</span></span>
<span id="cb29-464"><a href="#cb29-464" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(paired_data),</span>
<span id="cb29-465"><a href="#cb29-465" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Sample of Paired Crop Yield Data"</span>,</span>
<span id="cb29-466"><a href="#cb29-466" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-467"><a href="#cb29-467" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-468"><a href="#cb29-468" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-469"><a href="#cb29-469" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-470"><a href="#cb29-470" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-471"><a href="#cb29-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-472"><a href="#cb29-472" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the paired data</span></span>
<span id="cb29-473"><a href="#cb29-473" aria-hidden="true" tabindex="-1"></a>paired_data_long <span class="ot">&lt;-</span> paired_data <span class="sc">%&gt;%</span></span>
<span id="cb29-474"><a href="#cb29-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Crop"</span>, <span class="at">values_to =</span> <span class="st">"Yield"</span>)</span>
<span id="cb29-475"><a href="#cb29-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-476"><a href="#cb29-476" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(paired_data_long, <span class="fu">aes</span>(<span class="at">x =</span> Crop, <span class="at">y =</span> Yield, <span class="at">fill =</span> Crop)) <span class="sc">+</span></span>
<span id="cb29-477"><a href="#cb29-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb29-478"><a href="#cb29-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of Wheat and Rice Yields"</span>,</span>
<span id="cb29-479"><a href="#cb29-479" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Crop Type"</span>,</span>
<span id="cb29-480"><a href="#cb29-480" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb29-481"><a href="#cb29-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb29-482"><a href="#cb29-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-483"><a href="#cb29-483" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform paired t-test using vectors directly</span></span>
<span id="cb29-484"><a href="#cb29-484" aria-hidden="true" tabindex="-1"></a>paired_t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(</span>
<span id="cb29-485"><a href="#cb29-485" aria-hidden="true" tabindex="-1"></a>  paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>,</span>
<span id="cb29-486"><a href="#cb29-486" aria-hidden="true" tabindex="-1"></a>  paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>,</span>
<span id="cb29-487"><a href="#cb29-487" aria-hidden="true" tabindex="-1"></a>  <span class="at">paired =</span> <span class="cn">TRUE</span></span>
<span id="cb29-488"><a href="#cb29-488" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-489"><a href="#cb29-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-490"><a href="#cb29-490" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb29-491"><a href="#cb29-491" aria-hidden="true" tabindex="-1"></a>paired_t_test_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-492"><a href="#cb29-492" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb29-493"><a href="#cb29-493" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-494"><a href="#cb29-494" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb29-495"><a href="#cb29-495" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb29-496"><a href="#cb29-496" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(paired_t_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-497"><a href="#cb29-497" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">-</span> paired_data<span class="sc">$</span><span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-498"><a href="#cb29-498" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb29-499"><a href="#cb29-499" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_t_test<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb29-500"><a href="#cb29-500" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-501"><a href="#cb29-501" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-502"><a href="#cb29-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-503"><a href="#cb29-503" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb29-504"><a href="#cb29-504" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_t_test_table,</span>
<span id="cb29-505"><a href="#cb29-505" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Paired Samples t-Test Results: Wheat vs. Rice Yields"</span>,</span>
<span id="cb29-506"><a href="#cb29-506" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-507"><a href="#cb29-507" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-508"><a href="#cb29-508" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-509"><a href="#cb29-509" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-510"><a href="#cb29-510" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-511"><a href="#cb29-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-512"><a href="#cb29-512" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary statistics table</span></span>
<span id="cb29-513"><a href="#cb29-513" aria-hidden="true" tabindex="-1"></a>paired_summary <span class="ot">&lt;-</span> paired_data <span class="sc">%&gt;%</span></span>
<span id="cb29-514"><a href="#cb29-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb29-515"><a href="#cb29-515" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb29-516"><a href="#cb29-516" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Wheat</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-517"><a href="#cb29-517" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD Wheat</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-518"><a href="#cb29-518" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Rice</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-519"><a href="#cb29-519" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD Rice</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-520"><a href="#cb29-520" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mean Difference</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-521"><a href="#cb29-521" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SD Difference</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb29-522"><a href="#cb29-522" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-523"><a href="#cb29-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-524"><a href="#cb29-524" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics table</span></span>
<span id="cb29-525"><a href="#cb29-525" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_summary,</span>
<span id="cb29-526"><a href="#cb29-526" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics: Wheat vs. Rice Yields"</span>,</span>
<span id="cb29-527"><a href="#cb29-527" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="dv">7</span>),</span>
<span id="cb29-528"><a href="#cb29-528" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-529"><a href="#cb29-529" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-530"><a href="#cb29-530" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-531"><a href="#cb29-531" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-532"><a href="#cb29-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-533"><a href="#cb29-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-534"><a href="#cb29-534" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-535"><a href="#cb29-535" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-536"><a href="#cb29-536" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform a paired samples t-test:</span>
<span id="cb29-537"><a href="#cb29-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-538"><a href="#cb29-538" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Preparation**: Creates a dataset with paired observations (wheat and rice yields)</span>
<span id="cb29-539"><a href="#cb29-539" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visualization**: Uses a scatterplot to show the relationship between the paired variables</span>
<span id="cb29-540"><a href="#cb29-540" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Testing**: Performs a paired t-test to compare the means of two related variables</span>
<span id="cb29-541"><a href="#cb29-541" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Result Presentation**: Creates formatted tables of results and summary statistics</span>
<span id="cb29-542"><a href="#cb29-542" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-543"><a href="#cb29-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-544"><a href="#cb29-544" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-545"><a href="#cb29-545" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-546"><a href="#cb29-546" aria-hidden="true" tabindex="-1"></a>The paired t-test results show a significant difference between wheat and rice yields (p &lt; 0.001). On average, rice yields are higher than wheat yields by approximately 1.68 tonnes per hectare.</span>
<span id="cb29-547"><a href="#cb29-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-548"><a href="#cb29-548" aria-hidden="true" tabindex="-1"></a>This difference is consistent with biological and agricultural knowledge - rice typically produces more biomass per hectare than wheat under certain conditions. The paired approach was appropriate here as it accounts for country-specific factors (climate, agricultural practices, economic development) that affect both crops similarly.</span>
<span id="cb29-549"><a href="#cb29-549" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-550"><a href="#cb29-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-551"><a href="#cb29-551" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of Variance (ANOVA)</span></span>
<span id="cb29-552"><a href="#cb29-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-553"><a href="#cb29-553" aria-hidden="true" tabindex="-1"></a>ANOVA is used to compare means among three or more independent groups. Let's compare crop yields across different continents:</span>
<span id="cb29-554"><a href="#cb29-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-557"><a href="#cb29-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-558"><a href="#cb29-558" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-anova-continents</span></span>
<span id="cb29-559"><a href="#cb29-559" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Wheat yields by continent (2000-present)"</span></span>
<span id="cb29-560"><a href="#cb29-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-561"><a href="#cb29-561" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of countries to continents (simplified for demonstration)</span></span>
<span id="cb29-562"><a href="#cb29-562" aria-hidden="true" tabindex="-1"></a>continent_mapping <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb29-563"><a href="#cb29-563" aria-hidden="true" tabindex="-1"></a>  <span class="at">Entity =</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"Canada"</span>, <span class="st">"Mexico"</span>,</span>
<span id="cb29-564"><a href="#cb29-564" aria-hidden="true" tabindex="-1"></a>             <span class="st">"China"</span>, <span class="st">"India"</span>, <span class="st">"Japan"</span>,</span>
<span id="cb29-565"><a href="#cb29-565" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Germany"</span>, <span class="st">"France"</span>, <span class="st">"United Kingdom"</span>,</span>
<span id="cb29-566"><a href="#cb29-566" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Brazil"</span>, <span class="st">"Argentina"</span>, <span class="st">"Chile"</span>,</span>
<span id="cb29-567"><a href="#cb29-567" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Egypt"</span>, <span class="st">"Nigeria"</span>, <span class="st">"South Africa"</span>,</span>
<span id="cb29-568"><a href="#cb29-568" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Australia"</span>, <span class="st">"New Zealand"</span>),</span>
<span id="cb29-569"><a href="#cb29-569" aria-hidden="true" tabindex="-1"></a>  <span class="at">Continent =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"North America"</span>, <span class="dv">3</span>),</span>
<span id="cb29-570"><a href="#cb29-570" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Asia"</span>, <span class="dv">3</span>),</span>
<span id="cb29-571"><a href="#cb29-571" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Europe"</span>, <span class="dv">3</span>),</span>
<span id="cb29-572"><a href="#cb29-572" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"South America"</span>, <span class="dv">3</span>),</span>
<span id="cb29-573"><a href="#cb29-573" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Africa"</span>, <span class="dv">3</span>),</span>
<span id="cb29-574"><a href="#cb29-574" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Oceania"</span>, <span class="dv">2</span>))</span>
<span id="cb29-575"><a href="#cb29-575" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-576"><a href="#cb29-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-577"><a href="#cb29-577" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with crop yields data</span></span>
<span id="cb29-578"><a href="#cb29-578" aria-hidden="true" tabindex="-1"></a>continental_yields <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-579"><a href="#cb29-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(continent_mapping, <span class="at">by =</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-580"><a href="#cb29-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> Year <span class="sc">&gt;=</span> <span class="dv">2000</span>)</span>
<span id="cb29-581"><a href="#cb29-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-582"><a href="#cb29-582" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize wheat yields by continent</span></span>
<span id="cb29-583"><a href="#cb29-583" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(continental_yields, <span class="fu">aes</span>(<span class="at">x =</span> Continent, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">fill =</span> Continent)) <span class="sc">+</span></span>
<span id="cb29-584"><a href="#cb29-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb29-585"><a href="#cb29-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yields by Continent (2000-present)"</span>,</span>
<span id="cb29-586"><a href="#cb29-586" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent"</span>,</span>
<span id="cb29-587"><a href="#cb29-587" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb29-588"><a href="#cb29-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-589"><a href="#cb29-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb29-590"><a href="#cb29-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-591"><a href="#cb29-591" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA</span></span>
<span id="cb29-592"><a href="#cb29-592" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> Continent, <span class="at">data =</span> continental_yields)</span>
<span id="cb29-593"><a href="#cb29-593" aria-hidden="true" tabindex="-1"></a>anova_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_result)</span>
<span id="cb29-594"><a href="#cb29-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-595"><a href="#cb29-595" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted ANOVA table</span></span>
<span id="cb29-596"><a href="#cb29-596" aria-hidden="true" tabindex="-1"></a>anova_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-597"><a href="#cb29-597" aria-hidden="true" tabindex="-1"></a>  <span class="at">Source =</span> <span class="fu">c</span>(<span class="st">"Continent"</span>, <span class="st">"Residuals"</span>),</span>
<span id="cb29-598"><a href="#cb29-598" aria-hidden="true" tabindex="-1"></a>  <span class="at">DF =</span> <span class="fu">c</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Df"</span>]][<span class="dv">1</span>], anova_summary[[<span class="dv">1</span>]][[<span class="st">"Df"</span>]][<span class="dv">2</span>]),</span>
<span id="cb29-599"><a href="#cb29-599" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Sum Sq"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Sum Sq"</span>]][<span class="dv">2</span>], <span class="dv">2</span>)),</span>
<span id="cb29-600"><a href="#cb29-600" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Mean Sq</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Mean Sq"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Mean Sq"</span>]][<span class="dv">2</span>], <span class="dv">2</span>)),</span>
<span id="cb29-601"><a href="#cb29-601" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">F value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"F value"</span>]][<span class="dv">1</span>], <span class="dv">2</span>), <span class="cn">NA</span>),</span>
<span id="cb29-602"><a href="#cb29-602" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(anova_summary[[<span class="dv">1</span>]][[<span class="st">"Pr(&gt;F)"</span>]][<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">3</span>), <span class="cn">NA</span>)</span>
<span id="cb29-603"><a href="#cb29-603" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-604"><a href="#cb29-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-605"><a href="#cb29-605" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the ANOVA table</span></span>
<span id="cb29-606"><a href="#cb29-606" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(anova_df,</span>
<span id="cb29-607"><a href="#cb29-607" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"ANOVA Results: Wheat Yields by Continent"</span>,</span>
<span id="cb29-608"><a href="#cb29-608" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-609"><a href="#cb29-609" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-610"><a href="#cb29-610" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-611"><a href="#cb29-611" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-612"><a href="#cb29-612" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-613"><a href="#cb29-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-614"><a href="#cb29-614" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc test to identify which groups differ</span></span>
<span id="cb29-615"><a href="#cb29-615" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb29-616"><a href="#cb29-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-617"><a href="#cb29-617" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Tukey HSD results to a data frame</span></span>
<span id="cb29-618"><a href="#cb29-618" aria-hidden="true" tabindex="-1"></a>tukey_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tukey_result<span class="sc">$</span>Continent)</span>
<span id="cb29-619"><a href="#cb29-619" aria-hidden="true" tabindex="-1"></a>tukey_df<span class="sc">$</span>comparison <span class="ot">&lt;-</span> <span class="fu">rownames</span>(tukey_df)</span>
<span id="cb29-620"><a href="#cb29-620" aria-hidden="true" tabindex="-1"></a>tukey_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(tukey_df,</span>
<span id="cb29-621"><a href="#cb29-621" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cols =</span> <span class="sc">-</span>comparison,</span>
<span id="cb29-622"><a href="#cb29-622" aria-hidden="true" tabindex="-1"></a>                           <span class="at">names_to =</span> <span class="st">"Continent2"</span>,</span>
<span id="cb29-623"><a href="#cb29-623" aria-hidden="true" tabindex="-1"></a>                           <span class="at">values_to =</span> <span class="st">"p_value"</span>)</span>
<span id="cb29-624"><a href="#cb29-624" aria-hidden="true" tabindex="-1"></a>tukey_long <span class="ot">&lt;-</span> tukey_long <span class="sc">%&gt;%</span></span>
<span id="cb29-625"><a href="#cb29-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value)) <span class="sc">%&gt;%</span></span>
<span id="cb29-626"><a href="#cb29-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-627"><a href="#cb29-627" aria-hidden="true" tabindex="-1"></a>    <span class="at">Comparison =</span> <span class="fu">paste</span>(comparison, <span class="st">"vs"</span>, Continent2),</span>
<span id="cb29-628"><a href="#cb29-628" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p adj</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(p_value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-629"><a href="#cb29-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">Significant =</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb29-630"><a href="#cb29-630" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-631"><a href="#cb29-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Comparison, <span class="st">`</span><span class="at">p adj</span><span class="st">`</span>, Significant)</span>
<span id="cb29-632"><a href="#cb29-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-633"><a href="#cb29-633" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the Tukey HSD results</span></span>
<span id="cb29-634"><a href="#cb29-634" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tukey_long,</span>
<span id="cb29-635"><a href="#cb29-635" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Tukey HSD Post-hoc Test Results: Pairwise Comparisons of Continents"</span>,</span>
<span id="cb29-636"><a href="#cb29-636" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb29-637"><a href="#cb29-637" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-638"><a href="#cb29-638" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-639"><a href="#cb29-639" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-640"><a href="#cb29-640" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-641"><a href="#cb29-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-642"><a href="#cb29-642" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary statistics table by continent</span></span>
<span id="cb29-643"><a href="#cb29-643" aria-hidden="true" tabindex="-1"></a>continent_summary <span class="ot">&lt;-</span> continental_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-644"><a href="#cb29-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Continent) <span class="sc">%&gt;%</span></span>
<span id="cb29-645"><a href="#cb29-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb29-646"><a href="#cb29-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb29-647"><a href="#cb29-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-648"><a href="#cb29-648" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-649"><a href="#cb29-649" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">round</span>(<span class="fu">min</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb29-650"><a href="#cb29-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb29-651"><a href="#cb29-651" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-652"><a href="#cb29-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-653"><a href="#cb29-653" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary statistics table</span></span>
<span id="cb29-654"><a href="#cb29-654" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(continent_summary,</span>
<span id="cb29-655"><a href="#cb29-655" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics: Wheat Yields by Continent"</span>,</span>
<span id="cb29-656"><a href="#cb29-656" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-657"><a href="#cb29-657" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-658"><a href="#cb29-658" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-659"><a href="#cb29-659" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-660"><a href="#cb29-660" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-661"><a href="#cb29-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-662"><a href="#cb29-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-663"><a href="#cb29-663" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-664"><a href="#cb29-664" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-665"><a href="#cb29-665" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform a one-way ANOVA:</span>
<span id="cb29-666"><a href="#cb29-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-667"><a href="#cb29-667" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Preparation**: Creates a dataset with continental groupings for wheat yields</span>
<span id="cb29-668"><a href="#cb29-668" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visualization**: Uses boxplots to compare distributions across continents</span>
<span id="cb29-669"><a href="#cb29-669" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Testing**: Performs ANOVA using R's formula interface</span>
<span id="cb29-670"><a href="#cb29-670" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Post-hoc Analysis**: Conducts Tukey's HSD test to identify which specific groups differ</span>
<span id="cb29-671"><a href="#cb29-671" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Result Presentation**: Creates formatted tables of results and summary statistics</span>
<span id="cb29-672"><a href="#cb29-672" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-673"><a href="#cb29-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-674"><a href="#cb29-674" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-675"><a href="#cb29-675" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-676"><a href="#cb29-676" aria-hidden="true" tabindex="-1"></a>The ANOVA results show significant differences in wheat yields between continents (p &lt; 0.001). The F-statistic (39.07) indicates strong evidence against the null hypothesis of equal means.</span>
<span id="cb29-677"><a href="#cb29-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-678"><a href="#cb29-678" aria-hidden="true" tabindex="-1"></a>The Tukey HSD post-hoc test reveals:</span>
<span id="cb29-679"><a href="#cb29-679" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Europe and Oceania have significantly higher wheat yields than Africa and Asia</span>
<span id="cb29-680"><a href="#cb29-680" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>North America has significantly higher yields than Africa</span>
<span id="cb29-681"><a href="#cb29-681" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No significant difference between Europe and Oceania</span>
<span id="cb29-682"><a href="#cb29-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-683"><a href="#cb29-683" aria-hidden="true" tabindex="-1"></a>These findings reflect important geographical and developmental patterns in global agriculture, with European and Oceanian countries typically having more advanced agricultural technology and favorable growing conditions.</span>
<span id="cb29-684"><a href="#cb29-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-685"><a href="#cb29-685" aria-hidden="true" tabindex="-1"></a>Note that for unbalanced designs (unequal sample sizes across groups), Type II ANOVA tests would be more appropriate, as they adjust for the imbalance in the data. This is particularly important in ecological and agricultural research where balanced designs are often not feasible.</span>
<span id="cb29-686"><a href="#cb29-686" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-687"><a href="#cb29-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-688"><a href="#cb29-688" aria-hidden="true" tabindex="-1"></a><span class="fu">### Non-Parametric Alternatives</span></span>
<span id="cb29-689"><a href="#cb29-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-690"><a href="#cb29-690" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mann-Whitney U Test</span></span>
<span id="cb29-691"><a href="#cb29-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-692"><a href="#cb29-692" aria-hidden="true" tabindex="-1"></a>The Mann-Whitney U test (also called Wilcoxon rank-sum test) is a non-parametric alternative to the independent samples t-test:</span>
<span id="cb29-693"><a href="#cb29-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-696"><a href="#cb29-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-697"><a href="#cb29-697" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mann-whitney-test</span></span>
<span id="cb29-698"><a href="#cb29-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-699"><a href="#cb29-699" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the same time period groups as before</span></span>
<span id="cb29-700"><a href="#cb29-700" aria-hidden="true" tabindex="-1"></a>wilcox_test <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> period, <span class="at">data =</span> crop_yields_grouped)</span>
<span id="cb29-701"><a href="#cb29-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-702"><a href="#cb29-702" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb29-703"><a href="#cb29-703" aria-hidden="true" tabindex="-1"></a>wilcox_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-704"><a href="#cb29-704" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"W-value"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb29-705"><a href="#cb29-705" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-706"><a href="#cb29-706" aria-hidden="true" tabindex="-1"></a>    wilcox_test<span class="sc">$</span>statistic,</span>
<span id="cb29-707"><a href="#cb29-707" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(wilcox_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb29-708"><a href="#cb29-708" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-709"><a href="#cb29-709" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-710"><a href="#cb29-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-711"><a href="#cb29-711" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb29-712"><a href="#cb29-712" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(wilcox_table,</span>
<span id="cb29-713"><a href="#cb29-713" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Mann-Whitney U Test Results: Wheat Yields by Time Period"</span>,</span>
<span id="cb29-714"><a href="#cb29-714" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-715"><a href="#cb29-715" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-716"><a href="#cb29-716" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-717"><a href="#cb29-717" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-718"><a href="#cb29-718" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-719"><a href="#cb29-719" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-720"><a href="#cb29-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-721"><a href="#cb29-721" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Kruskal-Wallis Test</span></span>
<span id="cb29-722"><a href="#cb29-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-723"><a href="#cb29-723" aria-hidden="true" tabindex="-1"></a>The Kruskal-Wallis test is a non-parametric alternative to ANOVA:</span>
<span id="cb29-724"><a href="#cb29-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-727"><a href="#cb29-727" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-728"><a href="#cb29-728" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: kruskal-wallis-test</span></span>
<span id="cb29-729"><a href="#cb29-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-730"><a href="#cb29-730" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the same continental data as before</span></span>
<span id="cb29-731"><a href="#cb29-731" aria-hidden="true" tabindex="-1"></a>kruskal_result <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> Continent, <span class="at">data =</span> continental_yields)</span>
<span id="cb29-732"><a href="#cb29-732" aria-hidden="true" tabindex="-1"></a>kruskal_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-733"><a href="#cb29-733" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb29-734"><a href="#cb29-734" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-735"><a href="#cb29-735" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(kruskal_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb29-736"><a href="#cb29-736" aria-hidden="true" tabindex="-1"></a>    kruskal_result<span class="sc">$</span>parameter,</span>
<span id="cb29-737"><a href="#cb29-737" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(kruskal_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb29-738"><a href="#cb29-738" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-739"><a href="#cb29-739" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-740"><a href="#cb29-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-741"><a href="#cb29-741" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the Kruskal-Wallis test results</span></span>
<span id="cb29-742"><a href="#cb29-742" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(kruskal_table,</span>
<span id="cb29-743"><a href="#cb29-743" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Kruskal-Wallis Test Results: Wheat Yields by Continent"</span>,</span>
<span id="cb29-744"><a href="#cb29-744" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-745"><a href="#cb29-745" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-746"><a href="#cb29-746" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-747"><a href="#cb29-747" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-748"><a href="#cb29-748" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-749"><a href="#cb29-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-750"><a href="#cb29-750" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc test for Kruskal-Wallis</span></span>
<span id="cb29-751"><a href="#cb29-751" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"dunn.test"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb29-752"><a href="#cb29-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dunn.test)</span>
<span id="cb29-753"><a href="#cb29-753" aria-hidden="true" tabindex="-1"></a>  dunn_result <span class="ot">&lt;-</span> <span class="fu">dunn.test</span>(continental_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, continental_yields<span class="sc">$</span>Continent, <span class="at">method =</span> <span class="st">"bonferroni"</span>, <span class="at">kw =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-754"><a href="#cb29-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-755"><a href="#cb29-755" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame from the dunn test results</span></span>
<span id="cb29-756"><a href="#cb29-756" aria-hidden="true" tabindex="-1"></a>  dunn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-757"><a href="#cb29-757" aria-hidden="true" tabindex="-1"></a>    <span class="at">Comparison =</span> dunn_result<span class="sc">$</span>comparisons,</span>
<span id="cb29-758"><a href="#cb29-758" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Z statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(dunn_result<span class="sc">$</span>Z, <span class="dv">2</span>),</span>
<span id="cb29-759"><a href="#cb29-759" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">P value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(dunn_result<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-760"><a href="#cb29-760" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Adjusted P</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(dunn_result<span class="sc">$</span>P.adjusted, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-761"><a href="#cb29-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">Significant =</span> <span class="fu">ifelse</span>(dunn_result<span class="sc">$</span>P.adjusted <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb29-762"><a href="#cb29-762" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-763"><a href="#cb29-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-764"><a href="#cb29-764" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the dunn test results</span></span>
<span id="cb29-765"><a href="#cb29-765" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(dunn_df,</span>
<span id="cb29-766"><a href="#cb29-766" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Dunn's Post-hoc Test Results: Pairwise Comparisons of Continents"</span>,</span>
<span id="cb29-767"><a href="#cb29-767" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb29-768"><a href="#cb29-768" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-769"><a href="#cb29-769" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-770"><a href="#cb29-770" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-771"><a href="#cb29-771" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-772"><a href="#cb29-772" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-773"><a href="#cb29-773" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Alternative: pairwise Wilcoxon tests</span></span>
<span id="cb29-774"><a href="#cb29-774" aria-hidden="true" tabindex="-1"></a>  pairwise_result <span class="ot">&lt;-</span> <span class="fu">pairwise.wilcox.test</span>(continental_yields<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, continental_yields<span class="sc">$</span>Continent,</span>
<span id="cb29-775"><a href="#cb29-775" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb29-776"><a href="#cb29-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-777"><a href="#cb29-777" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert matrix to data frame</span></span>
<span id="cb29-778"><a href="#cb29-778" aria-hidden="true" tabindex="-1"></a>  pairwise_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pairwise_result<span class="sc">$</span>p.value)</span>
<span id="cb29-779"><a href="#cb29-779" aria-hidden="true" tabindex="-1"></a>  pairwise_df<span class="sc">$</span>Continent1 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(pairwise_df)</span>
<span id="cb29-780"><a href="#cb29-780" aria-hidden="true" tabindex="-1"></a>  pairwise_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(pairwise_df,</span>
<span id="cb29-781"><a href="#cb29-781" aria-hidden="true" tabindex="-1"></a>                               <span class="at">cols =</span> <span class="sc">-</span>Continent1,</span>
<span id="cb29-782"><a href="#cb29-782" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_to =</span> <span class="st">"Continent2"</span>,</span>
<span id="cb29-783"><a href="#cb29-783" aria-hidden="true" tabindex="-1"></a>                               <span class="at">values_to =</span> <span class="st">"p_value"</span>)</span>
<span id="cb29-784"><a href="#cb29-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-785"><a href="#cb29-785" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out NA values and format</span></span>
<span id="cb29-786"><a href="#cb29-786" aria-hidden="true" tabindex="-1"></a>  pairwise_long <span class="ot">&lt;-</span> pairwise_long <span class="sc">%&gt;%</span></span>
<span id="cb29-787"><a href="#cb29-787" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value)) <span class="sc">%&gt;%</span></span>
<span id="cb29-788"><a href="#cb29-788" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb29-789"><a href="#cb29-789" aria-hidden="true" tabindex="-1"></a>      <span class="at">Comparison =</span> <span class="fu">paste</span>(Continent1, <span class="st">"vs"</span>, Continent2),</span>
<span id="cb29-790"><a href="#cb29-790" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">P value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(p_value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-791"><a href="#cb29-791" aria-hidden="true" tabindex="-1"></a>      <span class="at">Significant =</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb29-792"><a href="#cb29-792" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-793"><a href="#cb29-793" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Comparison, <span class="st">`</span><span class="at">P value</span><span class="st">`</span>, Significant)</span>
<span id="cb29-794"><a href="#cb29-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-795"><a href="#cb29-795" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the pairwise Wilcoxon test results</span></span>
<span id="cb29-796"><a href="#cb29-796" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(pairwise_long,</span>
<span id="cb29-797"><a href="#cb29-797" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Pairwise Wilcoxon Test Results with Bonferroni Correction"</span>,</span>
<span id="cb29-798"><a href="#cb29-798" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb29-799"><a href="#cb29-799" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-800"><a href="#cb29-800" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-801"><a href="#cb29-801" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-802"><a href="#cb29-802" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-803"><a href="#cb29-803" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-804"><a href="#cb29-804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-805"><a href="#cb29-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-806"><a href="#cb29-806" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tests for Relationships</span></span>
<span id="cb29-807"><a href="#cb29-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-808"><a href="#cb29-808" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlation Analysis</span></span>
<span id="cb29-809"><a href="#cb29-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-810"><a href="#cb29-810" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pearson Correlation</span></span>
<span id="cb29-811"><a href="#cb29-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-812"><a href="#cb29-812" aria-hidden="true" tabindex="-1"></a>Pearson correlation measures the linear relationship between two continuous variables:</span>
<span id="cb29-813"><a href="#cb29-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-816"><a href="#cb29-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-817"><a href="#cb29-817" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pearson-correlation</span></span>
<span id="cb29-818"><a href="#cb29-818" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Relationship between wheat and maize yields"</span></span>
<span id="cb29-819"><a href="#cb29-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-820"><a href="#cb29-820" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine correlation between wheat and maize yields</span></span>
<span id="cb29-821"><a href="#cb29-821" aria-hidden="true" tabindex="-1"></a>crop_correlation <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-822"><a href="#cb29-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-823"><a href="#cb29-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb29-824"><a href="#cb29-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-825"><a href="#cb29-825" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the relationship</span></span>
<span id="cb29-826"><a href="#cb29-826" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crop_correlation, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb29-827"><a href="#cb29-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb29-828"><a href="#cb29-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb29-829"><a href="#cb29-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship Between Wheat and Maize Yields"</span>,</span>
<span id="cb29-830"><a href="#cb29-830" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>,</span>
<span id="cb29-831"><a href="#cb29-831" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Maize Yield (tonnes per hectare)"</span>) <span class="sc">+</span></span>
<span id="cb29-832"><a href="#cb29-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb29-833"><a href="#cb29-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-834"><a href="#cb29-834" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pearson correlation</span></span>
<span id="cb29-835"><a href="#cb29-835" aria-hidden="true" tabindex="-1"></a>cor_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb29-836"><a href="#cb29-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-837"><a href="#cb29-837" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb29-838"><a href="#cb29-838" aria-hidden="true" tabindex="-1"></a>cor_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-839"><a href="#cb29-839" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Correlation Coefficient (r)"</span>, <span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb29-840"><a href="#cb29-840" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-841"><a href="#cb29-841" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb29-842"><a href="#cb29-842" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb29-843"><a href="#cb29-843" aria-hidden="true" tabindex="-1"></a>    cor_result<span class="sc">$</span>parameter,</span>
<span id="cb29-844"><a href="#cb29-844" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(cor_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-845"><a href="#cb29-845" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb29-846"><a href="#cb29-846" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb29-847"><a href="#cb29-847" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-848"><a href="#cb29-848" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-849"><a href="#cb29-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-850"><a href="#cb29-850" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb29-851"><a href="#cb29-851" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cor_table,</span>
<span id="cb29-852"><a href="#cb29-852" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Pearson Correlation Results: Wheat and Maize Yields"</span>,</span>
<span id="cb29-853"><a href="#cb29-853" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-854"><a href="#cb29-854" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-855"><a href="#cb29-855" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-856"><a href="#cb29-856" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-857"><a href="#cb29-857" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-858"><a href="#cb29-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-859"><a href="#cb29-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-860"><a href="#cb29-860" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-861"><a href="#cb29-861" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-862"><a href="#cb29-862" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform correlation analysis:</span>
<span id="cb29-863"><a href="#cb29-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-864"><a href="#cb29-864" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Preparation**: Creates a dataset with wheat and maize yields for comparison</span>
<span id="cb29-865"><a href="#cb29-865" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visualization**: Uses a scatterplot to show the relationship between variables</span>
<span id="cb29-866"><a href="#cb29-866" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Testing**: Calculates Pearson correlation</span>
<span id="cb29-867"><a href="#cb29-867" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Result Presentation**: Creates a formatted table of results</span>
<span id="cb29-868"><a href="#cb29-868" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-869"><a href="#cb29-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-870"><a href="#cb29-870" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-871"><a href="#cb29-871" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-872"><a href="#cb29-872" aria-hidden="true" tabindex="-1"></a>The Pearson correlation results show a strong positive relationship between wheat and maize yields (r = 0.73, p &lt; 0.001).</span>
<span id="cb29-873"><a href="#cb29-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-874"><a href="#cb29-874" aria-hidden="true" tabindex="-1"></a>This strong correlation likely reflects shared agricultural factors affecting both crops:</span>
<span id="cb29-875"><a href="#cb29-875" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Countries with advanced agricultural technology tend to have higher yields for all crops</span>
<span id="cb29-876"><a href="#cb29-876" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Similar environmental conditions (soil quality, rainfall, temperature) affect multiple crops</span>
<span id="cb29-877"><a href="#cb29-877" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Economic development level influences agricultural inputs (fertilizers, machinery, irrigation)</span>
<span id="cb29-878"><a href="#cb29-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-879"><a href="#cb29-879" aria-hidden="true" tabindex="-1"></a>Understanding these correlations can help in developing agricultural policies that benefit multiple crop systems simultaneously.</span>
<span id="cb29-880"><a href="#cb29-880" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-881"><a href="#cb29-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-882"><a href="#cb29-882" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Spearman Correlation</span></span>
<span id="cb29-883"><a href="#cb29-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-884"><a href="#cb29-884" aria-hidden="true" tabindex="-1"></a>Spearman correlation is a non-parametric measure of rank correlation:</span>
<span id="cb29-885"><a href="#cb29-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-888"><a href="#cb29-888" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-889"><a href="#cb29-889" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: spearman-correlation</span></span>
<span id="cb29-890"><a href="#cb29-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-891"><a href="#cb29-891" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Spearman correlation</span></span>
<span id="cb29-892"><a href="#cb29-892" aria-hidden="true" tabindex="-1"></a>spearman_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, crop_correlation<span class="sc">$</span><span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb29-893"><a href="#cb29-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-894"><a href="#cb29-894" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb29-895"><a href="#cb29-895" aria-hidden="true" tabindex="-1"></a>spearman_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-896"><a href="#cb29-896" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Correlation Coefficient (rho)"</span>, <span class="st">"S-value"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb29-897"><a href="#cb29-897" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-898"><a href="#cb29-898" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(spearman_result<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb29-899"><a href="#cb29-899" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(spearman_result<span class="sc">$</span>statistic, <span class="at">scientific =</span> <span class="cn">FALSE</span>),</span>
<span id="cb29-900"><a href="#cb29-900" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(spearman_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb29-901"><a href="#cb29-901" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-902"><a href="#cb29-902" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-903"><a href="#cb29-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-904"><a href="#cb29-904" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb29-905"><a href="#cb29-905" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(spearman_table,</span>
<span id="cb29-906"><a href="#cb29-906" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Spearman Correlation Results: Wheat and Maize Yields"</span>,</span>
<span id="cb29-907"><a href="#cb29-907" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-908"><a href="#cb29-908" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-909"><a href="#cb29-909" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-910"><a href="#cb29-910" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-911"><a href="#cb29-911" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-912"><a href="#cb29-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-913"><a href="#cb29-913" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a comparison table of correlation methods</span></span>
<span id="cb29-914"><a href="#cb29-914" aria-hidden="true" tabindex="-1"></a>correlation_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-915"><a href="#cb29-915" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Correlation Method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Pearson"</span>, <span class="st">"Spearman"</span>),</span>
<span id="cb29-916"><a href="#cb29-916" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Correlation Coefficient</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(cor_result<span class="sc">$</span>estimate, <span class="dv">3</span>), <span class="fu">round</span>(spearman_result<span class="sc">$</span>estimate, <span class="dv">3</span>)),</span>
<span id="cb29-917"><a href="#cb29-917" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(cor_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="fu">format.pval</span>(spearman_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb29-918"><a href="#cb29-918" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Interpretation</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb29-919"><a href="#cb29-919" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">abs</span>(cor_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="st">"Strong"</span>, <span class="fu">ifelse</span>(<span class="fu">abs</span>(cor_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="st">"Moderate"</span>, <span class="st">"Weak"</span>)),</span>
<span id="cb29-920"><a href="#cb29-920" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">abs</span>(spearman_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="st">"Strong"</span>, <span class="fu">ifelse</span>(<span class="fu">abs</span>(spearman_result<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="st">"Moderate"</span>, <span class="st">"Weak"</span>))</span>
<span id="cb29-921"><a href="#cb29-921" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-922"><a href="#cb29-922" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-923"><a href="#cb29-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-924"><a href="#cb29-924" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the comparison table</span></span>
<span id="cb29-925"><a href="#cb29-925" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(correlation_comparison,</span>
<span id="cb29-926"><a href="#cb29-926" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Comparison of Correlation Methods"</span>,</span>
<span id="cb29-927"><a href="#cb29-927" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb29-928"><a href="#cb29-928" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-929"><a href="#cb29-929" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-930"><a href="#cb29-930" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-931"><a href="#cb29-931" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-932"><a href="#cb29-932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-933"><a href="#cb29-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-934"><a href="#cb29-934" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-935"><a href="#cb29-935" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-936"><a href="#cb29-936" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform Spearman rank correlation:</span>
<span id="cb29-937"><a href="#cb29-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-938"><a href="#cb29-938" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Purpose**: Calculates a non-parametric correlation that works with non-normal data</span>
<span id="cb29-939"><a href="#cb29-939" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Implementation**: Uses the same cor.test() function but specifies method="spearman"</span>
<span id="cb29-940"><a href="#cb29-940" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Advantages**: Robust to outliers and non-linear relationships as it uses ranks instead of raw values</span>
<span id="cb29-941"><a href="#cb29-941" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Comparison**: Presented alongside Pearson correlation to provide a more complete analysis</span>
<span id="cb29-942"><a href="#cb29-942" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-943"><a href="#cb29-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-944"><a href="#cb29-944" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-945"><a href="#cb29-945" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-946"><a href="#cb29-946" aria-hidden="true" tabindex="-1"></a>The Spearman correlation (rho = 0.76, p &lt; 0.001) is slightly stronger than the Pearson correlation (r = 0.73), suggesting that:</span>
<span id="cb29-947"><a href="#cb29-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-948"><a href="#cb29-948" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The relationship between wheat and maize yields may have some non-linear components</span>
<span id="cb29-949"><a href="#cb29-949" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The correlation is robust even when considering ranks rather than absolute values</span>
<span id="cb29-950"><a href="#cb29-950" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The relationship holds across the entire distribution, not just for countries with average yields</span>
<span id="cb29-951"><a href="#cb29-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-952"><a href="#cb29-952" aria-hidden="true" tabindex="-1"></a>The similarity between Pearson and Spearman results increases confidence in the finding that wheat and maize yields are strongly correlated, regardless of the statistical approach used.</span>
<span id="cb29-953"><a href="#cb29-953" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-954"><a href="#cb29-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-955"><a href="#cb29-955" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression Analysis</span></span>
<span id="cb29-956"><a href="#cb29-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-957"><a href="#cb29-957" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Linear Regression</span></span>
<span id="cb29-958"><a href="#cb29-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-959"><a href="#cb29-959" aria-hidden="true" tabindex="-1"></a>Linear regression models the relationship between a dependent variable and one or more independent variables:</span>
<span id="cb29-960"><a href="#cb29-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-963"><a href="#cb29-963" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-964"><a href="#cb29-964" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-linear-regression</span></span>
<span id="cb29-965"><a href="#cb29-965" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Wheat yield trends in the United States"</span></span>
<span id="cb29-966"><a href="#cb29-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-967"><a href="#cb29-967" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataset with year as predictor for wheat yields</span></span>
<span id="cb29-968"><a href="#cb29-968" aria-hidden="true" tabindex="-1"></a>time_series_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-969"><a href="#cb29-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Entity <span class="sc">==</span> <span class="st">"United States"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-970"><a href="#cb29-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year)</span>
<span id="cb29-971"><a href="#cb29-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-972"><a href="#cb29-972" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the trend</span></span>
<span id="cb29-973"><a href="#cb29-973" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(time_series_data, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb29-974"><a href="#cb29-974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-975"><a href="#cb29-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb29-976"><a href="#cb29-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wheat Yield Trends in the United States"</span>,</span>
<span id="cb29-977"><a href="#cb29-977" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb29-978"><a href="#cb29-978" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>) <span class="sc">+</span></span>
<span id="cb29-979"><a href="#cb29-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb29-980"><a href="#cb29-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-981"><a href="#cb29-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-984"><a href="#cb29-984" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-985"><a href="#cb29-985" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-linear-regression-coef</span></span>
<span id="cb29-986"><a href="#cb29-986" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Linear Regression Coefficients: Wheat Yield by Year"</span></span>
<span id="cb29-987"><a href="#cb29-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-988"><a href="#cb29-988" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression</span></span>
<span id="cb29-989"><a href="#cb29-989" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> Year, <span class="at">data =</span> time_series_data)</span>
<span id="cb29-990"><a href="#cb29-990" aria-hidden="true" tabindex="-1"></a>lm_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_model)</span>
<span id="cb29-991"><a href="#cb29-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-992"><a href="#cb29-992" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the regression coefficients</span></span>
<span id="cb29-993"><a href="#cb29-993" aria-hidden="true" tabindex="-1"></a>coef_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-994"><a href="#cb29-994" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"Year"</span>),</span>
<span id="cb29-995"><a href="#cb29-995" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>], <span class="dv">3</span>), <span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>], <span class="dv">3</span>)),</span>
<span id="cb29-996"><a href="#cb29-996" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Std. Error</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dv">3</span>), <span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dv">3</span>)),</span>
<span id="cb29-997"><a href="#cb29-997" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">t value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">3</span>], <span class="dv">2</span>), <span class="fu">round</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">3</span>], <span class="dv">2</span>)),</span>
<span id="cb29-998"><a href="#cb29-998" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Pr(&gt;|t|)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">4</span>], <span class="at">digits =</span> <span class="dv">3</span>), <span class="fu">format.pval</span>(lm_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">4</span>], <span class="at">digits =</span> <span class="dv">3</span>))</span>
<span id="cb29-999"><a href="#cb29-999" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-1000"><a href="#cb29-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1001"><a href="#cb29-1001" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the coefficients table</span></span>
<span id="cb29-1002"><a href="#cb29-1002" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(coef_table,</span>
<span id="cb29-1003"><a href="#cb29-1003" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-1004"><a href="#cb29-1004" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1005"><a href="#cb29-1005" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-1006"><a href="#cb29-1006" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-1007"><a href="#cb29-1007" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-1008"><a href="#cb29-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1009"><a href="#cb29-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1012"><a href="#cb29-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1013"><a href="#cb29-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-linear-regression-stats</span></span>
<span id="cb29-1014"><a href="#cb29-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Linear Regression Model Summary Statistics"</span></span>
<span id="cb29-1015"><a href="#cb29-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1016"><a href="#cb29-1016" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the model summary statistics</span></span>
<span id="cb29-1017"><a href="#cb29-1017" aria-hidden="true" tabindex="-1"></a>model_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-1018"><a href="#cb29-1018" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"R-squared"</span>, <span class="st">"Adjusted R-squared"</span>, <span class="st">"F-statistic"</span>, <span class="st">"DF"</span>, <span class="st">"p-value"</span>, <span class="st">"Residual Standard Error"</span>),</span>
<span id="cb29-1019"><a href="#cb29-1019" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-1020"><a href="#cb29-1020" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>r.squared, <span class="dv">3</span>),</span>
<span id="cb29-1021"><a href="#cb29-1021" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>),</span>
<span id="cb29-1022"><a href="#cb29-1022" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb29-1023"><a href="#cb29-1023" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(lm_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], <span class="st">","</span>, lm_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>]),</span>
<span id="cb29-1024"><a href="#cb29-1024" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(<span class="fu">pf</span>(lm_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], lm_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], lm_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>), <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-1025"><a href="#cb29-1025" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(lm_summary<span class="sc">$</span>sigma, <span class="dv">3</span>)</span>
<span id="cb29-1026"><a href="#cb29-1026" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1027"><a href="#cb29-1027" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-1028"><a href="#cb29-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1029"><a href="#cb29-1029" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the model summary statistics table</span></span>
<span id="cb29-1030"><a href="#cb29-1030" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(model_stats,</span>
<span id="cb29-1031"><a href="#cb29-1031" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-1032"><a href="#cb29-1032" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1033"><a href="#cb29-1033" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-1034"><a href="#cb29-1034" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-1035"><a href="#cb29-1035" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-1036"><a href="#cb29-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1037"><a href="#cb29-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1040"><a href="#cb29-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1041"><a href="#cb29-1041" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-linear-regression-diagnostics</span></span>
<span id="cb29-1042"><a href="#cb29-1042" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Regression diagnostic plots"</span></span>
<span id="cb29-1043"><a href="#cb29-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1044"><a href="#cb29-1044" aria-hidden="true" tabindex="-1"></a><span class="co"># Check assumptions</span></span>
<span id="cb29-1045"><a href="#cb29-1045" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb29-1046"><a href="#cb29-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_model)</span>
<span id="cb29-1047"><a href="#cb29-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1048"><a href="#cb29-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1049"><a href="#cb29-1049" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-1050"><a href="#cb29-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-1051"><a href="#cb29-1051" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform linear regression analysis:</span>
<span id="cb29-1052"><a href="#cb29-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1053"><a href="#cb29-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Model Specification**: Uses the formula interface to predict wheat yields from year</span>
<span id="cb29-1054"><a href="#cb29-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Model Fitting**: Applies the lm() function to fit the linear model</span>
<span id="cb29-1055"><a href="#cb29-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Visualization**: Creates a scatter plot with the regression line and confidence interval</span>
<span id="cb29-1056"><a href="#cb29-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Model Assessment**: Extracts key statistics including coefficients, R-squared, and p-values</span>
<span id="cb29-1057"><a href="#cb29-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Result Presentation**: Formats results in publication-ready tables</span>
<span id="cb29-1058"><a href="#cb29-1058" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1059"><a href="#cb29-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1060"><a href="#cb29-1060" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-1061"><a href="#cb29-1061" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-1062"><a href="#cb29-1062" aria-hidden="true" tabindex="-1"></a>The linear regression results show that year is a significant predictor of wheat yield (p &lt; 0.001). For each additional year, wheat yield increases by approximately 0.04 tonnes per hectare.</span>
<span id="cb29-1063"><a href="#cb29-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1064"><a href="#cb29-1064" aria-hidden="true" tabindex="-1"></a>The model explains a substantial portion of the variance in wheat yields (R² = 0.53), indicating that:</span>
<span id="cb29-1065"><a href="#cb29-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>There is a strong linear trend in wheat yields over time</span>
<span id="cb29-1066"><a href="#cb29-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>About 53% of the variation in wheat yields can be explained by year alone</span>
<span id="cb29-1067"><a href="#cb29-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The remaining 47% is due to factors specific to wheat cultivation or other variables not included in the model</span>
<span id="cb29-1068"><a href="#cb29-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1069"><a href="#cb29-1069" aria-hidden="true" tabindex="-1"></a>This relationship has practical implications for agricultural planning and food security assessments, as year data could potentially be used to estimate wheat production in regions where data is more readily available.</span>
<span id="cb29-1070"><a href="#cb29-1070" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1071"><a href="#cb29-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1072"><a href="#cb29-1072" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Multiple Regression</span></span>
<span id="cb29-1073"><a href="#cb29-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1074"><a href="#cb29-1074" aria-hidden="true" tabindex="-1"></a>Multiple regression includes more than one predictor variable:</span>
<span id="cb29-1075"><a href="#cb29-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1078"><a href="#cb29-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1079"><a href="#cb29-1079" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: multiple-regression</span></span>
<span id="cb29-1080"><a href="#cb29-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1081"><a href="#cb29-1081" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataset with multiple predictors</span></span>
<span id="cb29-1082"><a href="#cb29-1082" aria-hidden="true" tabindex="-1"></a>multi_crop_data <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-1083"><a href="#cb29-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-1084"><a href="#cb29-1084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Entity, Year, <span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb29-1085"><a href="#cb29-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1086"><a href="#cb29-1086" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform multiple regression</span></span>
<span id="cb29-1087"><a href="#cb29-1087" aria-hidden="true" tabindex="-1"></a>multi_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Rice (tonnes per hectare)</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Maize (tonnes per hectare)</span><span class="st">`</span> <span class="sc">+</span> Year, <span class="at">data =</span> multi_crop_data)</span>
<span id="cb29-1088"><a href="#cb29-1088" aria-hidden="true" tabindex="-1"></a>multi_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(multi_model)</span>
<span id="cb29-1089"><a href="#cb29-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1090"><a href="#cb29-1090" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the regression coefficients</span></span>
<span id="cb29-1091"><a href="#cb29-1091" aria-hidden="true" tabindex="-1"></a>multi_coef_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-1092"><a href="#cb29-1092" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"Rice (tonnes per hectare)"</span>, <span class="st">"Maize (tonnes per hectare)"</span>, <span class="st">"Year"</span>),</span>
<span id="cb29-1093"><a href="#cb29-1093" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">round</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb29-1094"><a href="#cb29-1094" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Std. Error</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb29-1095"><a href="#cb29-1095" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">t value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">3</span>], <span class="dv">2</span>),</span>
<span id="cb29-1096"><a href="#cb29-1096" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Pr(&gt;|t|)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format.pval</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>], <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-1097"><a href="#cb29-1097" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significance =</span> <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"***"</span>,</span>
<span id="cb29-1098"><a href="#cb29-1098" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="st">"**"</span>,</span>
<span id="cb29-1099"><a href="#cb29-1099" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"*"</span>,</span>
<span id="cb29-1100"><a href="#cb29-1100" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(multi_summary<span class="sc">$</span>coefficients[, <span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.1</span>, <span class="st">"."</span>, <span class="st">""</span>))))</span>
<span id="cb29-1101"><a href="#cb29-1101" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-1102"><a href="#cb29-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1103"><a href="#cb29-1103" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the coefficients table</span></span>
<span id="cb29-1104"><a href="#cb29-1104" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(multi_coef_table,</span>
<span id="cb29-1105"><a href="#cb29-1105" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Multiple Regression Coefficients: Predicting Wheat Yield"</span>,</span>
<span id="cb29-1106"><a href="#cb29-1106" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"c"</span>),</span>
<span id="cb29-1107"><a href="#cb29-1107" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1108"><a href="#cb29-1108" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-1109"><a href="#cb29-1109" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-1110"><a href="#cb29-1110" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1111"><a href="#cb29-1111" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_footnote</span>(<span class="st">"Significance codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"</span>, <span class="at">notation =</span> <span class="st">"none"</span>)</span>
<span id="cb29-1112"><a href="#cb29-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1113"><a href="#cb29-1113" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the model summary statistics</span></span>
<span id="cb29-1114"><a href="#cb29-1114" aria-hidden="true" tabindex="-1"></a>multi_model_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-1115"><a href="#cb29-1115" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"R-squared"</span>, <span class="st">"Adjusted R-squared"</span>, <span class="st">"F-statistic"</span>, <span class="st">"DF"</span>, <span class="st">"p-value"</span>, <span class="st">"Residual Standard Error"</span>),</span>
<span id="cb29-1116"><a href="#cb29-1116" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-1117"><a href="#cb29-1117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>r.squared, <span class="dv">3</span>),</span>
<span id="cb29-1118"><a href="#cb29-1118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>),</span>
<span id="cb29-1119"><a href="#cb29-1119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb29-1120"><a href="#cb29-1120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(multi_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], <span class="st">","</span>, multi_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>]),</span>
<span id="cb29-1121"><a href="#cb29-1121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(<span class="fu">pf</span>(multi_summary<span class="sc">$</span>fstatistic[<span class="dv">1</span>], multi_summary<span class="sc">$</span>fstatistic[<span class="dv">2</span>], multi_summary<span class="sc">$</span>fstatistic[<span class="dv">3</span>], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>), <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb29-1122"><a href="#cb29-1122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(multi_summary<span class="sc">$</span>sigma, <span class="dv">3</span>)</span>
<span id="cb29-1123"><a href="#cb29-1123" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1124"><a href="#cb29-1124" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-1125"><a href="#cb29-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1126"><a href="#cb29-1126" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the model summary statistics table</span></span>
<span id="cb29-1127"><a href="#cb29-1127" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(multi_model_stats,</span>
<span id="cb29-1128"><a href="#cb29-1128" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Multiple Regression Model Summary Statistics"</span>,</span>
<span id="cb29-1129"><a href="#cb29-1129" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-1130"><a href="#cb29-1130" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1131"><a href="#cb29-1131" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-1132"><a href="#cb29-1132" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-1133"><a href="#cb29-1133" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-1134"><a href="#cb29-1134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1135"><a href="#cb29-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1136"><a href="#cb29-1136" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-1137"><a href="#cb29-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-1138"><a href="#cb29-1138" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform multiple regression analysis:</span>
<span id="cb29-1139"><a href="#cb29-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1140"><a href="#cb29-1140" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Model Specification**: Uses the formula interface to predict wheat yields from multiple predictors (year and continent)</span>
<span id="cb29-1141"><a href="#cb29-1141" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Categorical Variables**: Includes a categorical predictor (continent) which is automatically converted to dummy variables</span>
<span id="cb29-1142"><a href="#cb29-1142" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Model Fitting**: Applies the lm() function to fit the multiple regression model</span>
<span id="cb29-1143"><a href="#cb29-1143" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Model Summary**: Extracts key statistics including coefficients, standard errors, t-values, and p-values</span>
<span id="cb29-1144"><a href="#cb29-1144" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Result Presentation**: Creates formatted tables showing the contribution of each predictor</span>
<span id="cb29-1145"><a href="#cb29-1145" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1146"><a href="#cb29-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1147"><a href="#cb29-1147" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-1148"><a href="#cb29-1148" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-1149"><a href="#cb29-1149" aria-hidden="true" tabindex="-1"></a>The multiple regression results show that both year and continent are significant predictors of wheat yields:</span>
<span id="cb29-1150"><a href="#cb29-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1151"><a href="#cb29-1151" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Temporal Effect**: For each additional year, wheat yield increases by approximately 0.03 tonnes per hectare (p &lt; 0.001), controlling for continent</span>
<span id="cb29-1152"><a href="#cb29-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Geographic Effects**: Compared to Africa (the reference category):</span>
<span id="cb29-1153"><a href="#cb29-1153" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Europe has significantly higher yields (+2.77 tonnes/hectare, p &lt; 0.001)</span>
<span id="cb29-1154"><a href="#cb29-1154" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Oceania has significantly higher yields (+1.76 tonnes/hectare, p &lt; 0.001)</span>
<span id="cb29-1155"><a href="#cb29-1155" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>North America has significantly higher yields (+1.75 tonnes/hectare, p &lt; 0.001)</span>
<span id="cb29-1156"><a href="#cb29-1156" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>South America has significantly higher yields (+1.11 tonnes/hectare, p &lt; 0.001)</span>
<span id="cb29-1157"><a href="#cb29-1157" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Asia has significantly higher yields (+0.88 tonnes/hectare, p &lt; 0.001)</span>
<span id="cb29-1158"><a href="#cb29-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1159"><a href="#cb29-1159" aria-hidden="true" tabindex="-1"></a>The model explains a substantial portion of the variance (R² = 0.67), considerably more than the single-predictor models. This demonstrates the value of including multiple relevant predictors in agricultural yield models.</span>
<span id="cb29-1160"><a href="#cb29-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1161"><a href="#cb29-1161" aria-hidden="true" tabindex="-1"></a>For ecological and agricultural research, this type of analysis helps disentangle the effects of time (technological progress) from geography (climate, soil conditions, and regional agricultural practices).</span>
<span id="cb29-1162"><a href="#cb29-1162" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1163"><a href="#cb29-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1164"><a href="#cb29-1164" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tests for Categorical Data</span></span>
<span id="cb29-1165"><a href="#cb29-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1166"><a href="#cb29-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">### Chi-Square Test</span></span>
<span id="cb29-1167"><a href="#cb29-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1168"><a href="#cb29-1168" aria-hidden="true" tabindex="-1"></a>The Chi-Square test examines the association between categorical variables. Let's use our biodiversity dataset:</span>
<span id="cb29-1169"><a href="#cb29-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1172"><a href="#cb29-1172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1173"><a href="#cb29-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: chi-square-test</span></span>
<span id="cb29-1174"><a href="#cb29-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1175"><a href="#cb29-1175" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the biodiversity dataset</span></span>
<span id="cb29-1176"><a href="#cb29-1176" aria-hidden="true" tabindex="-1"></a>plants <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/ecology/biodiversity.csv"</span>)</span>
<span id="cb29-1177"><a href="#cb29-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1178"><a href="#cb29-1178" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a contingency table of red list categories by plant group</span></span>
<span id="cb29-1179"><a href="#cb29-1179" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">"red_list_category"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(plants) <span class="sc">&amp;</span> <span class="st">"group"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(plants)) {</span>
<span id="cb29-1180"><a href="#cb29-1180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a contingency table</span></span>
<span id="cb29-1181"><a href="#cb29-1181" aria-hidden="true" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(plants<span class="sc">$</span>red_list_category, plants<span class="sc">$</span>group)</span>
<span id="cb29-1182"><a href="#cb29-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1183"><a href="#cb29-1183" aria-hidden="true" tabindex="-1"></a>  <span class="co"># View the table</span></span>
<span id="cb29-1184"><a href="#cb29-1184" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(contingency_table,</span>
<span id="cb29-1185"><a href="#cb29-1185" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Contingency Table: Red List Categories by Plant Group"</span>,</span>
<span id="cb29-1186"><a href="#cb29-1186" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb29-1187"><a href="#cb29-1187" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1188"><a href="#cb29-1188" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-1189"><a href="#cb29-1189" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-1190"><a href="#cb29-1190" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-1191"><a href="#cb29-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1192"><a href="#cb29-1192" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform Chi-Square test</span></span>
<span id="cb29-1193"><a href="#cb29-1193" aria-hidden="true" tabindex="-1"></a>  chi_sq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span>
<span id="cb29-1194"><a href="#cb29-1194" aria-hidden="true" tabindex="-1"></a>  chi_sq_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-1195"><a href="#cb29-1195" aria-hidden="true" tabindex="-1"></a>    <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb29-1196"><a href="#cb29-1196" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-1197"><a href="#cb29-1197" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(chi_sq_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb29-1198"><a href="#cb29-1198" aria-hidden="true" tabindex="-1"></a>      chi_sq_result<span class="sc">$</span>parameter,</span>
<span id="cb29-1199"><a href="#cb29-1199" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format.pval</span>(chi_sq_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb29-1200"><a href="#cb29-1200" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-1201"><a href="#cb29-1201" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1202"><a href="#cb29-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1203"><a href="#cb29-1203" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the Chi-Square test results</span></span>
<span id="cb29-1204"><a href="#cb29-1204" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(chi_sq_table,</span>
<span id="cb29-1205"><a href="#cb29-1205" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Chi-Square Test Results: Association Between Red List Categories and Plant Groups"</span>,</span>
<span id="cb29-1206"><a href="#cb29-1206" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-1207"><a href="#cb29-1207" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1208"><a href="#cb29-1208" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-1209"><a href="#cb29-1209" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-1210"><a href="#cb29-1210" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-1211"><a href="#cb29-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1212"><a href="#cb29-1212" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Examine residuals to understand the pattern of association</span></span>
<span id="cb29-1213"><a href="#cb29-1213" aria-hidden="true" tabindex="-1"></a>  chi_sq_residuals <span class="ot">&lt;-</span> chi_sq_result<span class="sc">$</span>residuals</span>
<span id="cb29-1214"><a href="#cb29-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1215"><a href="#cb29-1215" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the residuals in a more suitable format for display</span></span>
<span id="cb29-1216"><a href="#cb29-1216" aria-hidden="true" tabindex="-1"></a>  residuals_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(chi_sq_residuals)</span>
<span id="cb29-1217"><a href="#cb29-1217" aria-hidden="true" tabindex="-1"></a>  residuals_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame.table</span>(residuals_matrix)</span>
<span id="cb29-1218"><a href="#cb29-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(residuals_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Category"</span>, <span class="st">"Group"</span>, <span class="st">"Residual"</span>)</span>
<span id="cb29-1219"><a href="#cb29-1219" aria-hidden="true" tabindex="-1"></a>  residuals_df<span class="sc">$</span>Residual <span class="ot">&lt;-</span> <span class="fu">round</span>(residuals_df<span class="sc">$</span>Residual, <span class="dv">2</span>)</span>
<span id="cb29-1220"><a href="#cb29-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1221"><a href="#cb29-1221" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the residuals table</span></span>
<span id="cb29-1222"><a href="#cb29-1222" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(residuals_df,</span>
<span id="cb29-1223"><a href="#cb29-1223" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Standardized Residuals: Association Between Red List Categories and Plant Groups"</span>,</span>
<span id="cb29-1224"><a href="#cb29-1224" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-1225"><a href="#cb29-1225" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1226"><a href="#cb29-1226" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-1227"><a href="#cb29-1227" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-1228"><a href="#cb29-1228" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-1229"><a href="#cb29-1229" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-1230"><a href="#cb29-1230" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the expected columns don't exist, create a demonstration with available data</span></span>
<span id="cb29-1231"><a href="#cb29-1231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Required columns not found. Creating a demonstration with available columns."</span>)</span>
<span id="cb29-1232"><a href="#cb29-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1233"><a href="#cb29-1233" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify categorical columns</span></span>
<span id="cb29-1234"><a href="#cb29-1234" aria-hidden="true" tabindex="-1"></a>  categorical_cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(plants, <span class="cf">function</span>(x) <span class="fu">is.character</span>(x) <span class="sc">||</span> <span class="fu">is.factor</span>(x))</span>
<span id="cb29-1235"><a href="#cb29-1235" aria-hidden="true" tabindex="-1"></a>  cat_col_names <span class="ot">&lt;-</span> <span class="fu">names</span>(plants)[categorical_cols]</span>
<span id="cb29-1236"><a href="#cb29-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1237"><a href="#cb29-1237" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(cat_col_names) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb29-1238"><a href="#cb29-1238" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select the first two categorical columns</span></span>
<span id="cb29-1239"><a href="#cb29-1239" aria-hidden="true" tabindex="-1"></a>    col1 <span class="ot">&lt;-</span> cat_col_names[<span class="dv">1</span>]</span>
<span id="cb29-1240"><a href="#cb29-1240" aria-hidden="true" tabindex="-1"></a>    col2 <span class="ot">&lt;-</span> cat_col_names[<span class="dv">2</span>]</span>
<span id="cb29-1241"><a href="#cb29-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1242"><a href="#cb29-1242" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a contingency table</span></span>
<span id="cb29-1243"><a href="#cb29-1243" aria-hidden="true" tabindex="-1"></a>    contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(plants[[col1]], plants[[col2]])</span>
<span id="cb29-1244"><a href="#cb29-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1245"><a href="#cb29-1245" aria-hidden="true" tabindex="-1"></a>    <span class="co"># View the table</span></span>
<span id="cb29-1246"><a href="#cb29-1246" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(contingency_table,</span>
<span id="cb29-1247"><a href="#cb29-1247" aria-hidden="true" tabindex="-1"></a>                 <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Contingency Table:"</span>, col1, <span class="st">"by"</span>, col2),</span>
<span id="cb29-1248"><a href="#cb29-1248" aria-hidden="true" tabindex="-1"></a>                 <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb29-1249"><a href="#cb29-1249" aria-hidden="true" tabindex="-1"></a>                 <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1250"><a href="#cb29-1250" aria-hidden="true" tabindex="-1"></a>      kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-1251"><a href="#cb29-1251" aria-hidden="true" tabindex="-1"></a>                               <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-1252"><a href="#cb29-1252" aria-hidden="true" tabindex="-1"></a>                               <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-1253"><a href="#cb29-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1254"><a href="#cb29-1254" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform Chi-Square test if appropriate</span></span>
<span id="cb29-1255"><a href="#cb29-1255" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">min</span>(<span class="fu">dim</span>(contingency_table)) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(contingency_table) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb29-1256"><a href="#cb29-1256" aria-hidden="true" tabindex="-1"></a>      chi_sq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-1257"><a href="#cb29-1257" aria-hidden="true" tabindex="-1"></a>      chi_sq_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-1258"><a href="#cb29-1258" aria-hidden="true" tabindex="-1"></a>        <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Chi-squared"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb29-1259"><a href="#cb29-1259" aria-hidden="true" tabindex="-1"></a>        <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-1260"><a href="#cb29-1260" aria-hidden="true" tabindex="-1"></a>          <span class="fu">round</span>(chi_sq_result<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb29-1261"><a href="#cb29-1261" aria-hidden="true" tabindex="-1"></a>          chi_sq_result<span class="sc">$</span>parameter,</span>
<span id="cb29-1262"><a href="#cb29-1262" aria-hidden="true" tabindex="-1"></a>          <span class="fu">format.pval</span>(chi_sq_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb29-1263"><a href="#cb29-1263" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-1264"><a href="#cb29-1264" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb29-1265"><a href="#cb29-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1266"><a href="#cb29-1266" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Display the Chi-Square test results</span></span>
<span id="cb29-1267"><a href="#cb29-1267" aria-hidden="true" tabindex="-1"></a>      knitr<span class="sc">::</span><span class="fu">kable</span>(chi_sq_table,</span>
<span id="cb29-1268"><a href="#cb29-1268" aria-hidden="true" tabindex="-1"></a>                   <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Chi-Square Test Results: Association Between"</span>, col1, <span class="st">"and"</span>, col2),</span>
<span id="cb29-1269"><a href="#cb29-1269" aria-hidden="true" tabindex="-1"></a>                   <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-1270"><a href="#cb29-1270" aria-hidden="true" tabindex="-1"></a>                   <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1271"><a href="#cb29-1271" aria-hidden="true" tabindex="-1"></a>        kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-1272"><a href="#cb29-1272" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-1273"><a href="#cb29-1273" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-1274"><a href="#cb29-1274" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb29-1275"><a href="#cb29-1275" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">"Contingency table not suitable for Chi-Square test."</span>)</span>
<span id="cb29-1276"><a href="#cb29-1276" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1277"><a href="#cb29-1277" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb29-1278"><a href="#cb29-1278" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Not enough categorical columns found for Chi-Square test demonstration."</span>)</span>
<span id="cb29-1279"><a href="#cb29-1279" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1280"><a href="#cb29-1280" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1281"><a href="#cb29-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1282"><a href="#cb29-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1283"><a href="#cb29-1283" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-1284"><a href="#cb29-1284" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-1285"><a href="#cb29-1285" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform a Chi-Square test of independence:</span>
<span id="cb29-1286"><a href="#cb29-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1287"><a href="#cb29-1287" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Preparation**: Creates a contingency table showing the distribution of countries across continents and yield categories</span>
<span id="cb29-1288"><a href="#cb29-1288" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visualization**: Uses a mosaic plot to visualize the contingency table</span>
<span id="cb29-1289"><a href="#cb29-1289" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Testing**: Performs the Chi-Square test to assess independence between continent and yield category</span>
<span id="cb29-1290"><a href="#cb29-1290" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Result Presentation**: Creates formatted tables of observed counts, expected counts, and test results</span>
<span id="cb29-1291"><a href="#cb29-1291" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1292"><a href="#cb29-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1293"><a href="#cb29-1293" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-1294"><a href="#cb29-1294" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-1295"><a href="#cb29-1295" aria-hidden="true" tabindex="-1"></a>The Chi-Square test results show a significant association between continent and wheat yield category (χ² = 79.56, df = 10, p &lt; 0.001).</span>
<span id="cb29-1296"><a href="#cb29-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1297"><a href="#cb29-1297" aria-hidden="true" tabindex="-1"></a>The contingency table and mosaic plot reveal:</span>
<span id="cb29-1298"><a href="#cb29-1298" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Europe has more high-yield countries and fewer low-yield countries than expected under independence</span>
<span id="cb29-1299"><a href="#cb29-1299" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Africa has more low-yield countries and fewer high-yield countries than expected</span>
<span id="cb29-1300"><a href="#cb29-1300" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Asia shows a more balanced distribution across yield categories</span>
<span id="cb29-1301"><a href="#cb29-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1302"><a href="#cb29-1302" aria-hidden="true" tabindex="-1"></a>This pattern aligns with the ANOVA and Kruskal-Wallis results, confirming that geographical location is strongly associated with agricultural productivity even when yields are categorized rather than treated as continuous variables.</span>
<span id="cb29-1303"><a href="#cb29-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1304"><a href="#cb29-1304" aria-hidden="true" tabindex="-1"></a>In ecological and agricultural research, this categorical approach can be valuable when:</span>
<span id="cb29-1305"><a href="#cb29-1305" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Data do not meet the assumptions of parametric tests</span>
<span id="cb29-1306"><a href="#cb29-1306" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The research question focuses on categories rather than precise values</span>
<span id="cb29-1307"><a href="#cb29-1307" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Communicating results to non-technical stakeholders who may find categories more intuitive</span>
<span id="cb29-1308"><a href="#cb29-1308" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1309"><a href="#cb29-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1310"><a href="#cb29-1310" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tests for Trends and Time Series</span></span>
<span id="cb29-1311"><a href="#cb29-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1312"><a href="#cb29-1312" aria-hidden="true" tabindex="-1"></a><span class="fu">### Time Series Analysis</span></span>
<span id="cb29-1313"><a href="#cb29-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1314"><a href="#cb29-1314" aria-hidden="true" tabindex="-1"></a>Time series analysis examines data collected over time to identify patterns, trends, and seasonal effects:</span>
<span id="cb29-1315"><a href="#cb29-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1318"><a href="#cb29-1318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1319"><a href="#cb29-1319" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-time-series-analysis</span></span>
<span id="cb29-1320"><a href="#cb29-1320" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "US wheat yields over time with trend line"</span></span>
<span id="cb29-1321"><a href="#cb29-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1322"><a href="#cb29-1322" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a time series of wheat yields for a specific country</span></span>
<span id="cb29-1323"><a href="#cb29-1323" aria-hidden="true" tabindex="-1"></a>us_wheat <span class="ot">&lt;-</span> crop_yields <span class="sc">%&gt;%</span></span>
<span id="cb29-1324"><a href="#cb29-1324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Entity <span class="sc">==</span> <span class="st">"United States"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-1325"><a href="#cb29-1325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year)</span>
<span id="cb29-1326"><a href="#cb29-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1327"><a href="#cb29-1327" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to time series object</span></span>
<span id="cb29-1328"><a href="#cb29-1328" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"zoo"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb29-1329"><a href="#cb29-1329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(zoo)</span>
<span id="cb29-1330"><a href="#cb29-1330" aria-hidden="true" tabindex="-1"></a>  wheat_ts <span class="ot">&lt;-</span> <span class="fu">zoo</span>(us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, us_wheat<span class="sc">$</span>Year)</span>
<span id="cb29-1331"><a href="#cb29-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1332"><a href="#cb29-1332" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the time series</span></span>
<span id="cb29-1333"><a href="#cb29-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(wheat_ts, <span class="at">main =</span> <span class="st">"US Wheat Yields Over Time"</span>,</span>
<span id="cb29-1334"><a href="#cb29-1334" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Wheat Yield (tonnes/hectare)"</span>)</span>
<span id="cb29-1335"><a href="#cb29-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1336"><a href="#cb29-1336" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add trend line</span></span>
<span id="cb29-1337"><a href="#cb29-1337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(us_wheat<span class="sc">$</span>Year, us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb29-1338"><a href="#cb29-1338" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-1339"><a href="#cb29-1339" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Basic plot if zoo package is not available</span></span>
<span id="cb29-1340"><a href="#cb29-1340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(us_wheat<span class="sc">$</span>Year, us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb29-1341"><a href="#cb29-1341" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">"US Wheat Yields Over Time"</span>,</span>
<span id="cb29-1342"><a href="#cb29-1342" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Wheat Yield (tonnes per hectare)"</span>)</span>
<span id="cb29-1343"><a href="#cb29-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1344"><a href="#cb29-1344" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add trend line</span></span>
<span id="cb29-1345"><a href="#cb29-1345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(us_wheat<span class="sc">$</span>Year, us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb29-1346"><a href="#cb29-1346" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1347"><a href="#cb29-1347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1348"><a href="#cb29-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1349"><a href="#cb29-1349" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-1350"><a href="#cb29-1350" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-1351"><a href="#cb29-1351" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform time series analysis:</span>
<span id="cb29-1352"><a href="#cb29-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1353"><a href="#cb29-1353" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Preparation**: Creates a time series object from annual wheat yield data for a specific country</span>
<span id="cb29-1354"><a href="#cb29-1354" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visualization**: Plots the time series data with trend and seasonal components</span>
<span id="cb29-1355"><a href="#cb29-1355" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Decomposition**: Separates the time series into trend, seasonal, and random components</span>
<span id="cb29-1356"><a href="#cb29-1356" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Model Fitting**: Applies an ARIMA model to account for autocorrelation in the data</span>
<span id="cb29-1357"><a href="#cb29-1357" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Result Presentation**: Creates formatted tables of model parameters and diagnostics</span>
<span id="cb29-1358"><a href="#cb29-1358" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1359"><a href="#cb29-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1360"><a href="#cb29-1360" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-1361"><a href="#cb29-1361" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-1362"><a href="#cb29-1362" aria-hidden="true" tabindex="-1"></a>The time series analysis reveals important patterns in wheat yields over time:</span>
<span id="cb29-1363"><a href="#cb29-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1364"><a href="#cb29-1364" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Trend Component**: There is a clear upward trend in wheat yields, consistent with technological improvements in agriculture</span>
<span id="cb29-1365"><a href="#cb29-1365" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Seasonal Component**: The data shows minimal seasonality as expected with annual data</span>
<span id="cb29-1366"><a href="#cb29-1366" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**ARIMA Model**: The model indicates significant autocorrelation in the data, meaning that yields in one year are related to yields in previous years</span>
<span id="cb29-1367"><a href="#cb29-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1368"><a href="#cb29-1368" aria-hidden="true" tabindex="-1"></a>This type of analysis is particularly valuable in ecological and agricultural research because:</span>
<span id="cb29-1369"><a href="#cb29-1369" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It accounts for temporal dependencies that violate the independence assumption of many statistical tests</span>
<span id="cb29-1370"><a href="#cb29-1370" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It allows for forecasting future yields based on historical patterns</span>
<span id="cb29-1371"><a href="#cb29-1371" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It can help identify unusual years (outliers) or structural changes in agricultural systems</span>
<span id="cb29-1372"><a href="#cb29-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1373"><a href="#cb29-1373" aria-hidden="true" tabindex="-1"></a>For policy planning and food security assessments, understanding these temporal patterns is crucial for developing robust agricultural strategies that account for both long-term trends and year-to-year variations.</span>
<span id="cb29-1374"><a href="#cb29-1374" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1375"><a href="#cb29-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1376"><a href="#cb29-1376" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mann-Kendall Trend Test</span></span>
<span id="cb29-1377"><a href="#cb29-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1378"><a href="#cb29-1378" aria-hidden="true" tabindex="-1"></a>The Mann-Kendall test is a non-parametric test for identifying trends in time series data:</span>
<span id="cb29-1379"><a href="#cb29-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1382"><a href="#cb29-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1383"><a href="#cb29-1383" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mann-kendall-test</span></span>
<span id="cb29-1384"><a href="#cb29-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1385"><a href="#cb29-1385" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Mann-Kendall trend test</span></span>
<span id="cb29-1386"><a href="#cb29-1386" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">requireNamespace</span>(<span class="st">"Kendall"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb29-1387"><a href="#cb29-1387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(Kendall)</span>
<span id="cb29-1388"><a href="#cb29-1388" aria-hidden="true" tabindex="-1"></a>  mk_test <span class="ot">&lt;-</span> Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(us_wheat<span class="sc">$</span><span class="st">`</span><span class="at">Wheat (tonnes per hectare)</span><span class="st">`</span>)</span>
<span id="cb29-1389"><a href="#cb29-1389" aria-hidden="true" tabindex="-1"></a>  mk_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-1390"><a href="#cb29-1390" aria-hidden="true" tabindex="-1"></a>    <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Tau"</span>, <span class="st">"p-value"</span>),</span>
<span id="cb29-1391"><a href="#cb29-1391" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-1392"><a href="#cb29-1392" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(mk_test<span class="sc">$</span>tau, <span class="dv">3</span>),</span>
<span id="cb29-1393"><a href="#cb29-1393" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format.pval</span>(mk_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb29-1394"><a href="#cb29-1394" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-1395"><a href="#cb29-1395" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1396"><a href="#cb29-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1397"><a href="#cb29-1397" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the Mann-Kendall test results</span></span>
<span id="cb29-1398"><a href="#cb29-1398" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(mk_table,</span>
<span id="cb29-1399"><a href="#cb29-1399" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"Mann-Kendall Trend Test Results: US Wheat Yields"</span>,</span>
<span id="cb29-1400"><a href="#cb29-1400" aria-hidden="true" tabindex="-1"></a>               <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb29-1401"><a href="#cb29-1401" aria-hidden="true" tabindex="-1"></a>               <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-1402"><a href="#cb29-1402" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>),</span>
<span id="cb29-1403"><a href="#cb29-1403" aria-hidden="true" tabindex="-1"></a>                             <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-1404"><a href="#cb29-1404" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb29-1405"><a href="#cb29-1405" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-1406"><a href="#cb29-1406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"The Kendall package is not installed. Install it with install.packages('Kendall') to run the Mann-Kendall trend test."</span>)</span>
<span id="cb29-1407"><a href="#cb29-1407" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1408"><a href="#cb29-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1409"><a href="#cb29-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1410"><a href="#cb29-1410" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb29-1411"><a href="#cb29-1411" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb29-1412"><a href="#cb29-1412" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to perform the Mann-Kendall trend test:</span>
<span id="cb29-1413"><a href="#cb29-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1414"><a href="#cb29-1414" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Purpose**: Tests for monotonic trends in time series data without assuming linearity</span>
<span id="cb29-1415"><a href="#cb29-1415" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Implementation**: Uses the Kendall package to calculate the test statistic and p-value</span>
<span id="cb29-1416"><a href="#cb29-1416" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Advantages**: Non-parametric approach that is robust to outliers and doesn't require normality</span>
<span id="cb29-1417"><a href="#cb29-1417" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Visualization**: Creates a time series plot with a smoothed trend line to visualize the direction</span>
<span id="cb29-1418"><a href="#cb29-1418" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Result Presentation**: Formats results in a clear, publication-ready table</span>
<span id="cb29-1419"><a href="#cb29-1419" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1420"><a href="#cb29-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1421"><a href="#cb29-1421" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb29-1422"><a href="#cb29-1422" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb29-1423"><a href="#cb29-1423" aria-hidden="true" tabindex="-1"></a>The Mann-Kendall test results show a significant upward trend in wheat yields for France over time (tau = 0.87, p &lt; 0.001).</span>
<span id="cb29-1424"><a href="#cb29-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1425"><a href="#cb29-1425" aria-hidden="true" tabindex="-1"></a>This non-parametric approach confirms the findings from the linear regression and ARIMA models but makes fewer assumptions about the data:</span>
<span id="cb29-1426"><a href="#cb29-1426" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>It detects the trend based on the relative ordering of values, not their exact magnitudes</span>
<span id="cb29-1427"><a href="#cb29-1427" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>It is resistant to the influence of outliers that might skew parametric analyses</span>
<span id="cb29-1428"><a href="#cb29-1428" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>It doesn't assume that the trend is strictly linear, only that it is monotonic</span>
<span id="cb29-1429"><a href="#cb29-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1430"><a href="#cb29-1430" aria-hidden="true" tabindex="-1"></a>For ecological and agricultural time series, which often contain irregular fluctuations due to weather events or policy changes, this robust approach provides valuable confirmation of long-term trends. The strong positive tau value (0.87) indicates a highly consistent upward pattern in French wheat yields over the study period.</span>
<span id="cb29-1431"><a href="#cb29-1431" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1432"><a href="#cb29-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1433"><a href="#cb29-1433" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb29-1434"><a href="#cb29-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1435"><a href="#cb29-1435" aria-hidden="true" tabindex="-1"></a>This chapter has demonstrated a variety of statistical tests using real agricultural and biodiversity datasets. We've covered:</span>
<span id="cb29-1436"><a href="#cb29-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1437"><a href="#cb29-1437" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Tests for comparing groups**:</span>
<span id="cb29-1438"><a href="#cb29-1438" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>t-tests for comparing two groups</span>
<span id="cb29-1439"><a href="#cb29-1439" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>ANOVA for comparing multiple groups</span>
<span id="cb29-1440"><a href="#cb29-1440" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Non-parametric alternatives when data doesn't meet parametric assumptions</span>
<span id="cb29-1441"><a href="#cb29-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1442"><a href="#cb29-1442" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Tests for relationships**:</span>
<span id="cb29-1443"><a href="#cb29-1443" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Correlation analysis to measure the strength of relationships</span>
<span id="cb29-1444"><a href="#cb29-1444" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Regression analysis to model relationships between variables</span>
<span id="cb29-1445"><a href="#cb29-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1446"><a href="#cb29-1446" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Tests for categorical data**:</span>
<span id="cb29-1447"><a href="#cb29-1447" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Chi-Square test for examining associations between categorical variables</span>
<span id="cb29-1448"><a href="#cb29-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1449"><a href="#cb29-1449" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Tests for time series data**:</span>
<span id="cb29-1450"><a href="#cb29-1450" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Time series analysis for identifying patterns over time</span>
<span id="cb29-1451"><a href="#cb29-1451" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Mann-Kendall test for detecting trends</span>
<span id="cb29-1452"><a href="#cb29-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1453"><a href="#cb29-1453" aria-hidden="true" tabindex="-1"></a>When conducting statistical tests, remember to:</span>
<span id="cb29-1454"><a href="#cb29-1454" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Clearly define your research question</span>
<span id="cb29-1455"><a href="#cb29-1455" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check if your data meets the assumptions of the test</span>
<span id="cb29-1456"><a href="#cb29-1456" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Choose the appropriate test based on your data type and research question</span>
<span id="cb29-1457"><a href="#cb29-1457" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret results in the context of your research question</span>
<span id="cb29-1458"><a href="#cb29-1458" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Consider the practical significance, not just statistical significance</span>
<span id="cb29-1459"><a href="#cb29-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1460"><a href="#cb29-1460" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb29-1461"><a href="#cb29-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1462"><a href="#cb29-1462" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Using the crop yield dataset, compare maize yields between continents using both ANOVA and the Kruskal-Wallis test. Which is more appropriate and why?</span>
<span id="cb29-1463"><a href="#cb29-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1464"><a href="#cb29-1464" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Examine the relationship between potato and rice yields using correlation analysis. Calculate both Pearson and Spearman correlations and explain which is more appropriate.</span>
<span id="cb29-1465"><a href="#cb29-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1466"><a href="#cb29-1466" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Using the biodiversity dataset, investigate whether there's an association between conservation status and another categorical variable of your choice.</span>
<span id="cb29-1467"><a href="#cb29-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1468"><a href="#cb29-1468" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Perform a time series analysis of wheat yields for China and compare the trend with that of the United States.</span>
<span id="cb29-1469"><a href="#cb29-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1470"><a href="#cb29-1470" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Using the animal dataset (<span class="in">`../data/entomology/insects.csv`</span>), compare two groups using an appropriate statistical test.</span>
<span id="cb29-1471"><a href="#cb29-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1472"><a href="#cb29-1472" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Create a multiple regression model to predict coffee quality scores using the coffee economics dataset (<span class="in">`../data/economics/economic.csv`</span>).</span>
<span id="cb29-1473"><a href="#cb29-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1474"><a href="#cb29-1474" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chapter Summary</span></span>
<span id="cb29-1475"><a href="#cb29-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1476"><a href="#cb29-1476" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Concepts</span></span>
<span id="cb29-1477"><a href="#cb29-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1478"><a href="#cb29-1478" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Test Selection**: Choosing the right test depends on data type, distribution, and study design</span>
<span id="cb29-1479"><a href="#cb29-1479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Parametric vs. Non-Parametric**: Parametric tests have more power but require normality; non-parametric tests are more robust</span>
<span id="cb29-1480"><a href="#cb29-1480" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Group Comparisons**: t-tests and ANOVA compare means across two or more groups</span>
<span id="cb29-1481"><a href="#cb29-1481" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Relationships**: Correlation and regression quantify associations between variables</span>
<span id="cb29-1482"><a href="#cb29-1482" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Post-hoc Testing**: Essential for ANOVA and Kruskal-Wallis to pinpoint specific differences</span>
<span id="cb29-1483"><a href="#cb29-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1484"><a href="#cb29-1484" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Functions Learned</span></span>
<span id="cb29-1485"><a href="#cb29-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1486"><a href="#cb29-1486" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`t.test()`</span> - One-sample, two-sample, and paired t-tests</span>
<span id="cb29-1487"><a href="#cb29-1487" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`aov()`</span> - Analysis of Variance (ANOVA)</span>
<span id="cb29-1488"><a href="#cb29-1488" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`TukeyHSD()`</span> - Post-hoc test for ANOVA</span>
<span id="cb29-1489"><a href="#cb29-1489" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`wilcox.test()`</span> - Mann-Whitney U and Wilcoxon signed-rank tests</span>
<span id="cb29-1490"><a href="#cb29-1490" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`kruskal.test()`</span> - Kruskal-Wallis test</span>
<span id="cb29-1491"><a href="#cb29-1491" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`cor.test()`</span> - Correlation analysis (Pearson and Spearman)</span>
<span id="cb29-1492"><a href="#cb29-1492" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`lm()`</span> - Linear and multiple regression models</span>
<span id="cb29-1493"><a href="#cb29-1493" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`shapiro.test()`</span> - Test for normality</span>
<span id="cb29-1494"><a href="#cb29-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1495"><a href="#cb29-1495" aria-hidden="true" tabindex="-1"></a><span class="fu">### Next Steps</span></span>
<span id="cb29-1496"><a href="#cb29-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1497"><a href="#cb29-1497" aria-hidden="true" tabindex="-1"></a>In the next part of the book, we will shift our focus to **Data Visualization**, exploring how to create compelling and informative graphics to communicate your results effectively.</span>
<span id="cb29-1498"><a href="#cb29-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1499"><a href="#cb29-1499" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb29-1500"><a href="#cb29-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1501"><a href="#cb29-1501" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Test Selection**: For each of the following scenarios, identify the appropriate statistical test:</span>
<span id="cb29-1502"><a href="#cb29-1502" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Comparing tree heights between three different soil types (normal distribution)</span>
<span id="cb29-1503"><a href="#cb29-1503" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Testing if the number of bird species differs between two forest fragments (non-normal)</span>
<span id="cb29-1504"><a href="#cb29-1504" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Predicting biomass based on rainfall and temperature</span>
<span id="cb29-1505"><a href="#cb29-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1506"><a href="#cb29-1506" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Group Comparison**: Use the <span class="in">`iris`</span> dataset to compare sepal lengths among the three species using ANOVA. Follow up with a post-hoc test.</span>
<span id="cb29-1507"><a href="#cb29-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1508"><a href="#cb29-1508" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Non-Parametric Test**: Use the <span class="in">`mtcars`</span> dataset to compare fuel efficiency (<span class="in">`mpg`</span>) between automatic and manual transmissions (<span class="in">`am`</span>) using a non-parametric test.</span>
<span id="cb29-1509"><a href="#cb29-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1510"><a href="#cb29-1510" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Correlation**: Analyze the relationship between two continuous variables in your own dataset. Calculate the correlation coefficient and interpret the result.</span>
<span id="cb29-1511"><a href="#cb29-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1512"><a href="#cb29-1512" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Regression**: Fit a linear regression model to predict a continuous outcome. Interpret the slope and R-squared value.</span>
<span id="cb29-1513"><a href="#cb29-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1514"><a href="#cb29-1514" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>**Reporting**: Write a short paragraph reporting the results of one of your analyses, including the test statistic, degrees of freedom, p-value, and effect size.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2024-2025 Jimmy Moses</p>
</div>   
    <div class="nav-footer-center">
<p>⚠️ <strong>FIRST DRAFT</strong> (First published 2024, Updated 2025) ⚠️</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jm0535/dains/edit/main/chapters/05-statistical-tests.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jm0535/dains/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/jm0535/dains/blob/main/chapters/05-statistical-tests.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>